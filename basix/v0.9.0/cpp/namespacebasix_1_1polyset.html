<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,maximum-scale=2">
    <link rel="stylesheet" type="text/css" media="screen" href="https://fenicsproject.org/assets/css/style.css?v=2023-12-11">
    <link rel="apple-touch-icon" sizes="57x57" href="https://fenicsproject.org/assets/icons/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="https://fenicsproject.org/assets/icons/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="https://fenicsproject.org/assets/icons/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="https://fenicsproject.org/assets/icons/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="https://fenicsproject.org/assets/icons/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="https://fenicsproject.org/assets/icons/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="https://fenicsproject.org/assets/icons/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="https://fenicsproject.org/assets/icons/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="https://fenicsproject.org/assets/icons/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="https://fenicsproject.org/assets/icons/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://fenicsproject.org/assets/icons/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="https://fenicsproject.org/assets/icons/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://fenicsproject.org/assets/icons/favicon-16x16.png">
    <link rel="manifest" href="https://fenicsproject.org/assets/icons/manifest.json">
    <meta name="msapplication-TileColor" content="#555555">
    <meta name="msapplication-TileImage" content="https://fenicsproject.org/assets/icons/ms-icon-144x144.png">
    <meta name="theme-color" content="#555555">
    <link rel="stylesheet" type="text/css" href="https://fenicsproject.org/assets/css/customsty.css">
   <link rel="stylesheet" type="text/css" href="/assets/sty.css">
    <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://fenicsproject.org/assets/fontawesome/js/fontawesome.js"></script>
    <script src="https://fenicsproject.org/assets/fontawesome/js/brands.js"></script>
    <script src="https://fenicsproject.org/assets/fontawesome/js/solid.js"></script>
    <script type='text/javascript'>
document.getElementById("MathJax-script").addEventListener('load', function () {
window.MathJax = {
  tex: {
    inlineMath: [['$', '$']],
    displayMath: [['[[',']]']]
  },
  svg: {
    fontCache: 'global'
  }
}});
</script>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Basix: basix::polyset Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
  </head>
<body>
<!-- HEADER -->
<div id="nav_head">
  <header class="inner" id="nav_head_inner">
    <a id="logo" href="https://fenicsproject.org/"><img src="https://fenicsproject.org/assets/img/fenics-logo-small.png"></a>
    <div class="top-navigation">
  <nav role="navigation" id="site-nav" class="nav">
    <ul>
        <li><a href="https://fenicsproject.org/">Home</a></li>
        <li><a href="https://fenicsproject.org/fenics-2025">FEniCS 2025</a></li>
        <li><a href="https://fenicsproject.org/download">Download</a></li>
        <li><a href="https://fenicsproject.org/documentation">Documentation</a></li>
        <li><a href="https://fenicsproject.org/community">Community</a></li>
        <li><a href="https://fenicsproject.org/citing">Citing</a></li>
        <li><a href="https://numfocus.org/donate-to-fenics"><i class="fa-solid fa-arrow-up-right-from-square"></i> Donate</a></li>
    </ul>
  </nav>
</div>
  </header>
</div>
  <div id="header_wrap" class="outer" style="background-image:url(https://fenicsproject.org/assets/img/headers/fenics_fire.png);background-repeat:repeat">
  <header class="inner lesstall">
  <h1 id="project_title">Basix 0.9.0</h1>
  </header>
</div>
<!-- MAIN CONTENT -->
<div id="main_content_wrap" class="outer">
  <section id="main_content" class="inner">
    <h2 id="project_subtitle"><a class='fenicsnav' href='https://docs.fenicsproject.org/basix/v0.9.0/index.html'>Home</a>
&nbsp;
&nbsp;
<a class='fenicsnav' href='https://docs.fenicsproject.org/basix/v0.9.0/install.html'>Installation</a>
&nbsp;
&nbsp;
<a class='fenicsnav' href='https://docs.fenicsproject.org/basix/v0.9.0/python/demo'>Demos</a>
&nbsp;
&nbsp;
<a class='fenicsnav' href='https://docs.fenicsproject.org/basix/v0.9.0/cpp'>C++ docs</a>
&nbsp;
&nbsp;
<a class='fenicsnav' href='https://docs.fenicsproject.org/basix/v0.9.0/python'>Python docs</a>
</h2><div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespacebasix.html">basix</a></li><li class="navelem"><a class="el" href="namespacebasix_1_1polyset.html">polyset</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">basix::polyset Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Polynomial expansion sets.  
<a href="namespacebasix_1_1polyset.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a04ec1a9561f875220b50ad2076cd35c2"><td class="memItemLeft" align="right" valign="top"><a id="a04ec1a9561f875220b50ad2076cd35c2"></a>enum class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasix_1_1polyset.html#a04ec1a9561f875220b50ad2076cd35c2">type</a> { <b>standard</b> = 0
, <b>macroedge</b> = 1
 }</td></tr>
<tr class="memdesc:a04ec1a9561f875220b50ad2076cd35c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cell type. <br /></td></tr>
<tr class="separator:a04ec1a9561f875220b50ad2076cd35c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a535e46b2491c0ec69f7d7ed5f536dc7d"><td class="memTemplParams" colspan="2">template&lt;std::floating_point T&gt; </td></tr>
<tr class="memitem:a535e46b2491c0ec69f7d7ed5f536dc7d"><td class="memTemplItemLeft" align="right" valign="top">std::pair&lt; std::vector&lt; T &gt;, std::array&lt; std::size_t, 3 &gt; &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacebasix_1_1polyset.html#a535e46b2491c0ec69f7d7ed5f536dc7d">tabulate</a> (<a class="el" href="namespacebasix_1_1cell.html#a30ecf43ef8a377355caf943f9d8204b4">cell::type</a> celltype, <a class="el" href="namespacebasix_1_1polyset.html#a04ec1a9561f875220b50ad2076cd35c2">polyset::type</a> ptype, int d, int n, MDSPAN_IMPL_STANDARD_NAMESPACE::mdspan&lt; const T, MDSPAN_IMPL_STANDARD_NAMESPACE::dextents&lt; std::size_t, 2 &gt;&gt; x)</td></tr>
<tr class="memdesc:a535e46b2491c0ec69f7d7ed5f536dc7d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tabulate the orthonormal polynomial basis, and derivatives, at points on the reference cell.  <a href="namespacebasix_1_1polyset.html#a535e46b2491c0ec69f7d7ed5f536dc7d">More...</a><br /></td></tr>
<tr class="separator:a535e46b2491c0ec69f7d7ed5f536dc7d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9facc1362b1107a0775e6613d581324"><td class="memTemplParams" colspan="2">template&lt;std::floating_point T&gt; </td></tr>
<tr class="memitem:aa9facc1362b1107a0775e6613d581324"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="namespacebasix_1_1polyset.html#aa9facc1362b1107a0775e6613d581324">tabulate</a> (MDSPAN_IMPL_STANDARD_NAMESPACE::mdspan&lt; T, MDSPAN_IMPL_STANDARD_NAMESPACE::dextents&lt; std::size_t, 3 &gt;&gt; P, <a class="el" href="namespacebasix_1_1cell.html#a30ecf43ef8a377355caf943f9d8204b4">cell::type</a> celltype, <a class="el" href="namespacebasix_1_1polyset.html#a04ec1a9561f875220b50ad2076cd35c2">polyset::type</a> ptype, int d, int n, MDSPAN_IMPL_STANDARD_NAMESPACE::mdspan&lt; const T, MDSPAN_IMPL_STANDARD_NAMESPACE::dextents&lt; std::size_t, 2 &gt;&gt; x)</td></tr>
<tr class="memdesc:aa9facc1362b1107a0775e6613d581324"><td class="mdescLeft">&#160;</td><td class="mdescRight">Tabulate the orthonormal polynomial basis, and derivatives, at points on the reference cell.  <a href="namespacebasix_1_1polyset.html#aa9facc1362b1107a0775e6613d581324">More...</a><br /></td></tr>
<tr class="separator:aa9facc1362b1107a0775e6613d581324"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c3b2a1deeee57ba49002ef723764738"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasix_1_1polyset.html#a2c3b2a1deeee57ba49002ef723764738">dim</a> (<a class="el" href="namespacebasix_1_1cell.html#a30ecf43ef8a377355caf943f9d8204b4">cell::type</a> cell, <a class="el" href="namespacebasix_1_1polyset.html#a04ec1a9561f875220b50ad2076cd35c2">polyset::type</a> ptype, int d)</td></tr>
<tr class="memdesc:a2c3b2a1deeee57ba49002ef723764738"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dimension of a polynomial space.  <a href="namespacebasix_1_1polyset.html#a2c3b2a1deeee57ba49002ef723764738">More...</a><br /></td></tr>
<tr class="separator:a2c3b2a1deeee57ba49002ef723764738"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a6e365944a944f005610968ffba2dfc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasix_1_1polyset.html#a7a6e365944a944f005610968ffba2dfc">nderivs</a> (<a class="el" href="namespacebasix_1_1cell.html#a30ecf43ef8a377355caf943f9d8204b4">cell::type</a> cell, int d)</td></tr>
<tr class="memdesc:a7a6e365944a944f005610968ffba2dfc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of derivatives that the orthonormal basis will have on the given cell.  <a href="namespacebasix_1_1polyset.html#a7a6e365944a944f005610968ffba2dfc">More...</a><br /></td></tr>
<tr class="separator:a7a6e365944a944f005610968ffba2dfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addff9b18eddf754b6abf07133bc44ba6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacebasix_1_1polyset.html#a04ec1a9561f875220b50ad2076cd35c2">polyset::type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasix_1_1polyset.html#addff9b18eddf754b6abf07133bc44ba6">superset</a> (<a class="el" href="namespacebasix_1_1cell.html#a30ecf43ef8a377355caf943f9d8204b4">cell::type</a> cell, <a class="el" href="namespacebasix_1_1polyset.html#a04ec1a9561f875220b50ad2076cd35c2">polyset::type</a> type1, <a class="el" href="namespacebasix_1_1polyset.html#a04ec1a9561f875220b50ad2076cd35c2">polyset::type</a> type2)</td></tr>
<tr class="memdesc:addff9b18eddf754b6abf07133bc44ba6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the polyset types that is a superset of two types on the given cell.  <a href="namespacebasix_1_1polyset.html#addff9b18eddf754b6abf07133bc44ba6">More...</a><br /></td></tr>
<tr class="separator:addff9b18eddf754b6abf07133bc44ba6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee7ca976b30b64e6d8ba45fa92f60ad2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespacebasix_1_1polyset.html#a04ec1a9561f875220b50ad2076cd35c2">polyset::type</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacebasix_1_1polyset.html#aee7ca976b30b64e6d8ba45fa92f60ad2">restriction</a> (<a class="el" href="namespacebasix_1_1polyset.html#a04ec1a9561f875220b50ad2076cd35c2">polyset::type</a> ptype, <a class="el" href="namespacebasix_1_1cell.html#a30ecf43ef8a377355caf943f9d8204b4">cell::type</a> cell, <a class="el" href="namespacebasix_1_1cell.html#a30ecf43ef8a377355caf943f9d8204b4">cell::type</a> restriction_cell)</td></tr>
<tr class="memdesc:aee7ca976b30b64e6d8ba45fa92f60ad2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get the polyset type that represents the restrictions of a type on a subentity.  <a href="namespacebasix_1_1polyset.html#aee7ca976b30b64e6d8ba45fa92f60ad2">More...</a><br /></td></tr>
<tr class="separator:aee7ca976b30b64e6d8ba45fa92f60ad2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Polynomial expansion sets. </p>
<p>In Basix, the bases of the polynomial sets spanned by finite elements are represented by a set of coefficients of orthonormal polynomials on the cell. By orthogonality, we mean that</p>
<p class="formulaDsp">
\[\int_R p_ip_j=\begin{cases}1&amp;i=j\\0&amp;i\not=j\end{cases}\]
</p>
<h3>Interval</h3>
<p>Legendre polynomials form a set of orthogonal polynomials on an interval. Legrendre polynomials are a special case of the <a href="https://en.wikipedia.org/wiki/Jacobi_polynomials">Jacobi polynomials</a>, \(P_n^{\alpha, \beta}\), with the weights \((\alpha, \beta) = (0, 0)\). Using the Jacobi recurrence relation, we have</p>
<p class="formulaDsp">
\[ n P^{0,0}_n(x) = (2n - 1) x P^{0,0}_{n - 1}(x) - (n-1) P^{0,0}_{n-2}(x),\]
</p>
<p>starting with \(P^{0,0}_0 = 1\). Legendre polynomials are orthogonal when integrated over the interval [-1, 1].</p>
<p>In Basix, the interval [0, 1] is used as the reference, so we apply the transformation \(x\mapsto 2x-1\) to the standard Legendre polynomials. The orthogonal polynomials we use are therefore given by the recurrence relation</p>
<p class="formulaDsp">
\[n p_n(x)=(2n-1)(2x-1)p_{n-1}(x)-(n-1)p_{n-2}(x).\]
</p>
<p>For a given set of points, the recurrence relation can be used to compute the polynomial set up to arbitrary order.</p>
<h3>Triangle (Dubiner's basis)</h3>
<p>See <a href="https://doi.org/10.1016/0045-7825(94)00745-9">Sherwin &amp; Karniadakis (1995)</a>.</p>
<p>An orthogonal set over a triangle can be obtained with a change of variable to \(\zeta = 2\frac{1+x}{1 - y} - 1\), and a modified polynomial. The polynomial basis becomes:</p>
<p class="formulaDsp">
\[ Q_{p,q} = P^{0,0}_p(\zeta) \left(\frac{1-y}{2}\right)^p\ P_q^{2p+1, 0}(y), \]
</p>
<p>with a Legendre Polynomial of \(\zeta\) and a weighted Jacobi Polynomial of \(y\). In order to calculate these without actually multiplying together the two polynomials directly, we can first compute \(Q_{p, 0}\) using a recurrence relation (since \(P_0^{2p + 1, 0} = 1\)):</p>
<p class="formulaDsp">
\[ p Q_{p,0} = (2p-1)(2x + y+1)Q_{p-1,0} - (p-1)(1-y)^2 Q_{p-2, 0}.\]
</p>
<p>Subsequently, we can calculate \(Q_{p,q}\) by building up from \(Q_{p,0}\) with another recurrence relation:</p>
<p class="formulaDsp">
\[ Q_{p,q} = (a_0 y + a_1) Q_{p, q-1} + a_2 Q_{p, q-2}, \]
</p>
<p>where \(a_0, a_1, a_2\) are the coefficients in the Jacobi recurrence relation with \((\alpha,\beta) = (2p+1, 0)\), see <a href="https://en.wikipedia.org/wiki/Jacobi_polynomials#Recurrence_relations">Wikipedia</a>. Note that \(a_2 = 0\) when \(q &lt; 2\).</p>
<h3>Tetrahedron</h3>
<p>See <a href="https://doi.org/10.1016/0045-7825(94)00745-9">Sherwin &amp; Karniadakis (1995)</a>.</p>
<p>Let \(\zeta = 2\frac{1+x}{y+z} + 1\) and \(\xi = 2\frac{1+y}{1-z} - 1\). Orthogonal polynomials on a tetrahedron are then given by</p>
<p class="formulaDsp">
\[ Q_{p, q, r} = P^{0,0}_p(\zeta)\left(\frac{y+z}{2}\right)^p\ P_q^{2p+1,0}(\xi)\left(\frac{1-z}{2}\right)^q\ P_r^{2(p+q+1), 0}(z).\]
</p>
<p>This can similarly be built up by first computing \(Q_{p,0,0}\), then \(Q_{p, q, 0}\) and finally \(Q_{p, q, r}\) with recurrence relations on each axis.</p>
<h3>Quadrilateral and hexahedron</h3>
<p>The polynomial sets for quadrilateral and hexahedral elements can be formed by applying the recurrence relation for intervals in each direction.</p>
<h3>Prism</h3>
<p>The polynomial set for a prism can be computed by using using the recurrence relation for the triangle to get the polynomials that are constant with respect to \(z\), then applying the recurrence relation for the interval to compute further polynomials with \(z\)s.</p>
<h3>Pyramid</h3>
<p>Orthogonal polynomials on the pyramid element are best calculated in the same way as the tetrahedron, using recurrence relations on each axis. Let \(\zeta_x = 2\frac{1+x}{1-z} - 1\), \(\zeta_y = 2\frac{1+y}{1-z} - 1\). The recurrence relation is then</p>
<p class="formulaDsp">
\[Q_{p, q, r} = P^{0,0}_p(\zeta_x) P^{0,0}_q(\zeta_y) \left(\frac{1-z}{2}\right)^{(p+q)} P_r^{2(p+q+1), 0}(z).\]
</p>
<h3>Normalisation</h3>
<p>For each cell type, we obtain an orthonormal set of polynomials by scaling each of the orthogonal polynomials.</p>
<h3>Derivatives</h3>
<p>Recurrence relations can also be used to find the derivatives of the polynomials at given points. For example, on the interval, the first derivatives are given by</p>
<p class="formulaDsp">
\[ n P&#39;_n(x) = (2n - 1) \left(P_{n-1}(x) + x P&#39;_{n - 1}(x)\right) + (n-1)P&#39;_{n-2}(x). \]
</p>
<p>More generally, the \(k\)-th derivative is given by</p>
<p class="formulaDsp">
\[ n P^k_n(x) = (2n - 1) \left(k P^{k-1}_{n-1}(x) + x P^k_{n - 1}(x)\right)+ (n-1) P^k_{n-2}(x) \]
</p>
<p>This is now a recurrence relation in both \(n\) and \(k\). Similar recurrence relations can be obtained for the derivatives of all the polynomial sets on the other shapes. Care must be taken with quadratic terms, and cross-terms in two and three dimensions. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a535e46b2491c0ec69f7d7ed5f536dc7d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a535e46b2491c0ec69f7d7ed5f536dc7d">&#9670;&nbsp;</a></span>tabulate() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;std::floating_point T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; std::vector&lt; T &gt;, std::array&lt; std::size_t, 3 &gt; &gt; basix::polyset::tabulate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacebasix_1_1cell.html#a30ecf43ef8a377355caf943f9d8204b4">cell::type</a>&#160;</td>
          <td class="paramname"><em>celltype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacebasix_1_1polyset.html#a04ec1a9561f875220b50ad2076cd35c2">polyset::type</a>&#160;</td>
          <td class="paramname"><em>ptype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MDSPAN_IMPL_STANDARD_NAMESPACE::mdspan&lt; const T, MDSPAN_IMPL_STANDARD_NAMESPACE::dextents&lt; std::size_t, 2 &gt;&gt;&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tabulate the orthonormal polynomial basis, and derivatives, at points on the reference cell. </p>
<p>All derivatives up to the given order are computed. If derivatives are not required, use <code>n = 0</code>. For example, order <code>n = 2</code> for a 2D cell, will compute the basis \(\psi, d\psi/dx, d\psi/dy, d^2 \psi/dx^2, d^2\psi/dxdy, d^2\psi/dy^2\) in that order (0, 0), (1, 0), (0, 1), (2, 0), (1, 1), (0 ,2).</p>
<p>For an interval cell there are <code>nderiv + 1</code> derivatives, for a 2D cell, there are <code>(nderiv + 1)(nderiv + 2)/2</code> derivatives, and in 3D, there are <code>(nderiv + 1)(nderiv + 2)(nderiv + 3)/6</code>. The ordering is 'triangular' with the lower derivatives appearing first.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">celltype</td><td>Cell type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ptype</td><td>The polynomial type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>Polynomial degree </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Maximum derivative order. Use n = 0 for the basis only. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Points at which to evaluate the basis. The shape is (number of points, geometric dimension). </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Polynomial sets, for each derivative, tabulated at points. The shape is <code>(number of derivatives computed, number of points, basis index)</code>.</dd></dl>
<ul>
<li>The first index is the derivative. The first entry is the basis itself. Derivatives are stored in triangular (2D) or tetrahedral (3D) ordering, eg if <code>(p, q)</code> denotes <code>p</code> order derivative with respect to <code>x</code> and <code>q</code> order derivative with respect to <code>y</code>, [0] -&gt; (0, 0), [1] -&gt; (1, 0), [2] -&gt; (0, 1), [3] -&gt; (2, 0), [4] -&gt; (1, 1), [5] -&gt; (0, 2), [6] -&gt; (3, 0),... The function <a class="el" href="namespacebasix_1_1indexing.html#aee955bbd20bb422bca33e4654b7d7e46" title="Compute trivial indexing in a 1D array (for completeness).">basix::indexing::idx</a> maps tuples <code>(p, q, r)</code> to the array index.</li>
<li>The second index is the point, with index <code>i</code> corresponding to the point in row <code>i</code> of <code>x</code>.</li>
<li>The third index is the basis function index. <dl class="todo"><dt><b><a class="el" href="todo.html#_todo000003">Todo:</a></b></dt><dd>Does the order for the third index need to be documented? </dd></dl>
</li>
</ul>

</div>
</div>
<a id="aa9facc1362b1107a0775e6613d581324"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9facc1362b1107a0775e6613d581324">&#9670;&nbsp;</a></span>tabulate() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;std::floating_point T&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void basix::polyset::tabulate </td>
          <td>(</td>
          <td class="paramtype">MDSPAN_IMPL_STANDARD_NAMESPACE::mdspan&lt; T, MDSPAN_IMPL_STANDARD_NAMESPACE::dextents&lt; std::size_t, 3 &gt;&gt;&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacebasix_1_1cell.html#a30ecf43ef8a377355caf943f9d8204b4">cell::type</a>&#160;</td>
          <td class="paramname"><em>celltype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacebasix_1_1polyset.html#a04ec1a9561f875220b50ad2076cd35c2">polyset::type</a>&#160;</td>
          <td class="paramname"><em>ptype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">MDSPAN_IMPL_STANDARD_NAMESPACE::mdspan&lt; const T, MDSPAN_IMPL_STANDARD_NAMESPACE::dextents&lt; std::size_t, 2 &gt;&gt;&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Tabulate the orthonormal polynomial basis, and derivatives, at points on the reference cell. </p>
<p>All derivatives up to the given order are computed. If derivatives are not required, use <code>n = 0</code>. For example, order <code>n = 2</code> for a 2D cell, will compute the basis \(\psi, d\psi/dx, d\psi/dy, d^2 \psi/dx^2, d^2\psi/dxdy, d^2\psi/dy^2\) in that order (0, 0), (1, 0), (0, 1), (2, 0), (1, 1), (0 ,2).</p>
<p>For an interval cell there are <code>nderiv + 1</code> derivatives, for a 2D cell, there are <code>(nderiv + 1)(nderiv + 2)/2</code> derivatives, and in 3D, there are <code>(nderiv + 1)(nderiv + 2)(nderiv + 3)/6</code>. The ordering is 'triangular' with the lower derivatives appearing first.</p>
<dl class="section note"><dt>Note</dt><dd>This function will be called at runtime when tabulating a finite element, so its performance is critical.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">P</td><td>Polynomial sets, for each derivative, tabulated at points. The shape is <code>(number of derivatives computed, number of points, basis index)</code>.</td></tr>
  </table>
  </dd>
</dl>
<ul>
<li>The first index is the derivative. The first entry is the basis itself. Derivatives are stored in triangular (2D) or tetrahedral (3D) ordering, eg if <code>(p, q)</code> denotes <code>p</code> order derivative with respect to <code>x</code> and <code>q</code> order derivative with respect to <code>y</code>, [0] -&gt; (0, 0), [1] -&gt; (1, 0), [2] -&gt; (0, 1), [3] -&gt; (2, 0), [4] -&gt; (1, 1), [5] -&gt; (0, 2), [6] -&gt; (3, 0),... The function <a class="el" href="namespacebasix_1_1indexing.html#aee955bbd20bb422bca33e4654b7d7e46" title="Compute trivial indexing in a 1D array (for completeness).">basix::indexing::idx</a> maps tuples <code>(p, q, r)</code> to the array index.</li>
<li>The second index is the point, with index <code>i</code> corresponding to the point in row <code>i</code> of <code>x</code>.</li>
<li>The third index is the basis function index. <dl class="todo"><dt><b><a class="el" href="todo.html#_todo000004">Todo:</a></b></dt><dd>Does the order for the third index need to be documented? </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">celltype</td><td>Cell type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ptype</td><td>The polynomial type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>Polynomial degree </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">n</td><td>Maximum derivative order. Use <code>n=0</code> for the basis only. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Points at which to evaluate the basis. The shape is <code>(number of points, geometric dimension)</code>. </td></tr>
  </table>
  </dd>
</dl>
</li>
</ul>

</div>
</div>
<a id="a2c3b2a1deeee57ba49002ef723764738"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c3b2a1deeee57ba49002ef723764738">&#9670;&nbsp;</a></span>dim()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int basix::polyset::dim </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacebasix_1_1cell.html#a30ecf43ef8a377355caf943f9d8204b4">cell::type</a>&#160;</td>
          <td class="paramname"><em>cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacebasix_1_1polyset.html#a04ec1a9561f875220b50ad2076cd35c2">polyset::type</a>&#160;</td>
          <td class="paramname"><em>ptype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>d</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Dimension of a polynomial space. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cell</td><td>Cell type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">ptype</td><td>Polynomial type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>Polynomial degree </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The number of terms in the basis spanning a space of polynomial degree <code>d</code>. </dd></dl>

</div>
</div>
<a id="a7a6e365944a944f005610968ffba2dfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a6e365944a944f005610968ffba2dfc">&#9670;&nbsp;</a></span>nderivs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int basix::polyset::nderivs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacebasix_1_1cell.html#a30ecf43ef8a377355caf943f9d8204b4">cell::type</a>&#160;</td>
          <td class="paramname"><em>cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>d</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Number of derivatives that the orthonormal basis will have on the given cell. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cell</td><td>Cell type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">d</td><td>Highest derivative order </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of derivatives </dd></dl>

</div>
</div>
<a id="addff9b18eddf754b6abf07133bc44ba6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#addff9b18eddf754b6abf07133bc44ba6">&#9670;&nbsp;</a></span>superset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacebasix_1_1polyset.html#a04ec1a9561f875220b50ad2076cd35c2">polyset::type</a> basix::polyset::superset </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacebasix_1_1cell.html#a30ecf43ef8a377355caf943f9d8204b4">cell::type</a>&#160;</td>
          <td class="paramname"><em>cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacebasix_1_1polyset.html#a04ec1a9561f875220b50ad2076cd35c2">polyset::type</a>&#160;</td>
          <td class="paramname"><em>type1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacebasix_1_1polyset.html#a04ec1a9561f875220b50ad2076cd35c2">polyset::type</a>&#160;</td>
          <td class="paramname"><em>type2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the polyset types that is a superset of two types on the given cell. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">cell</td><td>Cell type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">type1</td><td>First polyset type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">type2</td><td>Decond polyset type </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Superset type </dd></dl>

</div>
</div>
<a id="aee7ca976b30b64e6d8ba45fa92f60ad2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee7ca976b30b64e6d8ba45fa92f60ad2">&#9670;&nbsp;</a></span>restriction()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespacebasix_1_1polyset.html#a04ec1a9561f875220b50ad2076cd35c2">polyset::type</a> basix::polyset::restriction </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="namespacebasix_1_1polyset.html#a04ec1a9561f875220b50ad2076cd35c2">polyset::type</a>&#160;</td>
          <td class="paramname"><em>ptype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacebasix_1_1cell.html#a30ecf43ef8a377355caf943f9d8204b4">cell::type</a>&#160;</td>
          <td class="paramname"><em>cell</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="namespacebasix_1_1cell.html#a30ecf43ef8a377355caf943f9d8204b4">cell::type</a>&#160;</td>
          <td class="paramname"><em>restriction_cell</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get the polyset type that represents the restrictions of a type on a subentity. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">ptype</td><td>Polyset type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cell</td><td>Cell type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">restriction_cell</td><td>Cell type of the subentity </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Restricted polyset type </dd></dl>

</div>
</div>
</div><!-- contents -->

  </section>
</div>
<!-- FOOTER  -->
<div id="footer_wrap" class="outer">
  <footer class="inner">
    &copy; FEniCS Project 2024. Changes to this website can be made/suggested on <a href='https://github.com/FEniCS/web'>GitHub</a>.
  </footer>
</div>
</body>
</html>
