
<!DOCTYPE html>

<html class="writer-html5" data-content_root="../" lang="en">
<head>
<meta charset="utf-8"/><meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Mixed formulation of the Poisson equation with a block-preconditioner/solver # noqa — DOLFINx 0.10.0.0 documentation</title>
<link href="../_static/pygments.css?v=03e43079" rel="stylesheet" type="text/css"/>
<link href="../_static/css/theme.css?v=e59714d7" rel="stylesheet" type="text/css"/>
<link href="../_static/sphinx-codeautolink.css?v=b2176991" rel="stylesheet" type="text/css"/>
<script src="../_static/jquery.js?v=5d32c60e"></script>
<script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
<script src="../_static/documentation_options.js?v=15ca63c5"></script>
<script src="../_static/doctools.js?v=9bcbadda"></script>
<script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
<script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
<script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="../_static/js/theme.js"></script>
<link href="../genindex.html" rel="index" title="Index"/>
<link href="../search.html" rel="search" title="Search"/>
<link href="demo_stokes.html" rel="next" title="Stokes equations using Taylor-Hood elements"/>
<link href="demo_axis.html" rel="prev" title="Electromagnetic scattering from a sphere (axisymmetric)"/>
</head>
<body class="wy-body-for-nav">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href="../index.html">
            DOLFINx
          </a>
<div role="search">
<form action="../search.html" class="wy-form" id="rtd-search-form" method="get">
<input aria-label="Search docs" name="q" placeholder="Search docs" type="text"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
</div>
</div><div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../demos.html">Demos</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../demos.html#pdes-introductory">PDEs (introductory)</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../demos.html#pdes-advanced">PDEs (advanced)</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Mixed formulation of the Poisson equation with a block-preconditioner/solver # noqa</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#equation-and-problem-definition">Equation and problem definition</a></li>
<li class="toctree-l4"><a class="reference internal" href="#implementation">Implementation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="demo_stokes.html">Stokes equations using Taylor-Hood elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_navier-stokes.html">Divergence conforming discontinuous Galerkin method for the Navier–Stokes equations # noqa</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_elasticity.html">Elasticity using algebraic multigrid</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_cahn-hilliard.html">Cahn-Hilliard equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_static-condensation.html">Static condensation of linear elasticity</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_biharmonic.html">Biharmonic equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_types.html">Solving PDEs with different scalar (float) types</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_poisson_matrix_free.html">Matrix-free conjugate gradient solver for the Poisson equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_pyamg.html">Solve the Poisson and linearised elasticity equations using pyamg</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_hdg.html">HDG scheme for the Poisson equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_mixed-topology.html">Poisson equation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../demos.html#nonlinear-problems">Nonlinear problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos.html#mesh-generation">Mesh generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos.html#interpolation-io-and-visualisation">Interpolation, IO and visualisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos.html#advanced-iterative-solvers">Advanced iterative solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos.html#user-defined-and-advanced-finite-elements">User-defined and advanced finite elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos.html#parallel-communication-analysis">Parallel communication analysis</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../demos.html#list-of-all-demos">List of all demos</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="demo_poisson.html">Poisson equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_biharmonic.html">Biharmonic equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_cahn-hilliard.html">Cahn-Hilliard equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_stokes.html">Stokes equations using Taylor-Hood elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_elasticity.html">Elasticity using algebraic multigrid</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_gmsh.html">Mesh generation with Gmsh</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_helmholtz.html">Helmholtz equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_static-condensation.html">Static condensation of linear elasticity</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_pyvista.html">Visualization with PyVista</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_interpolation-io.html">Interpolation and IO</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_types.html">Solving PDEs with different scalar (float) types</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_lagrange_variants.html">Variants of Lagrange elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_tnt-elements.html">Creating TNT elements using Basix’s custom element interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_scattering_boundary_conditions.html">Electromagnetic scattering from a wire with scattering BCs</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_pml.html">Electromagnetic scattering from a wire with PML</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_pml.html#mesh-generation-with-gmsh">Mesh generation with GMSH</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_half_loaded_waveguide.html">Electromagnetic modal analysis for a waveguide</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_axis.html">Electromagnetic scattering from a sphere (axisymmetric)</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_navier-stokes.html">Divergence conforming discontinuous Galerkin method for the Navier–Stokes equations # noqa</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Mixed formulation of the Poisson equation with a block-preconditioner/solver # noqa</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#equation-and-problem-definition">Equation and problem definition</a></li>
<li class="toctree-l4"><a class="reference internal" href="#implementation">Implementation</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="demo_pyamg.html">Solve the Poisson and linearised elasticity equations using pyamg</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_hdg.html">HDG scheme for the Poisson equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_mixed-topology.html">Poisson equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_comm-pattern.html">Parallel communication pattern analysis</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer.html">Developer resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift"><nav aria-label="Mobile navigation menu" class="wy-nav-top">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="../index.html">DOLFINx</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content">
<div aria-label="Page navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a aria-label="Home" class="icon icon-home" href="../index.html"></a></li>
<li class="breadcrumb-item"><a href="../demos.html">Demos</a></li>
<li class="breadcrumb-item active">Mixed formulation of the Poisson equation with a block-preconditioner/solver # noqa</li>
<li class="wy-breadcrumbs-aside">
<a href="../_sources/demos/demo_mixed-poisson.md.txt" rel="nofollow"> View page source</a>
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div itemprop="articleBody">
<section class="tex2jax_ignore mathjax_ignore" id="mixed-formulation-of-the-poisson-equation-with-a-block-preconditioner-solver-noqa">
<h1>Mixed formulation of the Poisson equation with a block-preconditioner/solver # noqa<a class="headerlink" href="#mixed-formulation-of-the-poisson-equation-with-a-block-preconditioner-solver-noqa" title="Link to this heading"></a></h1>
<p>This demo illustrates how to solve the Poisson equation using a mixed
(two-field) formulation and a block-preconditioned iterative solver.
In particular, it illustrates how to</p>
<ul class="simple">
<li><p>Use mixed and non-continuous finite element spaces.</p></li>
<li><p>Set essential boundary conditions for subspaces and
<span class="math notranslate nohighlight">\(H(\mathrm{div})\)</span> spaces.</p></li>
<li><p>Construct a blocked linear system.</p></li>
<li><p>Construct a block-preconditioned iterative linear solver using
PETSc/petsc4y.</p></li>
<li><p>Construct a Hypre Auxiliary Maxwell Space (AMS) preconditioner for
<span class="math notranslate nohighlight">\(H(\mathrm{div})\)</span> problems in two-dimensions.</p></li>
</ul>
<div class="download admonition">
<p class="admonition-title">Download sources</p>
<ul class="simple">
<li><p><a class="reference download internal" download="" href="../_downloads/4108f87eb9b678931168ffba26e2c302/demo_mixed-poisson.py"><code class="xref download docutils literal notranslate"><span class="pre">Python</span> <span class="pre">script</span></code></a></p></li>
<li><p><a class="reference download internal" download="" href="../_downloads/9ed4657d08dda04de30e6463e2f58d75/demo_mixed-poisson.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Jupyter</span> <span class="pre">notebook</span></code></a></p></li>
</ul>
</div>
<section id="equation-and-problem-definition">
<h2>Equation and problem definition<a class="headerlink" href="#equation-and-problem-definition" title="Link to this heading"></a></h2>
<p>An alternative formulation of Poisson equation can be formulated by
introducing an additional (vector) variable, namely the (negative)
flux: <span class="math notranslate nohighlight">\(\sigma = \nabla u\)</span>. The partial differential equations
then read</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
  \sigma - \nabla u &amp;= 0 \quad {\rm in} \ \Omega, \\
  \nabla \cdot \sigma &amp;= - f \quad {\rm in} \ \Omega,
\end{align}
\end{split}\]</div>
<p>with boundary conditions</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  u = u_0 \quad {\rm on} \ \Gamma_{D},  \\
  \sigma \cdot n = g \quad {\rm on} \ \Gamma_{N}.
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(n\)</span> is the outward unit normal vector on the boundary. Looking
at the variational form, we see that the boundary condition for the
flux (<span class="math notranslate nohighlight">\(\sigma \cdot n = g\)</span>) is now an essential boundary condition
(which should be enforced in the function space), while the other
boundary condition (<span class="math notranslate nohighlight">\(u = u_0\)</span>) is a natural boundary condition (which
should be applied to the variational form). Inserting the boundary
conditions, this variational problem can be phrased in the general
form: find <span class="math notranslate nohighlight">\((\sigma, u) \in \Sigma_g \times V\)</span> such that</p>
<div class="math notranslate nohighlight">
\[
   a((\sigma, u), (\tau, v)) = L((\tau, v))
   \quad \forall \ (\tau, v) \in \Sigma_0 \times V,
\]</div>
<p>where the variational forms <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(L\)</span> are defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}
  a((\sigma, u), (\tau, v)) &amp;:=
    \int_{\Omega} \sigma \cdot \tau + \nabla \cdot \tau \ u
  + \nabla \cdot \sigma \ v \ {\rm d} x, \\
  L((\tau, v)) &amp;:= - \int_{\Omega} f v \ {\rm d} x
  + \int_{\Gamma_D} u_0 \tau \cdot n  \ {\rm d} s,
\end{split}\]</div>
<p>and <span class="math notranslate nohighlight">\(\Sigma_g := \{ \tau \in H({\rm div})\)</span> such that <span class="math notranslate nohighlight">\(\tau \cdot
n|_{\Gamma_N} = g \}\)</span> and <span class="math notranslate nohighlight">\(V := L^2(\Omega)\)</span>.</p>
<p>To discretize the above formulation, two discrete function spaces
<span class="math notranslate nohighlight">\(\Sigma_h \subset \Sigma\)</span> and <span class="math notranslate nohighlight">\(V_h \subset V\)</span> are needed to form a
mixed function space <span class="math notranslate nohighlight">\(\Sigma_h \times V_h\)</span>. A stable choice of finite
element spaces is to let <span class="math notranslate nohighlight">\(\Sigma_h\)</span> be the Raviart-Thomas elements of
polynomial order <span class="math notranslate nohighlight">\(k\)</span> and let <span class="math notranslate nohighlight">\(V_h\)</span> be discontinuous Lagrange elements of
polynomial order <span class="math notranslate nohighlight">\(k-1\)</span>.</p>
<p>To solve the linear system for the mixed problem, we will use am
iterative method with a block-diagonal preconditioner that is based on
the Riesz map, see for example this
<a class="reference external" href="https://doi.org/10.1002/(SICI)1099-1506(199601/02)3:1%3C1::AID-NLA67%3E3.0.CO;2-E">paper</a>.</p>
</section>
<section id="implementation">
<h2>Implementation<a class="headerlink" href="#implementation" title="Link to this heading"></a></h2>
<p>Import the required modules:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">mpi4py</span><span class="w"> </span><span class="kn">import</span> <span class="n">MPI</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">petsc4py</span><span class="w"> </span><span class="kn">import</span> <span class="n">PETSc</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">dolfinx</span>
<span class="kn">import</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#module-ufl" title="ufl"><span class="nn">ufl</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/basix/main/python/_autosummary/basix.ufl.html#module-basix.ufl" title="basix.ufl"><span class="nn">basix.ufl</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/basix/main/python/_autosummary/basix.ufl.html#basix.ufl.element" title="basix.ufl.element"><span class="n">element</span></a>
<span class="kn">from</span><span class="w"> </span><span class="nn">dolfinx</span><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.html#module-dolfinx.fem" title="dolfinx.fem"><span class="n">fem</span></a><span class="p">,</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#module-dolfinx.mesh" title="dolfinx.mesh"><span class="n">mesh</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.petsc.html#module-dolfinx.fem.petsc" title="dolfinx.fem.petsc"><span class="nn">dolfinx.fem.petsc</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.petsc.html#dolfinx.fem.petsc.discrete_gradient" title="dolfinx.fem.petsc.discrete_gradient"><span class="n">discrete_gradient</span></a><span class="p">,</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.petsc.html#dolfinx.fem.petsc.interpolation_matrix" title="dolfinx.fem.petsc.interpolation_matrix"><span class="n">interpolation_matrix</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#module-dolfinx.mesh" title="dolfinx.mesh"><span class="nn">dolfinx.mesh</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.cpp.mesh.html#dolfinx.cpp.mesh.CellType" title="dolfinx.cpp.mesh.CellType"><span class="n">CellType</span></a><span class="p">,</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#dolfinx.mesh.create_unit_square" title="dolfinx.mesh.create_unit_square"><span class="n">create_unit_square</span></a>

<span class="c1"># Solution scalar (e.g., float32, complex128) and geometry (float32/64)</span>
<span class="c1"># types</span>
<span class="n">dtype</span> <span class="o">=</span> <span class="n">dolfinx</span><span class="o">.</span><span class="n">default_scalar_type</span>
<span class="n">xdtype</span> <span class="o">=</span> <span class="n">dolfinx</span><span class="o">.</span><span class="n">default_real_type</span>
</pre></div>
</div>
<p>Create a two-dimensional mesh. The iterative solver constructed
later requires special construction that is specific to two
dimensions. Application in three-dimensions would require a number of
changes to the linear solver.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#dolfinx.mesh.Mesh" title="dolfinx.mesh.Mesh"><span class="n">msh</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#dolfinx.mesh.create_unit_square" title="dolfinx.mesh.create_unit_square"><span class="n">create_unit_square</span></a><span class="p">(</span><span class="n">MPI</span><span class="o">.</span><span class="n">COMM_WORLD</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.cpp.mesh.html#dolfinx.cpp.mesh.CellType.triangle" title="dolfinx.cpp.mesh.CellType.triangle"><span class="n">CellType</span><span class="o">.</span><span class="n">triangle</span></a><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">xdtype</span><span class="p">)</span>
</pre></div>
</div>
<p>Here we construct compatible function spaces for the mixed Poisson
problem. The <code class="docutils literal notranslate"><span class="pre">V</span></code> Raviart-Thomas (<span class="math notranslate nohighlight">\(\mathbb{RT}\)</span>) space is a
vector-valued <span class="math notranslate nohighlight">\(H({\rm div})\)</span> conforming space. The <code class="docutils literal notranslate"><span class="pre">W</span></code> space is a
space of discontinuous Lagrange function of degree <code class="docutils literal notranslate"><span class="pre">k</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <span class="math notranslate nohighlight">\(\mathbb{RT}_{k}\)</span> element in DOLFINx/Basix is usually denoted as
<span class="math notranslate nohighlight">\(\mathbb{RT}_{k-1}\)</span> in the literature.</p>
</div>
<p>In the lowest-order case <span class="math notranslate nohighlight">\(k=1\)</span>. It can be increased, by the
convergence of the iterative solver will degrade.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">k</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">V</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.html#dolfinx.fem.functionspace" title="dolfinx.fem.functionspace"><span class="n">fem</span><span class="o">.</span><span class="n">functionspace</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#dolfinx.mesh.Mesh" title="dolfinx.mesh.Mesh"><span class="n">msh</span></a><span class="p">,</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/basix/main/python/_autosummary/basix.ufl.html#basix.ufl.element" title="basix.ufl.element"><span class="n">element</span></a><span class="p">(</span><span class="s2">"RT"</span><span class="p">,</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#dolfinx.mesh.Mesh.basix_cell" title="dolfinx.mesh.Mesh.basix_cell"><span class="n">msh</span><span class="o">.</span><span class="n">basix_cell</span></a><span class="p">(),</span> <span class="n">k</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">xdtype</span><span class="p">))</span>
<span class="n">W</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.html#dolfinx.fem.functionspace" title="dolfinx.fem.functionspace"><span class="n">fem</span><span class="o">.</span><span class="n">functionspace</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#dolfinx.mesh.Mesh" title="dolfinx.mesh.Mesh"><span class="n">msh</span></a><span class="p">,</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/basix/main/python/_autosummary/basix.ufl.html#basix.ufl.element" title="basix.ufl.element"><span class="n">element</span></a><span class="p">(</span><span class="s2">"Discontinuous Lagrange"</span><span class="p">,</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#dolfinx.mesh.Mesh.basix_cell" title="dolfinx.mesh.Mesh.basix_cell"><span class="n">msh</span><span class="o">.</span><span class="n">basix_cell</span></a><span class="p">(),</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">xdtype</span><span class="p">))</span>
<a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.functionspace.MixedFunctionSpace" title="ufl.functionspace.MixedFunctionSpace"><span class="n">Q</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.functionspace.MixedFunctionSpace" title="ufl.functionspace.MixedFunctionSpace"><span class="n">ufl</span><span class="o">.</span><span class="n">MixedFunctionSpace</span></a><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">W</span><span class="p">)</span>
</pre></div>
</div>
<p>Trial functions for <span class="math notranslate nohighlight">\(\sigma\)</span> and <span class="math notranslate nohighlight">\(u\)</span> are declared on the space <span class="math notranslate nohighlight">\(V\)</span> and
<span class="math notranslate nohighlight">\(W\)</span>, with corresponding test functions <span class="math notranslate nohighlight">\(\tau\)</span> and <span class="math notranslate nohighlight">\(v\)</span>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sigma</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.TrialFunctions" title="ufl.TrialFunctions"><span class="n">ufl</span><span class="o">.</span><span class="n">TrialFunctions</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.functionspace.MixedFunctionSpace" title="ufl.functionspace.MixedFunctionSpace"><span class="n">Q</span></a><span class="p">)</span>
<span class="n">tau</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.TestFunctions" title="ufl.TestFunctions"><span class="n">ufl</span><span class="o">.</span><span class="n">TestFunctions</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.functionspace.MixedFunctionSpace" title="ufl.functionspace.MixedFunctionSpace"><span class="n">Q</span></a><span class="p">)</span>
</pre></div>
</div>
<p>The source function is set to be <span class="math notranslate nohighlight">\(f = 10\exp(-((x_{0} - 0.5)^2 +
(x_{1} - 0.5)^2) / 0.02)\)</span>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.geometry.SpatialCoordinate" title="ufl.geometry.SpatialCoordinate"><span class="n">x</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.geometry.SpatialCoordinate" title="ufl.geometry.SpatialCoordinate"><span class="n">ufl</span><span class="o">.</span><span class="n">SpatialCoordinate</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#dolfinx.mesh.Mesh" title="dolfinx.mesh.Mesh"><span class="n">msh</span></a><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.exp" title="ufl.exp"><span class="n">ufl</span><span class="o">.</span><span class="n">exp</span></a><span class="p">(</span><span class="o">-</span><span class="p">((</span><a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.geometry.SpatialCoordinate" title="ufl.geometry.SpatialCoordinate"><span class="n">x</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.geometry.SpatialCoordinate" title="ufl.geometry.SpatialCoordinate"><span class="n">x</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.geometry.SpatialCoordinate" title="ufl.geometry.SpatialCoordinate"><span class="n">x</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.geometry.SpatialCoordinate" title="ufl.geometry.SpatialCoordinate"><span class="n">x</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">))</span> <span class="o">/</span> <span class="mf">0.02</span><span class="p">)</span>
</pre></div>
</div>
<p>We now declare the blocked bilinear and linear forms. We use
<code class="docutils literal notranslate"><span class="pre">ufl.extract_blocks</span></code> to extract the block structure of the bilinear
and linear form. For the first block of the right-hand side, we provide
a form that efficiently is 0. We do this to preserve knowledge of the
test space in the block. <em>Note that the defined <code class="docutils literal notranslate"><span class="pre">L</span></code> corresponds to
<span class="math notranslate nohighlight">\(u_{0} = 0\)</span> on <span class="math notranslate nohighlight">\(\Gamma_{D}\)</span>.</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.measure.Measure" title="ufl.measure.Measure"><span class="n">dx</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.measure.Measure" title="ufl.measure.Measure"><span class="n">ufl</span><span class="o">.</span><span class="n">Measure</span></a><span class="p">(</span><span class="s2">"dx"</span><span class="p">,</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#dolfinx.mesh.Mesh" title="dolfinx.mesh.Mesh"><span class="n">msh</span></a><span class="p">)</span>

<span class="n">a</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.extract_blocks" title="ufl.extract_blocks"><span class="n">ufl</span><span class="o">.</span><span class="n">extract_blocks</span></a><span class="p">(</span>
    <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.inner" title="ufl.inner"><span class="n">ufl</span><span class="o">.</span><span class="n">inner</span></a><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">tau</span><span class="p">)</span> <span class="o">*</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.measure.Measure" title="ufl.measure.Measure"><span class="n">dx</span></a> <span class="o">+</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.inner" title="ufl.inner"><span class="n">ufl</span><span class="o">.</span><span class="n">inner</span></a><span class="p">(</span><span class="n">u</span><span class="p">,</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.div" title="ufl.div"><span class="n">ufl</span><span class="o">.</span><span class="n">div</span></a><span class="p">(</span><span class="n">tau</span><span class="p">))</span> <span class="o">*</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.measure.Measure" title="ufl.measure.Measure"><span class="n">dx</span></a> <span class="o">+</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.inner" title="ufl.inner"><span class="n">ufl</span><span class="o">.</span><span class="n">inner</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.div" title="ufl.div"><span class="n">ufl</span><span class="o">.</span><span class="n">div</span></a><span class="p">(</span><span class="n">sigma</span><span class="p">),</span> <span class="n">v</span><span class="p">)</span> <span class="o">*</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.measure.Measure" title="ufl.measure.Measure"><span class="n">dx</span></a>
<span class="p">)</span>
<span class="n">L</span> <span class="o">=</span> <span class="p">[</span><a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.form.ZeroBaseForm" title="ufl.form.ZeroBaseForm"><span class="n">ufl</span><span class="o">.</span><span class="n">ZeroBaseForm</span></a><span class="p">((</span><span class="n">tau</span><span class="p">,)),</span> <span class="o">-</span><a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.inner" title="ufl.inner"><span class="n">ufl</span><span class="o">.</span><span class="n">inner</span></a><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">*</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.measure.Measure" title="ufl.measure.Measure"><span class="n">dx</span></a><span class="p">]</span>
</pre></div>
</div>
<p>In preparation for Dirichlet boundary conditions, we use the function
<a class="reference internal" href="../generated/dolfinx.mesh.html#dolfinx.mesh.locate_entities_boundary" title="dolfinx.mesh.locate_entities_boundary"><code class="xref py py-func docutils literal notranslate"><span class="pre">locate_entities_boundary</span></code></a> to locate mesh entities
(facets) with which degree-of-freedoms to be constrained are
associated with, and then use <a class="reference internal" href="../generated/dolfinx.fem.html#dolfinx.fem.locate_dofs_topological" title="dolfinx.fem.locate_dofs_topological"><code class="xref py py-func docutils literal notranslate"><span class="pre">locate_dofs_topological</span></code></a>
to get the  degree-of-freedom indices. Below we identify the
degree-of-freedom in <code class="docutils literal notranslate"><span class="pre">V</span></code> on the (i) top (<span class="math notranslate nohighlight">\(x_{1} = 1\)</span>)
and (ii) bottom (<span class="math notranslate nohighlight">\(x_{1} = 0\)</span>) of the mesh/domain.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fdim</span> <span class="o">=</span> <span class="n">msh</span><span class="o">.</span><span class="n">topology</span><span class="o">.</span><span class="n">dim</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">facets_top</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#dolfinx.mesh.locate_entities_boundary" title="dolfinx.mesh.locate_entities_boundary"><span class="n">mesh</span><span class="o">.</span><span class="n">locate_entities_boundary</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#dolfinx.mesh.Mesh" title="dolfinx.mesh.Mesh"><span class="n">msh</span></a><span class="p">,</span> <span class="n">fdim</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">1.0</span><span class="p">))</span>
<span class="n">facets_bottom</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#dolfinx.mesh.locate_entities_boundary" title="dolfinx.mesh.locate_entities_boundary"><span class="n">mesh</span><span class="o">.</span><span class="n">locate_entities_boundary</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#dolfinx.mesh.Mesh" title="dolfinx.mesh.Mesh"><span class="n">msh</span></a><span class="p">,</span> <span class="n">fdim</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.0</span><span class="p">))</span>
<span class="n">dofs_top</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.html#dolfinx.fem.locate_dofs_topological" title="dolfinx.fem.locate_dofs_topological"><span class="n">fem</span><span class="o">.</span><span class="n">locate_dofs_topological</span></a><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">fdim</span><span class="p">,</span> <span class="n">facets_top</span><span class="p">)</span>
<span class="n">dofs_bottom</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.html#dolfinx.fem.locate_dofs_topological" title="dolfinx.fem.locate_dofs_topological"><span class="n">fem</span><span class="o">.</span><span class="n">locate_dofs_topological</span></a><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">fdim</span><span class="p">,</span> <span class="n">facets_bottom</span><span class="p">)</span>
</pre></div>
</div>
<p>Now, we create Dirichlet boundary objects for the condition <span class="math notranslate nohighlight">\(\sigma
\cdot n = \sin(5 x_(0)\)</span> on the top and bottom boundaries:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">cells_top_</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#dolfinx.mesh.compute_incident_entities" title="dolfinx.mesh.compute_incident_entities"><span class="n">mesh</span><span class="o">.</span><span class="n">compute_incident_entities</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#dolfinx.mesh.Mesh.topology" title="dolfinx.mesh.Mesh.topology"><span class="n">msh</span><span class="o">.</span><span class="n">topology</span></a><span class="p">,</span> <span class="n">facets_top</span><span class="p">,</span> <span class="n">fdim</span><span class="p">,</span> <span class="n">fdim</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">cells_bottom</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#dolfinx.mesh.compute_incident_entities" title="dolfinx.mesh.compute_incident_entities"><span class="n">mesh</span><span class="o">.</span><span class="n">compute_incident_entities</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#dolfinx.mesh.Mesh.topology" title="dolfinx.mesh.Mesh.topology"><span class="n">msh</span><span class="o">.</span><span class="n">topology</span></a><span class="p">,</span> <span class="n">facets_bottom</span><span class="p">,</span> <span class="n">fdim</span><span class="p">,</span> <span class="n">fdim</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.html#dolfinx.fem.Function" title="dolfinx.fem.function.Function"><span class="n">g</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.html#dolfinx.fem.Function" title="dolfinx.fem.function.Function"><span class="n">fem</span><span class="o">.</span><span class="n">Function</span></a><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))),</span> <span class="n">cells0</span><span class="o">=</span><span class="n">cells_top_</span><span class="p">)</span>
<span class="n">g</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">5</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))),</span> <span class="n">cells0</span><span class="o">=</span><span class="n">cells_bottom</span><span class="p">)</span>
<span class="n">bcs</span> <span class="o">=</span> <span class="p">[</span><a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.html#dolfinx.fem.dirichletbc" title="dolfinx.fem.dirichletbc"><span class="n">fem</span><span class="o">.</span><span class="n">dirichletbc</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.html#dolfinx.fem.Function" title="dolfinx.fem.function.Function"><span class="n">g</span></a><span class="p">,</span> <span class="n">dofs_top</span><span class="p">),</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.html#dolfinx.fem.dirichletbc" title="dolfinx.fem.dirichletbc"><span class="n">fem</span><span class="o">.</span><span class="n">dirichletbc</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.html#dolfinx.fem.Function" title="dolfinx.fem.function.Function"><span class="n">g</span></a><span class="p">,</span> <span class="n">dofs_bottom</span><span class="p">)]</span>
</pre></div>
</div>
<p>Rather than solving the linear system <span class="math notranslate nohighlight">\(A x = b\)</span>, we will solve the
preconditioned problem <span class="math notranslate nohighlight">\(P^{-1} A x = P^{-1} b\)</span>. Commonly <span class="math notranslate nohighlight">\(P = A\)</span>, but
this does not lead to efficient solvers for saddle point problems.</p>
<p>For this problem, we introduce the preconditioner</p>
<div class="math notranslate nohighlight">
\[\begin{split}
a_p((\sigma, u), (\tau, v))
= \begin{bmatrix} \int_{\Omega} \sigma \cdot \tau + (\nabla \cdot
\sigma) (\nabla \cdot \tau) \ {\rm d} x  &amp; 0 \\ 0 &amp;
\int_{\Omega} u \cdot v \ {\rm d} x \end{bmatrix}
\end{split}\]</div>
<p>and assemble it into the matrix <code class="docutils literal notranslate"><span class="pre">P</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">a_p</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.extract_blocks" title="ufl.extract_blocks"><span class="n">ufl</span><span class="o">.</span><span class="n">extract_blocks</span></a><span class="p">(</span>
    <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.inner" title="ufl.inner"><span class="n">ufl</span><span class="o">.</span><span class="n">inner</span></a><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">tau</span><span class="p">)</span> <span class="o">*</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.measure.Measure" title="ufl.measure.Measure"><span class="n">dx</span></a> <span class="o">+</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.inner" title="ufl.inner"><span class="n">ufl</span><span class="o">.</span><span class="n">inner</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.div" title="ufl.div"><span class="n">ufl</span><span class="o">.</span><span class="n">div</span></a><span class="p">(</span><span class="n">sigma</span><span class="p">),</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.div" title="ufl.div"><span class="n">ufl</span><span class="o">.</span><span class="n">div</span></a><span class="p">(</span><span class="n">tau</span><span class="p">))</span> <span class="o">*</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.measure.Measure" title="ufl.measure.Measure"><span class="n">dx</span></a> <span class="o">+</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.inner" title="ufl.inner"><span class="n">ufl</span><span class="o">.</span><span class="n">inner</span></a><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="o">*</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api-doc/ufl.html#ufl.measure.Measure" title="ufl.measure.Measure"><span class="n">dx</span></a>
<span class="p">)</span>
</pre></div>
</div>
<p>We create finite element functions that will hold the <span class="math notranslate nohighlight">\(\sigma\)</span> and <span class="math notranslate nohighlight">\(u\)</span>
solutions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sigma</span><span class="p">,</span> <span class="n">u</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.html#dolfinx.fem.Function" title="dolfinx.fem.function.Function"><span class="n">fem</span><span class="o">.</span><span class="n">Function</span></a><span class="p">(</span><span class="n">V</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">"sigma"</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">),</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.html#dolfinx.fem.Function" title="dolfinx.fem.function.Function"><span class="n">fem</span><span class="o">.</span><span class="n">Function</span></a><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">"u"</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
</pre></div>
</div>
<p>We now create a linear problem solver for the mixed problem.
As we will use different preconditions for the individual blocks of
the saddle point problem, we specify the matrix kind to be “nest”,
so that we can use <a class="reference external" href="https://petsc.org/release/manual/ksp/#sec-block-matrices"><code class="docutils literal notranslate"><span class="pre">fieldsplit</span></code></a>
(block) type and set the ‘splits’ between the <span class="math notranslate nohighlight">\(\sigma\)</span> and <span class="math notranslate nohighlight">\(u\)</span> fields.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.petsc.html#dolfinx.fem.petsc.LinearProblem" title="dolfinx.fem.petsc.LinearProblem"><span class="n">problem</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.petsc.html#dolfinx.fem.petsc.LinearProblem" title="dolfinx.fem.petsc.LinearProblem"><span class="n">fem</span><span class="o">.</span><span class="n">petsc</span><span class="o">.</span><span class="n">LinearProblem</span></a><span class="p">(</span>
    <span class="n">a</span><span class="p">,</span>
    <span class="n">L</span><span class="p">,</span>
    <span class="n">u</span><span class="o">=</span><span class="p">[</span><span class="n">sigma</span><span class="p">,</span> <span class="n">u</span><span class="p">],</span>
    <span class="n">P</span><span class="o">=</span><span class="n">a_p</span><span class="p">,</span>
    <span class="n">kind</span><span class="o">=</span><span class="s2">"nest"</span><span class="p">,</span>
    <span class="n">bcs</span><span class="o">=</span><span class="n">bcs</span><span class="p">,</span>
    <span class="n">petsc_options_prefix</span><span class="o">=</span><span class="s2">"demo_mixed_poisson_"</span><span class="p">,</span>
    <span class="n">petsc_options</span><span class="o">=</span><span class="p">{</span>
        <span class="s2">"ksp_type"</span><span class="p">:</span> <span class="s2">"gmres"</span><span class="p">,</span>
        <span class="s2">"pc_type"</span><span class="p">:</span> <span class="s2">"fieldsplit"</span><span class="p">,</span>
        <span class="s2">"pc_fieldsplit_type"</span><span class="p">:</span> <span class="s2">"additive"</span><span class="p">,</span>
        <span class="s2">"ksp_rtol"</span><span class="p">:</span> <span class="mf">1e-8</span><span class="p">,</span>
        <span class="s2">"ksp_gmres_restart"</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
        <span class="s2">"ksp_view"</span><span class="p">:</span> <span class="s2">""</span><span class="p">,</span>
    <span class="p">},</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.petsc.html#dolfinx.fem.petsc.LinearProblem.solver" title="dolfinx.fem.petsc.LinearProblem.solver"><span class="n">ksp</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.petsc.html#dolfinx.fem.petsc.LinearProblem.solver" title="dolfinx.fem.petsc.LinearProblem.solver"><span class="n">problem</span><span class="o">.</span><span class="n">solver</span></a>
<span class="n">ksp</span><span class="o">.</span><span class="n">setMonitor</span><span class="p">(</span>
    <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">its</span><span class="p">,</span> <span class="n">rnorm</span><span class="p">:</span> <span class="n">PETSc</span><span class="o">.</span><span class="n">Sys</span><span class="o">.</span><span class="n">Print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Iteration: </span><span class="si">{</span><span class="n">its</span><span class="si">:</span><span class="s2">&gt;4d</span><span class="si">}</span><span class="s2">, residual: </span><span class="si">{</span><span class="n">rnorm</span><span class="si">:</span><span class="s2">.3e</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<p>For the <span class="math notranslate nohighlight">\(P_{11}\)</span> block, which is the discontinuous Lagrange mass
matrix, we let the preconditioner be the default, which is incomplete
LU factorisation and which can solve the block exactly in one
iteration. The <span class="math notranslate nohighlight">\(P_{00}\)</span> requires careful handling as <span class="math notranslate nohighlight">\(H({\rm div})\)</span>
problems require special preconditioners to be efficient.</p>
<p>If PETSc has been configured with Hypre, we use the Hypre <a class="reference external" href="https://hypre.readthedocs.io/en/latest/solvers-ams.html">Auxiliary
Maxwell Space</a>
(AMS) algebraic multigrid preconditioner. We can use
AMS for this <span class="math notranslate nohighlight">\(H({\rm div})\)</span>-type problem in two-dimensions because
<span class="math notranslate nohighlight">\(H({\rm div})\)</span> and <span class="math notranslate nohighlight">\(H({\rm curl})\)</span> spaces are effectively the same in
two-dimensions, just rotated by $\pi/2.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ksp_sigma</span><span class="p">,</span> <span class="n">ksp_u</span> <span class="o">=</span> <span class="n">ksp</span><span class="o">.</span><span class="n">getPC</span><span class="p">()</span><span class="o">.</span><span class="n">getFieldSplitSubKSP</span><span class="p">()</span>
<span class="n">pc_sigma</span> <span class="o">=</span> <span class="n">ksp_sigma</span><span class="o">.</span><span class="n">getPC</span><span class="p">()</span>
<span class="k">if</span> <span class="n">PETSc</span><span class="o">.</span><span class="n">Sys</span><span class="p">()</span><span class="o">.</span><span class="n">hasExternalPackage</span><span class="p">(</span><span class="s2">"hypre"</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">issubdtype</span><span class="p">(</span><span class="n">dtype</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">complexfloating</span><span class="p">):</span>
    <span class="n">pc_sigma</span><span class="o">.</span><span class="n">setType</span><span class="p">(</span><span class="s2">"hypre"</span><span class="p">)</span>
    <span class="n">pc_sigma</span><span class="o">.</span><span class="n">setHYPREType</span><span class="p">(</span><span class="s2">"ams"</span><span class="p">)</span>

    <span class="n">opts</span> <span class="o">=</span> <span class="n">PETSc</span><span class="o">.</span><span class="n">Options</span><span class="p">()</span>
    <span class="n">opts</span><span class="p">[</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">ksp_sigma</span><span class="o">.</span><span class="n">prefix</span><span class="si">}</span><span class="s2">pc_hypre_ams_cycle_type"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="n">opts</span><span class="p">[</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">ksp_sigma</span><span class="o">.</span><span class="n">prefix</span><span class="si">}</span><span class="s2">pc_hypre_ams_relax_times"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="c1"># Construct and set the 'discrete gradient' operator, which maps</span>
    <span class="c1"># grad H1 -&gt; H(curl), i.e. the gradient of a scalar Lagrange space</span>
    <span class="c1"># to a H(curl) space</span>
    <span class="n">V_H1</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.html#dolfinx.fem.functionspace" title="dolfinx.fem.functionspace"><span class="n">fem</span><span class="o">.</span><span class="n">functionspace</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#dolfinx.mesh.Mesh" title="dolfinx.mesh.Mesh"><span class="n">msh</span></a><span class="p">,</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/basix/main/python/_autosummary/basix.ufl.html#basix.ufl.element" title="basix.ufl.element"><span class="n">element</span></a><span class="p">(</span><span class="s2">"Lagrange"</span><span class="p">,</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#dolfinx.mesh.Mesh.basix_cell" title="dolfinx.mesh.Mesh.basix_cell"><span class="n">msh</span><span class="o">.</span><span class="n">basix_cell</span></a><span class="p">(),</span> <span class="n">k</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">xdtype</span><span class="p">))</span>
    <span class="n">V_curl</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.html#dolfinx.fem.functionspace" title="dolfinx.fem.functionspace"><span class="n">fem</span><span class="o">.</span><span class="n">functionspace</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#dolfinx.mesh.Mesh" title="dolfinx.mesh.Mesh"><span class="n">msh</span></a><span class="p">,</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/basix/main/python/_autosummary/basix.ufl.html#basix.ufl.element" title="basix.ufl.element"><span class="n">element</span></a><span class="p">(</span><span class="s2">"N1curl"</span><span class="p">,</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#dolfinx.mesh.Mesh.basix_cell" title="dolfinx.mesh.Mesh.basix_cell"><span class="n">msh</span><span class="o">.</span><span class="n">basix_cell</span></a><span class="p">(),</span> <span class="n">k</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">xdtype</span><span class="p">))</span>
    <span class="n">G</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.petsc.html#dolfinx.fem.petsc.discrete_gradient" title="dolfinx.fem.petsc.discrete_gradient"><span class="n">discrete_gradient</span></a><span class="p">(</span><span class="n">V_H1</span><span class="p">,</span> <span class="n">V_curl</span><span class="p">)</span>
    <span class="n">G</span><span class="o">.</span><span class="n">assemble</span><span class="p">()</span>
    <span class="n">pc_sigma</span><span class="o">.</span><span class="n">setHYPREDiscreteGradient</span><span class="p">(</span><span class="n">G</span><span class="p">)</span>

    <span class="k">assert</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">"Element degree must be at least 1."</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="c1"># For the lowest order base (k=1), we can supply interpolation</span>
        <span class="c1"># of the '1' vectors in the space V. Hypre can then construct</span>
        <span class="c1"># the required operators from G and the '1' vectors.</span>
        <span class="n">cvec0</span><span class="p">,</span> <span class="n">cvec1</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.html#dolfinx.fem.Function" title="dolfinx.fem.function.Function"><span class="n">fem</span><span class="o">.</span><span class="n">Function</span></a><span class="p">(</span><span class="n">V</span><span class="p">),</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.html#dolfinx.fem.Function" title="dolfinx.fem.function.Function"><span class="n">fem</span><span class="o">.</span><span class="n">Function</span></a><span class="p">(</span><span class="n">V</span><span class="p">)</span>
        <span class="n">cvec0</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))))</span>
        <span class="n">cvec1</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))))</span>
        <span class="n">pc_sigma</span><span class="o">.</span><span class="n">setHYPRESetEdgeConstantVectors</span><span class="p">(</span><span class="n">cvec0</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">petsc_vec</span><span class="p">,</span> <span class="n">cvec1</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">petsc_vec</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># For high-order spaces, we must provide the (H1)^d -&gt; H(div)</span>
        <span class="c1"># interpolation operator/matrix</span>
        <span class="n">V_H1d</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.html#dolfinx.fem.functionspace" title="dolfinx.fem.functionspace"><span class="n">fem</span><span class="o">.</span><span class="n">functionspace</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#dolfinx.mesh.Mesh" title="dolfinx.mesh.Mesh"><span class="n">msh</span></a><span class="p">,</span> <span class="p">(</span><span class="s2">"Lagrange"</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="p">(</span><span class="n">msh</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">dim</span><span class="p">,)))</span>
        <span class="n">Pi</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.petsc.html#dolfinx.fem.petsc.interpolation_matrix" title="dolfinx.fem.petsc.interpolation_matrix"><span class="n">interpolation_matrix</span></a><span class="p">(</span><span class="n">V_H1d</span><span class="p">,</span> <span class="n">V</span><span class="p">)</span>  <span class="c1"># (H1)^d -&gt; H(div)</span>
        <span class="n">Pi</span><span class="o">.</span><span class="n">assemble</span><span class="p">()</span>
        <span class="n">pc_sigma</span><span class="o">.</span><span class="n">setHYPRESetInterpolations</span><span class="p">(</span><span class="n">msh</span><span class="o">.</span><span class="n">geometry</span><span class="o">.</span><span class="n">dim</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">Pi</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="c1"># High-order elements generally converge less well than the</span>
        <span class="c1"># lowest-order case with algebraic multigrid, so we perform</span>
        <span class="c1"># extra work at the multigrid stage</span>
        <span class="n">opts</span><span class="p">[</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">ksp_sigma</span><span class="o">.</span><span class="n">prefix</span><span class="si">}</span><span class="s2">pc_hypre_ams_tol"</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1e-12</span>
        <span class="n">opts</span><span class="p">[</span><span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">ksp_sigma</span><span class="o">.</span><span class="n">prefix</span><span class="si">}</span><span class="s2">pc_hypre_ams_max_iter"</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="n">ksp_sigma</span><span class="o">.</span><span class="n">setFromOptions</span><span class="p">()</span>
<span class="k">else</span><span class="p">:</span>
    <span class="c1"># If Hypre is not available, use LU factorisation on the $P_{00}$</span>
    <span class="c1"># block</span>
    <span class="n">pc_sigma</span><span class="o">.</span><span class="n">setType</span><span class="p">(</span><span class="s2">"lu"</span><span class="p">)</span>
    <span class="n">use_superlu</span> <span class="o">=</span> <span class="n">PETSc</span><span class="o">.</span><span class="n">IntType</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">int64</span>
    <span class="k">if</span> <span class="n">PETSc</span><span class="o">.</span><span class="n">Sys</span><span class="p">()</span><span class="o">.</span><span class="n">hasExternalPackage</span><span class="p">(</span><span class="s2">"mumps"</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">use_superlu</span><span class="p">:</span>
        <span class="n">pc_sigma</span><span class="o">.</span><span class="n">setFactorSolverType</span><span class="p">(</span><span class="s2">"mumps"</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">PETSc</span><span class="o">.</span><span class="n">Sys</span><span class="p">()</span><span class="o">.</span><span class="n">hasExternalPackage</span><span class="p">(</span><span class="s2">"superlu_dist"</span><span class="p">):</span>
        <span class="n">pc_sigma</span><span class="o">.</span><span class="n">setFactorSolverType</span><span class="p">(</span><span class="s2">"superlu_dist"</span><span class="p">)</span>
</pre></div>
</div>
<p>Once we have set the preconditioners for the two blocks, we can
solve the linear system.
<a class="reference internal" href="../generated/dolfinx.fem.petsc.html#dolfinx.fem.petsc.LinearProblem" title="dolfinx.fem.petsc.LinearProblem"><code class="xref py py-class docutils literal notranslate"><span class="pre">LinearProblem</span></code></a> will
automatically assemble the linear system, apply the boundary
conditions, call the Krylov solver and update the solution
vectors <code class="docutils literal notranslate"><span class="pre">u</span></code> and <code class="docutils literal notranslate"><span class="pre">sigma</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.petsc.html#dolfinx.fem.petsc.LinearProblem.solve" title="dolfinx.fem.petsc.LinearProblem.solve"><span class="n">problem</span><span class="o">.</span><span class="n">solve</span></a><span class="p">()</span>
<span class="n">converged_reason</span> <span class="o">=</span> <span class="n">problem</span><span class="o">.</span><span class="n">solver</span><span class="o">.</span><span class="n">getConvergedReason</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">converged_reason</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"Krylov solver has not converged, reason: </span><span class="si">{</span><span class="n">converged_reason</span><span class="si">}</span><span class="s2">."</span>
</pre></div>
</div>
<p>We save the solution <code class="docutils literal notranslate"><span class="pre">u</span></code> in VTX format:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">dolfinx</span><span class="o">.</span><span class="n">has_adios2</span><span class="p">:</span>
    <span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="../generated/dolfinx.io.html#module-dolfinx.io" title="dolfinx.io"><span class="nn">dolfinx.io</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.io.html#dolfinx.io.VTXWriter" title="dolfinx.io.utils.VTXWriter"><span class="n">VTXWriter</span></a>

    <span class="k">with</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.io.html#dolfinx.io.VTXWriter" title="dolfinx.io.utils.VTXWriter"><span class="n">VTXWriter</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#dolfinx.mesh.Mesh.comm" title="dolfinx.mesh.Mesh.comm"><span class="n">msh</span><span class="o">.</span><span class="n">comm</span></a><span class="p">,</span> <span class="s2">"output_mixed_poisson.bp"</span><span class="p">,</span> <span class="n">u</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"ADIOS2 required for VTX output."</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</div>
</div>
<footer><div aria-label="Footer" class="rst-footer-buttons" role="navigation">
<a accesskey="p" class="btn btn-neutral float-left" href="demo_axis.html" rel="prev" title="Electromagnetic scattering from a sphere (axisymmetric)"><span aria-hidden="true" class="fa fa-arrow-circle-left"></span> Previous</a>
<a accesskey="n" class="btn btn-neutral float-right" href="demo_stokes.html" rel="next" title="Stokes equations using Taylor-Hood elements">Next <span aria-hidden="true" class="fa fa-arrow-circle-right"></span></a>
</div>
<hr/>
<div role="contentinfo">
<p>© Copyright 2025, FEniCS Project.</p>
</div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
</div>
</div>
</section>
</div>
<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
</body>
</html>