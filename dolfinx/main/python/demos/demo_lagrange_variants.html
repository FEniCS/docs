
<!DOCTYPE html>

<html class="writer-html5" data-content_root="../" lang="en">
<head>
<meta charset="utf-8"/><meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Variants of Lagrange elements — DOLFINx 0.11.0.dev0 documentation</title>
<link href="../_static/pygments.css?v=03e43079" rel="stylesheet" type="text/css"/>
<link href="../_static/css/theme.css?v=e59714d7" rel="stylesheet" type="text/css"/>
<link href="../_static/sphinx-codeautolink.css?v=b2176991" rel="stylesheet" type="text/css"/>
<script src="../_static/jquery.js?v=5d32c60e"></script>
<script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
<script src="../_static/documentation_options.js?v=cba6a91b"></script>
<script src="../_static/doctools.js?v=9bcbadda"></script>
<script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
<script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
<script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
<script src="../_static/js/theme.js"></script>
<link href="../genindex.html" rel="index" title="Index"/>
<link href="../search.html" rel="search" title="Search"/>
<link href="demo_tnt-elements.html" rel="next" title="Creating TNT elements using Basix’s custom element interface"/>
<link href="demo_interpolation-io.html" rel="prev" title="Interpolation and IO"/>
</head>
<body class="wy-body-for-nav">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href="../index.html">
            DOLFINx
          </a>
<div role="search">
<form action="../search.html" class="wy-form" id="rtd-search-form" method="get">
<input aria-label="Search docs" name="q" placeholder="Search docs" type="text"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
</div>
</div><div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../demos.html">Demos</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../demos.html#pdes-introductory">PDEs (introductory)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos.html#pdes-advanced">PDEs (advanced)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos.html#nonlinear-problems">Nonlinear problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos.html#mesh-generation">Mesh generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos.html#interpolation-io-and-visualisation">Interpolation, IO and visualisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos.html#advanced-iterative-solvers">Advanced iterative solvers</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../demos.html#user-defined-and-advanced-finite-elements">User-defined and advanced finite elements</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Variants of Lagrange elements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#equispaced-versus-gauss-lobatto-legendre-gll-points">Equispaced versus Gauss–Lobatto–Legendre (GLL) points</a></li>
<li class="toctree-l4"><a class="reference internal" href="#computing-the-error-of-an-interpolation">Computing the error of an interpolation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#available-lagrange-variants">Available Lagrange variants</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="demo_tnt-elements.html">Creating TNT elements using Basix’s custom element interface</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../demos.html#parallel-communication-analysis">Parallel communication analysis</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../demos.html#list-of-all-demos">List of all demos</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="demo_poisson.html">Poisson equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_biharmonic.html">Biharmonic equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_cahn-hilliard.html">Cahn-Hilliard equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_stokes.html">Stokes equations using Taylor-Hood elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_elasticity.html">Elasticity using algebraic multigrid</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_gmsh.html">Mesh generation with Gmsh</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_helmholtz.html">Helmholtz equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_static-condensation.html">Static condensation of linear elasticity</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_pyvista.html">Visualization with PyVista</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_interpolation-io.html">Interpolation and IO</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_types.html">Solving PDEs with different scalar (float) types</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Variants of Lagrange elements</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#equispaced-versus-gauss-lobatto-legendre-gll-points">Equispaced versus Gauss–Lobatto–Legendre (GLL) points</a></li>
<li class="toctree-l4"><a class="reference internal" href="#computing-the-error-of-an-interpolation">Computing the error of an interpolation</a></li>
<li class="toctree-l4"><a class="reference internal" href="#available-lagrange-variants">Available Lagrange variants</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="demo_tnt-elements.html">Creating TNT elements using Basix’s custom element interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_scattering_boundary_conditions.html">Electromagnetic scattering from a wire with scattering BCs</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_pml.html">Electromagnetic scattering from a wire with PML</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_pml.html#mesh-generation-with-gmsh">Mesh generation with GMSH</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_half_loaded_waveguide.html">Electromagnetic modal analysis for a waveguide</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_axis.html">Electromagnetic scattering from a sphere (axisymmetric)</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_navier-stokes.html">Divergence conforming discontinuous Galerkin method for the Navier–Stokes equations # noqa</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_mixed-poisson.html">Mixed formulation of the Poisson equation with a block-preconditioner/solver # noqa</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_pyamg.html">Solve the Poisson and linearised elasticity equations using pyamg</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_hdg.html">HDG scheme for the Poisson equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_mixed-topology.html">Poisson equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_comm-pattern.html">Parallel communication pattern analysis</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer.html">Developer resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift"><nav aria-label="Mobile navigation menu" class="wy-nav-top">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="../index.html">DOLFINx</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content">
<div aria-label="Page navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a aria-label="Home" class="icon icon-home" href="../index.html"></a></li>
<li class="breadcrumb-item"><a href="../demos.html">Demos</a></li>
<li class="breadcrumb-item active">Variants of Lagrange elements</li>
<li class="wy-breadcrumbs-aside">
<a href="../_sources/demos/demo_lagrange_variants.md.txt" rel="nofollow"> View page source</a>
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div itemprop="articleBody">
<section class="tex2jax_ignore mathjax_ignore" id="variants-of-lagrange-elements">
<h1>Variants of Lagrange elements<a class="headerlink" href="#variants-of-lagrange-elements" title="Link to this heading"></a></h1>
<div class="download admonition">
<p class="admonition-title">Download sources</p>
<ul class="simple">
<li><p><a class="reference download internal" download="" href="../_downloads/4805c30fd9f5602435f2b34dad232ba2/demo_lagrange_variants.py"><code class="xref download docutils literal notranslate"><span class="pre">Python</span> <span class="pre">script</span></code></a></p></li>
<li><p><a class="reference download internal" download="" href="../_downloads/0ff7b5905586c05f3ded87f72380f93b/demo_lagrange_variants.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Jupyter</span> <span class="pre">notebook</span></code></a></p></li>
</ul>
</div>
<p>This demo illustrates how to:</p>
<ul class="simple">
<li><p>Define finite elements directly using Basix</p></li>
<li><p>Create variants of Lagrange finite elements</p></li>
</ul>
<p>We begin this demo by importing the required modules.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://mpi4py.readthedocs.io/en/4.1.1/mpi4py.html#module-mpi4py" title="mpi4py"><span class="nn">mpi4py</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://mpi4py.readthedocs.io/en/4.1.1/reference/mpi4py.MPI.html#module-mpi4py.MPI" title="mpi4py.MPI"><span class="n">MPI</span></a>

<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pylab</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="kn">import</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/basix/main/python/_autosummary/basix.html#module-basix" title="basix"><span class="nn">basix</span></a>
<span class="kn">import</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/basix/main/python/_autosummary/basix.ufl.html#module-basix.ufl" title="basix.ufl"><span class="nn">basix.ufl</span></a>
<span class="kn">import</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api/api-ufl.html#module-ufl" title="ufl"><span class="nn">ufl</span></a>
<span class="kn">from</span><span class="w"> </span><span class="nn">dolfinx</span><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/2.2/reference/arrays.scalars.html#numpy.float64" title="numpy.float64"><span class="n">default_real_type</span></a><span class="p">,</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.html#module-dolfinx.fem" title="dolfinx.fem"><span class="n">fem</span></a><span class="p">,</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#module-dolfinx.mesh" title="dolfinx.mesh"><span class="n">mesh</span></a>
</pre></div>
</div>
<section id="equispaced-versus-gauss-lobatto-legendre-gll-points">
<h2>Equispaced versus Gauss–Lobatto–Legendre (GLL) points<a class="headerlink" href="#equispaced-versus-gauss-lobatto-legendre-gll-points" title="Link to this heading"></a></h2>
<p>The basis functions of a Lagrange element are defined by placing
points on the reference element, with each basis function equal to 1
at one point and 0 at all the other points. To demonstrate the
influence of interpolation point position, we create a degree 10
element on an interval using equally spaced points, and plot the basis
functions. We create this element using <code class="docutils literal notranslate"><span class="pre">basix.ufl</span></code>’s
<code class="docutils literal notranslate"><span class="pre">element</span></code> function. The function <code class="docutils literal notranslate"><span class="pre">element.tabulate</span></code> returns a 3-
dimensional array with shape (derivatives, points, (value size) *
(basis functions)).
In this example, we only tabulate the 0th derivative and the value
size is 1, so we take the slice <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">:,</span> <span class="pre">:]</span></code> to get a 2-dimensional
array.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">20</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">element</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/basix/main/python/_autosummary/basix.ufl.html#basix.ufl.element" title="basix.ufl.element"><span class="n">basix</span><span class="o">.</span><span class="n">ufl</span><span class="o">.</span><span class="n">element</span></a><span class="p">(</span>
    <span class="n">basix</span><span class="o">.</span><span class="n">ElementFamily</span><span class="o">.</span><span class="n">P</span><span class="p">,</span>
    <span class="n">basix</span><span class="o">.</span><span class="n">CellType</span><span class="o">.</span><span class="n">interval</span><span class="p">,</span>
    <span class="mi">10</span><span class="p">,</span>
    <span class="n">basix</span><span class="o">.</span><span class="n">LagrangeVariant</span><span class="o">.</span><span class="n">equispaced</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><a class="sphinx-codeautolink-a" href="https://numpy.org/doc/2.2/reference/arrays.scalars.html#numpy.float64" title="numpy.float64"><span class="n">default_real_type</span></a><span class="p">,</span>
<span class="p">)</span>
<span class="n">lattice</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/basix/main/python/_autosummary/basix.html#basix.create_lattice" title="basix.create_lattice"><span class="n">basix</span><span class="o">.</span><span class="n">create_lattice</span></a><span class="p">(</span><span class="n">basix</span><span class="o">.</span><span class="n">CellType</span><span class="o">.</span><span class="n">interval</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="n">basix</span><span class="o">.</span><span class="n">LatticeType</span><span class="o">.</span><span class="n">equispaced</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">tabulate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">lattice</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
<span class="k">if</span> <span class="n">MPI</span><span class="o">.</span><span class="n">COMM_WORLD</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lattice</span><span class="p">,</span> <span class="n">values</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">_element</span><span class="o">.</span><span class="n">points</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">11</span><span class="p">,</span> <span class="s2">"ko"</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">"demo_lagrange_variants_equispaced_10.png"</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
</pre></div>
</div>
<p><img alt="The basis functions of a degree 10 Lagrange space defined usingequispaced points." src="../_images/demo_lagrange_variants_equispaced_10.png"/></p>
<p>The basis functions exhibit large peaks towards the ends of the
interval. This is known as <a class="reference external" href="https://en.wikipedia.org/wiki/Runge%27s_phenomenon">Runge’s
phenomenon</a>. The
amplitude of the peaks increases as the degree of the element is
increased.</p>
<p>To rectify this issue, we can create a ‘variant’ of a Lagrange element
that uses the <a class="reference external" href="https://en.wikipedia.org/wiki/Gaussian_quadrature#Gauss%E2%80%93Lobatto_rules">Gauss–Lobatto–Legendre (GLL)
points</a>
to define the basis functions.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">element</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/basix/main/python/_autosummary/basix.ufl.html#basix.ufl.element" title="basix.ufl.element"><span class="n">basix</span><span class="o">.</span><span class="n">ufl</span><span class="o">.</span><span class="n">element</span></a><span class="p">(</span>
    <span class="n">basix</span><span class="o">.</span><span class="n">ElementFamily</span><span class="o">.</span><span class="n">P</span><span class="p">,</span>
    <span class="n">basix</span><span class="o">.</span><span class="n">CellType</span><span class="o">.</span><span class="n">interval</span><span class="p">,</span>
    <span class="mi">10</span><span class="p">,</span>
    <span class="n">basix</span><span class="o">.</span><span class="n">LagrangeVariant</span><span class="o">.</span><span class="n">gll_warped</span><span class="p">,</span>
    <span class="n">dtype</span><span class="o">=</span><a class="sphinx-codeautolink-a" href="https://numpy.org/doc/2.2/reference/arrays.scalars.html#numpy.float64" title="numpy.float64"><span class="n">default_real_type</span></a><span class="p">,</span>
<span class="p">)</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">tabulate</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">lattice</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
<span class="k">if</span> <span class="n">MPI</span><span class="o">.</span><span class="n">COMM_WORLD</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Skip this plotting in parallel</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">values</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lattice</span><span class="p">,</span> <span class="n">values</span><span class="p">[:,</span> <span class="n">i</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">element</span><span class="o">.</span><span class="n">_element</span><span class="o">.</span><span class="n">points</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mi">11</span><span class="p">,</span> <span class="s2">"ko"</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">"demo_lagrange_variants_gll_10.png"</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
</pre></div>
</div>
<p><img alt="The basis functions of a degree 10 Lagrange space defined using GLLpoints." src="../_images/demo_lagrange_variants_gll_10.png"/></p>
<p>The points are clustered towards the endpoints of the interval, and
the basis functions do not exhibit Runge’s phenomenon.</p>
</section>
<section id="computing-the-error-of-an-interpolation">
<h2>Computing the error of an interpolation<a class="headerlink" href="#computing-the-error-of-an-interpolation" title="Link to this heading"></a></h2>
<p>To demonstrate how the choice of Lagrange variant can affect
computed results, we compute the error when interpolating a
function into a finite element space. For this example, we define a
saw tooth wave that will be interpolated.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">saw_tooth</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="n">f</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mf">0.43</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
        <span class="n">f</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">f</span> <span class="o">-</span> <span class="mf">0.3</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">f</span>
</pre></div>
</div>
<p>We begin by interpolating the saw tooth wave with the two Lagrange
elements, and plot the finite element interpolation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#dolfinx.mesh.Mesh" title="dolfinx.mesh.Mesh"><span class="n">msh</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#dolfinx.mesh.create_unit_interval" title="dolfinx.mesh.create_unit_interval"><span class="n">mesh</span><span class="o">.</span><span class="n">create_unit_interval</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://mpi4py.readthedocs.io/en/4.1.1/reference/mpi4py.MPI.COMM_WORLD.html#mpi4py.MPI.COMM_WORLD" title="mpi4py.MPI.COMM_WORLD"><span class="n">MPI</span><span class="o">.</span><span class="n">COMM_WORLD</span></a><span class="p">,</span> <span class="n">N</span><span class="p">)</span>

<a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api/api-ufl.html#ufl.SpatialCoordinate" title="ufl.geometry.SpatialCoordinate"><span class="n">x</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api/api-ufl.html#ufl.SpatialCoordinate" title="ufl.geometry.SpatialCoordinate"><span class="n">ufl</span><span class="o">.</span><span class="n">SpatialCoordinate</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#dolfinx.mesh.Mesh" title="dolfinx.mesh.Mesh"><span class="n">msh</span></a><span class="p">)</span>
<span class="n">u_exact</span> <span class="o">=</span> <span class="n">saw_tooth</span><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/ufl/main/api/api-ufl.html#ufl.SpatialCoordinate" title="ufl.geometry.SpatialCoordinate"><span class="n">x</span></a><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="k">for</span> <span class="n">variant</span> <span class="ow">in</span> <span class="p">[</span><span class="n">basix</span><span class="o">.</span><span class="n">LagrangeVariant</span><span class="o">.</span><span class="n">equispaced</span><span class="p">,</span> <span class="n">basix</span><span class="o">.</span><span class="n">LagrangeVariant</span><span class="o">.</span><span class="n">gll_warped</span><span class="p">]:</span>
    <span class="n">ufl_element</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/basix/main/python/_autosummary/basix.ufl.html#basix.ufl.element" title="basix.ufl.element"><span class="n">basix</span><span class="o">.</span><span class="n">ufl</span><span class="o">.</span><span class="n">element</span></a><span class="p">(</span>
        <span class="n">basix</span><span class="o">.</span><span class="n">ElementFamily</span><span class="o">.</span><span class="n">P</span><span class="p">,</span> <span class="n">basix</span><span class="o">.</span><span class="n">CellType</span><span class="o">.</span><span class="n">interval</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">variant</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><a class="sphinx-codeautolink-a" href="https://numpy.org/doc/2.2/reference/arrays.scalars.html#numpy.float64" title="numpy.float64"><span class="n">default_real_type</span></a>
    <span class="p">)</span>
    <span class="n">V</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.html#dolfinx.fem.functionspace" title="dolfinx.fem.functionspace"><span class="n">fem</span><span class="o">.</span><span class="n">functionspace</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#dolfinx.mesh.Mesh" title="dolfinx.mesh.Mesh"><span class="n">msh</span></a><span class="p">,</span> <span class="n">ufl_element</span><span class="p">)</span>
    <a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.html#dolfinx.fem.Function" title="dolfinx.fem.function.Function"><span class="n">uh</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.html#dolfinx.fem.Function" title="dolfinx.fem.function.Function"><span class="n">fem</span><span class="o">.</span><span class="n">Function</span></a><span class="p">(</span><span class="n">V</span><span class="p">)</span>
    <span class="n">uh</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">saw_tooth</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="k">if</span> <span class="n">MPI</span><span class="o">.</span><span class="n">COMM_WORLD</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>  <span class="c1"># Skip this plotting in parallel</span>
        <span class="n">pts</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">cells</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">cell</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">51</span><span class="p">):</span>
                <span class="n">pts</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">cell</span> <span class="o">/</span> <span class="n">N</span> <span class="o">+</span> <span class="n">i</span> <span class="o">/</span> <span class="mi">50</span> <span class="o">/</span> <span class="n">N</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
                <span class="n">cells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
        <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/2.2/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray"><span class="n">values</span></a> <span class="o">=</span> <span class="n">uh</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="n">cells</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <span class="p">[</span><span class="n">saw_tooth</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pts</span><span class="p">],</span> <span class="s2">"k--"</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">pts</span><span class="p">,</span> <a class="sphinx-codeautolink-a" href="https://numpy.org/doc/2.2/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray"><span class="n">values</span></a><span class="p">,</span> <span class="s2">"r-"</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">([</span><span class="s2">"function"</span><span class="p">,</span> <span class="s2">"approximation"</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">variant</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s2">"demo_lagrange_variants_interpolation_</span><span class="si">{</span><span class="n">variant</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">.png"</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
</pre></div>
</div>
<p><img alt="" src="../_images/demo_lagrange_variants_interpolation_equispaced.png"/>
<img alt="" src="../_images/demo_lagrange_variants_interpolation_gll_warped.png"/></p>
<p>The plots illustrate that Runge’s phenomenon leads to the
interpolation being less accurate when using the equispaced variant of
Lagrange compared to the GLL variant. To quantify the error, we
compute the interpolation error in the <span class="math notranslate nohighlight">\(L_2\)</span> norm,</p>
<div class="math notranslate nohighlight">
\[\left\|u - u_h\right\|_2 =
  \left(\int_0^1 (u - u_h)^2\right)^{\frac{1}{2}},\]</div>
<p>where <span class="math notranslate nohighlight">\(u\)</span> is the function and <span class="math notranslate nohighlight">\(u_h\)</span> is its interpolation in the finite
element space. The following code uses UFL to compute the <span class="math notranslate nohighlight">\(L_2\)</span> error
for the equispaced and GLL variants. The <span class="math notranslate nohighlight">\(L_2\)</span> error for the GLL
variant is considerably smaller than the error for the equispaced
variant.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">variant</span> <span class="ow">in</span> <span class="p">[</span><span class="n">basix</span><span class="o">.</span><span class="n">LagrangeVariant</span><span class="o">.</span><span class="n">equispaced</span><span class="p">,</span> <span class="n">basix</span><span class="o">.</span><span class="n">LagrangeVariant</span><span class="o">.</span><span class="n">gll_warped</span><span class="p">]:</span>
    <span class="n">ufl_element</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="https://docs.fenicsproject.org/basix/main/python/_autosummary/basix.ufl.html#basix.ufl.element" title="basix.ufl.element"><span class="n">basix</span><span class="o">.</span><span class="n">ufl</span><span class="o">.</span><span class="n">element</span></a><span class="p">(</span>
        <span class="n">basix</span><span class="o">.</span><span class="n">ElementFamily</span><span class="o">.</span><span class="n">P</span><span class="p">,</span> <span class="n">basix</span><span class="o">.</span><span class="n">CellType</span><span class="o">.</span><span class="n">interval</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">variant</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><a class="sphinx-codeautolink-a" href="https://numpy.org/doc/2.2/reference/arrays.scalars.html#numpy.float64" title="numpy.float64"><span class="n">default_real_type</span></a>
    <span class="p">)</span>
    <span class="n">V</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.html#dolfinx.fem.functionspace" title="dolfinx.fem.functionspace"><span class="n">fem</span><span class="o">.</span><span class="n">functionspace</span></a><span class="p">(</span><a class="sphinx-codeautolink-a" href="../generated/dolfinx.mesh.html#dolfinx.mesh.Mesh" title="dolfinx.mesh.Mesh"><span class="n">msh</span></a><span class="p">,</span> <span class="n">ufl_element</span><span class="p">)</span>
    <a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.html#dolfinx.fem.Function" title="dolfinx.fem.function.Function"><span class="n">uh</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.html#dolfinx.fem.Function" title="dolfinx.fem.function.Function"><span class="n">fem</span><span class="o">.</span><span class="n">Function</span></a><span class="p">(</span><span class="n">V</span><span class="p">)</span>
    <span class="n">uh</span><span class="o">.</span><span class="n">interpolate</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">saw_tooth</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">M</span> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.html#dolfinx.fem.form" title="dolfinx.fem.form"><span class="n">fem</span><span class="o">.</span><span class="n">form</span></a><span class="p">((</span><span class="n">u_exact</span> <span class="o">-</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.html#dolfinx.fem.Function" title="dolfinx.fem.function.Function"><span class="n">uh</span></a><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">ufl</span><span class="o">.</span><span class="n">dx</span><span class="p">)</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">msh</span><span class="o">.</span><span class="n">comm</span><span class="o">.</span><span class="n">allreduce</span><span class="p">(</span><a class="sphinx-codeautolink-a" href="../generated/dolfinx.fem.html#dolfinx.fem.assemble_scalar" title="dolfinx.fem.assemble_scalar"><span class="n">fem</span><span class="o">.</span><span class="n">assemble_scalar</span></a><span class="p">(</span><span class="n">M</span><span class="p">),</span> <span class="n">op</span><span class="o">=</span><a class="sphinx-codeautolink-a" href="https://mpi4py.readthedocs.io/en/4.1.1/reference/mpi4py.MPI.SUM.html#mpi4py.MPI.SUM" title="mpi4py.MPI.SUM"><span class="n">MPI</span><span class="o">.</span><span class="n">SUM</span></a><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Computed L2 interpolation error (</span><span class="si">{</span><span class="n">variant</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">):"</span><span class="p">,</span> <span class="n">error</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="available-lagrange-variants">
<h2>Available Lagrange variants<a class="headerlink" href="#available-lagrange-variants" title="Link to this heading"></a></h2>
<p>Basix supports numerous Lagrange variants, including:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">basix.LagrangeVariant.equispaced</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">basix.LagrangeVariant.gll_warped</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">basix.LagrangeVariant.gll_isaac</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">basix.LagrangeVariant.gll_centroid</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">basix.LagrangeVariant.chebyshev_warped</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">basix.LagrangeVariant.chebyshev_isaac</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">basix.LagrangeVariant.chebyshev_centroid</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">basix.LagrangeVariant.gl_warped</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">basix.LagrangeVariant.gl_isaac</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">basix.LagrangeVariant.gl_centroid</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">basix.LagrangeVariant.legendre</span></code></p></li>
</ul>
<section id="equispaced-points">
<h3>Equispaced points<a class="headerlink" href="#equispaced-points" title="Link to this heading"></a></h3>
<p>The variant <code class="docutils literal notranslate"><span class="pre">basix.LagrangeVariant.equispaced</span></code> defines an element
using equally spaced points on the cell.</p>
</section>
<section id="gll-points">
<h3>GLL points<a class="headerlink" href="#gll-points" title="Link to this heading"></a></h3>
<p>For intervals, quadrilaterals and hexahedra, the variants
<code class="docutils literal notranslate"><span class="pre">basix.LagrangeVariant.gll_warped</span></code>, <code class="docutils literal notranslate"><span class="pre">basix.LagrangeVariant.gll_isaac</span></code>
and <code class="docutils literal notranslate"><span class="pre">basix.LagrangeVariant.gll_centroid</span></code> all define an element using
GLL-type points.</p>
<p>On triangles and tetrahedra, the three variants use different methods
to distribute points on the cell so that the points on each edge are
GLL points. The three methods used are described in <a class="reference external" href="https://docs.fenicsproject.org/basix/main/cpp/namespacebasix_1_1lattice.html">the Basix
documentation</a>.</p>
</section>
<section id="chebyshev-points">
<h3>Chebyshev points<a class="headerlink" href="#chebyshev-points" title="Link to this heading"></a></h3>
<p>The variants <code class="docutils literal notranslate"><span class="pre">basix.LagrangeVariant.chebyshev_warped</span></code>,
<code class="docutils literal notranslate"><span class="pre">basix.LagrangeVariant.chebyshev_isaac</span></code> and
<code class="docutils literal notranslate"><span class="pre">basix.LagrangeVariant.chebyshev_centroid</span></code> can be used to define
elements using <a class="reference external" href="https://en.wikipedia.org/wiki/Chebyshev_nodes">Chebyshev
points</a>. As with GLL
points, these three variants are the same on intervals, quadrilaterals
and hexahedra, and vary on simplex cells.</p>
</section>
<section id="gl-points">
<h3>GL points<a class="headerlink" href="#gl-points" title="Link to this heading"></a></h3>
<p>The variants <code class="docutils literal notranslate"><span class="pre">basix.LagrangeVariant.gl_warped</span></code>,
<code class="docutils literal notranslate"><span class="pre">basix.LagrangeVariant.gl_isaac</span></code> and
<code class="docutils literal notranslate"><span class="pre">basix.LagrangeVariant.gl_centroid</span></code> can be used to define elements
using <a class="reference external" href="https://en.wikipedia.org/wiki/Gaussian_quadrature#Gauss%E2%80%93Legendre_quadrature">Gauss-Legendre (GL)
points</a>.
GL points do not include the endpoints, hence this variant can only be
used for discontinuous elements.</p>
</section>
<section id="legendre-polynomials">
<h3>Legendre polynomials<a class="headerlink" href="#legendre-polynomials" title="Link to this heading"></a></h3>
<p>The variant <code class="docutils literal notranslate"><span class="pre">basix.LagrangeVariant.legendre</span></code> can be used to define a
Lagrange-like element whose basis functions are the orthonormal
Legendre polynomials. These polynomials are not defined using points
at the endpoints, so can also only be used for discontinuous elements.</p>
</section>
</section>
</section>
</div>
</div>
<footer><div aria-label="Footer" class="rst-footer-buttons" role="navigation">
<a accesskey="p" class="btn btn-neutral float-left" href="demo_interpolation-io.html" rel="prev" title="Interpolation and IO"><span aria-hidden="true" class="fa fa-arrow-circle-left"></span> Previous</a>
<a accesskey="n" class="btn btn-neutral float-right" href="demo_tnt-elements.html" rel="next" title="Creating TNT elements using Basix’s custom element interface">Next <span aria-hidden="true" class="fa fa-arrow-circle-right"></span></a>
</div>
<hr/>
<div role="contentinfo">
<p>© Copyright 2025, FEniCS Project.</p>
</div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
</div>
</div>
</section>
</div>
<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
</body>
</html>