<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Linear algebra (dolfinx::la) &mdash; DOLFINx 0.3.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=4621528c"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Mesh (dolfinx::mesh)" href="mesh.html" />
    <link rel="prev" title="IO (dolfinx::io)" href="io.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            DOLFINx
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="common.html">Common (<code class="docutils literal notranslate"><span class="pre">dolfinx::common</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="geometry.html">Geometry (<code class="docutils literal notranslate"><span class="pre">dolfinx::geometry</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph.html">Graph (<code class="docutils literal notranslate"><span class="pre">dolfinx::graph</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="fem.html">Finite element (<code class="docutils literal notranslate"><span class="pre">dolfinx::fem</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="io.html">IO (<code class="docutils literal notranslate"><span class="pre">dolfinx::io</span></code>)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Linear algebra (<code class="docutils literal notranslate"><span class="pre">dolfinx::la</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#_CPPv4N7dolfinx2laE"><code class="docutils literal notranslate"><span class="pre">la</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4N7dolfinx2la9BlockModeE"><code class="docutils literal notranslate"><span class="pre">la::BlockMode</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la9BlockMode7compactE"><code class="docutils literal notranslate"><span class="pre">la::BlockMode::compact</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la9BlockMode8expandedE"><code class="docutils literal notranslate"><span class="pre">la::BlockMode::expanded</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4N7dolfinx2la4NormE"><code class="docutils literal notranslate"><span class="pre">la::Norm</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la4Norm2l1E"><code class="docutils literal notranslate"><span class="pre">la::Norm::l1</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la4Norm2l2E"><code class="docutils literal notranslate"><span class="pre">la::Norm::l2</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la4Norm4linfE"><code class="docutils literal notranslate"><span class="pre">la::Norm::linf</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la4Norm9frobeniusE"><code class="docutils literal notranslate"><span class="pre">la::Norm::frobenius</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la13inner_productEDaRK1VRK1V"><code class="docutils literal notranslate"><span class="pre">la::inner_product()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la12squared_normEDaRK1V"><code class="docutils literal notranslate"><span class="pre">la::squared_norm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la4normEDaRK1V4Norm"><code class="docutils literal notranslate"><span class="pre">la::norm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la14orthonormalizeEvNSt6vectorINSt17reference_wrapperI1VEEEE"><code class="docutils literal notranslate"><span class="pre">la::orthonormalize()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la14is_orthonormalEbNSt6vectorINSt17reference_wrapperIK1VEEEE"><code class="docutils literal notranslate"><span class="pre">la::is_orthonormal()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I0000EN7dolfinx2la9MatrixCSRE"><code class="docutils literal notranslate"><span class="pre">la::MatrixCSR</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR10value_typeE"><code class="docutils literal notranslate"><span class="pre">la::MatrixCSR::value_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR14container_typeE"><code class="docutils literal notranslate"><span class="pre">la::MatrixCSR::container_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR21column_container_typeE"><code class="docutils literal notranslate"><span class="pre">la::MatrixCSR::column_container_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR21rowptr_container_typeE"><code class="docutils literal notranslate"><span class="pre">la::MatrixCSR::rowptr_container_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I_i_iEN7dolfinx2la9MatrixCSR14mat_set_valuesEDav"><code class="docutils literal notranslate"><span class="pre">la::MatrixCSR::mat_set_values()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I_i_iEN7dolfinx2la9MatrixCSR14mat_add_valuesEDav"><code class="docutils literal notranslate"><span class="pre">la::MatrixCSR::mat_add_values()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR9MatrixCSRERK15SparsityPattern9BlockMode"><code class="docutils literal notranslate"><span class="pre">la::MatrixCSR::MatrixCSR()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR9MatrixCSRERR9MatrixCSR"><code class="docutils literal notranslate"><span class="pre">la::MatrixCSR::MatrixCSR()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR3setE10value_type"><code class="docutils literal notranslate"><span class="pre">la::MatrixCSR::set()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I_i_iEN7dolfinx2la9MatrixCSR3setEvNSt4spanIK10value_typeEENSt4spanIKNSt7int32_tEEENSt4spanIKNSt7int32_tEEE"><code class="docutils literal notranslate"><span class="pre">la::MatrixCSR::set()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I_i_iEN7dolfinx2la9MatrixCSR3addEvNSt4spanIK10value_typeEENSt4spanIKNSt7int32_tEEENSt4spanIKNSt7int32_tEEE"><code class="docutils literal notranslate"><span class="pre">la::MatrixCSR::add()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la9MatrixCSR14num_owned_rowsEv"><code class="docutils literal notranslate"><span class="pre">la::MatrixCSR::num_owned_rows()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la9MatrixCSR12num_all_rowsEv"><code class="docutils literal notranslate"><span class="pre">la::MatrixCSR::num_all_rows()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la9MatrixCSR8to_denseEv"><code class="docutils literal notranslate"><span class="pre">la::MatrixCSR::to_dense()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR11scatter_revEv"><code class="docutils literal notranslate"><span class="pre">la::MatrixCSR::scatter_rev()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR17scatter_rev_beginEv"><code class="docutils literal notranslate"><span class="pre">la::MatrixCSR::scatter_rev_begin()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR15scatter_rev_endEv"><code class="docutils literal notranslate"><span class="pre">la::MatrixCSR::scatter_rev_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la9MatrixCSR12squared_normEv"><code class="docutils literal notranslate"><span class="pre">la::MatrixCSR::squared_norm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la9MatrixCSR9index_mapEi"><code class="docutils literal notranslate"><span class="pre">la::MatrixCSR::index_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR6valuesEv"><code class="docutils literal notranslate"><span class="pre">la::MatrixCSR::values()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la9MatrixCSR6valuesEv"><code class="docutils literal notranslate"><span class="pre">la::MatrixCSR::values()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la9MatrixCSR7row_ptrEv"><code class="docutils literal notranslate"><span class="pre">la::MatrixCSR::row_ptr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la9MatrixCSR4colsEv"><code class="docutils literal notranslate"><span class="pre">la::MatrixCSR::cols()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la9MatrixCSR15off_diag_offsetEv"><code class="docutils literal notranslate"><span class="pre">la::MatrixCSR::off_diag_offset()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la9MatrixCSR10block_sizeEv"><code class="docutils literal notranslate"><span class="pre">la::MatrixCSR::block_size()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4N7dolfinx2la16SLEPcEigenSolverE"><code class="docutils literal notranslate"><span class="pre">la::SLEPcEigenSolver</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la16SLEPcEigenSolver16SLEPcEigenSolverE8MPI_Comm"><code class="docutils literal notranslate"><span class="pre">la::SLEPcEigenSolver::SLEPcEigenSolver()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la16SLEPcEigenSolver16SLEPcEigenSolverE3EPSb"><code class="docutils literal notranslate"><span class="pre">la::SLEPcEigenSolver::SLEPcEigenSolver()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la16SLEPcEigenSolver16SLEPcEigenSolverERR16SLEPcEigenSolver"><code class="docutils literal notranslate"><span class="pre">la::SLEPcEigenSolver::SLEPcEigenSolver()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la16SLEPcEigenSolverD0Ev"><code class="docutils literal notranslate"><span class="pre">la::SLEPcEigenSolver::~SLEPcEigenSolver()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la16SLEPcEigenSolveraSERR16SLEPcEigenSolver"><code class="docutils literal notranslate"><span class="pre">la::SLEPcEigenSolver::operator=()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la16SLEPcEigenSolver13set_operatorsEK3MatK3Mat"><code class="docutils literal notranslate"><span class="pre">la::SLEPcEigenSolver::set_operators()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la16SLEPcEigenSolver5solveEv"><code class="docutils literal notranslate"><span class="pre">la::SLEPcEigenSolver::solve()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la16SLEPcEigenSolver5solveENSt7int64_tE"><code class="docutils literal notranslate"><span class="pre">la::SLEPcEigenSolver::solve()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la16SLEPcEigenSolver14get_eigenvalueEi"><code class="docutils literal notranslate"><span class="pre">la::SLEPcEigenSolver::get_eigenvalue()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la16SLEPcEigenSolver13get_eigenpairER11PetscScalarR11PetscScalar3Vec3Veci"><code class="docutils literal notranslate"><span class="pre">la::SLEPcEigenSolver::get_eigenpair()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la16SLEPcEigenSolver20get_iteration_numberEv"><code class="docutils literal notranslate"><span class="pre">la::SLEPcEigenSolver::get_iteration_number()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la16SLEPcEigenSolver20get_number_convergedEv"><code class="docutils literal notranslate"><span class="pre">la::SLEPcEigenSolver::get_number_converged()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la16SLEPcEigenSolver18set_options_prefixENSt6stringE"><code class="docutils literal notranslate"><span class="pre">la::SLEPcEigenSolver::set_options_prefix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la16SLEPcEigenSolver18get_options_prefixEv"><code class="docutils literal notranslate"><span class="pre">la::SLEPcEigenSolver::get_options_prefix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la16SLEPcEigenSolver16set_from_optionsEv"><code class="docutils literal notranslate"><span class="pre">la::SLEPcEigenSolver::set_from_options()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la16SLEPcEigenSolver3epsEv"><code class="docutils literal notranslate"><span class="pre">la::SLEPcEigenSolver::eps()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la16SLEPcEigenSolver4commEv"><code class="docutils literal notranslate"><span class="pre">la::SLEPcEigenSolver::comm()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4N7dolfinx2la15SparsityPatternE"><code class="docutils literal notranslate"><span class="pre">la::SparsityPattern</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la15SparsityPattern15SparsityPatternE8MPI_CommRKNSt5arrayINSt10shared_ptrIKN6common8IndexMapEEEXL2EEEERKNSt5arrayIiXL2EEEE"><code class="docutils literal notranslate"><span class="pre">la::SparsityPattern::SparsityPattern()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la15SparsityPattern15SparsityPatternE8MPI_CommRKNSt6vectorINSt6vectorIPK15SparsityPatternEEEERKNSt5arrayINSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEEXL2EEEERKNSt5arrayINSt6vectorIiEEXL2EEEE"><code class="docutils literal notranslate"><span class="pre">la::SparsityPattern::SparsityPattern()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la15SparsityPattern15SparsityPatternERR15SparsityPattern"><code class="docutils literal notranslate"><span class="pre">la::SparsityPattern::SparsityPattern()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la15SparsityPatternD0Ev"><code class="docutils literal notranslate"><span class="pre">la::SparsityPattern::~SparsityPattern()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la15SparsityPatternaSERR15SparsityPattern"><code class="docutils literal notranslate"><span class="pre">la::SparsityPattern::operator=()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la15SparsityPattern6insertERKNSt4spanIKNSt7int32_tEEERKNSt4spanIKNSt7int32_tEEE"><code class="docutils literal notranslate"><span class="pre">la::SparsityPattern::insert()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la15SparsityPattern15insert_diagonalENSt4spanIKNSt7int32_tEEE"><code class="docutils literal notranslate"><span class="pre">la::SparsityPattern::insert_diagonal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la15SparsityPattern8finalizeEv"><code class="docutils literal notranslate"><span class="pre">la::SparsityPattern::finalize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la15SparsityPattern9index_mapEi"><code class="docutils literal notranslate"><span class="pre">la::SparsityPattern::index_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la15SparsityPattern14column_indicesEv"><code class="docutils literal notranslate"><span class="pre">la::SparsityPattern::column_indices()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la15SparsityPattern16column_index_mapEv"><code class="docutils literal notranslate"><span class="pre">la::SparsityPattern::column_index_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la15SparsityPattern10block_sizeEi"><code class="docutils literal notranslate"><span class="pre">la::SparsityPattern::block_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la15SparsityPattern12num_nonzerosEv"><code class="docutils literal notranslate"><span class="pre">la::SparsityPattern::num_nonzeros()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la15SparsityPattern8nnz_diagENSt7int32_tE"><code class="docutils literal notranslate"><span class="pre">la::SparsityPattern::nnz_diag()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la15SparsityPattern12nnz_off_diagENSt7int32_tE"><code class="docutils literal notranslate"><span class="pre">la::SparsityPattern::nnz_off_diag()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la15SparsityPattern5graphEv"><code class="docutils literal notranslate"><span class="pre">la::SparsityPattern::graph()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la15SparsityPattern20off_diagonal_offsetsEv"><code class="docutils literal notranslate"><span class="pre">la::SparsityPattern::off_diagonal_offsets()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la15SparsityPattern4commEv"><code class="docutils literal notranslate"><span class="pre">la::SparsityPattern::comm()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4I00EN7dolfinx2la6VectorE"><code class="docutils literal notranslate"><span class="pre">la::Vector</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la6Vector10value_typeE"><code class="docutils literal notranslate"><span class="pre">la::Vector::value_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la6Vector14container_typeE"><code class="docutils literal notranslate"><span class="pre">la::Vector::container_type</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la6Vector6VectorENSt10shared_ptrIKN6common8IndexMapEEEi"><code class="docutils literal notranslate"><span class="pre">la::Vector::Vector()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la6Vector6VectorERK6Vector"><code class="docutils literal notranslate"><span class="pre">la::Vector::Vector()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la6Vector6VectorERR6Vector"><code class="docutils literal notranslate"><span class="pre">la::Vector::Vector()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la6VectoraSERR6Vector"><code class="docutils literal notranslate"><span class="pre">la::Vector::operator=()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la6Vector3setE10value_type"><code class="docutils literal notranslate"><span class="pre">la::Vector::set()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la6Vector17scatter_fwd_beginEv"><code class="docutils literal notranslate"><span class="pre">la::Vector::scatter_fwd_begin()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la6Vector15scatter_fwd_endEv"><code class="docutils literal notranslate"><span class="pre">la::Vector::scatter_fwd_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la6Vector11scatter_fwdEv"><code class="docutils literal notranslate"><span class="pre">la::Vector::scatter_fwd()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la6Vector17scatter_rev_beginEv"><code class="docutils literal notranslate"><span class="pre">la::Vector::scatter_rev_begin()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la6Vector15scatter_rev_endEv15BinaryOperation"><code class="docutils literal notranslate"><span class="pre">la::Vector::scatter_rev_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la6Vector11scatter_revEv15BinaryOperation"><code class="docutils literal notranslate"><span class="pre">la::Vector::scatter_rev()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la6Vector9index_mapEv"><code class="docutils literal notranslate"><span class="pre">la::Vector::index_map()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la6Vector2bsEv"><code class="docutils literal notranslate"><span class="pre">la::Vector::bs()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4NK7dolfinx2la6Vector5arrayEv"><code class="docutils literal notranslate"><span class="pre">la::Vector::array()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la6Vector13mutable_arrayEv"><code class="docutils literal notranslate"><span class="pre">la::Vector::mutable_array()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4N7dolfinx2la4implE"><code class="docutils literal notranslate"><span class="pre">la::impl</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl10insert_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE"><code class="docutils literal notranslate"><span class="pre">la::impl::insert_csr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl18insert_blocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE"><code class="docutils literal notranslate"><span class="pre">la::impl::insert_blocked_csr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I000000EN7dolfinx2la4impl21insert_nonblocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeEii"><code class="docutils literal notranslate"><span class="pre">la::impl::insert_nonblocked_csr()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4N7dolfinx2la5petscE"><code class="docutils literal notranslate"><span class="pre">la::petsc</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc5errorEiNSt6stringENSt6stringE"><code class="docutils literal notranslate"><span class="pre">la::petsc::error()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc14create_vectorsE8MPI_CommRKNSt6vectorINSt4spanIK11PetscScalarEEEE"><code class="docutils literal notranslate"><span class="pre">la::petsc::create_vectors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc13create_vectorERKN6common8IndexMapEi"><code class="docutils literal notranslate"><span class="pre">la::petsc::create_vector()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc13create_vectorE8MPI_CommNSt5arrayINSt7int64_tEXL2EEEENSt4spanIKNSt7int64_tEEEi"><code class="docutils literal notranslate"><span class="pre">la::petsc::create_vector()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc18create_vector_wrapERKN6common8IndexMapEiNSt4spanIK11PetscScalarEE"><code class="docutils literal notranslate"><span class="pre">la::petsc::create_vector_wrap()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la5petsc18create_vector_wrapE3VecRKN2la6VectorI1VEE"><code class="docutils literal notranslate"><span class="pre">la::petsc::create_vector_wrap()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc17create_index_setsERKNSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEE"><code class="docutils literal notranslate"><span class="pre">la::petsc::create_index_sets()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc17get_local_vectorsEK3VecRKNSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEE"><code class="docutils literal notranslate"><span class="pre">la::petsc::get_local_vectors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc21scatter_local_vectorsE3VecRKNSt6vectorINSt4spanIK11PetscScalarEEEERKNSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEE"><code class="docutils literal notranslate"><span class="pre">la::petsc::scatter_local_vectors()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc13create_matrixE8MPI_CommRK15SparsityPatternNSt6stringE"><code class="docutils literal notranslate"><span class="pre">la::petsc::create_matrix()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc16create_nullspaceE8MPI_CommNSt4spanIK3VecEE"><code class="docutils literal notranslate"><span class="pre">la::petsc::create_nullspace()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc12KrylovSolverE"><code class="docutils literal notranslate"><span class="pre">la::petsc::KrylovSolver</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc6MatrixE"><code class="docutils literal notranslate"><span class="pre">la::petsc::Matrix</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc8OperatorE"><code class="docutils literal notranslate"><span class="pre">la::petsc::Operator</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc6VectorE"><code class="docutils literal notranslate"><span class="pre">la::petsc::Vector</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc7optionsE"><code class="docutils literal notranslate"><span class="pre">la::petsc::options</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mesh.html">Mesh (<code class="docutils literal notranslate"><span class="pre">dolfinx::mesh</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="refinement.html">Refinement (<code class="docutils literal notranslate"><span class="pre">dolfinx::refinement</span></code>)</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">DOLFINx</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Linear algebra (<code class="docutils literal notranslate"><span class="pre">dolfinx::la</span></code>)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/la.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="linear-algebra-dolfinx-la">
<h1>Linear algebra (<code class="docutils literal notranslate"><span class="pre">dolfinx::la</span></code>)<a class="headerlink" href="#linear-algebra-dolfinx-la" title="Link to this heading"></a></h1>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2laE">
<span id="_CPPv3N7dolfinx2laE"></span><span id="_CPPv2N7dolfinx2laE"></span><span id="dolfinx::la"></span><span class="target" id="d6/dfa/namespacedolfinx_1_1la"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">la</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx2laE" title="Link to this definition"></a><br /></dt>
<dd><p>Linear algebra interface. </p>
<p>Interface to linear algebra data structures and solvers. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-enums">Enums</p>
<dl class="cpp enum-class">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9BlockModeE">
<span id="_CPPv3N7dolfinx2la9BlockModeE"></span><span id="_CPPv2N7dolfinx2la9BlockModeE"></span><span class="target" id="d6/dfa/namespacedolfinx_1_1la_1a95b1e1b5aab4eb54c39e0977036b7eb3"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BlockMode</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la9BlockModeE" title="Link to this definition"></a><br /></dt>
<dd><p>Modes for representing block structured matrices. </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9BlockMode7compactE">
<span id="_CPPv3N7dolfinx2la9BlockMode7compactE"></span><span id="_CPPv2N7dolfinx2la9BlockMode7compactE"></span><span class="target" id="d6/dfa/namespacedolfinx_1_1la_1a95b1e1b5aab4eb54c39e0977036b7eb3a7cf74ca49c304df8150205fc915cd465"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">compact</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la9BlockMode7compactE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9BlockMode8expandedE">
<span id="_CPPv3N7dolfinx2la9BlockMode8expandedE"></span><span id="_CPPv2N7dolfinx2la9BlockMode8expandedE"></span><span class="target" id="d6/dfa/namespacedolfinx_1_1la_1a95b1e1b5aab4eb54c39e0977036b7eb3a1a6130a21d7d578d81a168ebcf0d9921"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">expanded</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la9BlockMode8expandedE" title="Link to this definition"></a><br /></dt>
<dd><p>Each entry in the sparsity pattern of the matrix refers to a block of data of size (bs[0], bs[1]). </p>
</dd></dl>

</dd></dl>

<dl class="cpp enum-class">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la4NormE">
<span id="_CPPv3N7dolfinx2la4NormE"></span><span id="_CPPv2N7dolfinx2la4NormE"></span><span class="target" id="d6/dfa/namespacedolfinx_1_1la_1a2e0f25289c14e546b4ba10dd8fc735e5"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Norm</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la4NormE" title="Link to this definition"></a><br /></dt>
<dd><p>Norm types. </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la4Norm2l1E">
<span id="_CPPv3N7dolfinx2la4Norm2l1E"></span><span id="_CPPv2N7dolfinx2la4Norm2l1E"></span><span class="target" id="d6/dfa/namespacedolfinx_1_1la_1a2e0f25289c14e546b4ba10dd8fc735e5a377fd569971eedeba8fbea28434a390a"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">l1</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la4Norm2l1E" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la4Norm2l2E">
<span id="_CPPv3N7dolfinx2la4Norm2l2E"></span><span id="_CPPv2N7dolfinx2la4Norm2l2E"></span><span class="target" id="d6/dfa/namespacedolfinx_1_1la_1a2e0f25289c14e546b4ba10dd8fc735e5abec25675775e9e0a0d783a5018b463e3"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">l2</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la4Norm2l2E" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la4Norm4linfE">
<span id="_CPPv3N7dolfinx2la4Norm4linfE"></span><span id="_CPPv2N7dolfinx2la4Norm4linfE"></span><span class="target" id="d6/dfa/namespacedolfinx_1_1la_1a2e0f25289c14e546b4ba10dd8fc735e5a707f3c5e9c59c9e5f347d2cbec59c66b"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">linf</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la4Norm4linfE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la4Norm9frobeniusE">
<span id="_CPPv3N7dolfinx2la4Norm9frobeniusE"></span><span id="_CPPv2N7dolfinx2la4Norm9frobeniusE"></span><span class="target" id="d6/dfa/namespacedolfinx_1_1la_1a2e0f25289c14e546b4ba10dd8fc735e5aa1ae1f31da9633c9e25dcccb0acc3066"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">frobenius</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la4Norm9frobeniusE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN7dolfinx2la13inner_productEDaRK1VRK1V">
<span id="_CPPv3I0EN7dolfinx2la13inner_productERK1VRK1V"></span><span id="_CPPv2I0EN7dolfinx2la13inner_productERK1VRK1V"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">V</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d6/dfa/namespacedolfinx_1_1la_1aa5d7dcd5bb4b9b5c111350a5c6dd4751"></span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">inner_product</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la13inner_productEDaRK1VRK1V" title="dolfinx::la::inner_product::V"><span class="n"><span class="pre">V</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la13inner_productEDaRK1VRK1V" title="dolfinx::la::inner_product::V"><span class="n"><span class="pre">V</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">b</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN7dolfinx2la13inner_productEDaRK1VRK1V" title="Link to this definition"></a><br /></dt>
<dd><p>Compute the inner product of two vectors. The two vectors must have the same parallel layout. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Collective MPI operation </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> – A vector </p></li>
<li><p><strong>b</strong> – A vector </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Returns <code class="docutils literal notranslate"><span class="pre">a^{H}</span> <span class="pre">b</span></code> (<code class="docutils literal notranslate"><span class="pre">a^{T}</span> <span class="pre">b</span></code> if <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> are real) </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN7dolfinx2la12squared_normEDaRK1V">
<span id="_CPPv3I0EN7dolfinx2la12squared_normERK1V"></span><span id="_CPPv2I0EN7dolfinx2la12squared_normERK1V"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">V</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d6/dfa/namespacedolfinx_1_1la_1a690ebbef0223a5c669b637d5f2f2e6f0"></span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">squared_norm</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la12squared_normEDaRK1V" title="dolfinx::la::squared_norm::V"><span class="n"><span class="pre">V</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">a</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN7dolfinx2la12squared_normEDaRK1V" title="Link to this definition"></a><br /></dt>
<dd><p>Compute the squared L2 norm of vector. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Collective MPI operation </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN7dolfinx2la4normEDaRK1V4Norm">
<span id="_CPPv3I0EN7dolfinx2la4normERK1V4Norm"></span><span id="_CPPv2I0EN7dolfinx2la4normERK1V4Norm"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">V</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d6/dfa/namespacedolfinx_1_1la_1aa32f131f39f8be7ec5e7681950da35e6"></span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">norm</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la4normEDaRK1V4Norm" title="dolfinx::la::norm::V"><span class="n"><span class="pre">V</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x</span></span>, <a class="reference internal" href="#_CPPv4N7dolfinx2la4NormE" title="dolfinx::la::Norm"><span class="n"><span class="pre">Norm</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">type</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la4NormE" title="dolfinx::la::Norm"><span class="n"><span class="pre">Norm</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N7dolfinx2la4Norm2l2E" title="dolfinx::la::Norm::l2"><span class="n"><span class="pre">l2</span></span></a><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN7dolfinx2la4normEDaRK1V4Norm" title="Link to this definition"></a><br /></dt>
<dd><p>Compute the norm of the vector. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Collective MPI operation </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – A vector </p></li>
<li><p><strong>type</strong> – Norm type (supported types are <span class="math notranslate nohighlight">\(L^2\)</span> and <span class="math notranslate nohighlight">\(L^\infty\)</span>) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN7dolfinx2la14orthonormalizeEvNSt6vectorINSt17reference_wrapperI1VEEEE">
<span id="_CPPv3I0EN7dolfinx2la14orthonormalizeENSt6vectorINSt17reference_wrapperI1VEEEE"></span><span id="_CPPv2I0EN7dolfinx2la14orthonormalizeENSt6vectorINSt17reference_wrapperI1VEEEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">V</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d6/dfa/namespacedolfinx_1_1la_1a099c016d9a283690d5c49dfc49794c45"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">orthonormalize</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">reference_wrapper</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la14orthonormalizeEvNSt6vectorINSt17reference_wrapperI1VEEEE" title="dolfinx::la::orthonormalize::V"><span class="n"><span class="pre">V</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">basis</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN7dolfinx2la14orthonormalizeEvNSt6vectorINSt17reference_wrapperI1VEEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Orthonormalize a set of vectors. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>basis</strong> – <strong>[inout]</strong> The set of vectors to orthonormalise. The vectors must have identical parallel layouts. The vectors are modified in-place. </p>
</dd>
<dt class="field-even">Template Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>V</strong> – <a class="reference internal" href="#d2/d0b/classdolfinx_1_1la_1_1Vector"><span class="std std-ref">dolfinx::la::Vector</span></a></p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN7dolfinx2la14is_orthonormalEbNSt6vectorINSt17reference_wrapperIK1VEEEE">
<span id="_CPPv3I0EN7dolfinx2la14is_orthonormalENSt6vectorINSt17reference_wrapperIK1VEEEE"></span><span id="_CPPv2I0EN7dolfinx2la14is_orthonormalENSt6vectorINSt17reference_wrapperIK1VEEEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">V</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d6/dfa/namespacedolfinx_1_1la_1aa2996b780cf113b78f8ff09249453f1f"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">is_orthonormal</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">reference_wrapper</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la14is_orthonormalEbNSt6vectorINSt17reference_wrapperIK1VEEEE" title="dolfinx::la::is_orthonormal::V"><span class="n"><span class="pre">V</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">basis</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN7dolfinx2la14is_orthonormalEbNSt6vectorINSt17reference_wrapperIK1VEEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Test if basis is orthonormal. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>basis</strong> – <strong>[in]</strong> The set of vectors to check. </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True is basis is orthonormal, otherwise false. </p>
</dd>
</dl>
</dd></dl>

</div>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4I0000EN7dolfinx2la9MatrixCSRE">
<span id="_CPPv3I0000EN7dolfinx2la9MatrixCSRE"></span><span id="_CPPv2I0000EN7dolfinx2la9MatrixCSRE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Scalar</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Container</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000EN7dolfinx2la9MatrixCSRE" title="dolfinx::la::MatrixCSR::Scalar"><span class="n"><span class="pre">Scalar</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ColContainer</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">RowPtrContainer</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">MatrixCSR</span></span></span><a class="headerlink" href="#_CPPv4I0000EN7dolfinx2la9MatrixCSRE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;MatrixCSR.h&gt;</em></div>
<p>Distributed sparse matrix. </p>
<p>The matrix storage format is compressed sparse row. The matrix is partitioned row-wise across MPI ranks.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Experimental storage of a matrix in CSR format which can be assembled into using the usual DOLFINx assembly routines. Matrix internal data can be accessed for interfacing with other code.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Scalar</strong> – Scalar type of matrix entries </p></li>
<li><p><strong>Container</strong> – Sequence container type to store matrix entries </p></li>
<li><p><strong>ColContainer</strong> – Column index container type </p></li>
<li><p><strong>RowPtrContainer</strong> – Row pointer container type </p></li>
</ul>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-types">Public Types</p>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9MatrixCSR10value_typeE">
<span id="_CPPv3N7dolfinx2la9MatrixCSR10value_typeE"></span><span id="_CPPv2N7dolfinx2la9MatrixCSR10value_typeE"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1aae74c256d8fa59319145b92fa944bad9"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_type</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN7dolfinx2la9MatrixCSRE" title="dolfinx::la::MatrixCSR::Scalar"><span class="n"><span class="pre">Scalar</span></span></a><a class="headerlink" href="#_CPPv4N7dolfinx2la9MatrixCSR10value_typeE" title="Link to this definition"></a><br /></dt>
<dd><p>Scalar type. </p>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9MatrixCSR14container_typeE">
<span id="_CPPv3N7dolfinx2la9MatrixCSR14container_typeE"></span><span id="_CPPv2N7dolfinx2la9MatrixCSR14container_typeE"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a9c2014b8eab41918aa55438cb370dd55"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">container_type</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN7dolfinx2la9MatrixCSRE" title="dolfinx::la::MatrixCSR::Container"><span class="n"><span class="pre">Container</span></span></a><a class="headerlink" href="#_CPPv4N7dolfinx2la9MatrixCSR14container_typeE" title="Link to this definition"></a><br /></dt>
<dd><p>Matrix entries container type. </p>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9MatrixCSR21column_container_typeE">
<span id="_CPPv3N7dolfinx2la9MatrixCSR21column_container_typeE"></span><span id="_CPPv2N7dolfinx2la9MatrixCSR21column_container_typeE"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a57a12155c51f09fb23dc396ed08ecf08"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">column_container_type</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN7dolfinx2la9MatrixCSRE" title="dolfinx::la::MatrixCSR::ColContainer"><span class="n"><span class="pre">ColContainer</span></span></a><a class="headerlink" href="#_CPPv4N7dolfinx2la9MatrixCSR21column_container_typeE" title="Link to this definition"></a><br /></dt>
<dd><p>Column index container type. </p>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9MatrixCSR21rowptr_container_typeE">
<span id="_CPPv3N7dolfinx2la9MatrixCSR21rowptr_container_typeE"></span><span id="_CPPv2N7dolfinx2la9MatrixCSR21rowptr_container_typeE"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a199aedf0b3d25f4550fdf6e3cdf9baa0"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rowptr_container_type</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN7dolfinx2la9MatrixCSRE" title="dolfinx::la::MatrixCSR::RowPtrContainer"><span class="n"><span class="pre">RowPtrContainer</span></span></a><a class="headerlink" href="#_CPPv4N7dolfinx2la9MatrixCSR21rowptr_container_typeE" title="Link to this definition"></a><br /></dt>
<dd><p>Row pointer container type. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_i_iEN7dolfinx2la9MatrixCSR14mat_set_valuesEDav">
<span id="_CPPv3I_i_iEN7dolfinx2la9MatrixCSR14mat_set_valuesEv"></span><span id="_CPPv2I_i_iEN7dolfinx2la9MatrixCSR14mat_set_valuesEv"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BS0</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BS1</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1af82b24e20208984766017747768330d1"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mat_set_values</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_i_iEN7dolfinx2la9MatrixCSR14mat_set_valuesEDav" title="Link to this definition"></a><br /></dt>
<dd><p>Insertion functor for setting values in a matrix. It is typically used in finite element assembly functions. </p>
<p>Create a function to set values in a <a class="reference internal" href="#dc/dfa/classdolfinx_1_1la_1_1MatrixCSR"><span class="std std-ref">MatrixCSR</span></a>. The function signature is <code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">mat_set_fn(std::span&lt;const</span> <span class="pre">std::int32_t</span> <span class="pre">rows,</span> <span class="pre">std::span&lt;const</span> <span class="pre">std::int32_t</span> <span class="pre">cols,</span> <span class="pre">std::span&lt;const</span> <span class="pre">value_type&gt;</span> <span class="pre">data)</span></code>. The rows and columns use process local indexing, and the given rows and columns must pre-exist in the sparsity pattern of the matrix. Insertion into “ghost” rows (in the ghost region of the row <code class="docutils literal notranslate"><span class="pre">IndexMap</span></code>) is permitted, so long as there are correct entries in the sparsity pattern.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using rows or columns which are not in the sparsity will result in undefined behaviour (or an assert failure in Debug mode).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Matrix block size may be (1, 1) or (BS0, BS1) </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Data block size may be (1, 1) or (BS0, BS1)</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>BS0</strong> – Row block size of data for insertion </p></li>
<li><p><strong>BS1</strong> – Column block size of data for insertion</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Function for inserting values into <code class="docutils literal notranslate"><span class="pre">A</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_i_iEN7dolfinx2la9MatrixCSR14mat_add_valuesEDav">
<span id="_CPPv3I_i_iEN7dolfinx2la9MatrixCSR14mat_add_valuesEv"></span><span id="_CPPv2I_i_iEN7dolfinx2la9MatrixCSR14mat_add_valuesEv"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BS0</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BS1</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a29f31ac7eced3e98248e4537b570f1c1"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mat_add_values</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_i_iEN7dolfinx2la9MatrixCSR14mat_add_valuesEDav" title="Link to this definition"></a><br /></dt>
<dd><p>Insertion functor for adding values to a matrix. It is typically used in finite element assembly functions. </p>
<p>Create a function to add values to a <a class="reference internal" href="#dc/dfa/classdolfinx_1_1la_1_1MatrixCSR"><span class="std std-ref">MatrixCSR</span></a>. The function signature is <code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">mat_add_fn(std::span&lt;const</span> <span class="pre">std::int32_t</span> <span class="pre">rows,</span> <span class="pre">std::span&lt;const</span> <span class="pre">std::int32_t</span> <span class="pre">cols,</span> <span class="pre">std::span&lt;const</span> <span class="pre">value_type&gt;</span> <span class="pre">data)</span></code>. The rows and columns use process local indexing, and the given rows and columns must pre-exist in the sparsity pattern of the matrix. Insertion into “ghost” rows (in the ghost region of the row <code class="docutils literal notranslate"><span class="pre">IndexMap</span></code>) is permitted, so long as there are correct entries in the sparsity pattern.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using rows or columns which are not in the sparsity will result in undefined behaviour (or an assert failure in Debug mode).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Matrix block size may be (1, 1) or (BS0, BS1) </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Data block size may be (1, 1) or (BS0, BS1)</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>BS0</strong> – Row block size of data for insertion </p></li>
<li><p><strong>BS1</strong> – Column block size of data for insertion</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Function for inserting values into <code class="docutils literal notranslate"><span class="pre">A</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9MatrixCSR9MatrixCSRERK15SparsityPattern9BlockMode">
<span id="_CPPv3N7dolfinx2la9MatrixCSR9MatrixCSRERK15SparsityPattern9BlockMode"></span><span id="_CPPv2N7dolfinx2la9MatrixCSR9MatrixCSRERK15SparsityPattern9BlockMode"></span><span id="dolfinx::la::MatrixCSR::MatrixCSR__SparsityPatternCR.BlockMode"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a4fab1e7a87e50293d7a36cd75e1db2d8"></span><span class="sig-name descname"><span class="n"><span class="pre">MatrixCSR</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la15SparsityPatternE" title="dolfinx::la::SparsityPattern"><span class="n"><span class="pre">SparsityPattern</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">p</span></span>, <a class="reference internal" href="#_CPPv4N7dolfinx2la9BlockModeE" title="dolfinx::la::BlockMode"><span class="n"><span class="pre">BlockMode</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">mode</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la9BlockModeE" title="dolfinx::la::BlockMode"><span class="n"><span class="pre">BlockMode</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N7dolfinx2la9BlockMode7compactE" title="dolfinx::la::BlockMode::compact"><span class="n"><span class="pre">compact</span></span></a><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la9MatrixCSR9MatrixCSRERK15SparsityPattern9BlockMode" title="Link to this definition"></a><br /></dt>
<dd><p>Create a distributed matrix. </p>
<p>The structure of the matrix depends entirely on the input <code class="docutils literal notranslate"><a class="reference internal" href="#d5/df9/classdolfinx_1_1la_1_1SparsityPattern"><span class="std std-ref"><span class="pre">SparsityPattern</span></span></a></code>, which must be finalized. The matrix storage is distributed Compressed Sparse Row: the matrix is distributed by row across processes, and on each process, there is a list of column indices and matrix entries for each row stored. This exactly matches the layout of the <code class="docutils literal notranslate"><a class="reference internal" href="#d5/df9/classdolfinx_1_1la_1_1SparsityPattern"><span class="std std-ref"><span class="pre">SparsityPattern</span></span></a></code>. There is some overlap of matrix rows between processes to allow for independent Finite Element assembly, after which, the ghost rows should be sent to the row owning processes by calling <code class="docutils literal notranslate"><a class="reference internal" href="#dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a76f9d7c359047ead5a1de4746a930910"><span class="std std-ref"><span class="pre">scatter_rev()</span></span></a></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The block size of the matrix is given by the block size of the input <code class="docutils literal notranslate"><a class="reference internal" href="#d5/df9/classdolfinx_1_1la_1_1SparsityPattern"><span class="std std-ref"><span class="pre">SparsityPattern</span></span></a></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> – <strong>[in]</strong> The sparsity pattern which describes the parallel distribution and the non-zero structure. </p></li>
<li><p><strong>mode</strong> – <strong>[in]</strong> Block mode. When the block size is greater than one, the storage can be “compact” where each matrix entry refers to a block of data (stored row major), or “expanded” where each matrix entry is individual. In the “expanded” case, the sparsity is expanded for every entry in the block, and the block size of the matrix is set to (1, 1). </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9MatrixCSR9MatrixCSRERR9MatrixCSR">
<span id="_CPPv3N7dolfinx2la9MatrixCSR9MatrixCSRERR9MatrixCSR"></span><span id="_CPPv2N7dolfinx2la9MatrixCSR9MatrixCSRERR9MatrixCSR"></span><span id="dolfinx::la::MatrixCSR::MatrixCSR__MatrixCSRRR"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a614e45af83ed3e32c3f357e85464670c"></span><span class="sig-name descname"><span class="n"><span class="pre">MatrixCSR</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR9MatrixCSRERR9MatrixCSR" title="dolfinx::la::MatrixCSR::MatrixCSR"><span class="n"><span class="pre">MatrixCSR</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">A</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la9MatrixCSR9MatrixCSRERR9MatrixCSR" title="Link to this definition"></a><br /></dt>
<dd><p>Move constructor. </p>
<p><dl>
<dt class="sig sig-object cpp">
<em><span class="pre">Todo:</span></em></dt>
<dd><p>Check handling of MPI_Request </p>
</dd></dl>

</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9MatrixCSR3setE10value_type">
<span id="_CPPv3N7dolfinx2la9MatrixCSR3setE10value_type"></span><span id="_CPPv2N7dolfinx2la9MatrixCSR3setE10value_type"></span><span id="dolfinx::la::MatrixCSR::set__value_type"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1abdea5bd806d475ad3ca0636c6919aba2"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR10value_typeE" title="dolfinx::la::MatrixCSR::value_type"><span class="n"><span class="pre">value_type</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la9MatrixCSR3setE10value_type" title="Link to this definition"></a><br /></dt>
<dd><p>Set all non-zero local entries to a value including entries in ghost rows. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – <strong>[in]</strong> The value to set non-zero matrix entries to </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_i_iEN7dolfinx2la9MatrixCSR3setEvNSt4spanIK10value_typeEENSt4spanIKNSt7int32_tEEENSt4spanIKNSt7int32_tEEE">
<span id="_CPPv3I_i_iEN7dolfinx2la9MatrixCSR3setENSt4spanIK10value_typeEENSt4spanIKNSt7int32_tEEENSt4spanIKNSt7int32_tEEE"></span><span id="_CPPv2I_i_iEN7dolfinx2la9MatrixCSR3setENSt4spanIK10value_typeEENSt4spanIKNSt7int32_tEEENSt4spanIKNSt7int32_tEEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BS0</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BS1</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a0e569a33c5838c5fb4bedc14ed195300"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR10value_typeE" title="dolfinx::la::MatrixCSR::value_type"><span class="n"><span class="pre">value_type</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rows</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">cols</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_i_iEN7dolfinx2la9MatrixCSR3setEvNSt4spanIK10value_typeEENSt4spanIKNSt7int32_tEEENSt4spanIKNSt7int32_tEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Set values in the matrix. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only entries included in the sparsity pattern used to initialize the matrix can be set. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All indices are local to the calling MPI rank and entries cannot be set in ghost rows. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This should be called after <code class="docutils literal notranslate"><span class="pre">scatter_rev</span></code>. Using before <code class="docutils literal notranslate"><span class="pre">scatter_rev</span></code> will set the values correctly, but incoming values may get added to them during a subsequent reverse scatter operation. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>BS0</strong> – Data row block size </p></li>
<li><p><strong>BS1</strong> – Data column block size </p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>x</strong> – <strong>[in]</strong> The <code class="docutils literal notranslate"><span class="pre">m</span></code> by <code class="docutils literal notranslate"><span class="pre">n</span></code> dense block of values (row-major) to set in the matrix </p></li>
<li><p><strong>rows</strong> – <strong>[in]</strong> The row indices of <code class="docutils literal notranslate"><span class="pre">x</span></code></p></li>
<li><p><strong>cols</strong> – <strong>[in]</strong> The column indices of <code class="docutils literal notranslate"><span class="pre">x</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_i_iEN7dolfinx2la9MatrixCSR3addEvNSt4spanIK10value_typeEENSt4spanIKNSt7int32_tEEENSt4spanIKNSt7int32_tEEE">
<span id="_CPPv3I_i_iEN7dolfinx2la9MatrixCSR3addENSt4spanIK10value_typeEENSt4spanIKNSt7int32_tEEENSt4spanIKNSt7int32_tEEE"></span><span id="_CPPv2I_i_iEN7dolfinx2la9MatrixCSR3addENSt4spanIK10value_typeEENSt4spanIKNSt7int32_tEEENSt4spanIKNSt7int32_tEEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BS0</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BS1</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a3a86261e0064d3ed9ff6b96de35d3d90"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">add</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR10value_typeE" title="dolfinx::la::MatrixCSR::value_type"><span class="n"><span class="pre">value_type</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rows</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">cols</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_i_iEN7dolfinx2la9MatrixCSR3addEvNSt4spanIK10value_typeEENSt4spanIKNSt7int32_tEEENSt4spanIKNSt7int32_tEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Accumulate values in the matrix. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only entries included in the sparsity pattern used to initialize the matrix can be accumulated into. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All indices are local to the calling MPI rank and entries may go into ghost rows. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">scatter_rev</span></code> after all entries have been added to send ghost rows to owners. Adding more entries after <code class="docutils literal notranslate"><span class="pre">scatter_rev</span></code> is allowed, but another call to <code class="docutils literal notranslate"><span class="pre">scatter_rev</span></code> will then be required.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>BS0</strong> – Row block size of data </p></li>
<li><p><strong>BS1</strong> – Column block size of data </p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>x</strong> – <strong>[in]</strong> The <code class="docutils literal notranslate"><span class="pre">m</span></code> by <code class="docutils literal notranslate"><span class="pre">n</span></code> dense block of values (row-major) to add to the matrix </p></li>
<li><p><strong>rows</strong> – <strong>[in]</strong> The row indices of <code class="docutils literal notranslate"><span class="pre">x</span></code></p></li>
<li><p><strong>cols</strong> – <strong>[in]</strong> The column indices of <code class="docutils literal notranslate"><span class="pre">x</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la9MatrixCSR14num_owned_rowsEv">
<span id="_CPPv3NK7dolfinx2la9MatrixCSR14num_owned_rowsEv"></span><span id="_CPPv2NK7dolfinx2la9MatrixCSR14num_owned_rowsEv"></span><span id="dolfinx::la::MatrixCSR::num_owned_rowsC"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a44eabebe62656b3b8d9252477e5f61a0"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">num_owned_rows</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la9MatrixCSR14num_owned_rowsEv" title="Link to this definition"></a><br /></dt>
<dd><p>Number of local rows excluding ghost rows. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la9MatrixCSR12num_all_rowsEv">
<span id="_CPPv3NK7dolfinx2la9MatrixCSR12num_all_rowsEv"></span><span id="_CPPv2NK7dolfinx2la9MatrixCSR12num_all_rowsEv"></span><span id="dolfinx::la::MatrixCSR::num_all_rowsC"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1acf00f9c00e0b1fb45f838cccacead71a"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">num_all_rows</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la9MatrixCSR12num_all_rowsEv" title="Link to this definition"></a><br /></dt>
<dd><p>Number of local rows including ghost rows. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la9MatrixCSR8to_denseEv">
<span id="_CPPv3NK7dolfinx2la9MatrixCSR8to_denseEv"></span><span id="_CPPv2NK7dolfinx2la9MatrixCSR8to_denseEv"></span><span id="dolfinx::la::MatrixCSR::to_denseC"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a3957be66d50f9a07b0c75016759e181c"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR10value_typeE" title="dolfinx::la::MatrixCSR::value_type"><span class="n"><span class="pre">value_type</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">to_dense</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la9MatrixCSR8to_denseEv" title="Link to this definition"></a><br /></dt>
<dd><p>Copy to a dense matrix. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is typically used for debugging and not used in production </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Ghost rows are also returned, and these can be truncated manually by using <a class="reference internal" href="#dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a44eabebe62656b3b8d9252477e5f61a0"><span class="std std-ref">num_owned_rows()</span></a> if required. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the block size is greater than 1, the entries are expanded. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dense copy of the part of the matrix on the calling rank. Storage is row-major. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9MatrixCSR11scatter_revEv">
<span id="_CPPv3N7dolfinx2la9MatrixCSR11scatter_revEv"></span><span id="_CPPv2N7dolfinx2la9MatrixCSR11scatter_revEv"></span><span id="dolfinx::la::MatrixCSR::scatter_rev"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a76f9d7c359047ead5a1de4746a930910"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">scatter_rev</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la9MatrixCSR11scatter_revEv" title="Link to this definition"></a><br /></dt>
<dd><p>Transfer ghost row data to the owning ranks accumulating received values on the owned rows, and zeroing any existing data in ghost rows. This process is analogous to <code class="docutils literal notranslate"><span class="pre">scatter_rev</span></code> for <code class="docutils literal notranslate"><a class="reference internal" href="#d2/d0b/classdolfinx_1_1la_1_1Vector"><span class="std std-ref"><span class="pre">Vector</span></span></a></code> except that the values are always accumulated on the owning process. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9MatrixCSR17scatter_rev_beginEv">
<span id="_CPPv3N7dolfinx2la9MatrixCSR17scatter_rev_beginEv"></span><span id="_CPPv2N7dolfinx2la9MatrixCSR17scatter_rev_beginEv"></span><span id="dolfinx::la::MatrixCSR::scatter_rev_begin"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1ab032c989bf69e8d9a0f54c2bbdcf28ad"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">scatter_rev_begin</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la9MatrixCSR17scatter_rev_beginEv" title="Link to this definition"></a><br /></dt>
<dd><p>Begin transfer of ghost row data to owning ranks, where it will be accumulated into existing owned rows. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Calls to this function must be followed by <a class="reference internal" href="#dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a1ef6afb8da364f4f5990e31811348d13"><span class="std std-ref">MatrixCSR::scatter_rev_end()</span></a>. Between the two calls matrix values must not be changed. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function does not change the matrix data. Data update only occurs with <code class="docutils literal notranslate"><a class="reference internal" href="#dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a1ef6afb8da364f4f5990e31811348d13"><span class="std std-ref"><span class="pre">scatter_rev_end()</span></span></a></code>. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9MatrixCSR15scatter_rev_endEv">
<span id="_CPPv3N7dolfinx2la9MatrixCSR15scatter_rev_endEv"></span><span id="_CPPv2N7dolfinx2la9MatrixCSR15scatter_rev_endEv"></span><span id="dolfinx::la::MatrixCSR::scatter_rev_end"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a1ef6afb8da364f4f5990e31811348d13"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">scatter_rev_end</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la9MatrixCSR15scatter_rev_endEv" title="Link to this definition"></a><br /></dt>
<dd><p>End transfer of ghost row data to owning ranks. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Must be preceded by <a class="reference internal" href="#dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1ab032c989bf69e8d9a0f54c2bbdcf28ad"><span class="std std-ref">MatrixCSR::scatter_rev_begin()</span></a>. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Matrix data received from other processes will be accumulated into locally owned rows, and ghost rows will be zeroed. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la9MatrixCSR12squared_normEv">
<span id="_CPPv3NK7dolfinx2la9MatrixCSR12squared_normEv"></span><span id="_CPPv2NK7dolfinx2la9MatrixCSR12squared_normEv"></span><span id="dolfinx::la::MatrixCSR::squared_normC"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a76099c1549db9c057693a2f2fe90b620"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">squared_norm</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la9MatrixCSR12squared_normEv" title="Link to this definition"></a><br /></dt>
<dd><p>Compute the Frobenius norm squared across all processes. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>MPI Collective </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la9MatrixCSR9index_mapEi">
<span id="_CPPv3NK7dolfinx2la9MatrixCSR9index_mapEi"></span><span id="_CPPv2NK7dolfinx2la9MatrixCSR9index_mapEi"></span><span id="dolfinx::la::MatrixCSR::index_map__iC"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a0d7c9f032463aab0dc49ef3a3082ddbb"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6commonE" title="dolfinx::common"><span class="n"><span class="pre">common</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6common8IndexMapE" title="dolfinx::common::IndexMap"><span class="n"><span class="pre">IndexMap</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index_map</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dim</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la9MatrixCSR9index_mapEi" title="Link to this definition"></a><br /></dt>
<dd><p>Index maps for the row and column space. </p>
<p>The row IndexMap contains ghost entries for rows which may be inserted into and the column IndexMap contains all local and ghost columns that may exist in the owned rows.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Row (0) or column (1) index maps </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9MatrixCSR6valuesEv">
<span id="_CPPv3N7dolfinx2la9MatrixCSR6valuesEv"></span><span id="_CPPv2N7dolfinx2la9MatrixCSR6valuesEv"></span><span id="dolfinx::la::MatrixCSR::values"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a29b38057b0491969b2e775885cb33c69"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR14container_typeE" title="dolfinx::la::MatrixCSR::container_type"><span class="n"><span class="pre">container_type</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">values</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la9MatrixCSR6valuesEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get local data values. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Includes ghost values </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la9MatrixCSR6valuesEv">
<span id="_CPPv3NK7dolfinx2la9MatrixCSR6valuesEv"></span><span id="_CPPv2NK7dolfinx2la9MatrixCSR6valuesEv"></span><span id="dolfinx::la::MatrixCSR::valuesC"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a03c056df0ddfeee3a2cdc95b0d732329"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR14container_typeE" title="dolfinx::la::MatrixCSR::container_type"><span class="n"><span class="pre">container_type</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">values</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la9MatrixCSR6valuesEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get local values (const version) </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Includes ghost values </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la9MatrixCSR7row_ptrEv">
<span id="_CPPv3NK7dolfinx2la9MatrixCSR7row_ptrEv"></span><span id="_CPPv2NK7dolfinx2la9MatrixCSR7row_ptrEv"></span><span id="dolfinx::la::MatrixCSR::row_ptrC"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1ad0f87c20451b1fe7ec61010d6ae1bddf"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR21rowptr_container_typeE" title="dolfinx::la::MatrixCSR::rowptr_container_type"><span class="n"><span class="pre">rowptr_container_type</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">row_ptr</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la9MatrixCSR7row_ptrEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get local row pointers. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Includes pointers to ghost rows </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la9MatrixCSR4colsEv">
<span id="_CPPv3NK7dolfinx2la9MatrixCSR4colsEv"></span><span id="_CPPv2NK7dolfinx2la9MatrixCSR4colsEv"></span><span id="dolfinx::la::MatrixCSR::colsC"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1abbf3c9be3c7dd289c3e674ac445d9f4e"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR21column_container_typeE" title="dolfinx::la::MatrixCSR::column_container_type"><span class="n"><span class="pre">column_container_type</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">cols</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la9MatrixCSR4colsEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get local column indices. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Includes columns in ghost rows </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la9MatrixCSR15off_diag_offsetEv">
<span id="_CPPv3NK7dolfinx2la9MatrixCSR15off_diag_offsetEv"></span><span id="_CPPv2NK7dolfinx2la9MatrixCSR15off_diag_offsetEv"></span><span id="dolfinx::la::MatrixCSR::off_diag_offsetC"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a0e4fa2488d7568e011bd4e738861d0ab"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR21rowptr_container_typeE" title="dolfinx::la::MatrixCSR::rowptr_container_type"><span class="n"><span class="pre">rowptr_container_type</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">off_diag_offset</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la9MatrixCSR15off_diag_offsetEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get the start of off-diagonal (unowned columns) on each row, allowing the matrix to be split (virtually) into two parts. Operations (such as matrix-vector multiply) between the owned parts of the matrix and vector can then be performed separately from operations on the unowned parts. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Includes ghost rows, which should be truncated manually if not required. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la9MatrixCSR10block_sizeEv">
<span id="_CPPv3NK7dolfinx2la9MatrixCSR10block_sizeEv"></span><span id="_CPPv2NK7dolfinx2la9MatrixCSR10block_sizeEv"></span><span id="dolfinx::la::MatrixCSR::block_sizeC"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1acd5885105f8558be3508757c934eb606"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">block_size</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la9MatrixCSR10block_sizeEv" title="Link to this definition"></a><br /></dt>
<dd><p>Block size. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>block sizes for rows and columns </p>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la16SLEPcEigenSolverE">
<span id="_CPPv3N7dolfinx2la16SLEPcEigenSolverE"></span><span id="_CPPv2N7dolfinx2la16SLEPcEigenSolverE"></span><span id="dolfinx::la::SLEPcEigenSolver"></span><span class="target" id="d0/d6d/classdolfinx_1_1la_1_1SLEPcEigenSolver"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SLEPcEigenSolver</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la16SLEPcEigenSolverE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;slepc.h&gt;</em></div>
<p>This class provides an eigenvalue solver for PETSc matrices. It is a wrapper for the SLEPc eigenvalue solver. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la16SLEPcEigenSolver16SLEPcEigenSolverE8MPI_Comm">
<span id="_CPPv3N7dolfinx2la16SLEPcEigenSolver16SLEPcEigenSolverE8MPI_Comm"></span><span id="_CPPv2N7dolfinx2la16SLEPcEigenSolver16SLEPcEigenSolverE8MPI_Comm"></span><span id="dolfinx::la::SLEPcEigenSolver::SLEPcEigenSolver__MPI_Comm"></span><span class="target" id="d0/d6d/classdolfinx_1_1la_1_1SLEPcEigenSolver_1afb130e5af3867131b58a4bb0f74cbbdd"></span><span class="k"><span class="pre">explicit</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SLEPcEigenSolver</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPI_Comm</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">comm</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la16SLEPcEigenSolver16SLEPcEigenSolverE8MPI_Comm" title="Link to this definition"></a><br /></dt>
<dd><p>Create eigenvalue solver. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la16SLEPcEigenSolver16SLEPcEigenSolverE3EPSb">
<span id="_CPPv3N7dolfinx2la16SLEPcEigenSolver16SLEPcEigenSolverE3EPSb"></span><span id="_CPPv2N7dolfinx2la16SLEPcEigenSolver16SLEPcEigenSolverE3EPSb"></span><span id="dolfinx::la::SLEPcEigenSolver::SLEPcEigenSolver__EPS.b"></span><span class="target" id="d0/d6d/classdolfinx_1_1la_1_1SLEPcEigenSolver_1ac5eb848d590f628def3a462cc534d9c2"></span><span class="sig-name descname"><span class="n"><span class="pre">SLEPcEigenSolver</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">EPS</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">eps</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">inc_ref_count</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la16SLEPcEigenSolver16SLEPcEigenSolverE3EPSb" title="Link to this definition"></a><br /></dt>
<dd><p>Create eigenvalue solver from EPS object. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la16SLEPcEigenSolver16SLEPcEigenSolverERR16SLEPcEigenSolver">
<span id="_CPPv3N7dolfinx2la16SLEPcEigenSolver16SLEPcEigenSolverERR16SLEPcEigenSolver"></span><span id="_CPPv2N7dolfinx2la16SLEPcEigenSolver16SLEPcEigenSolverERR16SLEPcEigenSolver"></span><span id="dolfinx::la::SLEPcEigenSolver::SLEPcEigenSolver__SLEPcEigenSolverRR"></span><span class="target" id="d0/d6d/classdolfinx_1_1la_1_1SLEPcEigenSolver_1a49ed9e82a9cc3f0e44e1ebb2095d76ce"></span><span class="sig-name descname"><span class="n"><span class="pre">SLEPcEigenSolver</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx2la16SLEPcEigenSolver16SLEPcEigenSolverERR16SLEPcEigenSolver" title="dolfinx::la::SLEPcEigenSolver::SLEPcEigenSolver"><span class="n"><span class="pre">SLEPcEigenSolver</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">solver</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la16SLEPcEigenSolver16SLEPcEigenSolverERR16SLEPcEigenSolver" title="Link to this definition"></a><br /></dt>
<dd><p>Move constructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la16SLEPcEigenSolverD0Ev">
<span id="_CPPv3N7dolfinx2la16SLEPcEigenSolverD0Ev"></span><span id="_CPPv2N7dolfinx2la16SLEPcEigenSolverD0Ev"></span><span id="dolfinx::la::SLEPcEigenSolver::~SLEPcEigenSolver"></span><span class="target" id="d0/d6d/classdolfinx_1_1la_1_1SLEPcEigenSolver_1a90fc74c3f94706365140360fc2d33ca1"></span><span class="sig-name descname"><span class="n"><span class="pre">~SLEPcEigenSolver</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la16SLEPcEigenSolverD0Ev" title="Link to this definition"></a><br /></dt>
<dd><p>Destructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la16SLEPcEigenSolveraSERR16SLEPcEigenSolver">
<span id="_CPPv3N7dolfinx2la16SLEPcEigenSolveraSERR16SLEPcEigenSolver"></span><span id="_CPPv2N7dolfinx2la16SLEPcEigenSolveraSERR16SLEPcEigenSolver"></span><span id="dolfinx::la::SLEPcEigenSolver::assign-operator__SLEPcEigenSolverRR"></span><span class="target" id="d0/d6d/classdolfinx_1_1la_1_1SLEPcEigenSolver_1acfb4a59e1cc3d71534c9fb9096e89ac1"></span><a class="reference internal" href="#_CPPv4N7dolfinx2la16SLEPcEigenSolverE" title="dolfinx::la::SLEPcEigenSolver"><span class="n"><span class="pre">SLEPcEigenSolver</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx2la16SLEPcEigenSolverE" title="dolfinx::la::SLEPcEigenSolver"><span class="n"><span class="pre">SLEPcEigenSolver</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">solver</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la16SLEPcEigenSolveraSERR16SLEPcEigenSolver" title="Link to this definition"></a><br /></dt>
<dd><p>Move assignment. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la16SLEPcEigenSolver13set_operatorsEK3MatK3Mat">
<span id="_CPPv3N7dolfinx2la16SLEPcEigenSolver13set_operatorsEK3MatK3Mat"></span><span id="_CPPv2N7dolfinx2la16SLEPcEigenSolver13set_operatorsEK3MatK3Mat"></span><span id="dolfinx::la::SLEPcEigenSolver::set_operators__MatC.MatC"></span><span class="target" id="d0/d6d/classdolfinx_1_1la_1_1SLEPcEigenSolver_1adbc93de27baa9e70cb23b7a8d93a8909"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_operators</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Mat</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">A</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Mat</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">B</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la16SLEPcEigenSolver13set_operatorsEK3MatK3Mat" title="Link to this definition"></a><br /></dt>
<dd><p>Set operators (B may be nullptr for regular eigenvalues problems) </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la16SLEPcEigenSolver5solveEv">
<span id="_CPPv3N7dolfinx2la16SLEPcEigenSolver5solveEv"></span><span id="_CPPv2N7dolfinx2la16SLEPcEigenSolver5solveEv"></span><span id="dolfinx::la::SLEPcEigenSolver::solve"></span><span class="target" id="d0/d6d/classdolfinx_1_1la_1_1SLEPcEigenSolver_1af7d39f0eac0af0ed5785935ac72a1e7d"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">solve</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la16SLEPcEigenSolver5solveEv" title="Link to this definition"></a><br /></dt>
<dd><p>Compute all eigenpairs of the matrix A (solve <span class="math notranslate nohighlight">\(A x = \lambda x\)</span>) </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la16SLEPcEigenSolver5solveENSt7int64_tE">
<span id="_CPPv3N7dolfinx2la16SLEPcEigenSolver5solveENSt7int64_tE"></span><span id="_CPPv2N7dolfinx2la16SLEPcEigenSolver5solveENSt7int64_tE"></span><span id="dolfinx::la::SLEPcEigenSolver::solve__std::int64_t"></span><span class="target" id="d0/d6d/classdolfinx_1_1la_1_1SLEPcEigenSolver_1ae745cea5c0339920b3ea8f657f80e3da"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">solve</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la16SLEPcEigenSolver5solveENSt7int64_tE" title="Link to this definition"></a><br /></dt>
<dd><p>Compute the n first eigenpairs of the matrix A (solve <span class="math notranslate nohighlight">\(A x = \lambda x\)</span>) </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la16SLEPcEigenSolver14get_eigenvalueEi">
<span id="_CPPv3NK7dolfinx2la16SLEPcEigenSolver14get_eigenvalueEi"></span><span id="_CPPv2NK7dolfinx2la16SLEPcEigenSolver14get_eigenvalueEi"></span><span id="dolfinx::la::SLEPcEigenSolver::get_eigenvalue__iC"></span><span class="target" id="d0/d6d/classdolfinx_1_1la_1_1SLEPcEigenSolver_1a91c4e47381a2d4136fa544b6305b30ab"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">complex</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">PetscReal</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_eigenvalue</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la16SLEPcEigenSolver14get_eigenvalueEi" title="Link to this definition"></a><br /></dt>
<dd><p>Get ith eigenvalue. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la16SLEPcEigenSolver13get_eigenpairER11PetscScalarR11PetscScalar3Vec3Veci">
<span id="_CPPv3NK7dolfinx2la16SLEPcEigenSolver13get_eigenpairER11PetscScalarR11PetscScalar3Vec3Veci"></span><span id="_CPPv2NK7dolfinx2la16SLEPcEigenSolver13get_eigenpairER11PetscScalarR11PetscScalar3Vec3Veci"></span><span id="dolfinx::la::SLEPcEigenSolver::get_eigenpair__PetscScalarR.PetscScalarR.Vec.Vec.iC"></span><span class="target" id="d0/d6d/classdolfinx_1_1la_1_1SLEPcEigenSolver_1aff53d3094945b3a22a24e00bccbcb7c4"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_eigenpair</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">PetscScalar</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">lr</span></span>, <span class="n"><span class="pre">PetscScalar</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">lc</span></span>, <span class="n"><span class="pre">Vec</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">r</span></span>, <span class="n"><span class="pre">Vec</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">c</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la16SLEPcEigenSolver13get_eigenpairER11PetscScalarR11PetscScalar3Vec3Veci" title="Link to this definition"></a><br /></dt>
<dd><p>Get ith eigenpair. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la16SLEPcEigenSolver20get_iteration_numberEv">
<span id="_CPPv3NK7dolfinx2la16SLEPcEigenSolver20get_iteration_numberEv"></span><span id="_CPPv2NK7dolfinx2la16SLEPcEigenSolver20get_iteration_numberEv"></span><span id="dolfinx::la::SLEPcEigenSolver::get_iteration_numberC"></span><span class="target" id="d0/d6d/classdolfinx_1_1la_1_1SLEPcEigenSolver_1a16d167cff424d76e9fbdb41b07191c9c"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_iteration_number</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la16SLEPcEigenSolver20get_iteration_numberEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get the number of iterations used by the solver. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la16SLEPcEigenSolver20get_number_convergedEv">
<span id="_CPPv3NK7dolfinx2la16SLEPcEigenSolver20get_number_convergedEv"></span><span id="_CPPv2NK7dolfinx2la16SLEPcEigenSolver20get_number_convergedEv"></span><span id="dolfinx::la::SLEPcEigenSolver::get_number_convergedC"></span><span class="target" id="d0/d6d/classdolfinx_1_1la_1_1SLEPcEigenSolver_1a473b90775aa6b3138d37e5c01015cea2"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_number_converged</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la16SLEPcEigenSolver20get_number_convergedEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get the number of converged eigenvalues. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la16SLEPcEigenSolver18set_options_prefixENSt6stringE">
<span id="_CPPv3N7dolfinx2la16SLEPcEigenSolver18set_options_prefixENSt6stringE"></span><span id="_CPPv2N7dolfinx2la16SLEPcEigenSolver18set_options_prefixENSt6stringE"></span><span id="dolfinx::la::SLEPcEigenSolver::set_options_prefix__ss"></span><span class="target" id="d0/d6d/classdolfinx_1_1la_1_1SLEPcEigenSolver_1aec9b253b2e0af7ee55fa5ec5034f7759"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_options_prefix</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">options_prefix</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la16SLEPcEigenSolver18set_options_prefixENSt6stringE" title="Link to this definition"></a><br /></dt>
<dd><p>Sets the prefix used by PETSc when searching the PETSc options database. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la16SLEPcEigenSolver18get_options_prefixEv">
<span id="_CPPv3NK7dolfinx2la16SLEPcEigenSolver18get_options_prefixEv"></span><span id="_CPPv2NK7dolfinx2la16SLEPcEigenSolver18get_options_prefixEv"></span><span id="dolfinx::la::SLEPcEigenSolver::get_options_prefixC"></span><span class="target" id="d0/d6d/classdolfinx_1_1la_1_1SLEPcEigenSolver_1a70a5d4d223656a9031c311d8c0c09bfe"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_options_prefix</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la16SLEPcEigenSolver18get_options_prefixEv" title="Link to this definition"></a><br /></dt>
<dd><p>Returns the prefix used by PETSc when searching the PETSc options database. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la16SLEPcEigenSolver16set_from_optionsEv">
<span id="_CPPv3NK7dolfinx2la16SLEPcEigenSolver16set_from_optionsEv"></span><span id="_CPPv2NK7dolfinx2la16SLEPcEigenSolver16set_from_optionsEv"></span><span id="dolfinx::la::SLEPcEigenSolver::set_from_optionsC"></span><span class="target" id="d0/d6d/classdolfinx_1_1la_1_1SLEPcEigenSolver_1ac6eb7de73f9e7ad287ad5a5480cd2aa5"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_from_options</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la16SLEPcEigenSolver16set_from_optionsEv" title="Link to this definition"></a><br /></dt>
<dd><p>Set options from PETSc options database. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la16SLEPcEigenSolver3epsEv">
<span id="_CPPv3NK7dolfinx2la16SLEPcEigenSolver3epsEv"></span><span id="_CPPv2NK7dolfinx2la16SLEPcEigenSolver3epsEv"></span><span id="dolfinx::la::SLEPcEigenSolver::epsC"></span><span class="target" id="d0/d6d/classdolfinx_1_1la_1_1SLEPcEigenSolver_1afe9072abbf9df91c5e7661f4db56548b"></span><span class="n"><span class="pre">EPS</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">eps</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la16SLEPcEigenSolver3epsEv" title="Link to this definition"></a><br /></dt>
<dd><p>Return SLEPc EPS pointer. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la16SLEPcEigenSolver4commEv">
<span id="_CPPv3NK7dolfinx2la16SLEPcEigenSolver4commEv"></span><span id="_CPPv2NK7dolfinx2la16SLEPcEigenSolver4commEv"></span><span id="dolfinx::la::SLEPcEigenSolver::commC"></span><span class="target" id="d0/d6d/classdolfinx_1_1la_1_1SLEPcEigenSolver_1ad3217ebf3e21d7902bf89ab1248dabb9"></span><span class="n"><span class="pre">MPI_Comm</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">comm</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la16SLEPcEigenSolver4commEv" title="Link to this definition"></a><br /></dt>
<dd><p>Return MPI communicator. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la15SparsityPatternE">
<span id="_CPPv3N7dolfinx2la15SparsityPatternE"></span><span id="_CPPv2N7dolfinx2la15SparsityPatternE"></span><span id="dolfinx::la::SparsityPattern"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SparsityPattern</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la15SparsityPatternE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;SparsityPattern.h&gt;</em></div>
<p>Sparsity pattern data structure that can be used to initialize sparse matrices. After assembly, column indices are always sorted in increasing order. Ghost entries are kept after assembly. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la15SparsityPattern15SparsityPatternE8MPI_CommRKNSt5arrayINSt10shared_ptrIKN6common8IndexMapEEEXL2EEEERKNSt5arrayIiXL2EEEE">
<span id="_CPPv3N7dolfinx2la15SparsityPattern15SparsityPatternE8MPI_CommRKNSt5arrayINSt10shared_ptrIKN6common8IndexMapEEEXL2EEEERKNSt5arrayIiXL2EEEE"></span><span id="_CPPv2N7dolfinx2la15SparsityPattern15SparsityPatternE8MPI_CommRKNSt5arrayINSt10shared_ptrIKN6common8IndexMapEEEX2EEERKNSt5arrayIiX2EEE"></span><span id="dolfinx::la::SparsityPattern::SparsityPattern__MPI_Comm.std::array:std::shared_ptr:common::IndexMapC:.2:CR.std::array:i.2:CR"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1acfadf9fc444fc1f0d7ebe4e80b5e5eae"></span><span class="sig-name descname"><span class="n"><span class="pre">SparsityPattern</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPI_Comm</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">comm</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6commonE" title="dolfinx::common"><span class="n"><span class="pre">common</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6common8IndexMapE" title="dolfinx::common::IndexMap"><span class="n"><span class="pre">IndexMap</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">maps</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">bs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la15SparsityPattern15SparsityPatternE8MPI_CommRKNSt5arrayINSt10shared_ptrIKN6common8IndexMapEEEXL2EEEERKNSt5arrayIiXL2EEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Create an empty sparsity pattern with specified dimensions. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>comm</strong> – <strong>[in]</strong> Communicator that the pattern is defined on. </p></li>
<li><p><strong>maps</strong> – <strong>[in]</strong> Index maps describing the [0] row and [1] column index ranges (up to a block size). </p></li>
<li><p><strong>bs</strong> – <strong>[in]</strong> Block sizes for the [0] row and [1] column maps. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la15SparsityPattern15SparsityPatternE8MPI_CommRKNSt6vectorINSt6vectorIPK15SparsityPatternEEEERKNSt5arrayINSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEEXL2EEEERKNSt5arrayINSt6vectorIiEEXL2EEEE">
<span id="_CPPv3N7dolfinx2la15SparsityPattern15SparsityPatternE8MPI_CommRKNSt6vectorINSt6vectorIPK15SparsityPatternEEEERKNSt5arrayINSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEEXL2EEEERKNSt5arrayINSt6vectorIiEEXL2EEEE"></span><span id="_CPPv2N7dolfinx2la15SparsityPattern15SparsityPatternE8MPI_CommRKNSt6vectorINSt6vectorIPK15SparsityPatternEEEERKNSt5arrayINSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEEX2EEERKNSt5arrayINSt6vectorIiEEX2EEE"></span><span id="dolfinx::la::SparsityPattern::SparsityPattern__MPI_Comm.std::vector:std::vector:SparsityPatternCP::CR.std::array:std::vector:std::pair:std::reference_wrapper:common::IndexMapC:.i::.2:CR.std::array:std::vector:i:.2:CR"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a27ee9d8b12fe8591db6a166f10b06379"></span><span class="sig-name descname"><span class="n"><span class="pre">SparsityPattern</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPI_Comm</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">comm</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la15SparsityPattern15SparsityPatternE8MPI_CommRKNSt6vectorINSt6vectorIPK15SparsityPatternEEEERKNSt5arrayINSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEEXL2EEEERKNSt5arrayINSt6vectorIiEEXL2EEEE" title="dolfinx::la::SparsityPattern::SparsityPattern"><span class="n"><span class="pre">SparsityPattern</span></span></a><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">patterns</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">reference_wrapper</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6commonE" title="dolfinx::common"><span class="n"><span class="pre">common</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6common8IndexMapE" title="dolfinx::common::IndexMap"><span class="n"><span class="pre">IndexMap</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">maps</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">bs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la15SparsityPattern15SparsityPatternE8MPI_CommRKNSt6vectorINSt6vectorIPK15SparsityPatternEEEERKNSt5arrayINSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEEXL2EEEERKNSt5arrayINSt6vectorIiEEXL2EEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Create a new sparsity pattern by concatenating sub-patterns, e.g. pattern =[ pattern00 ][ pattern 01] [ pattern10 ][ pattern 11]. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>comm</strong> – <strong>[in]</strong> Communicator that the pattern is defined on. </p></li>
<li><p><strong>patterns</strong> – <strong>[in]</strong> Rectangular array of sparsity pattern. The patterns must not be finalised. Null block are permitted/ </p></li>
<li><p><strong>maps</strong> – <strong>[in]</strong> Pairs of (index map, block size) for each row block (maps[0]) and column blocks (maps[1])/ </p></li>
<li><p><strong>bs</strong> – <strong>[in]</strong> Block sizes for the sparsity pattern entries/ </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la15SparsityPattern15SparsityPatternERR15SparsityPattern">
<span id="_CPPv3N7dolfinx2la15SparsityPattern15SparsityPatternERR15SparsityPattern"></span><span id="_CPPv2N7dolfinx2la15SparsityPattern15SparsityPatternERR15SparsityPattern"></span><span id="dolfinx::la::SparsityPattern::SparsityPattern__SparsityPatternRR"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a02febb2f44c9c8f556a274fe39bb6975"></span><span class="sig-name descname"><span class="n"><span class="pre">SparsityPattern</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx2la15SparsityPattern15SparsityPatternERR15SparsityPattern" title="dolfinx::la::SparsityPattern::SparsityPattern"><span class="n"><span class="pre">SparsityPattern</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">pattern</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la15SparsityPattern15SparsityPatternERR15SparsityPattern" title="Link to this definition"></a><br /></dt>
<dd><p>Move constructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la15SparsityPatternD0Ev">
<span id="_CPPv3N7dolfinx2la15SparsityPatternD0Ev"></span><span id="_CPPv2N7dolfinx2la15SparsityPatternD0Ev"></span><span id="dolfinx::la::SparsityPattern::~SparsityPattern"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1adbd3a02ebc1814404361a1d6221658f1"></span><span class="sig-name descname"><span class="n"><span class="pre">~SparsityPattern</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la15SparsityPatternD0Ev" title="Link to this definition"></a><br /></dt>
<dd><p>Destructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la15SparsityPatternaSERR15SparsityPattern">
<span id="_CPPv3N7dolfinx2la15SparsityPatternaSERR15SparsityPattern"></span><span id="_CPPv2N7dolfinx2la15SparsityPatternaSERR15SparsityPattern"></span><span id="dolfinx::la::SparsityPattern::assign-operator__SparsityPatternRR"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1ad568d43e73eec2449ba9c3c8f54d68c4"></span><a class="reference internal" href="#_CPPv4N7dolfinx2la15SparsityPatternE" title="dolfinx::la::SparsityPattern"><span class="n"><span class="pre">SparsityPattern</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx2la15SparsityPatternE" title="dolfinx::la::SparsityPattern"><span class="n"><span class="pre">SparsityPattern</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">pattern</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la15SparsityPatternaSERR15SparsityPattern" title="Link to this definition"></a><br /></dt>
<dd><p>Move assignment. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la15SparsityPattern6insertERKNSt4spanIKNSt7int32_tEEERKNSt4spanIKNSt7int32_tEEE">
<span id="_CPPv3N7dolfinx2la15SparsityPattern6insertERKNSt4spanIKNSt7int32_tEEERKNSt4spanIKNSt7int32_tEEE"></span><span id="_CPPv2N7dolfinx2la15SparsityPattern6insertERKNSt4spanIKNSt7int32_tEEERKNSt4spanIKNSt7int32_tEEE"></span><span id="dolfinx::la::SparsityPattern::insert__std::span:std::int32_tC:CR.std::span:std::int32_tC:CR"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a7dd4e010202bd7228e5ec396bd7b3d81"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">insert</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">rows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">cols</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la15SparsityPattern6insertERKNSt4spanIKNSt7int32_tEEERKNSt4spanIKNSt7int32_tEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Insert non-zero locations using local (process-wise) indices. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la15SparsityPattern15insert_diagonalENSt4spanIKNSt7int32_tEEE">
<span id="_CPPv3N7dolfinx2la15SparsityPattern15insert_diagonalENSt4spanIKNSt7int32_tEEE"></span><span id="_CPPv2N7dolfinx2la15SparsityPattern15insert_diagonalENSt4spanIKNSt7int32_tEEE"></span><span id="dolfinx::la::SparsityPattern::insert_diagonal__std::span:std::int32_tC:"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a7125025cbd32fbce039d801b65dfffb2"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">insert_diagonal</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rows</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la15SparsityPattern15insert_diagonalENSt4spanIKNSt7int32_tEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Insert non-zero locations on the diagonal. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rows</strong> – <strong>[in]</strong> Rows in local (process-wise) indices. The indices must exist in the row IndexMap. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la15SparsityPattern8finalizeEv">
<span id="_CPPv3N7dolfinx2la15SparsityPattern8finalizeEv"></span><span id="_CPPv2N7dolfinx2la15SparsityPattern8finalizeEv"></span><span id="dolfinx::la::SparsityPattern::finalize"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a32d626626eee0bc4ade146973f6abb1c"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">finalize</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la15SparsityPattern8finalizeEv" title="Link to this definition"></a><br /></dt>
<dd><p>Finalize sparsity pattern and communicate off-process entries. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la15SparsityPattern9index_mapEi">
<span id="_CPPv3NK7dolfinx2la15SparsityPattern9index_mapEi"></span><span id="_CPPv2NK7dolfinx2la15SparsityPattern9index_mapEi"></span><span id="dolfinx::la::SparsityPattern::index_map__iC"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a0d7c9f032463aab0dc49ef3a3082ddbb"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6commonE" title="dolfinx::common"><span class="n"><span class="pre">common</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6common8IndexMapE" title="dolfinx::common::IndexMap"><span class="n"><span class="pre">IndexMap</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index_map</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dim</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la15SparsityPattern9index_mapEi" title="Link to this definition"></a><br /></dt>
<dd><p>Index map for given dimension dimension. Returns the index map for rows and columns that will be set by the current MPI rank. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dim</strong> – <strong>[in]</strong> Requested map, row (0) or column (1). </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The index map. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la15SparsityPattern14column_indicesEv">
<span id="_CPPv3NK7dolfinx2la15SparsityPattern14column_indicesEv"></span><span id="_CPPv2NK7dolfinx2la15SparsityPattern14column_indicesEv"></span><span id="dolfinx::la::SparsityPattern::column_indicesC"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a8d696ffd12d94e9995a56fddf7030dfb"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">column_indices</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la15SparsityPattern14column_indicesEv" title="Link to this definition"></a><br /></dt>
<dd><p>Global indices of non-zero columns on owned rows. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The ghosts are computed only once <a class="reference internal" href="#d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a32d626626eee0bc4ade146973f6abb1c"><span class="std std-ref">SparsityPattern::finalize</span></a> has been called. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Global index non-zero columns on this process, including ghosts. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la15SparsityPattern16column_index_mapEv">
<span id="_CPPv3NK7dolfinx2la15SparsityPattern16column_index_mapEv"></span><span id="_CPPv2NK7dolfinx2la15SparsityPattern16column_index_mapEv"></span><span id="dolfinx::la::SparsityPattern::column_index_mapC"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a9671fd5e7395782a5a664fba1806c2a8"></span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6commonE" title="dolfinx::common"><span class="n"><span class="pre">common</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6common8IndexMapE" title="dolfinx::common::IndexMap"><span class="n"><span class="pre">IndexMap</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">column_index_map</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la15SparsityPattern16column_index_mapEv" title="Link to this definition"></a><br /></dt>
<dd><p>Builds the index map for columns after assembly of the sparsity pattern. </p>
<p><dl>
<dt class="sig sig-object cpp">
<em><span class="pre">Todo:</span></em></dt>
<dd><p>Should this be compted and stored when finalising the <a class="reference internal" href="#d5/df9/classdolfinx_1_1la_1_1SparsityPattern"><span class="std std-ref">SparsityPattern</span></a>? </p>
</dd></dl>

</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Map for all non-zero columns on this process, including ghosts </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la15SparsityPattern10block_sizeEi">
<span id="_CPPv3NK7dolfinx2la15SparsityPattern10block_sizeEi"></span><span id="_CPPv2NK7dolfinx2la15SparsityPattern10block_sizeEi"></span><span id="dolfinx::la::SparsityPattern::block_size__iC"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a397d727caaff61d6caafbe154cb5c461"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">block_size</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dim</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la15SparsityPattern10block_sizeEi" title="Link to this definition"></a><br /></dt>
<dd><p>Return index map block size for dimension dim. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la15SparsityPattern12num_nonzerosEv">
<span id="_CPPv3NK7dolfinx2la15SparsityPattern12num_nonzerosEv"></span><span id="_CPPv2NK7dolfinx2la15SparsityPattern12num_nonzerosEv"></span><span id="dolfinx::la::SparsityPattern::num_nonzerosC"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a7ad58551156ab501aa9bee7580dc2a93"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">num_nonzeros</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la15SparsityPattern12num_nonzerosEv" title="Link to this definition"></a><br /></dt>
<dd><p>Number of nonzeros on this rank after assembly, including ghost rows. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la15SparsityPattern8nnz_diagENSt7int32_tE">
<span id="_CPPv3NK7dolfinx2la15SparsityPattern8nnz_diagENSt7int32_tE"></span><span id="_CPPv2NK7dolfinx2la15SparsityPattern8nnz_diagENSt7int32_tE"></span><span id="dolfinx::la::SparsityPattern::nnz_diag__std::int32_tC"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a5c76a6f74ef0aec646374dd6716b58e0"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">nnz_diag</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">row</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la15SparsityPattern8nnz_diagENSt7int32_tE" title="Link to this definition"></a><br /></dt>
<dd><p>Number of non-zeros in owned columns (diagonal block) on a given row. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Can also be used on ghost rows </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la15SparsityPattern12nnz_off_diagENSt7int32_tE">
<span id="_CPPv3NK7dolfinx2la15SparsityPattern12nnz_off_diagENSt7int32_tE"></span><span id="_CPPv2NK7dolfinx2la15SparsityPattern12nnz_off_diagENSt7int32_tE"></span><span id="dolfinx::la::SparsityPattern::nnz_off_diag__std::int32_tC"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a26aa980b1174e63fc8eb625f647d312e"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">nnz_off_diag</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">row</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la15SparsityPattern12nnz_off_diagENSt7int32_tE" title="Link to this definition"></a><br /></dt>
<dd><p>Number of non-zeros in unowned columns (off-diagonal block) on a given row. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Can also be used on ghost rows </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la15SparsityPattern5graphEv">
<span id="_CPPv3NK7dolfinx2la15SparsityPattern5graphEv"></span><span id="_CPPv2NK7dolfinx2la15SparsityPattern5graphEv"></span><span id="dolfinx::la::SparsityPattern::graphC"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1af3d9e7570db304b1492da0672877e481"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">graph</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la15SparsityPattern5graphEv" title="Link to this definition"></a><br /></dt>
<dd><p>Sparsity pattern graph after assembly. Uses local indices for the columns. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Column global indices can be obtained from <a class="reference internal" href="#d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a9671fd5e7395782a5a664fba1806c2a8"><span class="std std-ref">SparsityPattern::column_index_map()</span></a></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Includes ghost rows </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Adjacency list edges and offsets </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la15SparsityPattern20off_diagonal_offsetsEv">
<span id="_CPPv3NK7dolfinx2la15SparsityPattern20off_diagonal_offsetsEv"></span><span id="_CPPv2NK7dolfinx2la15SparsityPattern20off_diagonal_offsetsEv"></span><span id="dolfinx::la::SparsityPattern::off_diagonal_offsetsC"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a88067c688a3d32686a667f9a55bc4f07"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">off_diagonal_offsets</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la15SparsityPattern20off_diagonal_offsetsEv" title="Link to this definition"></a><br /></dt>
<dd><p>Row-wise start of off-diagonals (unowned columns) for each row. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Includes ghost rows </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la15SparsityPattern4commEv">
<span id="_CPPv3NK7dolfinx2la15SparsityPattern4commEv"></span><span id="_CPPv2NK7dolfinx2la15SparsityPattern4commEv"></span><span id="dolfinx::la::SparsityPattern::commC"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1ad3217ebf3e21d7902bf89ab1248dabb9"></span><span class="n"><span class="pre">MPI_Comm</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">comm</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la15SparsityPattern4commEv" title="Link to this definition"></a><br /></dt>
<dd><p>Return MPI communicator. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4I00EN7dolfinx2la6VectorE">
<span id="_CPPv3I00EN7dolfinx2la6VectorE"></span><span id="_CPPv2I00EN7dolfinx2la6VectorE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Container</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00EN7dolfinx2la6VectorE" title="dolfinx::la::Vector::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Vector</span></span></span><a class="headerlink" href="#_CPPv4I00EN7dolfinx2la6VectorE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;Vector.h&gt;</em></div>
<p>Distributed vector. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> – Scalar type </p></li>
<li><p><strong>Container</strong> – data container type </p></li>
</ul>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-types">Public Types</p>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la6Vector10value_typeE">
<span id="_CPPv3N7dolfinx2la6Vector10value_typeE"></span><span id="_CPPv2N7dolfinx2la6Vector10value_typeE"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1afb9ded5f49336ae503bb9f2035ea902b"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_type</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN7dolfinx2la6VectorE" title="dolfinx::la::Vector::T"><span class="n"><span class="pre">T</span></span></a><a class="headerlink" href="#_CPPv4N7dolfinx2la6Vector10value_typeE" title="Link to this definition"></a><br /></dt>
<dd><p>Scalar type. </p>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la6Vector14container_typeE">
<span id="_CPPv3N7dolfinx2la6Vector14container_typeE"></span><span id="_CPPv2N7dolfinx2la6Vector14container_typeE"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1a9c2014b8eab41918aa55438cb370dd55"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">container_type</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00EN7dolfinx2la6VectorE" title="dolfinx::la::Vector::Container"><span class="n"><span class="pre">Container</span></span></a><a class="headerlink" href="#_CPPv4N7dolfinx2la6Vector14container_typeE" title="Link to this definition"></a><br /></dt>
<dd><p>Container type. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la6Vector6VectorENSt10shared_ptrIKN6common8IndexMapEEEi">
<span id="_CPPv3N7dolfinx2la6Vector6VectorENSt10shared_ptrIKN6common8IndexMapEEEi"></span><span id="_CPPv2N7dolfinx2la6Vector6VectorENSt10shared_ptrIKN6common8IndexMapEEEi"></span><span id="dolfinx::la::Vector::Vector__std::shared_ptr:common::IndexMapC:.i"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1a5e05669c7cdb76c40cf5260bee4682be"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Vector</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6commonE" title="dolfinx::common"><span class="n"><span class="pre">common</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6common8IndexMapE" title="dolfinx::common::IndexMap"><span class="n"><span class="pre">IndexMap</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">map</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">bs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la6Vector6VectorENSt10shared_ptrIKN6common8IndexMapEEEi" title="Link to this definition"></a><br /></dt>
<dd><p>Create a distributed vector. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>map</strong> – IndexMap for parallel distribution of the data </p></li>
<li><p><strong>bs</strong> – Block size </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la6Vector6VectorERK6Vector">
<span id="_CPPv3N7dolfinx2la6Vector6VectorERK6Vector"></span><span id="_CPPv2N7dolfinx2la6Vector6VectorERK6Vector"></span><span id="dolfinx::la::Vector::Vector__VectorCR"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1aa849a85205c9e5105f87c18cbd6bc3f9"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Vector</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la6Vector6VectorERK6Vector" title="dolfinx::la::Vector::Vector"><span class="n"><span class="pre">Vector</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la6Vector6VectorERK6Vector" title="Link to this definition"></a><br /></dt>
<dd><p>Copy constructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la6Vector6VectorERR6Vector">
<span id="_CPPv3N7dolfinx2la6Vector6VectorERR6Vector"></span><span id="_CPPv2N7dolfinx2la6Vector6VectorERR6Vector"></span><span id="dolfinx::la::Vector::Vector__VectorRR"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1aa6b2550e845ae56a0c83ac094c54144b"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Vector</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx2la6Vector6VectorERR6Vector" title="dolfinx::la::Vector::Vector"><span class="n"><span class="pre">Vector</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la6Vector6VectorERR6Vector" title="Link to this definition"></a><br /></dt>
<dd><p>Move constructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la6VectoraSERR6Vector">
<span id="_CPPv3N7dolfinx2la6VectoraSERR6Vector"></span><span id="_CPPv2N7dolfinx2la6VectoraSERR6Vector"></span><span id="dolfinx::la::Vector::assign-operator__VectorRR"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1a776a08fdde16fc24c1de53bbb115f71f"></span><a class="reference internal" href="#_CPPv4I00EN7dolfinx2la6VectorE" title="dolfinx::la::Vector"><span class="n"><span class="pre">Vector</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00EN7dolfinx2la6VectorE" title="dolfinx::la::Vector"><span class="n"><span class="pre">Vector</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la6VectoraSERR6Vector" title="Link to this definition"></a><br /></dt>
<dd><p>Move Assignment operator. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la6Vector3setE10value_type">
<span id="_CPPv3N7dolfinx2la6Vector3setE10value_type"></span><span id="_CPPv2N7dolfinx2la6Vector3setE10value_type"></span><span id="dolfinx::la::Vector::set__value_type"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1ab4a809e8bd73a28e6bbe63aec58cda6a"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx2la6Vector10value_typeE" title="dolfinx::la::Vector::value_type"><span class="n"><span class="pre">value_type</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">v</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la6Vector3setE10value_type" title="Link to this definition"></a><br /></dt>
<dd><p>Set all entries (including ghosts) </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>v</strong> – <strong>[in]</strong> The value to set all entries to (on calling rank) </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la6Vector17scatter_fwd_beginEv">
<span id="_CPPv3N7dolfinx2la6Vector17scatter_fwd_beginEv"></span><span id="_CPPv2N7dolfinx2la6Vector17scatter_fwd_beginEv"></span><span id="dolfinx::la::Vector::scatter_fwd_begin"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1a16d573100774ff839f919c0a29a7c1fa"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">scatter_fwd_begin</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la6Vector17scatter_fwd_beginEv" title="Link to this definition"></a><br /></dt>
<dd><p>Begin scatter of local data from owner to ghosts on other ranks. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Collective MPI operation </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la6Vector15scatter_fwd_endEv">
<span id="_CPPv3N7dolfinx2la6Vector15scatter_fwd_endEv"></span><span id="_CPPv2N7dolfinx2la6Vector15scatter_fwd_endEv"></span><span id="dolfinx::la::Vector::scatter_fwd_end"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1aa9f9bb4f5fb7a667ba50f2632c020bc1"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">scatter_fwd_end</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la6Vector15scatter_fwd_endEv" title="Link to this definition"></a><br /></dt>
<dd><p>End scatter of local data from owner to ghosts on other ranks. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Collective MPI operation </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la6Vector11scatter_fwdEv">
<span id="_CPPv3N7dolfinx2la6Vector11scatter_fwdEv"></span><span id="_CPPv2N7dolfinx2la6Vector11scatter_fwdEv"></span><span id="dolfinx::la::Vector::scatter_fwd"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1a7d56e0fb74dc4c10495f93ad8a99ee2e"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">scatter_fwd</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la6Vector11scatter_fwdEv" title="Link to this definition"></a><br /></dt>
<dd><p>Scatter local data to ghost positions on other ranks. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Collective MPI operation </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la6Vector17scatter_rev_beginEv">
<span id="_CPPv3N7dolfinx2la6Vector17scatter_rev_beginEv"></span><span id="_CPPv2N7dolfinx2la6Vector17scatter_rev_beginEv"></span><span id="dolfinx::la::Vector::scatter_rev_begin"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1ab032c989bf69e8d9a0f54c2bbdcf28ad"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">scatter_rev_begin</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la6Vector17scatter_rev_beginEv" title="Link to this definition"></a><br /></dt>
<dd><p>Start scatter of ghost data to owner. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Collective MPI operation </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN7dolfinx2la6Vector15scatter_rev_endEv15BinaryOperation">
<span id="_CPPv3I0EN7dolfinx2la6Vector15scatter_rev_endE15BinaryOperation"></span><span id="_CPPv2I0EN7dolfinx2la6Vector15scatter_rev_endE15BinaryOperation"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BinaryOperation</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1af1d8541ecfc1997af4fbe270b59661cc"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">scatter_rev_end</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la6Vector15scatter_rev_endEv15BinaryOperation" title="dolfinx::la::Vector::scatter_rev_end::BinaryOperation"><span class="n"><span class="pre">BinaryOperation</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">op</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN7dolfinx2la6Vector15scatter_rev_endEv15BinaryOperation" title="Link to this definition"></a><br /></dt>
<dd><p>End scatter of ghost data to owner. This process may receive data from more than one process, and the received data can be summed or inserted into the local portion of the vector. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Collective MPI operation </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>op</strong> – The operation to perform when adding/setting received values (add or insert) </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN7dolfinx2la6Vector11scatter_revEv15BinaryOperation">
<span id="_CPPv3I0EN7dolfinx2la6Vector11scatter_revE15BinaryOperation"></span><span id="_CPPv2I0EN7dolfinx2la6Vector11scatter_revE15BinaryOperation"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BinaryOperation</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1afa9fc63debe548397b954874dea9bd5c"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">scatter_rev</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la6Vector11scatter_revEv15BinaryOperation" title="dolfinx::la::Vector::scatter_rev::BinaryOperation"><span class="n"><span class="pre">BinaryOperation</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">op</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN7dolfinx2la6Vector11scatter_revEv15BinaryOperation" title="Link to this definition"></a><br /></dt>
<dd><p>Scatter ghost data to owner. This process may receive data from more than one process, and the received data can be summed or inserted into the local portion of the vector. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Collective MPI operation </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>op</strong> – IndexMap operation (add or insert) </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la6Vector9index_mapEv">
<span id="_CPPv3NK7dolfinx2la6Vector9index_mapEv"></span><span id="_CPPv2NK7dolfinx2la6Vector9index_mapEv"></span><span id="dolfinx::la::Vector::index_mapC"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1a8293d9aee560cf478b9c9e3def1d0255"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6commonE" title="dolfinx::common"><span class="n"><span class="pre">common</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6common8IndexMapE" title="dolfinx::common::IndexMap"><span class="n"><span class="pre">IndexMap</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index_map</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la6Vector9index_mapEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get IndexMap. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la6Vector2bsEv">
<span id="_CPPv3NK7dolfinx2la6Vector2bsEv"></span><span id="_CPPv2NK7dolfinx2la6Vector2bsEv"></span><span id="dolfinx::la::Vector::bsCCE"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1a48ddad8b3b7b898f02a7e99332a2ac4e"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">constexpr</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">bs</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la6Vector2bsEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get block size. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la6Vector5arrayEv">
<span id="_CPPv3NK7dolfinx2la6Vector5arrayEv"></span><span id="_CPPv2NK7dolfinx2la6Vector5arrayEv"></span><span id="dolfinx::la::Vector::arrayC"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1a822efff34efebfaf96d93542cf1ff8bc"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la6Vector10value_typeE" title="dolfinx::la::Vector::value_type"><span class="n"><span class="pre">value_type</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">array</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la6Vector5arrayEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get local part of the vector (const version) </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la6Vector13mutable_arrayEv">
<span id="_CPPv3N7dolfinx2la6Vector13mutable_arrayEv"></span><span id="_CPPv2N7dolfinx2la6Vector13mutable_arrayEv"></span><span id="dolfinx::la::Vector::mutable_array"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1af044ff63caafb35d6011c13d19e06071"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4N7dolfinx2la6Vector10value_typeE" title="dolfinx::la::Vector::value_type"><span class="n"><span class="pre">value_type</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mutable_array</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la6Vector13mutable_arrayEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get local part of the vector. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la4implE">
<span id="_CPPv3N7dolfinx2la4implE"></span><span id="_CPPv2N7dolfinx2la4implE"></span><span id="dolfinx::la::impl"></span><span class="target" id="d8/d02/namespacedolfinx_1_1la_1_1impl"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">impl</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la4implE" title="Link to this definition"></a><br /></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_i_i000000EN7dolfinx2la4impl10insert_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE">
<span id="_CPPv3I_i_i000000EN7dolfinx2la4impl10insert_csrERR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE"></span><span id="_CPPv2I_i_i000000EN7dolfinx2la4impl10insert_csrERR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BS0</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BS1</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OP</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">U</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">V</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">W</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">X</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Y</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d8/dc8/matrix__csr__impl_8h_1a31692db705b456c0480131d9045a2131"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">insert_csr</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl10insert_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_csr::U"><span class="n"><span class="pre">U</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl10insert_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_csr::V"><span class="n"><span class="pre">V</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">cols</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl10insert_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_csr::W"><span class="n"><span class="pre">W</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">row_ptr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl10insert_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_csr::X"><span class="n"><span class="pre">X</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl10insert_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_csr::Y"><span class="n"><span class="pre">Y</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">xrows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl10insert_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_csr::Y"><span class="n"><span class="pre">Y</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">xcols</span></span>, <a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl10insert_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_csr::OP"><span class="n"><span class="pre">OP</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">op</span></span>, <span class="k"><span class="pre">typename</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl10insert_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_csr::Y"><span class="n"><span class="pre">Y</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">value_type</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_rows</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl10insert_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="Link to this definition"></a><br /></dt>
<dd><p>Incorporate data into a CSR matrix. </p>
<p>
0 1 | 2 3 <em>4 5 | 6 7 </em></p>
<p>8 9 | 10 11 12 13 | 14 15 </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the case of block data, where BS0 or BS1 are greater than one, the layout of the input data is still the same. For example, the following can be inserted into the top-left corner with xrows={0,1} and xcols={0,1}, BS0=2, BS1=2 and x={0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15}.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>BS0</strong> – Row block size (of both matrix and data) </p></li>
<li><p><strong>BS1</strong> – Column block size (of both matrix and data) </p></li>
<li><p><strong>OP</strong> – The operation (usually “set” or “add”) </p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>data</strong> – <strong>[out]</strong> The CSR matrix data </p></li>
<li><p><strong>cols</strong> – <strong>[in]</strong> The CSR column indices </p></li>
<li><p><strong>row_ptr</strong> – <strong>[in]</strong> The pointer to the ith row in the CSR data </p></li>
<li><p><strong>x</strong> – <strong>[in]</strong> The <code class="docutils literal notranslate"><span class="pre">m</span></code> by <code class="docutils literal notranslate"><span class="pre">n</span></code> dense block of values (row-major) to add to the matrix </p></li>
<li><p><strong>xrows</strong> – <strong>[in]</strong> The row indices of <code class="docutils literal notranslate"><span class="pre">x</span></code></p></li>
<li><p><strong>xcols</strong> – <strong>[in]</strong> The column indices of <code class="docutils literal notranslate"><span class="pre">x</span></code></p></li>
<li><p><strong>op</strong> – <strong>[in]</strong> The operation (set or add) </p></li>
<li><p><strong>num_rows</strong> – <strong>[in]</strong> The maximum row index that can be set. Used when debugging to check that rows beyond a permitted range are not being set.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_i_i000000EN7dolfinx2la4impl18insert_blocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE">
<span id="_CPPv3I_i_i000000EN7dolfinx2la4impl18insert_blocked_csrERR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE"></span><span id="_CPPv2I_i_i000000EN7dolfinx2la4impl18insert_blocked_csrERR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BS0</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BS1</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OP</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">U</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">V</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">W</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">X</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Y</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d8/dc8/matrix__csr__impl_8h_1aa25ace929659f48c2174ceade56a4953"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">insert_blocked_csr</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl18insert_blocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_blocked_csr::U"><span class="n"><span class="pre">U</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl18insert_blocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_blocked_csr::V"><span class="n"><span class="pre">V</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">cols</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl18insert_blocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_blocked_csr::W"><span class="n"><span class="pre">W</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">row_ptr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl18insert_blocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_blocked_csr::X"><span class="n"><span class="pre">X</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl18insert_blocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_blocked_csr::Y"><span class="n"><span class="pre">Y</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">xrows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl18insert_blocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_blocked_csr::Y"><span class="n"><span class="pre">Y</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">xcols</span></span>, <a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl18insert_blocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_blocked_csr::OP"><span class="n"><span class="pre">OP</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">op</span></span>, <span class="k"><span class="pre">typename</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl18insert_blocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_blocked_csr::Y"><span class="n"><span class="pre">Y</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">value_type</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_rows</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl18insert_blocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="Link to this definition"></a><br /></dt>
<dd><p>Incorporate blocked data with given block sizes into a non-blocked <a class="reference internal" href="#dc/dfa/classdolfinx_1_1la_1_1MatrixCSR"><span class="std std-ref">MatrixCSR</span></a>. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Matrix block size (bs=1). Matrix sparsity must be correct to accept the data. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>see <code class="docutils literal notranslate"><span class="pre">insert_csr</span></code> for data layout</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>BS0</strong> – Row block size of Data </p></li>
<li><p><strong>BS1</strong> – Column block size of Data </p></li>
<li><p><strong>OP</strong> – The operation (usually “set” or “add”) </p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>data</strong> – <strong>[out]</strong> The CSR matrix data </p></li>
<li><p><strong>cols</strong> – <strong>[in]</strong> The CSR column indices </p></li>
<li><p><strong>row_ptr</strong> – <strong>[in]</strong> The pointer to the ith row in the CSR data </p></li>
<li><p><strong>x</strong> – <strong>[in]</strong> The <code class="docutils literal notranslate"><span class="pre">m</span></code> by <code class="docutils literal notranslate"><span class="pre">n</span></code> dense block of values (row-major) to add to the matrix </p></li>
<li><p><strong>xrows</strong> – <strong>[in]</strong> The row indices of <code class="docutils literal notranslate"><span class="pre">x</span></code></p></li>
<li><p><strong>xcols</strong> – <strong>[in]</strong> The column indices of <code class="docutils literal notranslate"><span class="pre">x</span></code></p></li>
<li><p><strong>op</strong> – <strong>[in]</strong> The operation (set or add) </p></li>
<li><p><strong>num_rows</strong> – <strong>[in]</strong> The maximum row index that can be set. Used when debugging to check that rows beyond a permitted range are not being set. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000000EN7dolfinx2la4impl21insert_nonblocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeEii">
<span id="_CPPv3I000000EN7dolfinx2la4impl21insert_nonblocked_csrERR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeEii"></span><span id="_CPPv2I000000EN7dolfinx2la4impl21insert_nonblocked_csrERR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeEii"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OP</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">U</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">V</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">W</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">X</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Y</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d8/dc8/matrix__csr__impl_8h_1acc4c75ca996b044001c8f7677aa9b931"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">insert_nonblocked_csr</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I000000EN7dolfinx2la4impl21insert_nonblocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeEii" title="dolfinx::la::impl::insert_nonblocked_csr::U"><span class="n"><span class="pre">U</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000000EN7dolfinx2la4impl21insert_nonblocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeEii" title="dolfinx::la::impl::insert_nonblocked_csr::V"><span class="n"><span class="pre">V</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">cols</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000000EN7dolfinx2la4impl21insert_nonblocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeEii" title="dolfinx::la::impl::insert_nonblocked_csr::W"><span class="n"><span class="pre">W</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">row_ptr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000000EN7dolfinx2la4impl21insert_nonblocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeEii" title="dolfinx::la::impl::insert_nonblocked_csr::X"><span class="n"><span class="pre">X</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000000EN7dolfinx2la4impl21insert_nonblocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeEii" title="dolfinx::la::impl::insert_nonblocked_csr::Y"><span class="n"><span class="pre">Y</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">xrows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000000EN7dolfinx2la4impl21insert_nonblocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeEii" title="dolfinx::la::impl::insert_nonblocked_csr::Y"><span class="n"><span class="pre">Y</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">xcols</span></span>, <a class="reference internal" href="#_CPPv4I000000EN7dolfinx2la4impl21insert_nonblocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeEii" title="dolfinx::la::impl::insert_nonblocked_csr::OP"><span class="n"><span class="pre">OP</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">op</span></span>, <span class="k"><span class="pre">typename</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000000EN7dolfinx2la4impl21insert_nonblocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeEii" title="dolfinx::la::impl::insert_nonblocked_csr::Y"><span class="n"><span class="pre">Y</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">value_type</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_rows</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">bs0</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">bs1</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000000EN7dolfinx2la4impl21insert_nonblocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeEii" title="Link to this definition"></a><br /></dt>
<dd><p>Incorporate non-blocked data into a blocked matrix (Data block size = 1) </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Matrix sparsity must be correct to accept the data </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>see <code class="docutils literal notranslate"><span class="pre">insert_csr</span></code> for data layout </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – <strong>[out]</strong> The CSR matrix data </p></li>
<li><p><strong>cols</strong> – <strong>[in]</strong> The CSR column indices </p></li>
<li><p><strong>row_ptr</strong> – <strong>[in]</strong> The pointer to the ith row in the CSR data </p></li>
<li><p><strong>x</strong> – <strong>[in]</strong> The <code class="docutils literal notranslate"><span class="pre">m</span></code> by <code class="docutils literal notranslate"><span class="pre">n</span></code> dense block of values (row-major) to add to the matrix </p></li>
<li><p><strong>xrows</strong> – <strong>[in]</strong> The row indices of <code class="docutils literal notranslate"><span class="pre">x</span></code></p></li>
<li><p><strong>xcols</strong> – <strong>[in]</strong> The column indices of <code class="docutils literal notranslate"><span class="pre">x</span></code></p></li>
<li><p><strong>op</strong> – <strong>[in]</strong> The operation (set or add) </p></li>
<li><p><strong>num_rows</strong> – <strong>[in]</strong> The maximum row index that can be set. Used when debugging to check that rows beyond a permitted range are not being set. </p></li>
<li><p><strong>bs0</strong> – <strong>[in]</strong> Row block size of Matrix </p></li>
<li><p><strong>bs1</strong> – <strong>[in]</strong> Column block size of Matrix </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petscE">
<span id="_CPPv3N7dolfinx2la5petscE"></span><span id="_CPPv2N7dolfinx2la5petscE"></span><span id="dolfinx::la::petsc"></span><span class="target" id="d6/d2f/namespacedolfinx_1_1la_1_1petsc"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">petsc</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petscE" title="Link to this definition"></a><br /></dt>
<dd><p>PETSc linear algebra functions. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc5errorEiNSt6stringENSt6stringE">
<span id="_CPPv3N7dolfinx2la5petsc5errorEiNSt6stringENSt6stringE"></span><span id="_CPPv2N7dolfinx2la5petsc5errorEiNSt6stringENSt6stringE"></span><span id="dolfinx::la::petsc::error__i.ss.ss"></span><span class="target" id="d6/d2f/namespacedolfinx_1_1la_1_1petsc_1a642187b63ddbe119f8a8cbebb7dbb670"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">error</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">error_code</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">filename</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">petsc_function</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc5errorEiNSt6stringENSt6stringE" title="Link to this definition"></a><br /></dt>
<dd><p>Print error message for PETSc calls that return an error. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc14create_vectorsE8MPI_CommRKNSt6vectorINSt4spanIK11PetscScalarEEEE">
<span id="_CPPv3N7dolfinx2la5petsc14create_vectorsE8MPI_CommRKNSt6vectorINSt4spanIK11PetscScalarEEEE"></span><span id="_CPPv2N7dolfinx2la5petsc14create_vectorsE8MPI_CommRKNSt6vectorINSt4spanIK11PetscScalarEEEE"></span><span id="dolfinx::la::petsc::create_vectors__MPI_Comm.std::vector:std::span:PetscScalarC::CR"></span><span class="target" id="d6/d2f/namespacedolfinx_1_1la_1_1petsc_1a735a0258684b974c1def705e30752998"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">Vec</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">create_vectors</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPI_Comm</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">comm</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">PetscScalar</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc14create_vectorsE8MPI_CommRKNSt6vectorINSt4spanIK11PetscScalarEEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Create PETsc vectors from the local data. The data is copied into the PETSc vectors and is not shared. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Caller is responsible for destroying the returned object </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>comm</strong> – <strong>[in]</strong> The MPI communicator </p></li>
<li><p><strong>x</strong> – <strong>[in]</strong> The vector data owned by the calling rank. All components must have the same length. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of PETSc vectors </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc13create_vectorERKN6common8IndexMapEi">
<span id="_CPPv3N7dolfinx2la5petsc13create_vectorERKN6common8IndexMapEi"></span><span id="_CPPv2N7dolfinx2la5petsc13create_vectorERKN6common8IndexMapEi"></span><span id="dolfinx::la::petsc::create_vector__common::IndexMapCR.i"></span><span class="target" id="d6/d2f/namespacedolfinx_1_1la_1_1petsc_1ad5155dda717442637f48a2c9b626cc89"></span><span class="n"><span class="pre">Vec</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">create_vector</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6commonE" title="dolfinx::common"><span class="n"><span class="pre">common</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6common8IndexMapE" title="dolfinx::common::IndexMap"><span class="n"><span class="pre">IndexMap</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">map</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">bs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc13create_vectorERKN6common8IndexMapEi" title="Link to this definition"></a><br /></dt>
<dd><p>Create a ghosted PETSc Vec. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Caller is responsible for destroying the returned object </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>map</strong> – <strong>[in]</strong> The index map describing the parallel layout (by block) </p></li>
<li><p><strong>bs</strong> – <strong>[in]</strong> The block size </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A PETSc Vec </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc13create_vectorE8MPI_CommNSt5arrayINSt7int64_tEXL2EEEENSt4spanIKNSt7int64_tEEEi">
<span id="_CPPv3N7dolfinx2la5petsc13create_vectorE8MPI_CommNSt5arrayINSt7int64_tEXL2EEEENSt4spanIKNSt7int64_tEEEi"></span><span id="_CPPv2N7dolfinx2la5petsc13create_vectorE8MPI_CommNSt5arrayINSt7int64_tEX2EEENSt4spanIKNSt7int64_tEEEi"></span><span id="dolfinx::la::petsc::create_vector__MPI_Comm.std::array:std::int64_t.2:.std::span:std::int64_tC:.i"></span><span class="target" id="d6/d2f/namespacedolfinx_1_1la_1_1petsc_1a393bc1c3e71359b4f6992752d89b3349"></span><span class="n"><span class="pre">Vec</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">create_vector</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPI_Comm</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">comm</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">range</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ghosts</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">bs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc13create_vectorE8MPI_CommNSt5arrayINSt7int64_tEXL2EEEENSt4spanIKNSt7int64_tEEEi" title="Link to this definition"></a><br /></dt>
<dd><p>Create a ghosted PETSc Vec from a local range and ghost indices. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Caller is responsible for freeing the returned object </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>comm</strong> – <strong>[in]</strong> The MPI communicator </p></li>
<li><p><strong>range</strong> – <strong>[in]</strong> The local ownership range (by blocks) </p></li>
<li><p><strong>ghosts</strong> – <strong>[in]</strong> Ghost blocks </p></li>
<li><p><strong>bs</strong> – <strong>[in]</strong> The block size. The total number of local entries is <code class="docutils literal notranslate"><span class="pre">bs</span> <span class="pre">*</span> <span class="pre">(range[1]</span> <span class="pre">-</span> <span class="pre">range[0])</span></code>. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A PETSc Vec </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc18create_vector_wrapERKN6common8IndexMapEiNSt4spanIK11PetscScalarEE">
<span id="_CPPv3N7dolfinx2la5petsc18create_vector_wrapERKN6common8IndexMapEiNSt4spanIK11PetscScalarEE"></span><span id="_CPPv2N7dolfinx2la5petsc18create_vector_wrapERKN6common8IndexMapEiNSt4spanIK11PetscScalarEE"></span><span id="dolfinx::la::petsc::create_vector_wrap__common::IndexMapCR.i.std::span:PetscScalarC:"></span><span class="target" id="d6/d2f/namespacedolfinx_1_1la_1_1petsc_1a226d98ade8c930503d8fa66f72443aed"></span><span class="n"><span class="pre">Vec</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">create_vector_wrap</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6commonE" title="dolfinx::common"><span class="n"><span class="pre">common</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6common8IndexMapE" title="dolfinx::common::IndexMap"><span class="n"><span class="pre">IndexMap</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">map</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">bs</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">PetscScalar</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc18create_vector_wrapERKN6common8IndexMapEiNSt4spanIK11PetscScalarEE" title="Link to this definition"></a><br /></dt>
<dd><p>Create a PETSc Vec that wraps the data in an array. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The array <code class="docutils literal notranslate"><span class="pre">x</span></code> must be kept alive to use the PETSc Vec object </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The caller should call VecDestroy to free the return PETSc vector </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>map</strong> – <strong>[in]</strong> The index map that describes the parallel layout of the distributed vector (by block) </p></li>
<li><p><strong>bs</strong> – <strong>[in]</strong> Block size </p></li>
<li><p><strong>x</strong> – <strong>[in]</strong> The local part of the vector, including ghost entries </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A PETSc Vec object that shares the data in <code class="docutils literal notranslate"><span class="pre">x</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN7dolfinx2la5petsc18create_vector_wrapE3VecRKN2la6VectorI1VEE">
<span id="_CPPv3I0EN7dolfinx2la5petsc18create_vector_wrapERKN2la6VectorI1VEE"></span><span id="_CPPv2I0EN7dolfinx2la5petsc18create_vector_wrapERKN2la6VectorI1VEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">V</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d6/d2f/namespacedolfinx_1_1la_1_1petsc_1abe2bda86854477514c3e87dedc41cda3"></span><span class="n"><span class="pre">Vec</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">create_vector_wrap</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2laE" title="dolfinx::la"><span class="n"><span class="pre">la</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4I00EN7dolfinx2la6VectorE" title="dolfinx::la::Vector"><span class="n"><span class="pre">Vector</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la5petsc18create_vector_wrapE3VecRKN2la6VectorI1VEE" title="dolfinx::la::petsc::create_vector_wrap::V"><span class="n"><span class="pre">V</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN7dolfinx2la5petsc18create_vector_wrapE3VecRKN2la6VectorI1VEE" title="Link to this definition"></a><br /></dt>
<dd><p>Create a PETSc Vec that wraps the data in an array. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – <strong>[in]</strong> The vector to be wrapped </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A PETSc Vec object that shares the data in <code class="docutils literal notranslate"><span class="pre">x</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc17create_index_setsERKNSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEE">
<span id="_CPPv3N7dolfinx2la5petsc17create_index_setsERKNSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEE"></span><span id="_CPPv2N7dolfinx2la5petsc17create_index_setsERKNSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEE"></span><span id="dolfinx::la::petsc::create_index_sets__std::vector:std::pair:std::reference_wrapper:common::IndexMapC:.i::CR"></span><span class="target" id="d6/d2f/namespacedolfinx_1_1la_1_1petsc_1a66effb99a9ee6d2b4671cabd951cdc31"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">IS</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">create_index_sets</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">reference_wrapper</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6commonE" title="dolfinx::common"><span class="n"><span class="pre">common</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6common8IndexMapE" title="dolfinx::common::IndexMap"><span class="n"><span class="pre">IndexMap</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">maps</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc17create_index_setsERKNSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEE" title="Link to this definition"></a><br /></dt>
<dd><p><dl>
<dt class="sig sig-object cpp">
<em><span class="pre">Todo:</span></em></dt>
<dd><p>This function could take just the local sizes</p>
</dd></dl>

</p>
<p>Compute PETSc IndexSets (IS) for a stack of index maps. E.g., if <code class="docutils literal notranslate"><span class="pre">map[0]</span> <span class="pre">=</span> <span class="pre">{0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">5,</span> <span class="pre">6}</span></code> and <code class="docutils literal notranslate"><span class="pre">map[1]</span> <span class="pre">=</span> <span class="pre">{0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">4}</span></code> (in local indices) then <code class="docutils literal notranslate"><span class="pre">IS[0]</span> <span class="pre">=</span> <span class="pre">{0,</span> <span class="pre">1,</span> <span class="pre">2,</span> <span class="pre">3,</span> <span class="pre">4,</span> <span class="pre">5,</span> <span class="pre">6}</span></code> and <code class="docutils literal notranslate"><span class="pre">IS[1]</span> <span class="pre">=</span> <span class="pre">{7,</span> <span class="pre">8,</span> <span class="pre">9,</span> <span class="pre">10}</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The caller is responsible for destruction of each IS.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>maps</strong> – <strong>[in]</strong> <a class="reference internal" href="#dd/d35/classdolfinx_1_1la_1_1petsc_1_1Vector"><span class="std std-ref">Vector</span></a> of IndexMaps and corresponding block sizes </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="#dd/d35/classdolfinx_1_1la_1_1petsc_1_1Vector"><span class="std std-ref">Vector</span></a> of PETSc Index Sets, created on<code class="docutils literal notranslate"><span class="pre">PETSC_COMM_SELF</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc17get_local_vectorsEK3VecRKNSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEE">
<span id="_CPPv3N7dolfinx2la5petsc17get_local_vectorsEK3VecRKNSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEE"></span><span id="_CPPv2N7dolfinx2la5petsc17get_local_vectorsEK3VecRKNSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEE"></span><span id="dolfinx::la::petsc::get_local_vectors__VecC.std::vector:std::pair:std::reference_wrapper:common::IndexMapC:.i::CR"></span><span class="target" id="d6/d2f/namespacedolfinx_1_1la_1_1petsc_1aaa4b6dab7570d995efa113f2e5ac7374"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">PetscScalar</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_local_vectors</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Vec</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">reference_wrapper</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6commonE" title="dolfinx::common"><span class="n"><span class="pre">common</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6common8IndexMapE" title="dolfinx::common::IndexMap"><span class="n"><span class="pre">IndexMap</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">maps</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc17get_local_vectorsEK3VecRKNSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Copy blocks from Vec into local vectors. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc21scatter_local_vectorsE3VecRKNSt6vectorINSt4spanIK11PetscScalarEEEERKNSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEE">
<span id="_CPPv3N7dolfinx2la5petsc21scatter_local_vectorsE3VecRKNSt6vectorINSt4spanIK11PetscScalarEEEERKNSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEE"></span><span id="_CPPv2N7dolfinx2la5petsc21scatter_local_vectorsE3VecRKNSt6vectorINSt4spanIK11PetscScalarEEEERKNSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEE"></span><span id="dolfinx::la::petsc::scatter_local_vectors__Vec.std::vector:std::span:PetscScalarC::CR.std::vector:std::pair:std::reference_wrapper:common::IndexMapC:.i::CR"></span><span class="target" id="d6/d2f/namespacedolfinx_1_1la_1_1petsc_1a3139cf036059d98f8728411772d47088"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">scatter_local_vectors</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Vec</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">PetscScalar</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x_b</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">reference_wrapper</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6commonE" title="dolfinx::common"><span class="n"><span class="pre">common</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6common8IndexMapE" title="dolfinx::common::IndexMap"><span class="n"><span class="pre">IndexMap</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">maps</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc21scatter_local_vectorsE3VecRKNSt6vectorINSt4spanIK11PetscScalarEEEERKNSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Scatter local vectors to Vec. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc13create_matrixE8MPI_CommRK15SparsityPatternNSt6stringE">
<span id="_CPPv3N7dolfinx2la5petsc13create_matrixE8MPI_CommRK15SparsityPatternNSt6stringE"></span><span id="_CPPv2N7dolfinx2la5petsc13create_matrixE8MPI_CommRK15SparsityPatternNSt6stringE"></span><span id="dolfinx::la::petsc::create_matrix__MPI_Comm.SparsityPatternCR.ss"></span><span class="target" id="d6/d2f/namespacedolfinx_1_1la_1_1petsc_1aa7d300118df035bab503cf5639822e16"></span><span class="n"><span class="pre">Mat</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">create_matrix</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPI_Comm</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">comm</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la15SparsityPatternE" title="dolfinx::la::SparsityPattern"><span class="n"><span class="pre">SparsityPattern</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sp</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">type</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">)</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc13create_matrixE8MPI_CommRK15SparsityPatternNSt6stringE" title="Link to this definition"></a><br /></dt>
<dd><p>Create a PETSc Mat. Caller is responsible for destroying the returned object. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc16create_nullspaceE8MPI_CommNSt4spanIK3VecEE">
<span id="_CPPv3N7dolfinx2la5petsc16create_nullspaceE8MPI_CommNSt4spanIK3VecEE"></span><span id="_CPPv2N7dolfinx2la5petsc16create_nullspaceE8MPI_CommNSt4spanIK3VecEE"></span><span id="dolfinx::la::petsc::create_nullspace__MPI_Comm.std::span:VecC:"></span><span class="target" id="d6/d2f/namespacedolfinx_1_1la_1_1petsc_1a259d40294789997e103ad16528284558"></span><span class="n"><span class="pre">MatNullSpace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">create_nullspace</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPI_Comm</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">comm</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Vec</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">basis</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc16create_nullspaceE8MPI_CommNSt4spanIK3VecEE" title="Link to this definition"></a><br /></dt>
<dd><p>Create PETSc MatNullSpace. Caller is responsible for destruction returned object. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>comm</strong> – <strong>[in]</strong> The MPI communicator </p></li>
<li><p><strong>basis</strong> – <strong>[in]</strong> The nullspace basis vectors </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A PETSc nullspace object </p>
</dd>
</dl>
</dd></dl>

</div>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc12KrylovSolverE">
<span id="_CPPv3N7dolfinx2la5petsc12KrylovSolverE"></span><span id="_CPPv2N7dolfinx2la5petsc12KrylovSolverE"></span><span id="dolfinx::la::petsc::KrylovSolver"></span><span class="target" id="d2/dde/classdolfinx_1_1la_1_1petsc_1_1KrylovSolver"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">KrylovSolver</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc12KrylovSolverE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;petsc.h&gt;</em></div>
<p>This class implements Krylov methods for linear systems of the form Ax = b. It is a wrapper for the Krylov solvers of PETSc. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc12KrylovSolver12KrylovSolverE8MPI_Comm">
<span id="_CPPv3N7dolfinx2la5petsc12KrylovSolver12KrylovSolverE8MPI_Comm"></span><span id="_CPPv2N7dolfinx2la5petsc12KrylovSolver12KrylovSolverE8MPI_Comm"></span><span id="dolfinx::la::petsc::KrylovSolver::KrylovSolver__MPI_Comm"></span><span class="target" id="d2/dde/classdolfinx_1_1la_1_1petsc_1_1KrylovSolver_1abf3581e19446b66c3ac0ad8218270ca4"></span><span class="k"><span class="pre">explicit</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">KrylovSolver</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPI_Comm</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">comm</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc12KrylovSolver12KrylovSolverE8MPI_Comm" title="Link to this definition"></a><br /></dt>
<dd><p>Create Krylov solver for a particular method and named preconditioner. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc12KrylovSolver12KrylovSolverE3KSPb">
<span id="_CPPv3N7dolfinx2la5petsc12KrylovSolver12KrylovSolverE3KSPb"></span><span id="_CPPv2N7dolfinx2la5petsc12KrylovSolver12KrylovSolverE3KSPb"></span><span id="dolfinx::la::petsc::KrylovSolver::KrylovSolver__KSP.b"></span><span class="target" id="d2/dde/classdolfinx_1_1la_1_1petsc_1_1KrylovSolver_1a81ea3356f5cb498329ebc63a2128507c"></span><span class="sig-name descname"><span class="n"><span class="pre">KrylovSolver</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">KSP</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">ksp</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">inc_ref_count</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc12KrylovSolver12KrylovSolverE3KSPb" title="Link to this definition"></a><br /></dt>
<dd><p>Create solver wrapper of a PETSc KSP object. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ksp</strong> – <strong>[in]</strong> The PETSc KSP object. It should already have been created </p></li>
<li><p><strong>inc_ref_count</strong> – <strong>[in]</strong> Increment the reference count on <code class="docutils literal notranslate"><span class="pre">ksp</span></code> if true </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc12KrylovSolver12KrylovSolverERR12KrylovSolver">
<span id="_CPPv3N7dolfinx2la5petsc12KrylovSolver12KrylovSolverERR12KrylovSolver"></span><span id="_CPPv2N7dolfinx2la5petsc12KrylovSolver12KrylovSolverERR12KrylovSolver"></span><span id="dolfinx::la::petsc::KrylovSolver::KrylovSolver__KrylovSolverRR"></span><span class="target" id="d2/dde/classdolfinx_1_1la_1_1petsc_1_1KrylovSolver_1a42862338613d723e9df5002ae3fa0c37"></span><span class="sig-name descname"><span class="n"><span class="pre">KrylovSolver</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc12KrylovSolver12KrylovSolverERR12KrylovSolver" title="dolfinx::la::petsc::KrylovSolver::KrylovSolver"><span class="n"><span class="pre">KrylovSolver</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">solver</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc12KrylovSolver12KrylovSolverERR12KrylovSolver" title="Link to this definition"></a><br /></dt>
<dd><p>Move constructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc12KrylovSolverD0Ev">
<span id="_CPPv3N7dolfinx2la5petsc12KrylovSolverD0Ev"></span><span id="_CPPv2N7dolfinx2la5petsc12KrylovSolverD0Ev"></span><span id="dolfinx::la::petsc::KrylovSolver::~KrylovSolver"></span><span class="target" id="d2/dde/classdolfinx_1_1la_1_1petsc_1_1KrylovSolver_1ae2c37c4f6c86510675d97e83b8f36b1d"></span><span class="sig-name descname"><span class="n"><span class="pre">~KrylovSolver</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc12KrylovSolverD0Ev" title="Link to this definition"></a><br /></dt>
<dd><p>Destructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc12KrylovSolveraSERR12KrylovSolver">
<span id="_CPPv3N7dolfinx2la5petsc12KrylovSolveraSERR12KrylovSolver"></span><span id="_CPPv2N7dolfinx2la5petsc12KrylovSolveraSERR12KrylovSolver"></span><span id="dolfinx::la::petsc::KrylovSolver::assign-operator__KrylovSolverRR"></span><span class="target" id="d2/dde/classdolfinx_1_1la_1_1petsc_1_1KrylovSolver_1a2d783723b48047fd6a2ba02626c0762e"></span><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc12KrylovSolverE" title="dolfinx::la::petsc::KrylovSolver"><span class="n"><span class="pre">KrylovSolver</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc12KrylovSolverE" title="dolfinx::la::petsc::KrylovSolver"><span class="n"><span class="pre">KrylovSolver</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">solver</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc12KrylovSolveraSERR12KrylovSolver" title="Link to this definition"></a><br /></dt>
<dd><p>Move assignment. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc12KrylovSolver12set_operatorEK3Mat">
<span id="_CPPv3N7dolfinx2la5petsc12KrylovSolver12set_operatorEK3Mat"></span><span id="_CPPv2N7dolfinx2la5petsc12KrylovSolver12set_operatorEK3Mat"></span><span id="dolfinx::la::petsc::KrylovSolver::set_operator__MatC"></span><span class="target" id="d2/dde/classdolfinx_1_1la_1_1petsc_1_1KrylovSolver_1a07964f96869ec33889b89515bf3054c6"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_operator</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Mat</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">A</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc12KrylovSolver12set_operatorEK3Mat" title="Link to this definition"></a><br /></dt>
<dd><p>Set operator (Mat) </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc12KrylovSolver13set_operatorsEK3MatK3Mat">
<span id="_CPPv3N7dolfinx2la5petsc12KrylovSolver13set_operatorsEK3MatK3Mat"></span><span id="_CPPv2N7dolfinx2la5petsc12KrylovSolver13set_operatorsEK3MatK3Mat"></span><span id="dolfinx::la::petsc::KrylovSolver::set_operators__MatC.MatC"></span><span class="target" id="d2/dde/classdolfinx_1_1la_1_1petsc_1_1KrylovSolver_1ab330b017601395a363c721134239bef9"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_operators</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Mat</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">A</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Mat</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">P</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc12KrylovSolver13set_operatorsEK3MatK3Mat" title="Link to this definition"></a><br /></dt>
<dd><p>Set operator and preconditioner matrix (Mat) </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la5petsc12KrylovSolver5solveE3VecK3Vecb">
<span id="_CPPv3NK7dolfinx2la5petsc12KrylovSolver5solveE3VecK3Vecb"></span><span id="_CPPv2NK7dolfinx2la5petsc12KrylovSolver5solveE3VecK3Vecb"></span><span id="dolfinx::la::petsc::KrylovSolver::solve__Vec.VecC.bC"></span><span class="target" id="d2/dde/classdolfinx_1_1la_1_1petsc_1_1KrylovSolver_1ae4f94990049f1c8621499f8b2a2088a9"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">solve</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Vec</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Vec</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">b</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">transpose</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la5petsc12KrylovSolver5solveE3VecK3Vecb" title="Link to this definition"></a><br /></dt>
<dd><p>Solve linear system Ax = b and return number of iterations (A^t x = b if transpose is true) </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc12KrylovSolver18set_options_prefixENSt6stringE">
<span id="_CPPv3N7dolfinx2la5petsc12KrylovSolver18set_options_prefixENSt6stringE"></span><span id="_CPPv2N7dolfinx2la5petsc12KrylovSolver18set_options_prefixENSt6stringE"></span><span id="dolfinx::la::petsc::KrylovSolver::set_options_prefix__ss"></span><span class="target" id="d2/dde/classdolfinx_1_1la_1_1petsc_1_1KrylovSolver_1aec9b253b2e0af7ee55fa5ec5034f7759"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_options_prefix</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">options_prefix</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc12KrylovSolver18set_options_prefixENSt6stringE" title="Link to this definition"></a><br /></dt>
<dd><p>Sets the prefix used by PETSc when searching the PETSc options database. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la5petsc12KrylovSolver18get_options_prefixEv">
<span id="_CPPv3NK7dolfinx2la5petsc12KrylovSolver18get_options_prefixEv"></span><span id="_CPPv2NK7dolfinx2la5petsc12KrylovSolver18get_options_prefixEv"></span><span id="dolfinx::la::petsc::KrylovSolver::get_options_prefixC"></span><span class="target" id="d2/dde/classdolfinx_1_1la_1_1petsc_1_1KrylovSolver_1a70a5d4d223656a9031c311d8c0c09bfe"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_options_prefix</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la5petsc12KrylovSolver18get_options_prefixEv" title="Link to this definition"></a><br /></dt>
<dd><p>Returns the prefix used by PETSc when searching the PETSc options database. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la5petsc12KrylovSolver16set_from_optionsEv">
<span id="_CPPv3NK7dolfinx2la5petsc12KrylovSolver16set_from_optionsEv"></span><span id="_CPPv2NK7dolfinx2la5petsc12KrylovSolver16set_from_optionsEv"></span><span id="dolfinx::la::petsc::KrylovSolver::set_from_optionsC"></span><span class="target" id="d2/dde/classdolfinx_1_1la_1_1petsc_1_1KrylovSolver_1ac6eb7de73f9e7ad287ad5a5480cd2aa5"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_from_options</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la5petsc12KrylovSolver16set_from_optionsEv" title="Link to this definition"></a><br /></dt>
<dd><p>Set options from PETSc options database. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la5petsc12KrylovSolver3kspEv">
<span id="_CPPv3NK7dolfinx2la5petsc12KrylovSolver3kspEv"></span><span id="_CPPv2NK7dolfinx2la5petsc12KrylovSolver3kspEv"></span><span id="dolfinx::la::petsc::KrylovSolver::kspC"></span><span class="target" id="d2/dde/classdolfinx_1_1la_1_1petsc_1_1KrylovSolver_1a600c040db0ff046efd440961526b0f6f"></span><span class="n"><span class="pre">KSP</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ksp</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la5petsc12KrylovSolver3kspEv" title="Link to this definition"></a><br /></dt>
<dd><p>Return PETSc KSP pointer. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc6MatrixE">
<span id="_CPPv3N7dolfinx2la5petsc6MatrixE"></span><span id="_CPPv2N7dolfinx2la5petsc6MatrixE"></span><span id="dolfinx::la::petsc::Matrix"></span><span class="target" id="de/d18/classdolfinx_1_1la_1_1petsc_1_1Matrix"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Matrix</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc8OperatorE" title="dolfinx::la::petsc::Operator"><span class="n"><span class="pre">Operator</span></span></a><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc6MatrixE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;petsc.h&gt;</em></div>
<p>It is a simple wrapper for a PETSc matrix pointer (Mat). Its main purpose is to assist memory management of PETSc Mat objects. </p>
<p>For advanced usage, access the PETSc Mat pointer using the function <a class="reference internal" href="#db/d4b/classdolfinx_1_1la_1_1petsc_1_1Operator_1ade528b2122a5736900370592a773aba9"><span class="std std-ref">mat()</span></a> and use the standard PETSc interface. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-types">Public Types</p>
<dl class="cpp enum-class">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc6Matrix12AssemblyTypeE">
<span id="_CPPv3N7dolfinx2la5petsc6Matrix12AssemblyTypeE"></span><span id="_CPPv2N7dolfinx2la5petsc6Matrix12AssemblyTypeE"></span><span class="target" id="de/d18/classdolfinx_1_1la_1_1petsc_1_1Matrix_1ae78d8b657a736791820b89c5483bdb88"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">AssemblyType</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc6Matrix12AssemblyTypeE" title="Link to this definition"></a><br /></dt>
<dd><p>Assembly type FINAL - corresponds to PETSc MAT_FINAL_ASSEMBLY FLUSH - corresponds to PETSc MAT_FLUSH_ASSEMBLY. </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc6Matrix12AssemblyType5FINALE">
<span id="_CPPv3N7dolfinx2la5petsc6Matrix12AssemblyType5FINALE"></span><span id="_CPPv2N7dolfinx2la5petsc6Matrix12AssemblyType5FINALE"></span><span class="target" id="de/d18/classdolfinx_1_1la_1_1petsc_1_1Matrix_1ae78d8b657a736791820b89c5483bdb88a6c8361dc2036c0559376fe4957699f69"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">FINAL</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc6Matrix12AssemblyType5FINALE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc6Matrix12AssemblyType5FLUSHE">
<span id="_CPPv3N7dolfinx2la5petsc6Matrix12AssemblyType5FLUSHE"></span><span id="_CPPv2N7dolfinx2la5petsc6Matrix12AssemblyType5FLUSHE"></span><span class="target" id="de/d18/classdolfinx_1_1la_1_1petsc_1_1Matrix_1ae78d8b657a736791820b89c5483bdb88a26eed7f078fc015c5252f817059a6f9f"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">FLUSH</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc6Matrix12AssemblyType5FLUSHE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc6Matrix6MatrixE8MPI_CommRK15SparsityPatternNSt6stringE">
<span id="_CPPv3N7dolfinx2la5petsc6Matrix6MatrixE8MPI_CommRK15SparsityPatternNSt6stringE"></span><span id="_CPPv2N7dolfinx2la5petsc6Matrix6MatrixE8MPI_CommRK15SparsityPatternNSt6stringE"></span><span id="dolfinx::la::petsc::Matrix::Matrix__MPI_Comm.SparsityPatternCR.ss"></span><span class="target" id="de/d18/classdolfinx_1_1la_1_1petsc_1_1Matrix_1a523ff21bc12cbd3daed6cd3f25c29ddb"></span><span class="sig-name descname"><span class="n"><span class="pre">Matrix</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPI_Comm</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">comm</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la15SparsityPatternE" title="dolfinx::la::SparsityPattern"><span class="n"><span class="pre">SparsityPattern</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">sp</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">type</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">)</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc6Matrix6MatrixE8MPI_CommRK15SparsityPatternNSt6stringE" title="Link to this definition"></a><br /></dt>
<dd><p>Create holder for a PETSc Mat object from a sparsity pattern. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc6Matrix6MatrixE3Matb">
<span id="_CPPv3N7dolfinx2la5petsc6Matrix6MatrixE3Matb"></span><span id="_CPPv2N7dolfinx2la5petsc6Matrix6MatrixE3Matb"></span><span id="dolfinx::la::petsc::Matrix::Matrix__Mat.b"></span><span class="target" id="de/d18/classdolfinx_1_1la_1_1petsc_1_1Matrix_1aa426b6d57430e52e203b281a559ac1ec"></span><span class="sig-name descname"><span class="n"><span class="pre">Matrix</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Mat</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">A</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">inc_ref_count</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc6Matrix6MatrixE3Matb" title="Link to this definition"></a><br /></dt>
<dd><p>Create holder of a PETSc Mat object/pointer. The Mat A object should already be created. If inc_ref_count is true, the reference counter of the Mat will be increased. The Mat reference count will always be decreased upon destruction of the <a class="reference internal" href="#de/d18/classdolfinx_1_1la_1_1petsc_1_1Matrix"><span class="std std-ref">petsc::Matrix</span></a>. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc6Matrix6MatrixERR6Matrix">
<span id="_CPPv3N7dolfinx2la5petsc6Matrix6MatrixERR6Matrix"></span><span id="_CPPv2N7dolfinx2la5petsc6Matrix6MatrixERR6Matrix"></span><span id="dolfinx::la::petsc::Matrix::Matrix__MatrixRR"></span><span class="target" id="de/d18/classdolfinx_1_1la_1_1petsc_1_1Matrix_1a5cb4a1ecc5fb186a1206cf635a313301"></span><span class="sig-name descname"><span class="n"><span class="pre">Matrix</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc6Matrix6MatrixERR6Matrix" title="dolfinx::la::petsc::Matrix::Matrix"><span class="n"><span class="pre">Matrix</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">A</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc6Matrix6MatrixERR6Matrix" title="Link to this definition"></a><br /></dt>
<dd><p>Move constructor (falls through to base class move constructor) </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc6MatrixD0Ev">
<span id="_CPPv3N7dolfinx2la5petsc6MatrixD0Ev"></span><span id="_CPPv2N7dolfinx2la5petsc6MatrixD0Ev"></span><span id="dolfinx::la::petsc::Matrix::~Matrix"></span><span class="target" id="de/d18/classdolfinx_1_1la_1_1petsc_1_1Matrix_1a9bda91a0cead955347eb439e4b921da3"></span><span class="sig-name descname"><span class="n"><span class="pre">~Matrix</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc6MatrixD0Ev" title="Link to this definition"></a><br /></dt>
<dd><p>Destructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc6MatrixaSERK6Matrix">
<span id="_CPPv3N7dolfinx2la5petsc6MatrixaSERK6Matrix"></span><span id="_CPPv2N7dolfinx2la5petsc6MatrixaSERK6Matrix"></span><span id="dolfinx::la::petsc::Matrix::assign-operator__MatrixCR"></span><span class="target" id="de/d18/classdolfinx_1_1la_1_1petsc_1_1Matrix_1ad4d1ed2c5a71a5ca1c541007bc086257"></span><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc6MatrixE" title="dolfinx::la::petsc::Matrix"><span class="n"><span class="pre">Matrix</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc6MatrixE" title="dolfinx::la::petsc::Matrix"><span class="n"><span class="pre">Matrix</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">A</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">delete</span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc6MatrixaSERK6Matrix" title="Link to this definition"></a><br /></dt>
<dd><p>Assignment operator (deleted) </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc6MatrixaSERR6Matrix">
<span id="_CPPv3N7dolfinx2la5petsc6MatrixaSERR6Matrix"></span><span id="_CPPv2N7dolfinx2la5petsc6MatrixaSERR6Matrix"></span><span id="dolfinx::la::petsc::Matrix::assign-operator__MatrixRR"></span><span class="target" id="de/d18/classdolfinx_1_1la_1_1petsc_1_1Matrix_1a908e648284f560e89aade9f592649d2f"></span><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc6MatrixE" title="dolfinx::la::petsc::Matrix"><span class="n"><span class="pre">Matrix</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc6MatrixE" title="dolfinx::la::petsc::Matrix"><span class="n"><span class="pre">Matrix</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">A</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc6MatrixaSERR6Matrix" title="Link to this definition"></a><br /></dt>
<dd><p>Move assignment operator. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc6Matrix5applyE12AssemblyType">
<span id="_CPPv3N7dolfinx2la5petsc6Matrix5applyE12AssemblyType"></span><span id="_CPPv2N7dolfinx2la5petsc6Matrix5applyE12AssemblyType"></span><span id="dolfinx::la::petsc::Matrix::apply__AssemblyType"></span><span class="target" id="de/d18/classdolfinx_1_1la_1_1petsc_1_1Matrix_1aeba6179ec2a11b981e7cceb2c28c53c2"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">apply</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc6Matrix12AssemblyTypeE" title="dolfinx::la::petsc::Matrix::AssemblyType"><span class="n"><span class="pre">AssemblyType</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">type</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc6Matrix5applyE12AssemblyType" title="Link to this definition"></a><br /></dt>
<dd><p>Finalize assembly of tensor. The following values are recognized for the mode parameter: </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>type</strong> – FINAL - corresponds to PETSc MatAssemblyBegin+End(MAT_FINAL_ASSEMBLY) FLUSH - corresponds to PETSc MatAssemblyBegin+End(MAT_FLUSH_ASSEMBLY) </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la5petsc6Matrix4normE4Norm">
<span id="_CPPv3NK7dolfinx2la5petsc6Matrix4normE4Norm"></span><span id="_CPPv2NK7dolfinx2la5petsc6Matrix4normE4Norm"></span><span id="dolfinx::la::petsc::Matrix::norm__NormC"></span><span class="target" id="de/d18/classdolfinx_1_1la_1_1petsc_1_1Matrix_1a3096af607f3b72b2a6af400621eb02d2"></span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">norm</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx2la4NormE" title="dolfinx::la::Norm"><span class="n"><span class="pre">Norm</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">norm_type</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la5petsc6Matrix4normE4Norm" title="Link to this definition"></a><br /></dt>
<dd><p>Return norm of matrix. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc6Matrix18set_options_prefixENSt6stringE">
<span id="_CPPv3N7dolfinx2la5petsc6Matrix18set_options_prefixENSt6stringE"></span><span id="_CPPv2N7dolfinx2la5petsc6Matrix18set_options_prefixENSt6stringE"></span><span id="dolfinx::la::petsc::Matrix::set_options_prefix__ss"></span><span class="target" id="de/d18/classdolfinx_1_1la_1_1petsc_1_1Matrix_1aec9b253b2e0af7ee55fa5ec5034f7759"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_options_prefix</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">options_prefix</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc6Matrix18set_options_prefixENSt6stringE" title="Link to this definition"></a><br /></dt>
<dd><p>Sets the prefix used by PETSc when searching the options database. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la5petsc6Matrix18get_options_prefixEv">
<span id="_CPPv3NK7dolfinx2la5petsc6Matrix18get_options_prefixEv"></span><span id="_CPPv2NK7dolfinx2la5petsc6Matrix18get_options_prefixEv"></span><span id="dolfinx::la::petsc::Matrix::get_options_prefixC"></span><span class="target" id="de/d18/classdolfinx_1_1la_1_1petsc_1_1Matrix_1a70a5d4d223656a9031c311d8c0c09bfe"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_options_prefix</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la5petsc6Matrix18get_options_prefixEv" title="Link to this definition"></a><br /></dt>
<dd><p>Returns the prefix used by PETSc when searching the options database. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc6Matrix16set_from_optionsEv">
<span id="_CPPv3N7dolfinx2la5petsc6Matrix16set_from_optionsEv"></span><span id="_CPPv2N7dolfinx2la5petsc6Matrix16set_from_optionsEv"></span><span id="dolfinx::la::petsc::Matrix::set_from_options"></span><span class="target" id="de/d18/classdolfinx_1_1la_1_1petsc_1_1Matrix_1a228459b9d2eda187f2ab7e86a0f38b77"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_from_options</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc6Matrix16set_from_optionsEv" title="Link to this definition"></a><br /></dt>
<dd><p>Call PETSc function MatSetFromOptions on the PETSc Mat object. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-static-functions">Public Static Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc6Matrix6set_fnE3Mat10InsertMode">
<span id="_CPPv3N7dolfinx2la5petsc6Matrix6set_fnE3Mat10InsertMode"></span><span id="_CPPv2N7dolfinx2la5petsc6Matrix6set_fnE3Mat10InsertMode"></span><span id="dolfinx::la::petsc::Matrix::set_fn__Mat.InsertMode"></span><span class="target" id="de/d18/classdolfinx_1_1la_1_1petsc_1_1Matrix_1a4897db0f0c253924dbd41bc8e85021a1"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_fn</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Mat</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">A</span></span>, <span class="n"><span class="pre">InsertMode</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">mode</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc6Matrix6set_fnE3Mat10InsertMode" title="Link to this definition"></a><br /></dt>
<dd><p>Return a function with an interface for adding or inserting values into the matrix A (calls MatSetValuesLocal) </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> – <strong>[in]</strong> The matrix to set values in </p></li>
<li><p><strong>mode</strong> – <strong>[in]</strong> The PETSc insert mode (ADD_VALUES, INSERT_VALUES, …) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc6Matrix12set_block_fnE3Mat10InsertMode">
<span id="_CPPv3N7dolfinx2la5petsc6Matrix12set_block_fnE3Mat10InsertMode"></span><span id="_CPPv2N7dolfinx2la5petsc6Matrix12set_block_fnE3Mat10InsertMode"></span><span id="dolfinx::la::petsc::Matrix::set_block_fn__Mat.InsertMode"></span><span class="target" id="de/d18/classdolfinx_1_1la_1_1petsc_1_1Matrix_1a0c835b485eb601c612dd24c29cab87fc"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_block_fn</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Mat</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">A</span></span>, <span class="n"><span class="pre">InsertMode</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">mode</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc6Matrix12set_block_fnE3Mat10InsertMode" title="Link to this definition"></a><br /></dt>
<dd><p>Return a function with an interface for adding or inserting values into the matrix A using blocked indices (calls MatSetValuesBlockedLocal) </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> – <strong>[in]</strong> The matrix to set values in </p></li>
<li><p><strong>mode</strong> – <strong>[in]</strong> The PETSc insert mode (ADD_VALUES, INSERT_VALUES, …) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc6Matrix19set_block_expand_fnE3Matii10InsertMode">
<span id="_CPPv3N7dolfinx2la5petsc6Matrix19set_block_expand_fnE3Matii10InsertMode"></span><span id="_CPPv2N7dolfinx2la5petsc6Matrix19set_block_expand_fnE3Matii10InsertMode"></span><span id="dolfinx::la::petsc::Matrix::set_block_expand_fn__Mat.i.i.InsertMode"></span><span class="target" id="de/d18/classdolfinx_1_1la_1_1petsc_1_1Matrix_1a98679c491ba256ac5c83bfd6c1d63f81"></span><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_block_expand_fn</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Mat</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">A</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">bs0</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">bs1</span></span>, <span class="n"><span class="pre">InsertMode</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">mode</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc6Matrix19set_block_expand_fnE3Matii10InsertMode" title="Link to this definition"></a><br /></dt>
<dd><p>Return a function with an interface for adding or inserting blocked values to the matrix A using non-blocked insertion (calls MatSetValuesLocal). Internally it expands the blocked indices into non-blocked arrays. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> – <strong>[in]</strong> The matrix to set values in </p></li>
<li><p><strong>bs0</strong> – <strong>[in]</strong> Block size for the matrix rows </p></li>
<li><p><strong>bs1</strong> – <strong>[in]</strong> Block size for the matrix columns </p></li>
<li><p><strong>mode</strong> – <strong>[in]</strong> The PETSc insert mode (ADD_VALUES, INSERT_VALUES, …) </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc8OperatorE">
<span id="_CPPv3N7dolfinx2la5petsc8OperatorE"></span><span id="_CPPv2N7dolfinx2la5petsc8OperatorE"></span><span id="dolfinx::la::petsc::Operator"></span><span class="target" id="db/d4b/classdolfinx_1_1la_1_1petsc_1_1Operator"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Operator</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc8OperatorE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;petsc.h&gt;</em></div>
<p>This class is a base class for matrices that can be used in <a class="reference internal" href="#d2/dde/classdolfinx_1_1la_1_1petsc_1_1KrylovSolver"><span class="std std-ref">petsc::KrylovSolver</span></a>. </p>
<p>Subclassed by <a class="reference internal" href="#de/d18/classdolfinx_1_1la_1_1petsc_1_1Matrix"><span class="std std-ref">Matrix</span></a></p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc8Operator8OperatorE3Matb">
<span id="_CPPv3N7dolfinx2la5petsc8Operator8OperatorE3Matb"></span><span id="_CPPv2N7dolfinx2la5petsc8Operator8OperatorE3Matb"></span><span id="dolfinx::la::petsc::Operator::Operator__Mat.b"></span><span class="target" id="db/d4b/classdolfinx_1_1la_1_1petsc_1_1Operator_1a96ee7c468c45ee4d2a538bff13042868"></span><span class="sig-name descname"><span class="n"><span class="pre">Operator</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Mat</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">A</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">inc_ref_count</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc8Operator8OperatorE3Matb" title="Link to this definition"></a><br /></dt>
<dd><p>Constructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc8Operator8OperatorERR8Operator">
<span id="_CPPv3N7dolfinx2la5petsc8Operator8OperatorERR8Operator"></span><span id="_CPPv2N7dolfinx2la5petsc8Operator8OperatorERR8Operator"></span><span id="dolfinx::la::petsc::Operator::Operator__OperatorRR"></span><span class="target" id="db/d4b/classdolfinx_1_1la_1_1petsc_1_1Operator_1ab508c49578b9a68be5afedad458cd2bc"></span><span class="sig-name descname"><span class="n"><span class="pre">Operator</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc8Operator8OperatorERR8Operator" title="dolfinx::la::petsc::Operator::Operator"><span class="n"><span class="pre">Operator</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">A</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc8Operator8OperatorERR8Operator" title="Link to this definition"></a><br /></dt>
<dd><p>Move constructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc8OperatorD0Ev">
<span id="_CPPv3N7dolfinx2la5petsc8OperatorD0Ev"></span><span id="_CPPv2N7dolfinx2la5petsc8OperatorD0Ev"></span><span id="dolfinx::la::petsc::Operator::~Operator"></span><span class="target" id="db/d4b/classdolfinx_1_1la_1_1petsc_1_1Operator_1af199ce36b3e947d11258bc12a480c1b7"></span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">~Operator</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc8OperatorD0Ev" title="Link to this definition"></a><br /></dt>
<dd><p>Destructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc8OperatoraSERK8Operator">
<span id="_CPPv3N7dolfinx2la5petsc8OperatoraSERK8Operator"></span><span id="_CPPv2N7dolfinx2la5petsc8OperatoraSERK8Operator"></span><span id="dolfinx::la::petsc::Operator::assign-operator__OperatorCR"></span><span class="target" id="db/d4b/classdolfinx_1_1la_1_1petsc_1_1Operator_1a425f3f25182d7fbe423cecc04a6e1652"></span><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc8OperatorE" title="dolfinx::la::petsc::Operator"><span class="n"><span class="pre">Operator</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc8OperatorE" title="dolfinx::la::petsc::Operator"><span class="n"><span class="pre">Operator</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">A</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">delete</span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc8OperatoraSERK8Operator" title="Link to this definition"></a><br /></dt>
<dd><p>Assignment operator (deleted) </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc8OperatoraSERR8Operator">
<span id="_CPPv3N7dolfinx2la5petsc8OperatoraSERR8Operator"></span><span id="_CPPv2N7dolfinx2la5petsc8OperatoraSERR8Operator"></span><span id="dolfinx::la::petsc::Operator::assign-operator__OperatorRR"></span><span class="target" id="db/d4b/classdolfinx_1_1la_1_1petsc_1_1Operator_1a5e93d288c91be83d40b122b3f6b160ab"></span><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc8OperatorE" title="dolfinx::la::petsc::Operator"><span class="n"><span class="pre">Operator</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc8OperatorE" title="dolfinx::la::petsc::Operator"><span class="n"><span class="pre">Operator</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">A</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc8OperatoraSERR8Operator" title="Link to this definition"></a><br /></dt>
<dd><p>Move assignment operator. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la5petsc8Operator4sizeEv">
<span id="_CPPv3NK7dolfinx2la5petsc8Operator4sizeEv"></span><span id="_CPPv2NK7dolfinx2la5petsc8Operator4sizeEv"></span><span id="dolfinx::la::petsc::Operator::sizeC"></span><span class="target" id="db/d4b/classdolfinx_1_1la_1_1petsc_1_1Operator_1a3395bdd4928a16ee4b4203fe31443568"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">size</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la5petsc8Operator4sizeEv" title="Link to this definition"></a><br /></dt>
<dd><p>Return number of rows and columns (num_rows, num_cols). PETSc returns -1 if size has not been set. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la5petsc8Operator13create_vectorENSt6size_tE">
<span id="_CPPv3NK7dolfinx2la5petsc8Operator13create_vectorENSt6size_tE"></span><span id="_CPPv2NK7dolfinx2la5petsc8Operator13create_vectorENSt6size_tE"></span><span id="dolfinx::la::petsc::Operator::create_vector__std::sC"></span><span class="target" id="db/d4b/classdolfinx_1_1la_1_1petsc_1_1Operator_1a975542d9258713ef7aaa885a660a29b0"></span><span class="n"><span class="pre">Vec</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">create_vector</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dim</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la5petsc8Operator13create_vectorENSt6size_tE" title="Link to this definition"></a><br /></dt>
<dd><p>Initialize vector to be compatible with the matrix-vector product y = Ax. In the parallel case, size and layout are both important. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dim</strong> – <strong>[in]</strong> The dimension (axis): dim = 0 –&gt; z = y, dim = 1 –&gt; z = x </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la5petsc8Operator3matEv">
<span id="_CPPv3NK7dolfinx2la5petsc8Operator3matEv"></span><span id="_CPPv2NK7dolfinx2la5petsc8Operator3matEv"></span><span id="dolfinx::la::petsc::Operator::matC"></span><span class="target" id="db/d4b/classdolfinx_1_1la_1_1petsc_1_1Operator_1ade528b2122a5736900370592a773aba9"></span><span class="n"><span class="pre">Mat</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mat</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la5petsc8Operator3matEv" title="Link to this definition"></a><br /></dt>
<dd><p>Return PETSc Mat pointer. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc6VectorE">
<span id="_CPPv3N7dolfinx2la5petsc6VectorE"></span><span id="_CPPv2N7dolfinx2la5petsc6VectorE"></span><span id="dolfinx::la::petsc::Vector"></span><span class="target" id="dd/d35/classdolfinx_1_1la_1_1petsc_1_1Vector"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Vector</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc6VectorE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;petsc.h&gt;</em></div>
<p>A simple wrapper for a PETSc vector pointer (Vec). Its main purpose is to assist with memory/lifetime management of PETSc Vec objects. </p>
<p>Access the underlying PETSc Vec pointer using the function <a class="reference internal" href="#dd/d35/classdolfinx_1_1la_1_1petsc_1_1Vector_1aea730f3778ec99c234bfe033beba486c"><span class="std std-ref">Vector::vec()</span></a> and use the full PETSc interface. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc6Vector6VectorERKN6common8IndexMapEi">
<span id="_CPPv3N7dolfinx2la5petsc6Vector6VectorERKN6common8IndexMapEi"></span><span id="_CPPv2N7dolfinx2la5petsc6Vector6VectorERKN6common8IndexMapEi"></span><span id="dolfinx::la::petsc::Vector::Vector__common::IndexMapCR.i"></span><span class="target" id="dd/d35/classdolfinx_1_1la_1_1petsc_1_1Vector_1ac243b99edafecbb508445be857577615"></span><span class="sig-name descname"><span class="n"><span class="pre">Vector</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6commonE" title="dolfinx::common"><span class="n"><span class="pre">common</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6common8IndexMapE" title="dolfinx::common::IndexMap"><span class="n"><span class="pre">IndexMap</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">map</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">bs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc6Vector6VectorERKN6common8IndexMapEi" title="Link to this definition"></a><br /></dt>
<dd><p>Create a vector. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Collective </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>map</strong> – <strong>[in]</strong> Index map describing the parallel layout </p></li>
<li><p><strong>bs</strong> – <strong>[in]</strong> the block size </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc6Vector6VectorERR6Vector">
<span id="_CPPv3N7dolfinx2la5petsc6Vector6VectorERR6Vector"></span><span id="_CPPv2N7dolfinx2la5petsc6Vector6VectorERR6Vector"></span><span id="dolfinx::la::petsc::Vector::Vector__VectorRR"></span><span class="target" id="dd/d35/classdolfinx_1_1la_1_1petsc_1_1Vector_1aa6b2550e845ae56a0c83ac094c54144b"></span><span class="sig-name descname"><span class="n"><span class="pre">Vector</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc6Vector6VectorERR6Vector" title="dolfinx::la::petsc::Vector::Vector"><span class="n"><span class="pre">Vector</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc6Vector6VectorERR6Vector" title="Link to this definition"></a><br /></dt>
<dd><p>Move constructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc6Vector6VectorE3Vecb">
<span id="_CPPv3N7dolfinx2la5petsc6Vector6VectorE3Vecb"></span><span id="_CPPv2N7dolfinx2la5petsc6Vector6VectorE3Vecb"></span><span id="dolfinx::la::petsc::Vector::Vector__Vec.b"></span><span class="target" id="dd/d35/classdolfinx_1_1la_1_1petsc_1_1Vector_1adbed377722da289bc2ebcadc28eb0dad"></span><span class="sig-name descname"><span class="n"><span class="pre">Vector</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Vec</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">inc_ref_count</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc6Vector6VectorE3Vecb" title="Link to this definition"></a><br /></dt>
<dd><p>Create holder of a PETSc Vec object/pointer. The Vec x object should already be created. If inc_ref_count is true, the reference counter of the Vec object will be increased. The Vec reference count will always be decreased upon destruction of the PETScVector. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Collective</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – <strong>[in]</strong> The PETSc Vec </p></li>
<li><p><strong>inc_ref_count</strong> – <strong>[in]</strong> True if the reference count of <code class="docutils literal notranslate"><span class="pre">x</span></code> should be incremented </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc6VectorD0Ev">
<span id="_CPPv3N7dolfinx2la5petsc6VectorD0Ev"></span><span id="_CPPv2N7dolfinx2la5petsc6VectorD0Ev"></span><span id="dolfinx::la::petsc::Vector::~Vector"></span><span class="target" id="dd/d35/classdolfinx_1_1la_1_1petsc_1_1Vector_1aaa9fccd0cb7734271f7a15e5d9dc0d27"></span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">~Vector</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc6VectorD0Ev" title="Link to this definition"></a><br /></dt>
<dd><p>Destructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc6VectoraSERR6Vector">
<span id="_CPPv3N7dolfinx2la5petsc6VectoraSERR6Vector"></span><span id="_CPPv2N7dolfinx2la5petsc6VectoraSERR6Vector"></span><span id="dolfinx::la::petsc::Vector::assign-operator__VectorRR"></span><span class="target" id="dd/d35/classdolfinx_1_1la_1_1petsc_1_1Vector_1ab557a676f5c16a0aaa03cddb8aa4f9d9"></span><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc6VectorE" title="dolfinx::la::petsc::Vector"><span class="n"><span class="pre">Vector</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc6VectorE" title="dolfinx::la::petsc::Vector"><span class="n"><span class="pre">Vector</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc6VectoraSERR6Vector" title="Link to this definition"></a><br /></dt>
<dd><p>Move Assignment operator. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la5petsc6Vector4copyEv">
<span id="_CPPv3NK7dolfinx2la5petsc6Vector4copyEv"></span><span id="_CPPv2NK7dolfinx2la5petsc6Vector4copyEv"></span><span id="dolfinx::la::petsc::Vector::copyC"></span><span class="target" id="dd/d35/classdolfinx_1_1la_1_1petsc_1_1Vector_1a99a96e571005eb4a00c04c0b2a4549dd"></span><a class="reference internal" href="#_CPPv4N7dolfinx2la5petsc6VectorE" title="dolfinx::la::petsc::Vector"><span class="n"><span class="pre">Vector</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">copy</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la5petsc6Vector4copyEv" title="Link to this definition"></a><br /></dt>
<dd><p>Create a copy of the vector. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Collective </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la5petsc6Vector4sizeEv">
<span id="_CPPv3NK7dolfinx2la5petsc6Vector4sizeEv"></span><span id="_CPPv2NK7dolfinx2la5petsc6Vector4sizeEv"></span><span id="dolfinx::la::petsc::Vector::sizeC"></span><span class="target" id="dd/d35/classdolfinx_1_1la_1_1petsc_1_1Vector_1a6d82a8d933066653ab4079cf0a4a3c69"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">size</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la5petsc6Vector4sizeEv" title="Link to this definition"></a><br /></dt>
<dd><p>Return global size of the vector. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la5petsc6Vector10local_sizeEv">
<span id="_CPPv3NK7dolfinx2la5petsc6Vector10local_sizeEv"></span><span id="_CPPv2NK7dolfinx2la5petsc6Vector10local_sizeEv"></span><span id="dolfinx::la::petsc::Vector::local_sizeC"></span><span class="target" id="dd/d35/classdolfinx_1_1la_1_1petsc_1_1Vector_1ae85f06246f6274a56d71da26c527b36d"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">local_size</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la5petsc6Vector10local_sizeEv" title="Link to this definition"></a><br /></dt>
<dd><p>Return local size of vector (belonging to the call rank) </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la5petsc6Vector11local_rangeEv">
<span id="_CPPv3NK7dolfinx2la5petsc6Vector11local_rangeEv"></span><span id="_CPPv2NK7dolfinx2la5petsc6Vector11local_rangeEv"></span><span id="dolfinx::la::petsc::Vector::local_rangeC"></span><span class="target" id="dd/d35/classdolfinx_1_1la_1_1petsc_1_1Vector_1adbc599a073567f49262119af3f1e8aa6"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">local_range</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la5petsc6Vector11local_rangeEv" title="Link to this definition"></a><br /></dt>
<dd><p>Return ownership range for calling rank. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la5petsc6Vector4commEv">
<span id="_CPPv3NK7dolfinx2la5petsc6Vector4commEv"></span><span id="_CPPv2NK7dolfinx2la5petsc6Vector4commEv"></span><span id="dolfinx::la::petsc::Vector::commC"></span><span class="target" id="dd/d35/classdolfinx_1_1la_1_1petsc_1_1Vector_1ad3217ebf3e21d7902bf89ab1248dabb9"></span><span class="n"><span class="pre">MPI_Comm</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">comm</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la5petsc6Vector4commEv" title="Link to this definition"></a><br /></dt>
<dd><p>Return MPI communicator. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc6Vector18set_options_prefixENSt6stringE">
<span id="_CPPv3N7dolfinx2la5petsc6Vector18set_options_prefixENSt6stringE"></span><span id="_CPPv2N7dolfinx2la5petsc6Vector18set_options_prefixENSt6stringE"></span><span id="dolfinx::la::petsc::Vector::set_options_prefix__ss"></span><span class="target" id="dd/d35/classdolfinx_1_1la_1_1petsc_1_1Vector_1aec9b253b2e0af7ee55fa5ec5034f7759"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_options_prefix</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">options_prefix</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc6Vector18set_options_prefixENSt6stringE" title="Link to this definition"></a><br /></dt>
<dd><p>Sets the prefix used by PETSc when searching the options database. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la5petsc6Vector18get_options_prefixEv">
<span id="_CPPv3NK7dolfinx2la5petsc6Vector18get_options_prefixEv"></span><span id="_CPPv2NK7dolfinx2la5petsc6Vector18get_options_prefixEv"></span><span id="dolfinx::la::petsc::Vector::get_options_prefixC"></span><span class="target" id="dd/d35/classdolfinx_1_1la_1_1petsc_1_1Vector_1a70a5d4d223656a9031c311d8c0c09bfe"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_options_prefix</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la5petsc6Vector18get_options_prefixEv" title="Link to this definition"></a><br /></dt>
<dd><p>Returns the prefix used by PETSc when searching the options database. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc6Vector16set_from_optionsEv">
<span id="_CPPv3N7dolfinx2la5petsc6Vector16set_from_optionsEv"></span><span id="_CPPv2N7dolfinx2la5petsc6Vector16set_from_optionsEv"></span><span id="dolfinx::la::petsc::Vector::set_from_options"></span><span class="target" id="dd/d35/classdolfinx_1_1la_1_1petsc_1_1Vector_1a228459b9d2eda187f2ab7e86a0f38b77"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_from_options</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc6Vector16set_from_optionsEv" title="Link to this definition"></a><br /></dt>
<dd><p>Call PETSc function VecSetFromOptions on the underlying Vec object. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la5petsc6Vector3vecEv">
<span id="_CPPv3NK7dolfinx2la5petsc6Vector3vecEv"></span><span id="_CPPv2NK7dolfinx2la5petsc6Vector3vecEv"></span><span id="dolfinx::la::petsc::Vector::vecC"></span><span class="target" id="dd/d35/classdolfinx_1_1la_1_1petsc_1_1Vector_1aea730f3778ec99c234bfe033beba486c"></span><span class="n"><span class="pre">Vec</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">vec</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la5petsc6Vector3vecEv" title="Link to this definition"></a><br /></dt>
<dd><p>Return pointer to PETSc Vec object. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc7optionsE">
<span id="_CPPv3N7dolfinx2la5petsc7optionsE"></span><span id="_CPPv2N7dolfinx2la5petsc7optionsE"></span><span id="dolfinx::la::petsc::options"></span><span class="target" id="dd/d01/namespacedolfinx_1_1la_1_1petsc_1_1options"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">options</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc7optionsE" title="Link to this definition"></a><br /></dt>
<dd><p>These class provides static functions that permit users to set and retrieve PETSc options via the PETSc option/parameter system. The option must not be prefixed by ‘-’, e.g. </p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span><span class="n">la</span><span class="o">::</span><span class="n">petsc</span><span class="o">::</span><span class="n">options</span><span class="o">::</span><span class="n">set</span><span class="p">(</span><span class="s">&quot;mat_mumps_icntl_14&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">40</span><span class="p">);</span>
</pre></div>
</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc7options3setENSt6stringE">
<span id="_CPPv3N7dolfinx2la5petsc7options3setENSt6stringE"></span><span id="_CPPv2N7dolfinx2la5petsc7options3setENSt6stringE"></span><span id="dolfinx::la::petsc::options::set__ss"></span><span class="target" id="dd/d01/namespacedolfinx_1_1la_1_1petsc_1_1options_1aff6d47e0209b632772fec95a417f72fa"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">option</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc7options3setENSt6stringE" title="Link to this definition"></a><br /></dt>
<dd><p>Set PETSc option that takes no value. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN7dolfinx2la5petsc7options3setEvNSt6stringEK1T">
<span id="_CPPv3I0EN7dolfinx2la5petsc7options3setENSt6stringEK1T"></span><span id="_CPPv2I0EN7dolfinx2la5petsc7options3setENSt6stringEK1T"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="dd/d01/namespacedolfinx_1_1la_1_1petsc_1_1options_1ae93e1844770a04cee9417902929eb935"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">option</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la5petsc7options3setEvNSt6stringEK1T" title="dolfinx::la::petsc::options::set::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">value</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN7dolfinx2la5petsc7options3setEvNSt6stringEK1T" title="Link to this definition"></a><br /></dt>
<dd><p>Generic function for setting PETSc option. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc7options5clearENSt6stringE">
<span id="_CPPv3N7dolfinx2la5petsc7options5clearENSt6stringE"></span><span id="_CPPv2N7dolfinx2la5petsc7options5clearENSt6stringE"></span><span id="dolfinx::la::petsc::options::clear__ss"></span><span class="target" id="dd/d01/namespacedolfinx_1_1la_1_1petsc_1_1options_1ae61761e2af400bc975600f7571bcbd74"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">clear</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">option</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc7options5clearENSt6stringE" title="Link to this definition"></a><br /></dt>
<dd><p>Clear a PETSc option. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la5petsc7options5clearEv">
<span id="_CPPv3N7dolfinx2la5petsc7options5clearEv"></span><span id="_CPPv2N7dolfinx2la5petsc7options5clearEv"></span><span id="dolfinx::la::petsc::options::clear"></span><span class="target" id="dd/d01/namespacedolfinx_1_1la_1_1petsc_1_1options_1ac8bb3912a3ce86b15842e79d0b421204"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">clear</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la5petsc7options5clearEv" title="Link to this definition"></a><br /></dt>
<dd><p>Clear PETSc global options database. </p>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="io.html" class="btn btn-neutral float-left" title="IO (dolfinx::io)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="mesh.html" class="btn btn-neutral float-right" title="Mesh (dolfinx::mesh)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, FEniCS Project.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>