<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Finite element (dolfinx::fem) &mdash; DOLFINx 0.3.1 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="IO (dolfinx::io)" href="io.html" />
    <link rel="prev" title="Graph (dolfinx::graph)" href="graph.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> DOLFINx
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="common.html">Common (<code class="docutils literal notranslate"><span class="pre">dolfinx::common</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="geometry.html">Geometry (<code class="docutils literal notranslate"><span class="pre">dolfinx::geometry</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph.html">Graph (<code class="docutils literal notranslate"><span class="pre">dolfinx::graph</span></code>)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Finite element (<code class="docutils literal notranslate"><span class="pre">dolfinx::fem</span></code>)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#finite-elements">Finite elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#function-spaces-and-functions">Function spaces and functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#function-spaces">Function spaces</a></li>
<li class="toctree-l3"><a class="reference internal" href="#functions">Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#constants">Constants</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#forms">Forms</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dirichlet-boundary-conditions">Dirichlet boundary conditions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#degree-of-freedom-maps">Degree-of-freedom maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="#assembly">Assembly</a></li>
<li class="toctree-l2"><a class="reference internal" href="#interpolation">Interpolation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sparsity-pattern-construction">Sparsity pattern construction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#petsc-helpers">PETSc helpers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#misc">Misc</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="io.html">IO (<code class="docutils literal notranslate"><span class="pre">dolfinx::io</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="la.html">Linea algebra (<code class="docutils literal notranslate"><span class="pre">dolfinx::la</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="mesh.html">Mesh (<code class="docutils literal notranslate"><span class="pre">dolfinx::mesh</span></code>)</a></li>
<li class="toctree-l1"><a class="reference internal" href="refinement.html">Refinement (<code class="docutils literal notranslate"><span class="pre">dolfinx::refinement</span></code>)</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">DOLFINx</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Finite element (<code class="docutils literal notranslate"><span class="pre">dolfinx::fem</span></code>)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/fem.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="finite-element-dolfinx-fem">
<h1>Finite element (<code class="docutils literal notranslate"><span class="pre">dolfinx::fem</span></code>)<a class="headerlink" href="#finite-element-dolfinx-fem" title="Permalink to this headline"></a></h1>
<p><em>Under development</em></p>
<section id="finite-elements">
<h2>Finite elements<a class="headerlink" href="#finite-elements" title="Permalink to this headline"></a></h2>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem13FiniteElementE">
<span id="_CPPv3N7dolfinx3fem13FiniteElementE"></span><span id="_CPPv2N7dolfinx3fem13FiniteElementE"></span><span id="dolfinx::fem::FiniteElement"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">dolfinx</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">FiniteElement</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx3fem13FiniteElementE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Finite Element, containing the dof layout on a reference element, and various methods for evaluating and transforming the basis. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem13FiniteElement13FiniteElementERK19ufcx_finite_element">
<span id="_CPPv3N7dolfinx3fem13FiniteElement13FiniteElementERK19ufcx_finite_element"></span><span id="_CPPv2N7dolfinx3fem13FiniteElement13FiniteElementERK19ufcx_finite_element"></span><span id="dolfinx::fem::FiniteElement::FiniteElement__ufcx_finite_elementCR"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a4564e5b15f8d676b5d123f5da8400b7f"></span><span class="k"><span class="pre">explicit</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">FiniteElement</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">ufcx_finite_element</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">e</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx3fem13FiniteElement13FiniteElementERK19ufcx_finite_element" title="Permalink to this definition"></a><br /></dt>
<dd><p>Create finite element from UFC finite element. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>e</strong> – <strong>[in]</strong> UFC finite element </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem13FiniteElement13FiniteElementERKN5basix13FiniteElementEi">
<span id="_CPPv3N7dolfinx3fem13FiniteElement13FiniteElementERKN5basix13FiniteElementEi"></span><span id="_CPPv2N7dolfinx3fem13FiniteElement13FiniteElementERKN5basix13FiniteElementEi"></span><span id="dolfinx::fem::FiniteElement::FiniteElement__basix::FiniteElementCR.i"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1ad5326f607862ae2bd9851cd73fd6102f"></span><span class="sig-name descname"><span class="n"><span class="pre">FiniteElement</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">basix</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">FiniteElement</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">element</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">bs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx3fem13FiniteElement13FiniteElementERKN5basix13FiniteElementEi" title="Permalink to this definition"></a><br /></dt>
<dd><p>Create finite element from a Basix finite element. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>element</strong> – <strong>[in]</strong> Basix finite element </p></li>
<li><p><strong>bs</strong> – <strong>[in]</strong> The block size </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem13FiniteElement13FiniteElementERK13FiniteElement">
<span id="_CPPv3N7dolfinx3fem13FiniteElement13FiniteElementERK13FiniteElement"></span><span id="_CPPv2N7dolfinx3fem13FiniteElement13FiniteElementERK13FiniteElement"></span><span id="dolfinx::fem::FiniteElement::FiniteElement__FiniteElementCR"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a43bdd28e8ff53d4bc27a9719d037b7bb"></span><span class="sig-name descname"><span class="n"><span class="pre">FiniteElement</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FiniteElement13FiniteElementERK13FiniteElement" title="dolfinx::fem::FiniteElement::FiniteElement"><span class="n"><span class="pre">FiniteElement</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">element</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">delete</span></span><a class="headerlink" href="#_CPPv4N7dolfinx3fem13FiniteElement13FiniteElementERK13FiniteElement" title="Permalink to this definition"></a><br /></dt>
<dd><p>Copy constructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem13FiniteElement13FiniteElementERR13FiniteElement">
<span id="_CPPv3N7dolfinx3fem13FiniteElement13FiniteElementERR13FiniteElement"></span><span id="_CPPv2N7dolfinx3fem13FiniteElement13FiniteElementERR13FiniteElement"></span><span id="dolfinx::fem::FiniteElement::FiniteElement__FiniteElementRR"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1abdf2fed83b951b0c90933fae07307496"></span><span class="sig-name descname"><span class="n"><span class="pre">FiniteElement</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FiniteElement13FiniteElementERR13FiniteElement" title="dolfinx::fem::FiniteElement::FiniteElement"><span class="n"><span class="pre">FiniteElement</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">element</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx3fem13FiniteElement13FiniteElementERR13FiniteElement" title="Permalink to this definition"></a><br /></dt>
<dd><p>Move constructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem13FiniteElementD0Ev">
<span id="_CPPv3N7dolfinx3fem13FiniteElementD0Ev"></span><span id="_CPPv2N7dolfinx3fem13FiniteElementD0Ev"></span><span id="dolfinx::fem::FiniteElement::~FiniteElement"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a8812d0d4b429336eeb5f041099035d53"></span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">~FiniteElement</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx3fem13FiniteElementD0Ev" title="Permalink to this definition"></a><br /></dt>
<dd><p>Destructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem13FiniteElementaSERK13FiniteElement">
<span id="_CPPv3N7dolfinx3fem13FiniteElementaSERK13FiniteElement"></span><span id="_CPPv2N7dolfinx3fem13FiniteElementaSERK13FiniteElement"></span><span id="dolfinx::fem::FiniteElement::assign-operator__FiniteElementCR"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1ac7165b31c44809bbfd6413856a8b3689"></span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FiniteElementE" title="dolfinx::fem::FiniteElement"><span class="n"><span class="pre">FiniteElement</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FiniteElementE" title="dolfinx::fem::FiniteElement"><span class="n"><span class="pre">FiniteElement</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">element</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">delete</span></span><a class="headerlink" href="#_CPPv4N7dolfinx3fem13FiniteElementaSERK13FiniteElement" title="Permalink to this definition"></a><br /></dt>
<dd><p>Copy assignment. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem13FiniteElementaSERR13FiniteElement">
<span id="_CPPv3N7dolfinx3fem13FiniteElementaSERR13FiniteElement"></span><span id="_CPPv2N7dolfinx3fem13FiniteElementaSERR13FiniteElement"></span><span id="dolfinx::fem::FiniteElement::assign-operator__FiniteElementRR"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a77bbc83f9f6eb3ee7b99d16d28e62506"></span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FiniteElementE" title="dolfinx::fem::FiniteElement"><span class="n"><span class="pre">FiniteElement</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FiniteElementE" title="dolfinx::fem::FiniteElement"><span class="n"><span class="pre">FiniteElement</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">element</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx3fem13FiniteElementaSERR13FiniteElement" title="Permalink to this definition"></a><br /></dt>
<dd><p>Move assignment. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FiniteElementeqERK13FiniteElement">
<span id="_CPPv3NK7dolfinx3fem13FiniteElementeqERK13FiniteElement"></span><span id="_CPPv2NK7dolfinx3fem13FiniteElementeqERK13FiniteElement"></span><span id="dolfinx::fem::FiniteElement::eq-operator__FiniteElementCRC"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1afa62c95fee8cd0b22a4a272ba67bddbf"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">==</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FiniteElementE" title="dolfinx::fem::FiniteElement"><span class="n"><span class="pre">FiniteElement</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">e</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FiniteElementeqERK13FiniteElement" title="Permalink to this definition"></a><br /></dt>
<dd><p>Check if two elements are equivalent. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Equality can be checked only for non-mixed elements. For a mixed element, this function will raise an exception. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True is the two elements are the same </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FiniteElementneERK13FiniteElement">
<span id="_CPPv3NK7dolfinx3fem13FiniteElementneERK13FiniteElement"></span><span id="_CPPv2NK7dolfinx3fem13FiniteElementneERK13FiniteElement"></span><span id="dolfinx::fem::FiniteElement::neq-operator__FiniteElementCRC"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a9382c35cf56595f89617732cb1b0eba3"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">!=</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FiniteElementE" title="dolfinx::fem::FiniteElement"><span class="n"><span class="pre">FiniteElement</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">e</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FiniteElementneERK13FiniteElement" title="Permalink to this definition"></a><br /></dt>
<dd><p>Check if two elements are not equivalent. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Equality can be checked only for non-mixed elements. For a mixed element, this function will raise an exception. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True is the two elements are not the same </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FiniteElement9signatureEv">
<span id="_CPPv3NK7dolfinx3fem13FiniteElement9signatureEv"></span><span id="_CPPv2NK7dolfinx3fem13FiniteElement9signatureEv"></span><span id="dolfinx::fem::FiniteElement::signatureC"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a508f93d3a34146afe1d2ed248b0ed225"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">signature</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FiniteElement9signatureEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>String identifying the finite element. </p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The function is provided for convenience, but it should not be relied upon for determining the element type. Use other functions, commonly returning enums, to determine element properties. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Element signature </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FiniteElement10cell_shapeEv">
<span id="_CPPv3NK7dolfinx3fem13FiniteElement10cell_shapeEv"></span><span id="_CPPv2NK7dolfinx3fem13FiniteElement10cell_shapeEv"></span><span id="dolfinx::fem::FiniteElement::cell_shapeC"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1afe212a12d708345ecd94f21e9f16f822"></span><a class="reference internal" href="mesh.html#_CPPv4N7dolfinx4meshE" title="dolfinx::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mesh.html#_CPPv4N7dolfinx4mesh8CellTypeE" title="dolfinx::mesh::CellType"><span class="n"><span class="pre">CellType</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cell_shape</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FiniteElement10cell_shapeEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Cell shape. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Element cell shape </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FiniteElement15space_dimensionEv">
<span id="_CPPv3NK7dolfinx3fem13FiniteElement15space_dimensionEv"></span><span id="_CPPv2NK7dolfinx3fem13FiniteElement15space_dimensionEv"></span><span id="dolfinx::fem::FiniteElement::space_dimensionC"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a2585c6e4d6d6133186cdc237e0ce9cfc"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">space_dimension</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FiniteElement15space_dimensionEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Dimension of the finite element function space (the number of degrees-of-freedom for the element) </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Dimension of the finite element space </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FiniteElement10block_sizeEv">
<span id="_CPPv3NK7dolfinx3fem13FiniteElement10block_sizeEv"></span><span id="_CPPv2NK7dolfinx3fem13FiniteElement10block_sizeEv"></span><span id="dolfinx::fem::FiniteElement::block_sizeC"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1acd3f76c0eb872b28ffb94a427332686f"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">block_size</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FiniteElement10block_sizeEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Block size of the finite element function space. For VectorElements and TensorElements, this is the number of DOFs colocated at each DOF point. For other elements, this is always 1. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Block size of the finite element space </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FiniteElement10value_sizeEv">
<span id="_CPPv3NK7dolfinx3fem13FiniteElement10value_sizeEv"></span><span id="_CPPv2NK7dolfinx3fem13FiniteElement10value_sizeEv"></span><span id="dolfinx::fem::FiniteElement::value_sizeC"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a7d326295a6362a9b6f112e0efa5a7de7"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_size</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FiniteElement10value_sizeEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>The value size, e.g. 1 for a scalar function, 2 for a 2D vector, 9 for a second-order tensor in 3D. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The return value of this function is equal to <code class="docutils literal notranslate"><span class="pre">std::accumulate(</span><a class="reference internal" href="#df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a396c56d384d802c31c8ef52cc30c92d7"><span class="std std-ref"><span class="pre">value_shape()</span></span></a><span class="pre">.begin(),</span> <a class="reference internal" href="#df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a396c56d384d802c31c8ef52cc30c92d7"><span class="std std-ref"><span class="pre">value_shape()</span></span></a><span class="pre">.end(),</span> <span class="pre">1,</span> <span class="pre">std::multiplies&lt;int&gt;())</span></code>. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The value size </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FiniteElement20reference_value_sizeEv">
<span id="_CPPv3NK7dolfinx3fem13FiniteElement20reference_value_sizeEv"></span><span id="_CPPv2NK7dolfinx3fem13FiniteElement20reference_value_sizeEv"></span><span id="dolfinx::fem::FiniteElement::reference_value_sizeC"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a78737d3c0a9c143fa24c503cac16d519"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">reference_value_size</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FiniteElement20reference_value_sizeEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>The value size, e.g. 1 for a scalar function, 2 for a 2D vector, 9 for a second-order tensor in 3D, for the reference element. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The value size for the reference element </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FiniteElement11value_shapeEv">
<span id="_CPPv3NK7dolfinx3fem13FiniteElement11value_shapeEv"></span><span id="_CPPv2NK7dolfinx3fem13FiniteElement11value_shapeEv"></span><span id="dolfinx::fem::FiniteElement::value_shapeC"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a396c56d384d802c31c8ef52cc30c92d7"></span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_shape</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FiniteElement11value_shapeEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Shape of the value space. The rank is the size of the <code class="docutils literal notranslate"><span class="pre">value_shape</span></code>. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FiniteElement6familyEv">
<span id="_CPPv3NK7dolfinx3fem13FiniteElement6familyEv"></span><span id="_CPPv2NK7dolfinx3fem13FiniteElement6familyEv"></span><span id="dolfinx::fem::FiniteElement::familyC"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a132ceaf57dee2fe5b8346fdfe608fbd9"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">family</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FiniteElement6familyEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>The finite element family. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The string of the finite element family </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FiniteElement8tabulateERN2xt7xtensorIdXL4EEEERKN2xt7xtensorIdXL2EEEEi">
<span id="_CPPv3NK7dolfinx3fem13FiniteElement8tabulateERN2xt7xtensorIdXL4EEEERKN2xt7xtensorIdXL2EEEEi"></span><span id="_CPPv2NK7dolfinx3fem13FiniteElement8tabulateERN2xt7xtensorIdX4EEERKN2xt7xtensorIdX2EEEi"></span><span id="dolfinx::fem::FiniteElement::tabulate__xt::xtensor:double.4:R.xt::xtensor:double.2:CR.iC"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1ae18f92e94fea6b949aa0665bfbe8db9e"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tabulate</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">xt</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">xtensor</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">4</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">values</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xt</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">xtensor</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">X</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">order</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FiniteElement8tabulateERN2xt7xtensorIdXL4EEEERKN2xt7xtensorIdXL2EEEEi" title="Permalink to this definition"></a><br /></dt>
<dd><p>Evaluate all derivatives of the basis functions up to given order at given points in reference cell. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>values</strong> – <strong>[inout]</strong> Four dimensional xtensor that will be filled with the tabulated values. Should be of shape {num_derivatives, num_points, num_dofs, reference_value_size} </p></li>
<li><p><strong>X</strong> – <strong>[in]</strong> Two dimensional xtensor of shape [num_points, geometric dimension] containing the points at the reference element </p></li>
<li><p><strong>order</strong> – <strong>[in]</strong> The number of derivatives (up to and including this order) to tabulate for </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000ENK7dolfinx3fem13FiniteElement6map_fnENSt8functionIFvR1ORK1PRK1QdRK1REEEv">
<span id="_CPPv3I0000ENK7dolfinx3fem13FiniteElement6map_fnEv"></span><span id="_CPPv2I0000ENK7dolfinx3fem13FiniteElement6map_fnEv"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">O</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">P</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Q</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">R</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1ab4bc150b7173b920416df953497e5387"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">void</span></span><span class="p"><span class="pre">(</span></span><a class="reference internal" href="#_CPPv4I0000ENK7dolfinx3fem13FiniteElement6map_fnENSt8functionIFvR1ORK1PRK1QdRK1REEEv" title="dolfinx::fem::FiniteElement::map_fn::O"><span class="n"><span class="pre">O</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000ENK7dolfinx3fem13FiniteElement6map_fnENSt8functionIFvR1ORK1PRK1QdRK1REEEv" title="dolfinx::fem::FiniteElement::map_fn::P"><span class="n"><span class="pre">P</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000ENK7dolfinx3fem13FiniteElement6map_fnENSt8functionIFvR1ORK1PRK1QdRK1REEEv" title="dolfinx::fem::FiniteElement::map_fn::Q"><span class="n"><span class="pre">Q</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000ENK7dolfinx3fem13FiniteElement6map_fnENSt8functionIFvR1ORK1PRK1QdRK1REEEv" title="dolfinx::fem::FiniteElement::map_fn::R"><span class="n"><span class="pre">R</span></span></a><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">map_fn</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4I0000ENK7dolfinx3fem13FiniteElement6map_fnENSt8functionIFvR1ORK1PRK1QdRK1REEEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Return a function that performs the appropriate push-forward (pull-back) for the element type. </p>
<p>
For a pull-back the passed arguments should be:<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">U</span></code> [out] The data on the reference cell after the pull-back, flattened with row-major layout, shape=(num_points, ref value_size)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">u</span></code> [in] The data on the physical cell that should be pulled back , flattened with row-major layout, shape=(num_points, value_size)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">K</span></code> [in] The inverse oif the Jacobian matrix of the map, shape=(tdim, gdim)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">detJ_inv</span></code> [in] 1/det(J)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">J</span></code> [in] The Jacobian matrix, shape=(gdim, tdim) </p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>O</strong> – The type that hold the computed pushed-forward (pulled-back) data (ndim==1) </p></li>
<li><p><strong>P</strong> – The type that hold the data to be pulled back (pushed forwarded) (ndim==1) </p></li>
<li><p><strong>Q</strong> – The type that holds the Jacobian (inverse Jacobian) matrix (ndim==2) </p></li>
<li><p><strong>R</strong> – The type that holds the inverse Jacobian (Jacobian) matrix (ndim==2)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A function that for a push-forward takes arguments<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">u</span></code> [out] The data on the physical cell after the push-forward flattened with row-major layout, shape=(num_points, value_size)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">U</span></code> [in] The data on the reference cell physical field to push forward, flattened with row-major layout, shape=(num_points, ref_value_size)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">J</span></code> [in] The Jacobian matrix of the map ,shape=(gdim, tdim)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">detJ</span></code> [in] det(J)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">K</span></code> [in] The inverse of the Jacobian matrix, shape=(tdim, gdim)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FiniteElement16num_sub_elementsEv">
<span id="_CPPv3NK7dolfinx3fem13FiniteElement16num_sub_elementsEv"></span><span id="_CPPv2NK7dolfinx3fem13FiniteElement16num_sub_elementsEv"></span><span id="dolfinx::fem::FiniteElement::num_sub_elementsC"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1abf6d258f77b4060f5d259fe7e877709b"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">num_sub_elements</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FiniteElement16num_sub_elementsEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the number of sub elements (for a mixed or blocked element) </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The number of sub elements </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FiniteElement8is_mixedEv">
<span id="_CPPv3NK7dolfinx3fem13FiniteElement8is_mixedEv"></span><span id="_CPPv2NK7dolfinx3fem13FiniteElement8is_mixedEv"></span><span id="dolfinx::fem::FiniteElement::is_mixedC"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a6f152d3559b409b233e7d64b13978e9a"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">is_mixed</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FiniteElement8is_mixedEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Check if element is a mixed element, i.e. composed of two or more elements of different types. A block element, e.g. a Lagrange element with block size &gt; 1 is not considered mixed. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True is element is mixed. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FiniteElement12sub_elementsEv">
<span id="_CPPv3NK7dolfinx3fem13FiniteElement12sub_elementsEv"></span><span id="_CPPv2NK7dolfinx3fem13FiniteElement12sub_elementsEv"></span><span id="dolfinx::fem::FiniteElement::sub_elementsC"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1acf3f851cba0b33029c943e473f0cc429"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FiniteElementE" title="dolfinx::fem::FiniteElement"><span class="n"><span class="pre">FiniteElement</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">sub_elements</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FiniteElement12sub_elementsEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Subelements (if any) </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FiniteElement4tdimEv">
<span id="_CPPv3NK7dolfinx3fem13FiniteElement4tdimEv"></span><span id="_CPPv2NK7dolfinx3fem13FiniteElement4tdimEv"></span><span id="dolfinx::fem::FiniteElement::tdimC"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a070b257eeb781fe7066d55f41d4aff60"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tdim</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FiniteElement4tdimEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Return the topological dimension. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FiniteElement19extract_sub_elementERKNSt6vectorIiEE">
<span id="_CPPv3NK7dolfinx3fem13FiniteElement19extract_sub_elementERKNSt6vectorIiEE"></span><span id="_CPPv2NK7dolfinx3fem13FiniteElement19extract_sub_elementERKNSt6vectorIiEE"></span><span id="dolfinx::fem::FiniteElement::extract_sub_element__std::vector:i:CRC"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a75cbf139e2726fff49c6c22f5eddf499"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FiniteElementE" title="dolfinx::fem::FiniteElement"><span class="n"><span class="pre">FiniteElement</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">extract_sub_element</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">component</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FiniteElement19extract_sub_elementERKNSt6vectorIiEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Extract sub finite element for component. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FiniteElement8map_typeEv">
<span id="_CPPv3NK7dolfinx3fem13FiniteElement8map_typeEv"></span><span id="_CPPv2NK7dolfinx3fem13FiniteElement8map_typeEv"></span><span id="dolfinx::fem::FiniteElement::map_typeC"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a1ea0e3c46b6922df927b7a7f9e282543"></span><span class="n"><span class="pre">basix</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">maps</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">type</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">map_type</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FiniteElement8map_typeEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the map type used by the element. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FiniteElement19interpolation_identEv">
<span id="_CPPv3NK7dolfinx3fem13FiniteElement19interpolation_identEv"></span><span id="_CPPv2NK7dolfinx3fem13FiniteElement19interpolation_identEv"></span><span id="dolfinx::fem::FiniteElement::interpolation_identC"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1ae813cd4de1512a7c830fa06928e54a5c"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">interpolation_ident</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FiniteElement19interpolation_identEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Check if interpolation into the finite element space is an identity operation given the evaluation on an expression at specific points, i.e. the degree-of-freedom are equal to point evaluations. The function will return <code class="docutils literal notranslate"><span class="pre">true</span></code> for Lagrange elements. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if interpolation is an identity operation </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FiniteElement20interpolation_pointsEv">
<span id="_CPPv3NK7dolfinx3fem13FiniteElement20interpolation_pointsEv"></span><span id="_CPPv2NK7dolfinx3fem13FiniteElement20interpolation_pointsEv"></span><span id="dolfinx::fem::FiniteElement::interpolation_pointsC"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a0c379c8cd3ec7e04e5c204aa96012c02"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xt</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">xtensor</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">interpolation_points</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FiniteElement20interpolation_pointsEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Points on the reference cell at which an expression need to be evaluated in order to interpolate the expression in the finite element space. For Lagrange elements the points will just be the nodal positions. For other elements the points will typically be the quadrature points used to evaluate moment degrees of freedom. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Points on the reference cell. Shape is (num_points, tdim). </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FiniteElement22interpolation_operatorEv">
<span id="_CPPv3NK7dolfinx3fem13FiniteElement22interpolation_operatorEv"></span><span id="_CPPv2NK7dolfinx3fem13FiniteElement22interpolation_operatorEv"></span><span id="dolfinx::fem::FiniteElement::interpolation_operatorC"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a595a1ec8cfa65eead279fa2997d2da73"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xt</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">xtensor</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">interpolation_operator</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FiniteElement22interpolation_operatorEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Interpolation operator (matrix) <code class="docutils literal notranslate"><span class="pre">Pi</span></code> that maps a function evaluated at the points provided by <a class="reference internal" href="#df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a0c379c8cd3ec7e04e5c204aa96012c02"><span class="std std-ref">FiniteElement::interpolation_points</span></a> to the element degrees of freedom, i.e. dofs = Pi f_x. See the Basix documentation for basix::FiniteElement::interpolation_matrix for how the data in <code class="docutils literal notranslate"><span class="pre">f_x</span></code> should be ordered. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The interpolation operator <code class="docutils literal notranslate"><span class="pre">Pi</span></code>. Shape is (num_dofs, num_points*value_size) </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FiniteElement29create_interpolation_operatorERK13FiniteElement">
<span id="_CPPv3NK7dolfinx3fem13FiniteElement29create_interpolation_operatorERK13FiniteElement"></span><span id="_CPPv2NK7dolfinx3fem13FiniteElement29create_interpolation_operatorERK13FiniteElement"></span><span id="dolfinx::fem::FiniteElement::create_interpolation_operator__FiniteElementCRC"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1abaf6ae5e648775dbcf7d9d9e0ac00e7c"></span><span class="n"><span class="pre">xt</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">xtensor</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">create_interpolation_operator</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FiniteElementE" title="dolfinx::fem::FiniteElement"><span class="n"><span class="pre">FiniteElement</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">from</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FiniteElement29create_interpolation_operatorERK13FiniteElement" title="Permalink to this definition"></a><br /></dt>
<dd><p>Create a matrix that maps degrees of freedom from one element to this element (interpolation). </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The two elements must use the same mapping between the reference and physical cells </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Does not support mixed elements </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>from</strong> – <strong>[in]</strong> The element to interpolate from </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Matrix operator that maps the <code class="docutils literal notranslate"><span class="pre">from</span></code> degrees-of-freedom to the degrees-of-freedom of this element. Shape is (num_dofs of this element, num_dofs of <code class="docutils literal notranslate"><span class="pre">from</span></code>). </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FiniteElement25needs_dof_transformationsEv">
<span id="_CPPv3NK7dolfinx3fem13FiniteElement25needs_dof_transformationsEv"></span><span id="_CPPv2NK7dolfinx3fem13FiniteElement25needs_dof_transformationsEv"></span><span id="dolfinx::fem::FiniteElement::needs_dof_transformationsC"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a42dab99126ab3dbc778779339f0dee55"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">needs_dof_transformations</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FiniteElement25needs_dof_transformationsEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Check if DOF transformations are needed for this element. </p>
<p>DOF transformations will be needed for elements which might not be continuous when two neighbouring cells disagree on the orientation of a shared subentity, and when this cannot be corrected for by permuting the DOF numbering in the dofmap.</p>
<p>For example, Raviart-Thomas elements will need DOF transformations, as the neighbouring cells may disagree on the orientation of a basis function, and this orientation cannot be corrected for by permuting the DOF numbers on each cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if DOF transformations are required </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FiniteElement22needs_dof_permutationsEv">
<span id="_CPPv3NK7dolfinx3fem13FiniteElement22needs_dof_permutationsEv"></span><span id="_CPPv2NK7dolfinx3fem13FiniteElement22needs_dof_permutationsEv"></span><span id="dolfinx::fem::FiniteElement::needs_dof_permutationsC"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a537fdd7e0f98c10bd48ef5a6c2996ce9"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">needs_dof_permutations</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FiniteElement22needs_dof_permutationsEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Check if DOF permutations are needed for this element. </p>
<p>DOF permutations will be needed for elements which might not be continuous when two neighbouring cells disagree on the orientation of a shared subentity, and when this can be corrected for by permuting the DOF numbering in the dofmap.</p>
<p>For example, higher order Lagrange elements will need DOF permutations, as the arrangement of DOFs on a shared subentity may be different from the point of view of neighbouring cells, and this can be corrected for by permuting the DOF numbers on each cell.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if DOF transformations are required </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0ENK7dolfinx3fem13FiniteElement31get_dof_transformation_functionENSt8functionIFvRKN3xtl4spanI1TEERKN3xtl4spanIKNSt8uint32_tEEENSt7int32_tEiEEEbbb">
<span id="_CPPv3I0ENK7dolfinx3fem13FiniteElement31get_dof_transformation_functionEbbb"></span><span id="_CPPv2I0ENK7dolfinx3fem13FiniteElement31get_dof_transformation_functionEbbb"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a6bd480f492630f88c85617e55265b512"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">void</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0ENK7dolfinx3fem13FiniteElement31get_dof_transformation_functionENSt8functionIFvRKN3xtl4spanI1TEERKN3xtl4spanIKNSt8uint32_tEEENSt7int32_tEiEEEbbb" title="dolfinx::fem::FiniteElement::get_dof_transformation_function::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_dof_transformation_function</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">inverse</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">transpose</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">scalar_element</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4I0ENK7dolfinx3fem13FiniteElement31get_dof_transformation_functionENSt8functionIFvRKN3xtl4spanI1TEERKN3xtl4spanIKNSt8uint32_tEEENSt7int32_tEiEEEbbb" title="Permalink to this definition"></a><br /></dt>
<dd><p>Return a function that applies DOF transformation to some data. </p>
<p>The returned function will take four inputs:<ul class="simple">
<li><p>[in,out] data The data to be transformed. This data is flattened with row-major layout, shape=(num_dofs, block_size)</p></li>
<li><p>[in] cell_info Permutation data for the cell. The size of this is num_cells. For elements where no transformations are required, an empty span can be passed in.</p></li>
<li><p>[in] cell The cell number</p></li>
<li><p>[in] block_size The block_size of the input data</p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inverse</strong> – <strong>[in]</strong> Indicates whether the inverse transformations should be returned </p></li>
<li><p><strong>transpose</strong> – <strong>[in]</strong> Indicates whether the transpose transformations should be returned </p></li>
<li><p><strong>scalar_element</strong> – <strong>[in]</strong> Indicates whether the scalar transformations should be returned for a vector element </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0ENK7dolfinx3fem13FiniteElement44get_dof_transformation_to_transpose_functionENSt8functionIFvRKN3xtl4spanI1TEERKN3xtl4spanIKNSt8uint32_tEEENSt7int32_tEiEEEbbb">
<span id="_CPPv3I0ENK7dolfinx3fem13FiniteElement44get_dof_transformation_to_transpose_functionEbbb"></span><span id="_CPPv2I0ENK7dolfinx3fem13FiniteElement44get_dof_transformation_to_transpose_functionEbbb"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a048a77298c2672c497d698ed72dfcfd7"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">void</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0ENK7dolfinx3fem13FiniteElement44get_dof_transformation_to_transpose_functionENSt8functionIFvRKN3xtl4spanI1TEERKN3xtl4spanIKNSt8uint32_tEEENSt7int32_tEiEEEbbb" title="dolfinx::fem::FiniteElement::get_dof_transformation_to_transpose_function::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_dof_transformation_to_transpose_function</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">inverse</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">transpose</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">scalar_element</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4I0ENK7dolfinx3fem13FiniteElement44get_dof_transformation_to_transpose_functionENSt8functionIFvRKN3xtl4spanI1TEERKN3xtl4spanIKNSt8uint32_tEEENSt7int32_tEiEEEbbb" title="Permalink to this definition"></a><br /></dt>
<dd><p>Return a function that applies DOF transformation to some transposed data. </p>
<p>The returned function will take three inputs:<ul class="simple">
<li><p>[in,out] data The data to be transformed. This data is flattened with row-major layout, shape=(num_dofs, block_size)</p></li>
<li><p>[in] cell_info Permutation data for the cell. The size of this is num_cells. For elements where no transformations are required, an empty span can be passed in.</p></li>
<li><p>[in] cell The cell number</p></li>
<li><p>[in] block_size The block_size of the input data</p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inverse</strong> – <strong>[in]</strong> Indicates whether the inverse transformations should be returned </p></li>
<li><p><strong>transpose</strong> – <strong>[in]</strong> Indicates whether the transpose transformations should be returned </p></li>
<li><p><strong>scalar_element</strong> – <strong>[in]</strong> Indicated whether the scalar transformations should be returned for a vector element </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0ENK7dolfinx3fem13FiniteElement24apply_dof_transformationEvRKN3xtl4spanI1TEENSt8uint32_tEi">
<span id="_CPPv3I0ENK7dolfinx3fem13FiniteElement24apply_dof_transformationERKN3xtl4spanI1TEENSt8uint32_tEi"></span><span id="_CPPv2I0ENK7dolfinx3fem13FiniteElement24apply_dof_transformationERKN3xtl4spanI1TEENSt8uint32_tEi"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a726a04840c95094a49db469e12153bc1"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">apply_dof_transformation</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0ENK7dolfinx3fem13FiniteElement24apply_dof_transformationEvRKN3xtl4spanI1TEENSt8uint32_tEi" title="dolfinx::fem::FiniteElement::apply_dof_transformation::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">cell_permutation</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">block_size</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4I0ENK7dolfinx3fem13FiniteElement24apply_dof_transformationEvRKN3xtl4spanI1TEENSt8uint32_tEi" title="Permalink to this definition"></a><br /></dt>
<dd><p>Apply DOF transformation to some data. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – <strong>[inout]</strong> The data to be transformed. This data is flattened with row-major layout, shape=(num_dofs, block_size) </p></li>
<li><p><strong>cell_permutation</strong> – <strong>[in]</strong> Permutation data for the cell </p></li>
<li><p><strong>block_size</strong> – <strong>[in]</strong> The block_size of the input data </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0ENK7dolfinx3fem13FiniteElement42apply_inverse_transpose_dof_transformationEvRKN3xtl4spanI1TEENSt8uint32_tEi">
<span id="_CPPv3I0ENK7dolfinx3fem13FiniteElement42apply_inverse_transpose_dof_transformationERKN3xtl4spanI1TEENSt8uint32_tEi"></span><span id="_CPPv2I0ENK7dolfinx3fem13FiniteElement42apply_inverse_transpose_dof_transformationERKN3xtl4spanI1TEENSt8uint32_tEi"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a5068162424df8f1fa3e6b6e3b0cdd5a8"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">apply_inverse_transpose_dof_transformation</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0ENK7dolfinx3fem13FiniteElement42apply_inverse_transpose_dof_transformationEvRKN3xtl4spanI1TEENSt8uint32_tEi" title="dolfinx::fem::FiniteElement::apply_inverse_transpose_dof_transformation::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">cell_permutation</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">block_size</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4I0ENK7dolfinx3fem13FiniteElement42apply_inverse_transpose_dof_transformationEvRKN3xtl4spanI1TEENSt8uint32_tEi" title="Permalink to this definition"></a><br /></dt>
<dd><p>Apply inverse transpose transformation to some data. For VectorElements, this applies the transformations for the scalar subelement. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – <strong>[inout]</strong> The data to be transformed. This data is flattened with row-major layout, shape=(num_dofs, block_size) </p></li>
<li><p><strong>cell_permutation</strong> – <strong>[in]</strong> Permutation data for the cell </p></li>
<li><p><strong>block_size</strong> – <strong>[in]</strong> The block_size of the input data </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0ENK7dolfinx3fem13FiniteElement34apply_transpose_dof_transformationEvRKN3xtl4spanI1TEENSt8uint32_tEi">
<span id="_CPPv3I0ENK7dolfinx3fem13FiniteElement34apply_transpose_dof_transformationERKN3xtl4spanI1TEENSt8uint32_tEi"></span><span id="_CPPv2I0ENK7dolfinx3fem13FiniteElement34apply_transpose_dof_transformationERKN3xtl4spanI1TEENSt8uint32_tEi"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1ac29ff5d1e1c443033c3dfafc1d7b1e38"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">apply_transpose_dof_transformation</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0ENK7dolfinx3fem13FiniteElement34apply_transpose_dof_transformationEvRKN3xtl4spanI1TEENSt8uint32_tEi" title="dolfinx::fem::FiniteElement::apply_transpose_dof_transformation::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">cell_permutation</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">block_size</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4I0ENK7dolfinx3fem13FiniteElement34apply_transpose_dof_transformationEvRKN3xtl4spanI1TEENSt8uint32_tEi" title="Permalink to this definition"></a><br /></dt>
<dd><p>Apply transpose transformation to some data. For VectorElements, this applies the transformations for the scalar subelement. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – <strong>[inout]</strong> The data to be transformed. This data is flattened with row-major layout, shape=(num_dofs, block_size) </p></li>
<li><p><strong>cell_permutation</strong> – <strong>[in]</strong> Permutation data for the cell </p></li>
<li><p><strong>block_size</strong> – <strong>[in]</strong> The block_size of the input data </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0ENK7dolfinx3fem13FiniteElement32apply_inverse_dof_transformationEvRKN3xtl4spanI1TEENSt8uint32_tEi">
<span id="_CPPv3I0ENK7dolfinx3fem13FiniteElement32apply_inverse_dof_transformationERKN3xtl4spanI1TEENSt8uint32_tEi"></span><span id="_CPPv2I0ENK7dolfinx3fem13FiniteElement32apply_inverse_dof_transformationERKN3xtl4spanI1TEENSt8uint32_tEi"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1abbe6c5c9d801550065467e5d79c65fe7"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">apply_inverse_dof_transformation</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0ENK7dolfinx3fem13FiniteElement32apply_inverse_dof_transformationEvRKN3xtl4spanI1TEENSt8uint32_tEi" title="dolfinx::fem::FiniteElement::apply_inverse_dof_transformation::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">cell_permutation</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">block_size</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4I0ENK7dolfinx3fem13FiniteElement32apply_inverse_dof_transformationEvRKN3xtl4spanI1TEENSt8uint32_tEi" title="Permalink to this definition"></a><br /></dt>
<dd><p>Apply inverse transformation to some data. For VectorElements, this applies the transformations for the scalar subelement. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – <strong>[inout]</strong> The data to be transformed. This data is flattened with row-major layout, shape=(num_dofs, block_size) </p></li>
<li><p><strong>cell_permutation</strong> – <strong>[in]</strong> Permutation data for the cell </p></li>
<li><p><strong>block_size</strong> – <strong>[in]</strong> The block_size of the input data </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0ENK7dolfinx3fem13FiniteElement37apply_dof_transformation_to_transposeEvRKN3xtl4spanI1TEENSt8uint32_tEi">
<span id="_CPPv3I0ENK7dolfinx3fem13FiniteElement37apply_dof_transformation_to_transposeERKN3xtl4spanI1TEENSt8uint32_tEi"></span><span id="_CPPv2I0ENK7dolfinx3fem13FiniteElement37apply_dof_transformation_to_transposeERKN3xtl4spanI1TEENSt8uint32_tEi"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a8b50cd04bea9684e3bf35163393bed26"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">apply_dof_transformation_to_transpose</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0ENK7dolfinx3fem13FiniteElement37apply_dof_transformation_to_transposeEvRKN3xtl4spanI1TEENSt8uint32_tEi" title="dolfinx::fem::FiniteElement::apply_dof_transformation_to_transpose::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">cell_permutation</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">block_size</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4I0ENK7dolfinx3fem13FiniteElement37apply_dof_transformation_to_transposeEvRKN3xtl4spanI1TEENSt8uint32_tEi" title="Permalink to this definition"></a><br /></dt>
<dd><p>Apply DOF transformation to some transposed data. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – <strong>[inout]</strong> The data to be transformed. This data is flattened with row-major layout, shape=(num_dofs, block_size) </p></li>
<li><p><strong>cell_permutation</strong> – <strong>[in]</strong> Permutation data for the cell </p></li>
<li><p><strong>block_size</strong> – <strong>[in]</strong> The block_size of the input data </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0ENK7dolfinx3fem13FiniteElement45apply_inverse_dof_transformation_to_transposeEvRKN3xtl4spanI1TEENSt8uint32_tEi">
<span id="_CPPv3I0ENK7dolfinx3fem13FiniteElement45apply_inverse_dof_transformation_to_transposeERKN3xtl4spanI1TEENSt8uint32_tEi"></span><span id="_CPPv2I0ENK7dolfinx3fem13FiniteElement45apply_inverse_dof_transformation_to_transposeERKN3xtl4spanI1TEENSt8uint32_tEi"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a487d8618b63e9510acded5b2d0251ee2"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">apply_inverse_dof_transformation_to_transpose</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0ENK7dolfinx3fem13FiniteElement45apply_inverse_dof_transformation_to_transposeEvRKN3xtl4spanI1TEENSt8uint32_tEi" title="dolfinx::fem::FiniteElement::apply_inverse_dof_transformation_to_transpose::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">cell_permutation</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">block_size</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4I0ENK7dolfinx3fem13FiniteElement45apply_inverse_dof_transformation_to_transposeEvRKN3xtl4spanI1TEENSt8uint32_tEi" title="Permalink to this definition"></a><br /></dt>
<dd><p>Apply inverse of DOF transformation to some transposed data. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – <strong>[inout]</strong> The data to be transformed. This data is flattened with row-major layout, shape=(num_dofs, block_size) </p></li>
<li><p><strong>cell_permutation</strong> – <strong>[in]</strong> Permutation data for the cell </p></li>
<li><p><strong>block_size</strong> – <strong>[in]</strong> The block_size of the input data </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0ENK7dolfinx3fem13FiniteElement47apply_transpose_dof_transformation_to_transposeEvRKN3xtl4spanI1TEENSt8uint32_tEi">
<span id="_CPPv3I0ENK7dolfinx3fem13FiniteElement47apply_transpose_dof_transformation_to_transposeERKN3xtl4spanI1TEENSt8uint32_tEi"></span><span id="_CPPv2I0ENK7dolfinx3fem13FiniteElement47apply_transpose_dof_transformation_to_transposeERKN3xtl4spanI1TEENSt8uint32_tEi"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a3fa3fa1cc0f84e22469419d7e2e68f23"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">apply_transpose_dof_transformation_to_transpose</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0ENK7dolfinx3fem13FiniteElement47apply_transpose_dof_transformation_to_transposeEvRKN3xtl4spanI1TEENSt8uint32_tEi" title="dolfinx::fem::FiniteElement::apply_transpose_dof_transformation_to_transpose::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">cell_permutation</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">block_size</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4I0ENK7dolfinx3fem13FiniteElement47apply_transpose_dof_transformation_to_transposeEvRKN3xtl4spanI1TEENSt8uint32_tEi" title="Permalink to this definition"></a><br /></dt>
<dd><p>Apply transpose of transformation to some transposed data. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – <strong>[inout]</strong> The data to be transformed. This data is flattened with row-major layout, shape=(num_dofs, block_size) </p></li>
<li><p><strong>cell_permutation</strong> – <strong>[in]</strong> Permutation data for the cell </p></li>
<li><p><strong>block_size</strong> – <strong>[in]</strong> The block_size of the input data </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0ENK7dolfinx3fem13FiniteElement55apply_inverse_transpose_dof_transformation_to_transposeEvRKN3xtl4spanI1TEENSt8uint32_tEi">
<span id="_CPPv3I0ENK7dolfinx3fem13FiniteElement55apply_inverse_transpose_dof_transformation_to_transposeERKN3xtl4spanI1TEENSt8uint32_tEi"></span><span id="_CPPv2I0ENK7dolfinx3fem13FiniteElement55apply_inverse_transpose_dof_transformation_to_transposeERKN3xtl4spanI1TEENSt8uint32_tEi"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a5c95249c2785228d123bf35c48c2d4c2"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">apply_inverse_transpose_dof_transformation_to_transpose</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0ENK7dolfinx3fem13FiniteElement55apply_inverse_transpose_dof_transformation_to_transposeEvRKN3xtl4spanI1TEENSt8uint32_tEi" title="dolfinx::fem::FiniteElement::apply_inverse_transpose_dof_transformation_to_transpose::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">cell_permutation</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">block_size</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4I0ENK7dolfinx3fem13FiniteElement55apply_inverse_transpose_dof_transformation_to_transposeEvRKN3xtl4spanI1TEENSt8uint32_tEi" title="Permalink to this definition"></a><br /></dt>
<dd><p>Apply inverse transpose transformation to some transposed data. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – <strong>[inout]</strong> The data to be transformed. This data is flattened with row-major layout, shape=(num_dofs, block_size) </p></li>
<li><p><strong>cell_permutation</strong> – <strong>[in]</strong> Permutation data for the cell </p></li>
<li><p><strong>block_size</strong> – <strong>[in]</strong> The block_size of the input data </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FiniteElement12permute_dofsERKN3xtl4spanINSt7int32_tEEENSt8uint32_tE">
<span id="_CPPv3NK7dolfinx3fem13FiniteElement12permute_dofsERKN3xtl4spanINSt7int32_tEEENSt8uint32_tE"></span><span id="_CPPv2NK7dolfinx3fem13FiniteElement12permute_dofsERKN3xtl4spanINSt7int32_tEEENSt8uint32_tE"></span><span id="dolfinx::fem::FiniteElement::permute_dofs__xtl::span:std::int32_t:CR.std::uint32_tC"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a51efe81a6ca588b565b926a4b0966a85"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">permute_dofs</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">doflist</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">cell_permutation</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FiniteElement12permute_dofsERKN3xtl4spanINSt7int32_tEEENSt8uint32_tE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Permute the DOFs of the element. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>doflist</strong> – <strong>[inout]</strong> The numbers of the DOFs, a span of length num_dofs </p></li>
<li><p><strong>cell_permutation</strong> – <strong>[in]</strong> Permutation data for the cell </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FiniteElement14unpermute_dofsERKN3xtl4spanINSt7int32_tEEENSt8uint32_tE">
<span id="_CPPv3NK7dolfinx3fem13FiniteElement14unpermute_dofsERKN3xtl4spanINSt7int32_tEEENSt8uint32_tE"></span><span id="_CPPv2NK7dolfinx3fem13FiniteElement14unpermute_dofsERKN3xtl4spanINSt7int32_tEEENSt8uint32_tE"></span><span id="dolfinx::fem::FiniteElement::unpermute_dofs__xtl::span:std::int32_t:CR.std::uint32_tC"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1ac3ac80732d9edb77d94ad18fabe883e7"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">unpermute_dofs</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">doflist</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">cell_permutation</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FiniteElement14unpermute_dofsERKN3xtl4spanINSt7int32_tEEENSt8uint32_tE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Unpermute the DOFs of the element. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>doflist</strong> – <strong>[inout]</strong> The numbers of the DOFs, a span of length num_dofs </p></li>
<li><p><strong>cell_permutation</strong> – <strong>[in]</strong> Permutation data for the cell </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FiniteElement28get_dof_permutation_functionEbb">
<span id="_CPPv3NK7dolfinx3fem13FiniteElement28get_dof_permutation_functionEbb"></span><span id="_CPPv2NK7dolfinx3fem13FiniteElement28get_dof_permutation_functionEbb"></span><span id="dolfinx::fem::FiniteElement::get_dof_permutation_function__b.bC"></span><span class="target" id="df/d27/classdolfinx_1_1fem_1_1FiniteElement_1abc9f5b0e84f5e80b1291d47f0001b136"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">void</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_dof_permutation_function</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">inverse</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">scalar_element</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">false</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FiniteElement28get_dof_permutation_functionEbb" title="Permalink to this definition"></a><br /></dt>
<dd><p>Return a function that applies DOF permutation to some data. </p>
<p>The returned function will take three inputs:<ul class="simple">
<li><p>[in,out] doflist The numbers of the DOFs, a span of length num_dofs</p></li>
<li><p>[in] cell_permutation Permutation data for the cell</p></li>
<li><p>[in] block_size The block_size of the input data</p></li>
</ul>
</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inverse</strong> – <strong>[in]</strong> Indicates whether the inverse transformations should be returned </p></li>
<li><p><strong>scalar_element</strong> – <strong>[in]</strong> Indicated whether the scalar transformations should be returned for a vector element </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="function-spaces-and-functions">
<h2>Function spaces and functions<a class="headerlink" href="#function-spaces-and-functions" title="Permalink to this headline"></a></h2>
<p>Finite element functions, expressions and constants</p>
<section id="function-spaces">
<h3>Function spaces<a class="headerlink" href="#function-spaces" title="Permalink to this headline"></a></h3>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem13FunctionSpaceE">
<span id="_CPPv3N7dolfinx3fem13FunctionSpaceE"></span><span id="_CPPv2N7dolfinx3fem13FunctionSpaceE"></span><span id="dolfinx::fem::FunctionSpace"></span><span class="target" id="d9/d69/classdolfinx_1_1fem_1_1FunctionSpace"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">dolfinx</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">FunctionSpace</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx3fem13FunctionSpaceE" title="Permalink to this definition"></a><br /></dt>
<dd><p>This class represents a finite element function space defined by a mesh, a finite element, and a local-to-global map of the degrees of freedom (dofmap). </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem13FunctionSpace13FunctionSpaceENSt10shared_ptrIKN4mesh4MeshEEENSt10shared_ptrIKN3fem13FiniteElementEEENSt10shared_ptrIKN3fem6DofMapEEE">
<span id="_CPPv3N7dolfinx3fem13FunctionSpace13FunctionSpaceENSt10shared_ptrIKN4mesh4MeshEEENSt10shared_ptrIKN3fem13FiniteElementEEENSt10shared_ptrIKN3fem6DofMapEEE"></span><span id="_CPPv2N7dolfinx3fem13FunctionSpace13FunctionSpaceENSt10shared_ptrIKN4mesh4MeshEEENSt10shared_ptrIKN3fem13FiniteElementEEENSt10shared_ptrIKN3fem6DofMapEEE"></span><span id="dolfinx::fem::FunctionSpace::FunctionSpace__std::shared_ptr:mesh::MeshC:.std::shared_ptr:fem::FiniteElementC:.std::shared_ptr:fem::DofMapC:"></span><span class="target" id="d9/d69/classdolfinx_1_1fem_1_1FunctionSpace_1a6448b651af8e0ee0ebbb41c1f5551acf"></span><span class="sig-name descname"><span class="n"><span class="pre">FunctionSpace</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FunctionSpace13FunctionSpaceENSt10shared_ptrIKN4mesh4MeshEEENSt10shared_ptrIKN3fem13FiniteElementEEENSt10shared_ptrIKN3fem6DofMapEEE" title="dolfinx::fem::FunctionSpace::FunctionSpace::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Mesh</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">mesh</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FiniteElementE" title="dolfinx::fem::FiniteElement"><span class="n"><span class="pre">FiniteElement</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">element</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N7dolfinx3fem6DofMapE" title="dolfinx::fem::DofMap"><span class="n"><span class="pre">DofMap</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dofmap</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx3fem13FunctionSpace13FunctionSpaceENSt10shared_ptrIKN4mesh4MeshEEENSt10shared_ptrIKN3fem13FiniteElementEEENSt10shared_ptrIKN3fem6DofMapEEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Create function space for given mesh, element and dofmap. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – <strong>[in]</strong> The mesh </p></li>
<li><p><strong>element</strong> – <strong>[in]</strong> The element </p></li>
<li><p><strong>dofmap</strong> – <strong>[in]</strong> The dofmap </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem13FunctionSpace13FunctionSpaceERR13FunctionSpace">
<span id="_CPPv3N7dolfinx3fem13FunctionSpace13FunctionSpaceERR13FunctionSpace"></span><span id="_CPPv2N7dolfinx3fem13FunctionSpace13FunctionSpaceERR13FunctionSpace"></span><span id="dolfinx::fem::FunctionSpace::FunctionSpace__FunctionSpaceRR"></span><span class="target" id="d9/d69/classdolfinx_1_1fem_1_1FunctionSpace_1aec1d15d338fcf9ba8eeed7c223383bbd"></span><span class="sig-name descname"><span class="n"><span class="pre">FunctionSpace</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FunctionSpace13FunctionSpaceERR13FunctionSpace" title="dolfinx::fem::FunctionSpace::FunctionSpace"><span class="n"><span class="pre">FunctionSpace</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">V</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx3fem13FunctionSpace13FunctionSpaceERR13FunctionSpace" title="Permalink to this definition"></a><br /></dt>
<dd><p>Move constructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem13FunctionSpaceD0Ev">
<span id="_CPPv3N7dolfinx3fem13FunctionSpaceD0Ev"></span><span id="_CPPv2N7dolfinx3fem13FunctionSpaceD0Ev"></span><span id="dolfinx::fem::FunctionSpace::~FunctionSpace"></span><span class="target" id="d9/d69/classdolfinx_1_1fem_1_1FunctionSpace_1a853ffbbacf012db17510105aa4907544"></span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">~FunctionSpace</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx3fem13FunctionSpaceD0Ev" title="Permalink to this definition"></a><br /></dt>
<dd><p>Destructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem13FunctionSpaceaSERR13FunctionSpace">
<span id="_CPPv3N7dolfinx3fem13FunctionSpaceaSERR13FunctionSpace"></span><span id="_CPPv2N7dolfinx3fem13FunctionSpaceaSERR13FunctionSpace"></span><span id="dolfinx::fem::FunctionSpace::assign-operator__FunctionSpaceRR"></span><span class="target" id="d9/d69/classdolfinx_1_1fem_1_1FunctionSpace_1ac012a7b961cb1e6aec2fb63d4d4090dd"></span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FunctionSpaceE" title="dolfinx::fem::FunctionSpace"><span class="n"><span class="pre">FunctionSpace</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FunctionSpaceE" title="dolfinx::fem::FunctionSpace"><span class="n"><span class="pre">FunctionSpace</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">V</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx3fem13FunctionSpaceaSERR13FunctionSpace" title="Permalink to this definition"></a><br /></dt>
<dd><p>Move assignment operator. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FunctionSpace3subERKNSt6vectorIiEE">
<span id="_CPPv3NK7dolfinx3fem13FunctionSpace3subERKNSt6vectorIiEE"></span><span id="_CPPv2NK7dolfinx3fem13FunctionSpace3subERKNSt6vectorIiEE"></span><span id="dolfinx::fem::FunctionSpace::sub__std::vector:i:CRC"></span><span class="target" id="d9/d69/classdolfinx_1_1fem_1_1FunctionSpace_1ad445d58291d3fc2809b5759327ccf1ad"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FunctionSpaceE" title="dolfinx::fem::FunctionSpace"><span class="n"><span class="pre">FunctionSpace</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sub</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">component</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FunctionSpace3subERKNSt6vectorIiEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Extract subspace for component. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>component</strong> – <strong>[in]</strong> The subspace component </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The subspace </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FunctionSpace8containsERK13FunctionSpace">
<span id="_CPPv3NK7dolfinx3fem13FunctionSpace8containsERK13FunctionSpace"></span><span id="_CPPv2NK7dolfinx3fem13FunctionSpace8containsERK13FunctionSpace"></span><span id="dolfinx::fem::FunctionSpace::contains__FunctionSpaceCRC"></span><span class="target" id="d9/d69/classdolfinx_1_1fem_1_1FunctionSpace_1a6a9bb21afbfdef687dbf91cc218df37c"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">contains</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FunctionSpaceE" title="dolfinx::fem::FunctionSpace"><span class="n"><span class="pre">FunctionSpace</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">V</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FunctionSpace8containsERK13FunctionSpace" title="Permalink to this definition"></a><br /></dt>
<dd><p>Check whether V is subspace of this, or this itself. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>V</strong> – <strong>[in]</strong> The space to be tested for inclusion </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if V is contained in or is equal to this <a class="reference internal" href="#d9/d69/classdolfinx_1_1fem_1_1FunctionSpace"><span class="std std-ref">FunctionSpace</span></a> </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FunctionSpace8collapseEv">
<span id="_CPPv3NK7dolfinx3fem13FunctionSpace8collapseEv"></span><span id="_CPPv2NK7dolfinx3fem13FunctionSpace8collapseEv"></span><span id="dolfinx::fem::FunctionSpace::collapseC"></span><span class="target" id="d9/d69/classdolfinx_1_1fem_1_1FunctionSpace_1a23aef51a7f01e31f2687fd3954bfb394"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FunctionSpaceE" title="dolfinx::fem::FunctionSpace"><span class="n"><span class="pre">FunctionSpace</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">collapse</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FunctionSpace8collapseEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Collapse a subspace and return a new function space and a map from new to old dofs. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The new function space and a map from new to old dofs </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FunctionSpace9componentEv">
<span id="_CPPv3NK7dolfinx3fem13FunctionSpace9componentEv"></span><span id="_CPPv2NK7dolfinx3fem13FunctionSpace9componentEv"></span><span id="dolfinx::fem::FunctionSpace::componentC"></span><span class="target" id="d9/d69/classdolfinx_1_1fem_1_1FunctionSpace_1a01fa5339ea2f35a1507757de55c47c25"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">component</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FunctionSpace9componentEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the component with respect to the root superspace. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The component with respect to the root superspace , i.e. W.sub(1).sub(0) == [1, 0] </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FunctionSpace24tabulate_dof_coordinatesEb">
<span id="_CPPv3NK7dolfinx3fem13FunctionSpace24tabulate_dof_coordinatesEb"></span><span id="_CPPv2NK7dolfinx3fem13FunctionSpace24tabulate_dof_coordinatesEb"></span><span id="dolfinx::fem::FunctionSpace::tabulate_dof_coordinates__bC"></span><span class="target" id="d9/d69/classdolfinx_1_1fem_1_1FunctionSpace_1a22a539ad6911f32073a71178264c77e1"></span><span class="n"><span class="pre">xt</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">xtensor</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tabulate_dof_coordinates</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">transpose</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FunctionSpace24tabulate_dof_coordinatesEb" title="Permalink to this definition"></a><br /></dt>
<dd><p>Tabulate the physical coordinates of all dofs on this process. </p>
<p><dl>
<dt class="sig sig-object cpp">
<em><span class="pre">Todo:</span></em></dt>
<dd><p>Remove - see function in interpolate.h </p>
</dd></dl>

</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>transpose</strong> – <strong>[in]</strong> If false the returned data has shape <code class="docutils literal notranslate"><span class="pre">(num_points,</span> <span class="pre">gdim)</span></code>, otherwise it is transposed and has shape <code class="docutils literal notranslate"><span class="pre">(gdim,</span> <span class="pre">num_points)</span></code> </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The dof coordinates <code class="docutils literal notranslate"><span class="pre">[([x0,</span> <span class="pre">y0,</span> <span class="pre">z0],</span> <span class="pre">[x1,</span> <span class="pre">y1,</span> <span class="pre">z1],</span> <span class="pre">...)</span></code> if <code class="docutils literal notranslate"><span class="pre">transpose</span></code> is false, and otherwise the returned data is transposed. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FunctionSpace4meshEv">
<span id="_CPPv3NK7dolfinx3fem13FunctionSpace4meshEv"></span><span id="_CPPv2NK7dolfinx3fem13FunctionSpace4meshEv"></span><span id="dolfinx::fem::FunctionSpace::meshC"></span><span class="target" id="d9/d69/classdolfinx_1_1fem_1_1FunctionSpace_1aaf6972694493b8326d009747e106c54e"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4NK7dolfinx3fem13FunctionSpace4meshEv" title="dolfinx::fem::FunctionSpace::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Mesh</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mesh</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FunctionSpace4meshEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>The mesh. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FunctionSpace7elementEv">
<span id="_CPPv3NK7dolfinx3fem13FunctionSpace7elementEv"></span><span id="_CPPv2NK7dolfinx3fem13FunctionSpace7elementEv"></span><span id="dolfinx::fem::FunctionSpace::elementC"></span><span class="target" id="d9/d69/classdolfinx_1_1fem_1_1FunctionSpace_1a61fc975778f3c14a67bb9ed0df4c8d95"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FiniteElementE" title="dolfinx::fem::FiniteElement"><span class="n"><span class="pre">FiniteElement</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">element</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FunctionSpace7elementEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>The finite element. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem13FunctionSpace6dofmapEv">
<span id="_CPPv3NK7dolfinx3fem13FunctionSpace6dofmapEv"></span><span id="_CPPv2NK7dolfinx3fem13FunctionSpace6dofmapEv"></span><span id="dolfinx::fem::FunctionSpace::dofmapC"></span><span class="target" id="d9/d69/classdolfinx_1_1fem_1_1FunctionSpace_1a5542d76bf4a3e653fdb822e0f38edfa1"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N7dolfinx3fem6DofMapE" title="dolfinx::fem::DofMap"><span class="n"><span class="pre">DofMap</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dofmap</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem13FunctionSpace6dofmapEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>The dofmap. </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Permalink to this headline"></a></h3>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4I0EN7dolfinx3fem8FunctionE">
<span id="_CPPv3I0EN7dolfinx3fem8FunctionE"></span><span id="_CPPv2I0EN7dolfinx3fem8FunctionE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d7/d76/classdolfinx_1_1fem_1_1Function"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">dolfinx</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">Function</span></span></span><a class="headerlink" href="#_CPPv4I0EN7dolfinx3fem8FunctionE" title="Permalink to this definition"></a><br /></dt>
<dd><p>This class represents a function <span class="math notranslate nohighlight">\( u_h \)</span> in a finite element function space <span class="math notranslate nohighlight">\( V_h \)</span>, given by. </p>
<p><div class="math notranslate nohighlight">
\[ u_h = \sum_{i=1}^{n} U_i \phi_i \]</div>
 where <span class="math notranslate nohighlight">\( \{\phi_i\}_{i=1}^{n} \)</span> is a basis for <span class="math notranslate nohighlight">\( V_h \)</span>, and <span class="math notranslate nohighlight">\( U \)</span> is a vector of expansion coefficients for <span class="math notranslate nohighlight">\( u_h \)</span>. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-types">Public Types</p>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem8Function10value_typeE">
<span id="_CPPv3N7dolfinx3fem8Function10value_typeE"></span><span id="_CPPv2N7dolfinx3fem8Function10value_typeE"></span><span class="target" id="d7/d76/classdolfinx_1_1fem_1_1Function_1afb9ded5f49336ae503bb9f2035ea902b"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_type</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8FunctionE" title="dolfinx::fem::Function::T"><span class="n"><span class="pre">T</span></span></a><a class="headerlink" href="#_CPPv4N7dolfinx3fem8Function10value_typeE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Field type for the <a class="reference internal" href="#d7/d76/classdolfinx_1_1fem_1_1Function"><span class="std std-ref">Function</span></a>, e.g. double. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem8Function8FunctionENSt10shared_ptrIK13FunctionSpaceEE">
<span id="_CPPv3N7dolfinx3fem8Function8FunctionENSt10shared_ptrIK13FunctionSpaceEE"></span><span id="_CPPv2N7dolfinx3fem8Function8FunctionENSt10shared_ptrIK13FunctionSpaceEE"></span><span id="dolfinx::fem::Function::Function__std::shared_ptr:FunctionSpaceC:"></span><span class="target" id="d7/d76/classdolfinx_1_1fem_1_1Function_1a9ba4ca537db2701060ff88c8efbfc52b"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">explicit</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Function</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FunctionSpaceE" title="dolfinx::fem::FunctionSpace"><span class="n"><span class="pre">FunctionSpace</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">V</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx3fem8Function8FunctionENSt10shared_ptrIK13FunctionSpaceEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Create function on given function space. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>V</strong> – <strong>[in]</strong> The function space </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem8Function8FunctionENSt10shared_ptrIK13FunctionSpaceEENSt10shared_ptrIN2la6VectorI1TEEEE">
<span id="_CPPv3N7dolfinx3fem8Function8FunctionENSt10shared_ptrIK13FunctionSpaceEENSt10shared_ptrIN2la6VectorI1TEEEE"></span><span id="_CPPv2N7dolfinx3fem8Function8FunctionENSt10shared_ptrIK13FunctionSpaceEENSt10shared_ptrIN2la6VectorI1TEEEE"></span><span id="dolfinx::fem::Function::Function__std::shared_ptr:FunctionSpaceC:.std::shared_ptr:la::Vector:T::"></span><span class="target" id="d7/d76/classdolfinx_1_1fem_1_1Function_1a29bf42749f378fb1af62d13689fb6fc4"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Function</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FunctionSpaceE" title="dolfinx::fem::FunctionSpace"><span class="n"><span class="pre">FunctionSpace</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">V</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="la.html#_CPPv4N7dolfinx2laE" title="dolfinx::la"><span class="n"><span class="pre">la</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="la.html#_CPPv4I00EN7dolfinx2la6VectorE" title="dolfinx::la::Vector"><span class="n"><span class="pre">Vector</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8FunctionE" title="dolfinx::fem::Function::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx3fem8Function8FunctionENSt10shared_ptrIK13FunctionSpaceEENSt10shared_ptrIN2la6VectorI1TEEEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Create function on given function space with a given vector. </p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This constructor is intended for internal library use only</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>V</strong> – <strong>[in]</strong> The function space </p></li>
<li><p><strong>x</strong> – <strong>[in]</strong> The vector </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem8Function8FunctionERR8Function">
<span id="_CPPv3N7dolfinx3fem8Function8FunctionERR8Function"></span><span id="_CPPv2N7dolfinx3fem8Function8FunctionERR8Function"></span><span id="dolfinx::fem::Function::Function__FunctionRR"></span><span class="target" id="d7/d76/classdolfinx_1_1fem_1_1Function_1ae44efb6d4841e4f36179410eb6890968"></span><span class="sig-name descname"><span class="n"><span class="pre">Function</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx3fem8Function8FunctionERR8Function" title="dolfinx::fem::Function::Function"><span class="n"><span class="pre">Function</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">v</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx3fem8Function8FunctionERR8Function" title="Permalink to this definition"></a><br /></dt>
<dd><p>Move constructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem8FunctionD0Ev">
<span id="_CPPv3N7dolfinx3fem8FunctionD0Ev"></span><span id="_CPPv2N7dolfinx3fem8FunctionD0Ev"></span><span id="dolfinx::fem::Function::~Function"></span><span class="target" id="d7/d76/classdolfinx_1_1fem_1_1Function_1ad5cc237b7e4c264a11f41d5b7bbf455a"></span><span class="sig-name descname"><span class="n"><span class="pre">~Function</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx3fem8FunctionD0Ev" title="Permalink to this definition"></a><br /></dt>
<dd><p>Destructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem8FunctionaSERR8Function">
<span id="_CPPv3N7dolfinx3fem8FunctionaSERR8Function"></span><span id="_CPPv2N7dolfinx3fem8FunctionaSERR8Function"></span><span id="dolfinx::fem::Function::assign-operator__FunctionRR"></span><span class="target" id="d7/d76/classdolfinx_1_1fem_1_1Function_1af9b3f52301a17aea6e72009dd328f0fc"></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8FunctionE" title="dolfinx::fem::Function"><span class="n"><span class="pre">Function</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8FunctionE" title="dolfinx::fem::Function"><span class="n"><span class="pre">Function</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">v</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx3fem8FunctionaSERR8Function" title="Permalink to this definition"></a><br /></dt>
<dd><p>Move assignment. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem8Function3subEi">
<span id="_CPPv3NK7dolfinx3fem8Function3subEi"></span><span id="_CPPv2NK7dolfinx3fem8Function3subEi"></span><span id="dolfinx::fem::Function::sub__iC"></span><span class="target" id="d7/d76/classdolfinx_1_1fem_1_1Function_1a6bdea53633d1c759488b53e1ca60c672"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8FunctionE" title="dolfinx::fem::Function"><span class="n"><span class="pre">Function</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sub</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem8Function3subEi" title="Permalink to this definition"></a><br /></dt>
<dd><p>Extract subfunction (view into the <a class="reference internal" href="#d7/d76/classdolfinx_1_1fem_1_1Function"><span class="std std-ref">Function</span></a>) </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>i</strong> – <strong>[in]</strong> Index of subfunction </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The subfunction </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem8Function8collapseEv">
<span id="_CPPv3NK7dolfinx3fem8Function8collapseEv"></span><span id="_CPPv2NK7dolfinx3fem8Function8collapseEv"></span><span id="dolfinx::fem::Function::collapseC"></span><span class="target" id="d7/d76/classdolfinx_1_1fem_1_1Function_1a57f581463a433b4192ccac7fffebd9de"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8FunctionE" title="dolfinx::fem::Function"><span class="n"><span class="pre">Function</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">collapse</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem8Function8collapseEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Collapse a subfunction (view into a <a class="reference internal" href="#d7/d76/classdolfinx_1_1fem_1_1Function"><span class="std std-ref">Function</span></a>) to a stand-alone <a class="reference internal" href="#d7/d76/classdolfinx_1_1fem_1_1Function"><span class="std std-ref">Function</span></a>. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>New collapsed <a class="reference internal" href="#d7/d76/classdolfinx_1_1fem_1_1Function"><span class="std std-ref">Function</span></a> </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem8Function14function_spaceEv">
<span id="_CPPv3NK7dolfinx3fem8Function14function_spaceEv"></span><span id="_CPPv2NK7dolfinx3fem8Function14function_spaceEv"></span><span id="dolfinx::fem::Function::function_spaceC"></span><span class="target" id="d7/d76/classdolfinx_1_1fem_1_1Function_1aea5931c140f32ab04096d499fc8b6b09"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FunctionSpaceE" title="dolfinx::fem::FunctionSpace"><span class="n"><span class="pre">FunctionSpace</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">function_space</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem8Function14function_spaceEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Access the function space. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The function space </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem8Function1xEv">
<span id="_CPPv3NK7dolfinx3fem8Function1xEv"></span><span id="_CPPv2NK7dolfinx3fem8Function1xEv"></span><span id="dolfinx::fem::Function::xC"></span><span class="target" id="d7/d76/classdolfinx_1_1fem_1_1Function_1a9ac7aae417cfd4044ff882a1bba092b0"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="la.html#_CPPv4N7dolfinx2laE" title="dolfinx::la"><span class="n"><span class="pre">la</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="la.html#_CPPv4I00EN7dolfinx2la6VectorE" title="dolfinx::la::Vector"><span class="n"><span class="pre">Vector</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8FunctionE" title="dolfinx::fem::Function::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">x</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem8Function1xEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Underlying vector. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem8Function1xEv">
<span id="_CPPv3N7dolfinx3fem8Function1xEv"></span><span id="_CPPv2N7dolfinx3fem8Function1xEv"></span><span id="dolfinx::fem::Function::x"></span><span class="target" id="d7/d76/classdolfinx_1_1fem_1_1Function_1a4b3a9be9077bbdfcfe96136fade089ff"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="la.html#_CPPv4N7dolfinx2laE" title="dolfinx::la"><span class="n"><span class="pre">la</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="la.html#_CPPv4I00EN7dolfinx2la6VectorE" title="dolfinx::la::Vector"><span class="n"><span class="pre">Vector</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8FunctionE" title="dolfinx::fem::Function::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">x</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx3fem8Function1xEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Underlying vector. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem8Function11interpolateERK8FunctionI1TERKN3xtl4spanIKNSt7int32_tEEE">
<span id="_CPPv3N7dolfinx3fem8Function11interpolateERK8FunctionI1TERKN3xtl4spanIKNSt7int32_tEEE"></span><span id="_CPPv2N7dolfinx3fem8Function11interpolateERK8FunctionI1TERKN3xtl4spanIKNSt7int32_tEEE"></span><span id="dolfinx::fem::Function::interpolate__Function:T:CR.xtl::span:std::int32_tC:CR"></span><span class="target" id="d7/d76/classdolfinx_1_1fem_1_1Function_1a3ce1a7e82503ce47a03bc978ffacfbd6"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">interpolate</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8FunctionE" title="dolfinx::fem::Function"><span class="n"><span class="pre">Function</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8FunctionE" title="dolfinx::fem::Function::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">v</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">cells</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx3fem8Function11interpolateERK8FunctionI1TERKN3xtl4spanIKNSt7int32_tEEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Interpolate a <a class="reference internal" href="#d7/d76/classdolfinx_1_1fem_1_1Function"><span class="std std-ref">Function</span></a>. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v</strong> – <strong>[in]</strong> The function to be interpolated </p></li>
<li><p><strong>cells</strong> – <strong>[in]</strong> The cells to interpolate on </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem8Function11interpolateERK8FunctionI1TE">
<span id="_CPPv3N7dolfinx3fem8Function11interpolateERK8FunctionI1TE"></span><span id="_CPPv2N7dolfinx3fem8Function11interpolateERK8FunctionI1TE"></span><span id="dolfinx::fem::Function::interpolate__Function:T:CR"></span><span class="target" id="d7/d76/classdolfinx_1_1fem_1_1Function_1a421ecb7160a27a2dc58c8503fffbcef4"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">interpolate</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8FunctionE" title="dolfinx::fem::Function"><span class="n"><span class="pre">Function</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8FunctionE" title="dolfinx::fem::Function::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">v</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx3fem8Function11interpolateERK8FunctionI1TE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Interpolate a <a class="reference internal" href="#d7/d76/classdolfinx_1_1fem_1_1Function"><span class="std std-ref">Function</span></a>. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>v</strong> – <strong>[in]</strong> The function to be interpolated </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem8Function11interpolateERKNSt8functionIFN2xt6xarrayI1TEERKN2xt7xtensorIdXL2EEEEEEERKN3xtl4spanIKNSt7int32_tEEE">
<span id="_CPPv3N7dolfinx3fem8Function11interpolateERKNSt8functionIFN2xt6xarrayI1TEERKN2xt7xtensorIdXL2EEEEEEERKN3xtl4spanIKNSt7int32_tEEE"></span><span id="_CPPv2N7dolfinx3fem8Function11interpolateERKNSt8functionIFN2xt6xarrayI1TEERKN2xt7xtensorIdX2EEEEEERKN3xtl4spanIKNSt7int32_tEEE"></span><span class="target" id="d7/d76/classdolfinx_1_1fem_1_1Function_1ae2cebf68dcbc085bd9e0371a2f89f88d"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">interpolate</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">xt</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">xarray</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8FunctionE" title="dolfinx::fem::Function::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xt</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">xtensor</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">f</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">cells</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx3fem8Function11interpolateERKNSt8functionIFN2xt6xarrayI1TEERKN2xt7xtensorIdXL2EEEEEEERKN3xtl4spanIKNSt7int32_tEEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Interpolate an expression function on a list of cells. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>f</strong> – <strong>[in]</strong> The expression function to be interpolated </p></li>
<li><p><strong>cells</strong> – <strong>[in]</strong> The cells to interpolate on </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem8Function11interpolateERKNSt8functionIFN2xt6xarrayI1TEERKN2xt7xtensorIdXL2EEEEEEE">
<span id="_CPPv3N7dolfinx3fem8Function11interpolateERKNSt8functionIFN2xt6xarrayI1TEERKN2xt7xtensorIdXL2EEEEEEE"></span><span id="_CPPv2N7dolfinx3fem8Function11interpolateERKNSt8functionIFN2xt6xarrayI1TEERKN2xt7xtensorIdX2EEEEEE"></span><span class="target" id="d7/d76/classdolfinx_1_1fem_1_1Function_1a8cb7b4bf6a996345f6e1fa7b5e547398"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">interpolate</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">xt</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">xarray</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8FunctionE" title="dolfinx::fem::Function::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xt</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">xtensor</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">f</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx3fem8Function11interpolateERKNSt8functionIFN2xt6xarrayI1TEERKN2xt7xtensorIdXL2EEEEEEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Interpolate an expression function on the whole domain. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>f</strong> – <strong>[in]</strong> The expression to be interpolated </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem8Function11interpolateERK10ExpressionI1TERKN3xtl4spanIKNSt7int32_tEEE">
<span id="_CPPv3N7dolfinx3fem8Function11interpolateERK10ExpressionI1TERKN3xtl4spanIKNSt7int32_tEEE"></span><span id="_CPPv2N7dolfinx3fem8Function11interpolateERK10ExpressionI1TERKN3xtl4spanIKNSt7int32_tEEE"></span><span id="dolfinx::fem::Function::interpolate__Expression:T:CR.xtl::span:std::int32_tC:CR"></span><span class="target" id="d7/d76/classdolfinx_1_1fem_1_1Function_1a0520ad47298e93d39c8d2cea48077ed1"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">interpolate</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Expression</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8FunctionE" title="dolfinx::fem::Function::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">e</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">cells</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx3fem8Function11interpolateERK10ExpressionI1TERKN3xtl4spanIKNSt7int32_tEEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Interpolate an Expression (based on UFL) </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>e</strong> – <strong>[in]</strong> The Expression to be interpolated. The Expression must have been created using the reference coordinates <code class="docutils literal notranslate"><a class="reference internal" href="#df/d27/classdolfinx_1_1fem_1_1FiniteElement_1a0c379c8cd3ec7e04e5c204aa96012c02"><span class="std std-ref"><span class="pre">FiniteElement::interpolation_points()</span></span></a></code> for the element associated with <code class="docutils literal notranslate"><span class="pre">u</span></code>. </p></li>
<li><p><strong>cells</strong> – <strong>[in]</strong> The cells to interpolate on </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem8Function11interpolateERK10ExpressionI1TE">
<span id="_CPPv3N7dolfinx3fem8Function11interpolateERK10ExpressionI1TE"></span><span id="_CPPv2N7dolfinx3fem8Function11interpolateERK10ExpressionI1TE"></span><span id="dolfinx::fem::Function::interpolate__Expression:T:CR"></span><span class="target" id="d7/d76/classdolfinx_1_1fem_1_1Function_1a3239a94df2c104fbb94722c3d268597b"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">interpolate</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Expression</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8FunctionE" title="dolfinx::fem::Function::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">e</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx3fem8Function11interpolateERK10ExpressionI1TE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Interpolate an Expression (based on UFL) on all cells. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>e</strong> – <strong>[in]</strong> The function to be interpolated </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem8Function4evalERKN2xt7xtensorIdXL2EEEERKN3xtl4spanIKNSt7int32_tEEERN2xt7xtensorI1TXL2EEEE">
<span id="_CPPv3NK7dolfinx3fem8Function4evalERKN2xt7xtensorIdXL2EEEERKN3xtl4spanIKNSt7int32_tEEERN2xt7xtensorI1TXL2EEEE"></span><span id="_CPPv2NK7dolfinx3fem8Function4evalERKN2xt7xtensorIdX2EEERKN3xtl4spanIKNSt7int32_tEEERN2xt7xtensorI1TX2EEE"></span><span id="dolfinx::fem::Function::eval__xt::xtensor:double.2:CR.xtl::span:std::int32_tC:CR.xt::xtensor:T.2:RC"></span><span class="target" id="d7/d76/classdolfinx_1_1fem_1_1Function_1a7d7316a81939dff70f3d327bd1114ed3"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">eval</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xt</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">xtensor</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">cells</span></span>, <span class="n"><span class="pre">xt</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">xtensor</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8FunctionE" title="dolfinx::fem::Function::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">u</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem8Function4evalERKN2xt7xtensorIdXL2EEEERKN3xtl4spanIKNSt7int32_tEEERN2xt7xtensorI1TXL2EEEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Evaluate the <a class="reference internal" href="#d7/d76/classdolfinx_1_1fem_1_1Function"><span class="std std-ref">Function</span></a> at points. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – <strong>[in]</strong> The coordinates of the points. It has shape (num_points, 3). </p></li>
<li><p><strong>cells</strong> – <strong>[in]</strong> An array of cell indices. cells[i] is the index of the cell that contains the point x(i). Negative cell indices can be passed, and the corresponding point will be ignored. </p></li>
<li><p><strong>u</strong> – <strong>[inout]</strong> The values at the points. Values are not computed for points with a negative cell index. This argument must be passed with the correct size. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem8Function4nameE">
<span id="_CPPv3N7dolfinx3fem8Function4nameE"></span><span id="_CPPv2N7dolfinx3fem8Function4nameE"></span><span id="dolfinx::fem::Function::name__ss"></span><span class="target" id="d7/d76/classdolfinx_1_1fem_1_1Function_1a9b45b3e13bd9167aab02e17e08916231"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">name</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="s"><span class="pre">&quot;u&quot;</span></span><a class="headerlink" href="#_CPPv4N7dolfinx3fem8Function4nameE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Name. </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="constants">
<h3>Constants<a class="headerlink" href="#constants" title="Permalink to this headline"></a></h3>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4I0EN7dolfinx3fem8ConstantE">
<span id="_CPPv3I0EN7dolfinx3fem8ConstantE"></span><span id="_CPPv2I0EN7dolfinx3fem8ConstantE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d6/d06/classdolfinx_1_1fem_1_1Constant"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">dolfinx</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">Constant</span></span></span><a class="headerlink" href="#_CPPv4I0EN7dolfinx3fem8ConstantE" title="Permalink to this definition"></a><br /></dt>
<dd><p><a class="reference internal" href="#d6/d06/classdolfinx_1_1fem_1_1Constant"><span class="std std-ref">Constant</span></a> value which can be attached to a <a class="reference internal" href="#df/d02/classdolfinx_1_1fem_1_1Form"><span class="std std-ref">Form</span></a>. Constants may be scalar (rank 0), vector (rank 1), or tensor valued. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN7dolfinx3fem8Constant8ConstantE1T">
<span id="_CPPv3I0EN7dolfinx3fem8Constant8ConstantE1T"></span><span id="_CPPv2I0EN7dolfinx3fem8Constant8ConstantE1T"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">enable_if_t</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">is_arithmetic_v</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8ConstantE" title="dolfinx::fem::Constant::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="o"><span class="pre">||</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">is_same_v</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8ConstantE" title="dolfinx::fem::Constant::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">complex</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">float</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="o"><span class="pre">||</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">is_same_v</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8ConstantE" title="dolfinx::fem::Constant::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">complex</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d6/d06/classdolfinx_1_1fem_1_1Constant_1a6584f5f49b91b070791d2a2550ffbb80"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Constant</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8ConstantE" title="dolfinx::fem::Constant::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">c</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN7dolfinx3fem8Constant8ConstantE1T" title="Permalink to this definition"></a><br /></dt>
<dd><p>Create a rank-0 (scalar-valued) constant. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>c</strong> – <strong>[in]</strong> Value of the constant </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem8Constant8ConstantERKN2xt6xarrayI1TEE">
<span id="_CPPv3N7dolfinx3fem8Constant8ConstantERKN2xt6xarrayI1TEE"></span><span id="_CPPv2N7dolfinx3fem8Constant8ConstantERKN2xt6xarrayI1TEE"></span><span id="dolfinx::fem::Constant::Constant__xt::xarray:T:CR"></span><span class="target" id="d6/d06/classdolfinx_1_1fem_1_1Constant_1afc46731be05313cb3f98125e8533366c"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Constant</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xt</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">xarray</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8ConstantE" title="dolfinx::fem::Constant::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">c</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx3fem8Constant8ConstantERKN2xt6xarrayI1TEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Create a rank-d constant. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>c</strong> – <strong>[in]</strong> Value of the constant </p>
</dd>
</dl>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem8Constant5shapeE">
<span id="_CPPv3N7dolfinx3fem8Constant5shapeE"></span><span id="_CPPv2N7dolfinx3fem8Constant5shapeE"></span><span id="dolfinx::fem::Constant::shape__std::vector:i:"></span><span class="target" id="d6/d06/classdolfinx_1_1fem_1_1Constant_1a57d0c7a7497d0cce539e98f089291f0d"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">shape</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx3fem8Constant5shapeE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Shape. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem8Constant5valueE">
<span id="_CPPv3N7dolfinx3fem8Constant5valueE"></span><span id="_CPPv2N7dolfinx3fem8Constant5valueE"></span><span id="dolfinx::fem::Constant::value__std::vector:T:"></span><span class="target" id="d6/d06/classdolfinx_1_1fem_1_1Constant_1aec326c324745d11291d2f0d5d7eea804"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8ConstantE" title="dolfinx::fem::Constant::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx3fem8Constant5valueE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Values, stored as a row-major flattened array. </p>
</dd></dl>

</div>
</dd></dl>

</section>
</section>
<section id="forms">
<h2>Forms<a class="headerlink" href="#forms" title="Permalink to this headline"></a></h2>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4I0EN7dolfinx3fem4FormE">
<span id="_CPPv3I0EN7dolfinx3fem4FormE"></span><span id="_CPPv2I0EN7dolfinx3fem4FormE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="df/d02/classdolfinx_1_1fem_1_1Form"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">dolfinx</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">Form</span></span></span><a class="headerlink" href="#_CPPv4I0EN7dolfinx3fem4FormE" title="Permalink to this definition"></a><br /></dt>
<dd><p>A representation of finite element variational forms. </p>
<p>A note on the order of trial and test spaces: FEniCS numbers argument spaces starting with the leading dimension of the corresponding tensor (matrix). In other words, the test space is numbered 0 and the trial space is numbered 1. However, in order to have a notation that agrees with most existing finite element literature, in particular</p>
<p><div class="math notranslate nohighlight">
\[ a = a(u, v) \]</div>
</p>
<p>the spaces are numbered from right to left</p>
<p><div class="math notranslate nohighlight">
\[ a: V_1 \times V_0 \rightarrow \mathbb{R} \]</div>
</p>
<p>This is reflected in the ordering of the spaces that should be supplied to generated subclasses. In particular, when a bilinear form is initialized, it should be initialized as <code class="docutils literal notranslate"><span class="pre">a(V_1,</span> <span class="pre">V_0)</span> <span class="pre">=</span> <span class="pre">...</span></code>, where <code class="docutils literal notranslate"><span class="pre">V_1</span></code> is the trial space and <code class="docutils literal notranslate"><span class="pre">V_0</span></code> is the test space. However, when a form is initialized by a list of argument spaces (the variable <code class="docutils literal notranslate"><span class="pre">function_spaces</span></code> in the constructors below), the list of spaces should start with space number 0 (the test space) and then space number 1 (the trial space). </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-types">Public Types</p>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem4Form11scalar_typeE">
<span id="_CPPv3N7dolfinx3fem4Form11scalar_typeE"></span><span id="_CPPv2N7dolfinx3fem4Form11scalar_typeE"></span><span class="target" id="df/d02/classdolfinx_1_1fem_1_1Form_1ae879758ab49a8cd7f2302f96a9e9dd0c"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">scalar_type</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem4FormE" title="dolfinx::fem::Form::T"><span class="n"><span class="pre">T</span></span></a><a class="headerlink" href="#_CPPv4N7dolfinx3fem4Form11scalar_typeE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Scalar type (T) </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem4Form4FormERKNSt6vectorINSt10shared_ptrIKN3fem13FunctionSpaceEEEEERKNSt3mapI12IntegralTypeNSt4pairINSt6vectorINSt4pairIiNSt8functionIFvP1TPK1TPK1TPKdPKiPKNSt7uint8_tEEEEEEEEPKN4mesh8MeshTagsIiEEEEEERKNSt6vectorINSt10shared_ptrIKN3fem8FunctionI1TEEEEEERKNSt6vectorINSt10shared_ptrIKN3fem8ConstantI1TEEEEEEbRKNSt10shared_ptrIKN4mesh4MeshEEE">
<span id="_CPPv3N7dolfinx3fem4Form4FormERKNSt6vectorINSt10shared_ptrIKN3fem13FunctionSpaceEEEEERKNSt3mapI12IntegralTypeNSt4pairINSt6vectorINSt4pairIiNSt8functionIFvP1TPK1TPK1TPKdPKiPKNSt7uint8_tEEEEEEEEPKN4mesh8MeshTagsIiEEEEEERKNSt6vectorINSt10shared_ptrIKN3fem8FunctionI1TEEEEEERKNSt6vectorINSt10shared_ptrIKN3fem8ConstantI1TEEEEEEbRKNSt10shared_ptrIKN4mesh4MeshEEE"></span><span id="_CPPv2N7dolfinx3fem4Form4FormERKNSt6vectorINSt10shared_ptrIKN3fem13FunctionSpaceEEEEERKNSt3mapI12IntegralTypeNSt4pairINSt6vectorINSt4pairIiNSt8functionIFvP1TPK1TPK1TPKdPKiPKNSt7uint8_tEEEEEEEEPKN4mesh8MeshTagsIiEEEEEERKNSt6vectorINSt10shared_ptrIKN3fem8FunctionI1TEEEEEERKNSt6vectorINSt10shared_ptrIKN3fem8ConstantI1TEEEEEEbRKNSt10shared_ptrIKN4mesh4MeshEEE"></span><span class="target" id="df/d02/classdolfinx_1_1fem_1_1Form_1a4ed393d8f72626e23448f7f5b30158e2"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Form</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FunctionSpaceE" title="dolfinx::fem::FunctionSpace"><span class="n"><span class="pre">FunctionSpace</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">function_spaces</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">IntegralType</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">void</span></span><span class="p"><span class="pre">(</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem4FormE" title="dolfinx::fem::Form::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem4FormE" title="dolfinx::fem::Form::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem4FormE" title="dolfinx::fem::Form::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">uint8_t</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx3fem4Form4FormERKNSt6vectorINSt10shared_ptrIKN3fem13FunctionSpaceEEEEERKNSt3mapI12IntegralTypeNSt4pairINSt6vectorINSt4pairIiNSt8functionIFvP1TPK1TPK1TPKdPKiPKNSt7uint8_tEEEEEEEEPKN4mesh8MeshTagsIiEEEEEERKNSt6vectorINSt10shared_ptrIKN3fem8FunctionI1TEEEEEERKNSt6vectorINSt10shared_ptrIKN3fem8ConstantI1TEEEEEEbRKNSt10shared_ptrIKN4mesh4MeshEEE" title="dolfinx::fem::Form::Form::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MeshTags</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">integrals</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8FunctionE" title="dolfinx::fem::Function"><span class="n"><span class="pre">Function</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem4FormE" title="dolfinx::fem::Form::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">coefficients</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8ConstantE" title="dolfinx::fem::Constant"><span class="n"><span class="pre">Constant</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem4FormE" title="dolfinx::fem::Form::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">constants</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">needs_facet_permutations</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx3fem4Form4FormERKNSt6vectorINSt10shared_ptrIKN3fem13FunctionSpaceEEEEERKNSt3mapI12IntegralTypeNSt4pairINSt6vectorINSt4pairIiNSt8functionIFvP1TPK1TPK1TPKdPKiPKNSt7uint8_tEEEEEEEEPKN4mesh8MeshTagsIiEEEEEERKNSt6vectorINSt10shared_ptrIKN3fem8FunctionI1TEEEEEERKNSt6vectorINSt10shared_ptrIKN3fem8ConstantI1TEEEEEEbRKNSt10shared_ptrIKN4mesh4MeshEEE" title="dolfinx::fem::Form::Form::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Mesh</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">mesh</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx3fem4Form4FormERKNSt6vectorINSt10shared_ptrIKN3fem13FunctionSpaceEEEEERKNSt3mapI12IntegralTypeNSt4pairINSt6vectorINSt4pairIiNSt8functionIFvP1TPK1TPK1TPKdPKiPKNSt7uint8_tEEEEEEEEPKN4mesh8MeshTagsIiEEEEEERKNSt6vectorINSt10shared_ptrIKN3fem8FunctionI1TEEEEEERKNSt6vectorINSt10shared_ptrIKN3fem8ConstantI1TEEEEEEbRKNSt10shared_ptrIKN4mesh4MeshEEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Create a finite element form. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>User applications will normally call a <a class="reference internal" href="#df/d02/classdolfinx_1_1fem_1_1Form"><span class="std std-ref">fem::Form</span></a> builder function rather using this interfcae directly.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>function_spaces</strong> – <strong>[in]</strong> <a class="reference internal" href="#d7/d76/classdolfinx_1_1fem_1_1Function"><span class="std std-ref">Function</span></a> spaces for the form arguments </p></li>
<li><p><strong>integrals</strong> – <strong>[in]</strong> The integrals in the form. The first key is the domain type. For each key there is a pair (list[domain id, integration kernel], domain markers). </p></li>
<li><p><strong>coefficients</strong> – <strong>[in]</strong> </p></li>
<li><p><strong>constants</strong> – <strong>[in]</strong> Constants in the <a class="reference internal" href="#df/d02/classdolfinx_1_1fem_1_1Form"><span class="std std-ref">Form</span></a> </p></li>
<li><p><strong>needs_facet_permutations</strong> – <strong>[in]</strong> Set to true is any of the integration kernels require cell permutation data </p></li>
<li><p><strong>mesh</strong> – <strong>[in]</strong> The mesh of the domain. This is required when there are not argument functions from which the mesh can be extracted, e.g. for functionals </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem4Form4FormERK4Form">
<span id="_CPPv3N7dolfinx3fem4Form4FormERK4Form"></span><span id="_CPPv2N7dolfinx3fem4Form4FormERK4Form"></span><span id="dolfinx::fem::Form::Form__FormCR"></span><span class="target" id="df/d02/classdolfinx_1_1fem_1_1Form_1a423512b32e596ae56fccf17da19be8dc"></span><span class="sig-name descname"><span class="n"><span class="pre">Form</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx3fem4Form4FormERK4Form" title="dolfinx::fem::Form::Form"><span class="n"><span class="pre">Form</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">form</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">delete</span></span><a class="headerlink" href="#_CPPv4N7dolfinx3fem4Form4FormERK4Form" title="Permalink to this definition"></a><br /></dt>
<dd><p>Copy constructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem4Form4FormERR4Form">
<span id="_CPPv3N7dolfinx3fem4Form4FormERR4Form"></span><span id="_CPPv2N7dolfinx3fem4Form4FormERR4Form"></span><span id="dolfinx::fem::Form::Form__FormRR"></span><span class="target" id="df/d02/classdolfinx_1_1fem_1_1Form_1a284277cdb740e39d1bb8498e11038ec8"></span><span class="sig-name descname"><span class="n"><span class="pre">Form</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx3fem4Form4FormERR4Form" title="dolfinx::fem::Form::Form"><span class="n"><span class="pre">Form</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">form</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx3fem4Form4FormERR4Form" title="Permalink to this definition"></a><br /></dt>
<dd><p>Move constructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem4FormD0Ev">
<span id="_CPPv3N7dolfinx3fem4FormD0Ev"></span><span id="_CPPv2N7dolfinx3fem4FormD0Ev"></span><span id="dolfinx::fem::Form::~Form"></span><span class="target" id="df/d02/classdolfinx_1_1fem_1_1Form_1a4793396a9359437874c066d13b0a1bef"></span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">~Form</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx3fem4FormD0Ev" title="Permalink to this definition"></a><br /></dt>
<dd><p>Destructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem4Form4rankEv">
<span id="_CPPv3NK7dolfinx3fem4Form4rankEv"></span><span id="_CPPv2NK7dolfinx3fem4Form4rankEv"></span><span id="dolfinx::fem::Form::rankC"></span><span class="target" id="df/d02/classdolfinx_1_1fem_1_1Form_1a290d348ba17e7752621ed7bd3d5e4b3a"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rank</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem4Form4rankEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Rank of the form (bilinear form = 2, linear form = 1, functional = 0, etc) </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The rank of the form </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem4Form4meshEv">
<span id="_CPPv3NK7dolfinx3fem4Form4meshEv"></span><span id="_CPPv2NK7dolfinx3fem4Form4meshEv"></span><span id="dolfinx::fem::Form::meshC"></span><span class="target" id="df/d02/classdolfinx_1_1fem_1_1Form_1abb62312a0c054692005c84b12ef6c739"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4NK7dolfinx3fem4Form4meshEv" title="dolfinx::fem::Form::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Mesh</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mesh</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem4Form4meshEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Extract common mesh for the form. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The mesh </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem4Form15function_spacesEv">
<span id="_CPPv3NK7dolfinx3fem4Form15function_spacesEv"></span><span id="_CPPv2NK7dolfinx3fem4Form15function_spacesEv"></span><span id="dolfinx::fem::Form::function_spacesC"></span><span class="target" id="df/d02/classdolfinx_1_1fem_1_1Form_1a224e54b187cebc041c23ba6c3890a469"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FunctionSpaceE" title="dolfinx::fem::FunctionSpace"><span class="n"><span class="pre">FunctionSpace</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">function_spaces</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem4Form15function_spacesEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Return function spaces for all arguments. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><a class="reference internal" href="#d7/d76/classdolfinx_1_1fem_1_1Function"><span class="std std-ref">Function</span></a> spaces </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem4Form6kernelE12IntegralTypei">
<span id="_CPPv3NK7dolfinx3fem4Form6kernelE12IntegralTypei"></span><span id="_CPPv2NK7dolfinx3fem4Form6kernelE12IntegralTypei"></span><span id="dolfinx::fem::Form::kernel__IntegralType.iC"></span><span class="target" id="df/d02/classdolfinx_1_1fem_1_1Form_1ade9e1875eb67345448ea8793ec1dd926"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">void</span></span><span class="p"><span class="pre">(</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem4FormE" title="dolfinx::fem::Form::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem4FormE" title="dolfinx::fem::Form::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem4FormE" title="dolfinx::fem::Form::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">uint8_t</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">kernel</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">IntegralType</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">type</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem4Form6kernelE12IntegralTypei" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the function for ‘kernel’ for integral i of given type. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>type</strong> – <strong>[in]</strong> Integral type </p></li>
<li><p><strong>i</strong> – <strong>[in]</strong> Domain index </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><a class="reference internal" href="#d7/d76/classdolfinx_1_1fem_1_1Function"><span class="std std-ref">Function</span></a> to call for tabulate_tensor </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem4Form14integral_typesEv">
<span id="_CPPv3NK7dolfinx3fem4Form14integral_typesEv"></span><span id="_CPPv2NK7dolfinx3fem4Form14integral_typesEv"></span><span id="dolfinx::fem::Form::integral_typesC"></span><span class="target" id="df/d02/classdolfinx_1_1fem_1_1Form_1a073ae6eeed5493e1955d454e2c8d39b5"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">set</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">IntegralType</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">integral_types</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem4Form14integral_typesEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get types of integrals in the form. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Integrals types </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem4Form13num_integralsE12IntegralType">
<span id="_CPPv3NK7dolfinx3fem4Form13num_integralsE12IntegralType"></span><span id="_CPPv2NK7dolfinx3fem4Form13num_integralsE12IntegralType"></span><span id="dolfinx::fem::Form::num_integrals__IntegralTypeC"></span><span class="target" id="df/d02/classdolfinx_1_1fem_1_1Form_1ae81f3b402ccf3d910dfa5bfe944d5024"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">num_integrals</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">IntegralType</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">type</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem4Form13num_integralsE12IntegralType" title="Permalink to this definition"></a><br /></dt>
<dd><p>Number of integrals of given type. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>type</strong> – <strong>[in]</strong> Integral type </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Number of integrals </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem4Form12integral_idsE12IntegralType">
<span id="_CPPv3NK7dolfinx3fem4Form12integral_idsE12IntegralType"></span><span id="_CPPv2NK7dolfinx3fem4Form12integral_idsE12IntegralType"></span><span id="dolfinx::fem::Form::integral_ids__IntegralTypeC"></span><span class="target" id="df/d02/classdolfinx_1_1fem_1_1Form_1af8f686ba563d8353b75f3deb2a3c0ac1"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">integral_ids</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">IntegralType</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">type</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem4Form12integral_idsE12IntegralType" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the IDs for integrals (kernels) for given integral type. The IDs correspond to the domain IDs which the integrals are defined for in the form. ID=-1 is the default integral over the whole domain. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>type</strong> – <strong>[in]</strong> Integral type </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of IDs for given integral type </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem4Form12cell_domainsEi">
<span id="_CPPv3NK7dolfinx3fem4Form12cell_domainsEi"></span><span id="_CPPv2NK7dolfinx3fem4Form12cell_domainsEi"></span><span id="dolfinx::fem::Form::cell_domains__iC"></span><span class="target" id="df/d02/classdolfinx_1_1fem_1_1Form_1a8924d906a25bd0a3d0f8dbcfddade1f6"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">cell_domains</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem4Form12cell_domainsEi" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the list of cell indices for the ith integral (kernel) for the cell domain type. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>i</strong> – <strong>[in]</strong> Integral ID, i.e. (sub)domain index </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of active cell entities for the given integral (kernel) </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem4Form22exterior_facet_domainsEi">
<span id="_CPPv3NK7dolfinx3fem4Form22exterior_facet_domainsEi"></span><span id="_CPPv2NK7dolfinx3fem4Form22exterior_facet_domainsEi"></span><span id="dolfinx::fem::Form::exterior_facet_domains__iC"></span><span class="target" id="df/d02/classdolfinx_1_1fem_1_1Form_1abd27353ebf81b45d4fc3424dac1877dc"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">exterior_facet_domains</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem4Form22exterior_facet_domainsEi" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the list of (cell_index, local_facet_index) pairs for the ith integral (kernel) for the exterior facet domain type. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>i</strong> – <strong>[in]</strong> Integral ID, i.e. (sub)domain index </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of (cell_index, local_facet_index) pairs </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem4Form22interior_facet_domainsEi">
<span id="_CPPv3NK7dolfinx3fem4Form22interior_facet_domainsEi"></span><span id="_CPPv2NK7dolfinx3fem4Form22interior_facet_domainsEi"></span><span id="dolfinx::fem::Form::interior_facet_domains__iC"></span><span class="target" id="df/d02/classdolfinx_1_1fem_1_1Form_1afa73be5df3443febd3f7594f448c5691"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">tuple</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">interior_facet_domains</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">i</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem4Form22interior_facet_domainsEi" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the list of (cell_index_0, local_facet_index_0, cell_index_1, local_facet_index_1) tuples for the ith integral (kernel) for the interior facet domain type,. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>i</strong> – <strong>[in]</strong> Integral ID, i.e. (sub)domain index </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of tuples of the form (cell_index_0, local_facet_index_0, cell_index_1, local_facet_index_1) </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem4Form12coefficientsEv">
<span id="_CPPv3NK7dolfinx3fem4Form12coefficientsEv"></span><span id="_CPPv2NK7dolfinx3fem4Form12coefficientsEv"></span><span id="dolfinx::fem::Form::coefficientsC"></span><span class="target" id="df/d02/classdolfinx_1_1fem_1_1Form_1ad8a28f301bd50376c6aeb29f33b7faf8"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8FunctionE" title="dolfinx::fem::Function"><span class="n"><span class="pre">Function</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem4FormE" title="dolfinx::fem::Form::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">coefficients</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem4Form12coefficientsEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Access coefficients. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem4Form24needs_facet_permutationsEv">
<span id="_CPPv3NK7dolfinx3fem4Form24needs_facet_permutationsEv"></span><span id="_CPPv2NK7dolfinx3fem4Form24needs_facet_permutationsEv"></span><span id="dolfinx::fem::Form::needs_facet_permutationsC"></span><span class="target" id="df/d02/classdolfinx_1_1fem_1_1Form_1a2706d72fc422a090ea83c6975543f9fa"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">needs_facet_permutations</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem4Form24needs_facet_permutationsEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get bool indicating whether permutation data needs to be passed into these integrals. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if cell permutation data is required </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem4Form19coefficient_offsetsEv">
<span id="_CPPv3NK7dolfinx3fem4Form19coefficient_offsetsEv"></span><span id="_CPPv2NK7dolfinx3fem4Form19coefficient_offsetsEv"></span><span id="dolfinx::fem::Form::coefficient_offsetsC"></span><span class="target" id="df/d02/classdolfinx_1_1fem_1_1Form_1a80619c13397d1a6f8846286fee808bb2"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">coefficient_offsets</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem4Form19coefficient_offsetsEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Offset for each coefficient expansion array on a cell. Used to pack data for multiple coefficients in a flat array. The last entry is the size required to store all coefficients. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem4Form9constantsEv">
<span id="_CPPv3NK7dolfinx3fem4Form9constantsEv"></span><span id="_CPPv2NK7dolfinx3fem4Form9constantsEv"></span><span id="dolfinx::fem::Form::constantsC"></span><span class="target" id="df/d02/classdolfinx_1_1fem_1_1Form_1a4f8be1e44c93a95fb1b0390575138413"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8ConstantE" title="dolfinx::fem::Constant"><span class="n"><span class="pre">Constant</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem4FormE" title="dolfinx::fem::Form::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">constants</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem4Form9constantsEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Access constants. </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="dirichlet-boundary-conditions">
<h2>Dirichlet boundary conditions<a class="headerlink" href="#dirichlet-boundary-conditions" title="Permalink to this headline"></a></h2>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4I0EN7dolfinx3fem11DirichletBCE">
<span id="_CPPv3I0EN7dolfinx3fem11DirichletBCE"></span><span id="_CPPv2I0EN7dolfinx3fem11DirichletBCE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="db/d9f/classdolfinx_1_1fem_1_1DirichletBC"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">dolfinx</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">DirichletBC</span></span></span><a class="headerlink" href="#_CPPv4I0EN7dolfinx3fem11DirichletBCE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Object for setting (strong) Dirichlet boundary conditions. </p>
<p><span class="math notranslate nohighlight">\(u = g \ \text{on} \ G\)</span>,</p>
<p>where <span class="math notranslate nohighlight">\(u\)</span> is the solution to be computed, <span class="math notranslate nohighlight">\(g\)</span> is a function and <span class="math notranslate nohighlight">\(G\)</span> is a sub domain of the mesh.</p>
<p>A <a class="reference internal" href="#db/d9f/classdolfinx_1_1fem_1_1DirichletBC"><span class="std std-ref">DirichletBC</span></a> is specified by the function <span class="math notranslate nohighlight">\(g\)</span>, the function space (trial space) and degrees of freedom to which the boundary condition applies. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000EN7dolfinx3fem11DirichletBC11DirichletBCERK1SRR1URKNSt10shared_ptrIK13FunctionSpaceEE">
<span id="_CPPv3I000EN7dolfinx3fem11DirichletBC11DirichletBCERK1SRR1URKNSt10shared_ptrIK13FunctionSpaceEE"></span><span id="_CPPv2I000EN7dolfinx3fem11DirichletBC11DirichletBCERK1SRR1URKNSt10shared_ptrIK13FunctionSpaceEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">S</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">U</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">enable_if_t</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">is_convertible_v</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000EN7dolfinx3fem11DirichletBC11DirichletBCERK1SRR1URKNSt10shared_ptrIK13FunctionSpaceEE" title="dolfinx::fem::DirichletBC::DirichletBC::S"><span class="n"><span class="pre">S</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem11DirichletBCE" title="dolfinx::fem::DirichletBC::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="k"><span class="pre">or</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">is_convertible_v</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000EN7dolfinx3fem11DirichletBC11DirichletBCERK1SRR1URKNSt10shared_ptrIK13FunctionSpaceEE" title="dolfinx::fem::DirichletBC::DirichletBC::S"><span class="n"><span class="pre">S</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">xt</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">xarray</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem11DirichletBCE" title="dolfinx::fem::DirichletBC::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="db/d9f/classdolfinx_1_1fem_1_1DirichletBC_1ae313c55a6033112ce7027ab2e72f351e"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DirichletBC</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN7dolfinx3fem11DirichletBC11DirichletBCERK1SRR1URKNSt10shared_ptrIK13FunctionSpaceEE" title="dolfinx::fem::DirichletBC::DirichletBC::S"><span class="n"><span class="pre">S</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">g</span></span>, <a class="reference internal" href="#_CPPv4I000EN7dolfinx3fem11DirichletBC11DirichletBCERK1SRR1URKNSt10shared_ptrIK13FunctionSpaceEE" title="dolfinx::fem::DirichletBC::DirichletBC::U"><span class="n"><span class="pre">U</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dofs</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FunctionSpaceE" title="dolfinx::fem::FunctionSpace"><span class="n"><span class="pre">FunctionSpace</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">V</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000EN7dolfinx3fem11DirichletBC11DirichletBCERK1SRR1URKNSt10shared_ptrIK13FunctionSpaceEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Create a representation of a Dirichlet boundary condition constrained by a scalar or tensor constant. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The indices in <code class="docutils literal notranslate"><span class="pre">dofs</span></code> are for <em>blocks</em>, e.g. a block index maps to 3 degrees-of-freedom if the dofmap associated with <code class="docutils literal notranslate"><span class="pre">g</span></code> has block size 3 </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Can be used only with point-evaluation elements </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g</strong> – <strong>[in]</strong> The boundary condition value (<code class="docutils literal notranslate"><span class="pre">T</span></code> or <code class="docutils literal notranslate"><span class="pre">xt::xarray&lt;T&gt;</span></code>) </p></li>
<li><p><strong>dofs</strong> – <strong>[in]</strong> Degree-of-freedom block indices (<code class="docutils literal notranslate"><span class="pre">std::vector&lt;std::int32_t&gt;</span></code>) to be constrained. The indices must be sorted. </p></li>
<li><p><strong>V</strong> – <strong>[in]</strong> The function space to be constrained </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN7dolfinx3fem11DirichletBC11DirichletBCERKNSt10shared_ptrIK8ConstantI1TEEERR1URKNSt10shared_ptrIK13FunctionSpaceEE">
<span id="_CPPv3I0EN7dolfinx3fem11DirichletBC11DirichletBCERKNSt10shared_ptrIK8ConstantI1TEEERR1URKNSt10shared_ptrIK13FunctionSpaceEE"></span><span id="_CPPv2I0EN7dolfinx3fem11DirichletBC11DirichletBCERKNSt10shared_ptrIK8ConstantI1TEEERR1URKNSt10shared_ptrIK13FunctionSpaceEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">U</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="db/d9f/classdolfinx_1_1fem_1_1DirichletBC_1a6008ef4b9e7026443350b162d91faa50"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DirichletBC</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8ConstantE" title="dolfinx::fem::Constant"><span class="n"><span class="pre">Constant</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem11DirichletBCE" title="dolfinx::fem::DirichletBC::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">g</span></span>, <a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem11DirichletBC11DirichletBCERKNSt10shared_ptrIK8ConstantI1TEEERR1URKNSt10shared_ptrIK13FunctionSpaceEE" title="dolfinx::fem::DirichletBC::DirichletBC::U"><span class="n"><span class="pre">U</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dofs</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FunctionSpaceE" title="dolfinx::fem::FunctionSpace"><span class="n"><span class="pre">FunctionSpace</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">V</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN7dolfinx3fem11DirichletBC11DirichletBCERKNSt10shared_ptrIK8ConstantI1TEEERR1URKNSt10shared_ptrIK13FunctionSpaceEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Create a representation of a Dirichlet boundary condition constrained by a <a class="reference internal" href="#d6/d06/classdolfinx_1_1fem_1_1Constant"><span class="std std-ref">fem::Constant</span></a>. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The indices in <code class="docutils literal notranslate"><span class="pre">dofs</span></code> are for <em>blocks</em>, e.g. a block index maps to 3 degrees-of-freedom if the dofmap associated with <code class="docutils literal notranslate"><span class="pre">g</span></code> has block size 3 </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Can be used only with point-evaluation elements </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g</strong> – <strong>[in]</strong> The boundary condition value </p></li>
<li><p><strong>dofs</strong> – <strong>[in]</strong> Degree-of-freedom block indices (<code class="docutils literal notranslate"><span class="pre">std::vector&lt;std::int32_t&gt;</span></code>) to be constrained. The indices must be sorted. </p></li>
<li><p><strong>V</strong> – <strong>[in]</strong> The function space to be constrained </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN7dolfinx3fem11DirichletBC11DirichletBCERKNSt10shared_ptrIK8FunctionI1TEEERR1U">
<span id="_CPPv3I0EN7dolfinx3fem11DirichletBC11DirichletBCERKNSt10shared_ptrIK8FunctionI1TEEERR1U"></span><span id="_CPPv2I0EN7dolfinx3fem11DirichletBC11DirichletBCERKNSt10shared_ptrIK8FunctionI1TEEERR1U"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">U</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="db/d9f/classdolfinx_1_1fem_1_1DirichletBC_1a2eae05a9a822795bdd191b13e0f6a1e8"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DirichletBC</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8FunctionE" title="dolfinx::fem::Function"><span class="n"><span class="pre">Function</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem11DirichletBCE" title="dolfinx::fem::DirichletBC::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">g</span></span>, <a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem11DirichletBC11DirichletBCERKNSt10shared_ptrIK8FunctionI1TEEERR1U" title="dolfinx::fem::DirichletBC::DirichletBC::U"><span class="n"><span class="pre">U</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dofs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN7dolfinx3fem11DirichletBC11DirichletBCERKNSt10shared_ptrIK8FunctionI1TEEERR1U" title="Permalink to this definition"></a><br /></dt>
<dd><p>Create a representation of a Dirichlet boundary condition where the space being constrained is the same as the function that defines the constraint <a class="reference internal" href="#d7/d76/classdolfinx_1_1fem_1_1Function"><span class="std std-ref">Function</span></a>, i.e. share the same <code class="docutils literal notranslate"><a class="reference internal" href="#d9/d69/classdolfinx_1_1fem_1_1FunctionSpace"><span class="std std-ref"><span class="pre">fem::FunctionSpace</span></span></a></code> </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The indices in <code class="docutils literal notranslate"><span class="pre">dofs</span></code> are for <em>blocks</em>, e.g. a block index maps to 3 degrees-of-freedom if the dofmap associated with <code class="docutils literal notranslate"><span class="pre">g</span></code> has block size 3 </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g</strong> – <strong>[in]</strong> The boundary condition value </p></li>
<li><p><strong>dofs</strong> – <strong>[in]</strong> Degree-of-freedom block indices (<code class="docutils literal notranslate"><span class="pre">std::vector&lt;std::int32_t&gt;</span></code>) to be constrained. The indices must be sorted. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN7dolfinx3fem11DirichletBC11DirichletBCERKNSt10shared_ptrIK8FunctionI1TEEERR1URKNSt10shared_ptrIK13FunctionSpaceEE">
<span id="_CPPv3I0EN7dolfinx3fem11DirichletBC11DirichletBCERKNSt10shared_ptrIK8FunctionI1TEEERR1URKNSt10shared_ptrIK13FunctionSpaceEE"></span><span id="_CPPv2I0EN7dolfinx3fem11DirichletBC11DirichletBCERKNSt10shared_ptrIK8FunctionI1TEEERR1URKNSt10shared_ptrIK13FunctionSpaceEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">U</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="db/d9f/classdolfinx_1_1fem_1_1DirichletBC_1a44d010e32745fad4be3518222e5eaf79"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DirichletBC</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8FunctionE" title="dolfinx::fem::Function"><span class="n"><span class="pre">Function</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem11DirichletBCE" title="dolfinx::fem::DirichletBC::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">g</span></span>, <a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem11DirichletBC11DirichletBCERKNSt10shared_ptrIK8FunctionI1TEEERR1URKNSt10shared_ptrIK13FunctionSpaceEE" title="dolfinx::fem::DirichletBC::DirichletBC::U"><span class="n"><span class="pre">U</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">V_g_dofs</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FunctionSpaceE" title="dolfinx::fem::FunctionSpace"><span class="n"><span class="pre">FunctionSpace</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">V</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN7dolfinx3fem11DirichletBC11DirichletBCERKNSt10shared_ptrIK8FunctionI1TEEERR1URKNSt10shared_ptrIK13FunctionSpaceEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Create a representation of a Dirichlet boundary condition where the space being constrained and the function that defines the constraint values do not share the same <code class="docutils literal notranslate"><a class="reference internal" href="#d9/d69/classdolfinx_1_1fem_1_1FunctionSpace"><span class="std std-ref"><span class="pre">FunctionSpace</span></span></a></code>. A typical examples is when applying a constraint on a subspace. The (sub)space and the constrain function must have the same finite element. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The indices in <code class="docutils literal notranslate"><span class="pre">dofs</span></code> are unrolled and not for blocks </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g</strong> – <strong>[in]</strong> The boundary condition value </p></li>
<li><p><strong>V_g_dofs</strong> – <strong>[in]</strong> Two arrays of degree-of-freedom indices (<code class="docutils literal notranslate"><span class="pre">std::array&lt;std::vector&lt;std::int32_t&gt;</span></code>, 2&gt;). First array are indices in the space where boundary condition is applied (V), second array are indices in the space of the boundary condition value function g. The arrays must be sorted by the indices in the first array. The dof indices are unrolled, i.e. are not by dof block. </p></li>
<li><p><strong>V</strong> – <strong>[in]</strong> The function (sub)space on which the boundary condition is applied </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem11DirichletBC11DirichletBCERK11DirichletBC">
<span id="_CPPv3N7dolfinx3fem11DirichletBC11DirichletBCERK11DirichletBC"></span><span id="_CPPv2N7dolfinx3fem11DirichletBC11DirichletBCERK11DirichletBC"></span><span id="dolfinx::fem::DirichletBC::DirichletBC__DirichletBCCR"></span><span class="target" id="db/d9f/classdolfinx_1_1fem_1_1DirichletBC_1a7986b02ec85e7fdc6945efce2d2e840a"></span><span class="sig-name descname"><span class="n"><span class="pre">DirichletBC</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx3fem11DirichletBC11DirichletBCERK11DirichletBC" title="dolfinx::fem::DirichletBC::DirichletBC"><span class="n"><span class="pre">DirichletBC</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">bc</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx3fem11DirichletBC11DirichletBCERK11DirichletBC" title="Permalink to this definition"></a><br /></dt>
<dd><p>Copy constructor. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bc</strong> – <strong>[in]</strong> The object to be copied </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem11DirichletBC11DirichletBCERR11DirichletBC">
<span id="_CPPv3N7dolfinx3fem11DirichletBC11DirichletBCERR11DirichletBC"></span><span id="_CPPv2N7dolfinx3fem11DirichletBC11DirichletBCERR11DirichletBC"></span><span id="dolfinx::fem::DirichletBC::DirichletBC__DirichletBCRR"></span><span class="target" id="db/d9f/classdolfinx_1_1fem_1_1DirichletBC_1a7de6888d88c12f3e105cca97988f8697"></span><span class="sig-name descname"><span class="n"><span class="pre">DirichletBC</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx3fem11DirichletBC11DirichletBCERR11DirichletBC" title="dolfinx::fem::DirichletBC::DirichletBC"><span class="n"><span class="pre">DirichletBC</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">bc</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx3fem11DirichletBC11DirichletBCERR11DirichletBC" title="Permalink to this definition"></a><br /></dt>
<dd><p>Move constructor. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bc</strong> – <strong>[in]</strong> The object to be moved </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem11DirichletBCD0Ev">
<span id="_CPPv3N7dolfinx3fem11DirichletBCD0Ev"></span><span id="_CPPv2N7dolfinx3fem11DirichletBCD0Ev"></span><span id="dolfinx::fem::DirichletBC::~DirichletBC"></span><span class="target" id="db/d9f/classdolfinx_1_1fem_1_1DirichletBC_1abee143c0149a09bcc95636cbbb62f85f"></span><span class="sig-name descname"><span class="n"><span class="pre">~DirichletBC</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx3fem11DirichletBCD0Ev" title="Permalink to this definition"></a><br /></dt>
<dd><p>Destructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem11DirichletBCaSERK11DirichletBC">
<span id="_CPPv3N7dolfinx3fem11DirichletBCaSERK11DirichletBC"></span><span id="_CPPv2N7dolfinx3fem11DirichletBCaSERK11DirichletBC"></span><span id="dolfinx::fem::DirichletBC::assign-operator__DirichletBCCR"></span><span class="target" id="db/d9f/classdolfinx_1_1fem_1_1DirichletBC_1a397244946e3490ae795c653529bdeb7b"></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem11DirichletBCE" title="dolfinx::fem::DirichletBC"><span class="n"><span class="pre">DirichletBC</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem11DirichletBCE" title="dolfinx::fem::DirichletBC"><span class="n"><span class="pre">DirichletBC</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">bc</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx3fem11DirichletBCaSERK11DirichletBC" title="Permalink to this definition"></a><br /></dt>
<dd><p>Assignment operator. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bc</strong> – <strong>[in]</strong> Another <a class="reference internal" href="#db/d9f/classdolfinx_1_1fem_1_1DirichletBC"><span class="std std-ref">DirichletBC</span></a> object </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem11DirichletBCaSERR11DirichletBC">
<span id="_CPPv3N7dolfinx3fem11DirichletBCaSERR11DirichletBC"></span><span id="_CPPv2N7dolfinx3fem11DirichletBCaSERR11DirichletBC"></span><span id="dolfinx::fem::DirichletBC::assign-operator__DirichletBCRR"></span><span class="target" id="db/d9f/classdolfinx_1_1fem_1_1DirichletBC_1aa7b2d177cdeaf89d7240b69e58ca656b"></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem11DirichletBCE" title="dolfinx::fem::DirichletBC"><span class="n"><span class="pre">DirichletBC</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem11DirichletBCE" title="dolfinx::fem::DirichletBC"><span class="n"><span class="pre">DirichletBC</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">bc</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx3fem11DirichletBCaSERR11DirichletBC" title="Permalink to this definition"></a><br /></dt>
<dd><p>Move assignment operator. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem11DirichletBC14function_spaceEv">
<span id="_CPPv3NK7dolfinx3fem11DirichletBC14function_spaceEv"></span><span id="_CPPv2NK7dolfinx3fem11DirichletBC14function_spaceEv"></span><span id="dolfinx::fem::DirichletBC::function_spaceC"></span><span class="target" id="db/d9f/classdolfinx_1_1fem_1_1DirichletBC_1a9e07de7a99243f225c3ed2a26fc7c17c"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FunctionSpaceE" title="dolfinx::fem::FunctionSpace"><span class="n"><span class="pre">FunctionSpace</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">function_space</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem11DirichletBC14function_spaceEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>The function space to which boundary conditions are applied. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The function space </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem11DirichletBC5valueEv">
<span id="_CPPv3NK7dolfinx3fem11DirichletBC5valueEv"></span><span id="_CPPv2NK7dolfinx3fem11DirichletBC5valueEv"></span><span id="dolfinx::fem::DirichletBC::valueC"></span><span class="target" id="db/d9f/classdolfinx_1_1fem_1_1DirichletBC_1a5a7afeb567d22660c6686dd78868631c"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">variant</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8FunctionE" title="dolfinx::fem::Function"><span class="n"><span class="pre">Function</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem11DirichletBCE" title="dolfinx::fem::DirichletBC::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8ConstantE" title="dolfinx::fem::Constant"><span class="n"><span class="pre">Constant</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem11DirichletBCE" title="dolfinx::fem::DirichletBC::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem11DirichletBC5valueEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Return boundary value function g. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The boundary values <a class="reference internal" href="#d7/d76/classdolfinx_1_1fem_1_1Function"><span class="std std-ref">Function</span></a> </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem11DirichletBC11dof_indicesEv">
<span id="_CPPv3NK7dolfinx3fem11DirichletBC11dof_indicesEv"></span><span id="_CPPv2NK7dolfinx3fem11DirichletBC11dof_indicesEv"></span><span id="dolfinx::fem::DirichletBC::dof_indicesC"></span><span class="target" id="db/d9f/classdolfinx_1_1fem_1_1DirichletBC_1a94766e0c6432720deb2dab0147e60173"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dof_indices</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem11DirichletBC11dof_indicesEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Access dof indices (local indices, unrolled), including ghosts, to which a Dirichlet condition is applied, and the index to the first non-owned (ghost) index. The array of indices is sorted. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Sorted array of dof indices (unrolled) and index to the first entry in the dof index array that is not owned. Entries <code class="docutils literal notranslate"><span class="pre">dofs[:pos]</span></code> are owned and entries <code class="docutils literal notranslate"><span class="pre">dofs[pos:]</span></code> are ghosts. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem11DirichletBC3setEN3xtl4spanI1TEEd">
<span id="_CPPv3NK7dolfinx3fem11DirichletBC3setEN3xtl4spanI1TEEd"></span><span id="_CPPv2NK7dolfinx3fem11DirichletBC3setEN3xtl4spanI1TEEd"></span><span id="dolfinx::fem::DirichletBC::set__xtl::span:T:.doubleC"></span><span class="target" id="db/d9f/classdolfinx_1_1fem_1_1DirichletBC_1a18ea3616121441c4c837a0c432cb4d32"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem11DirichletBCE" title="dolfinx::fem::DirichletBC::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">scale</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1.0</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem11DirichletBC3setEN3xtl4spanI1TEEd" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set bc entries in <code class="docutils literal notranslate"><span class="pre">x</span></code> to <code class="docutils literal notranslate"><span class="pre">scale</span> <span class="pre">*</span> <span class="pre">x_bc</span></code> </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – <strong>[in]</strong> The array in which to set <code class="docutils literal notranslate"><span class="pre">scale</span> <span class="pre">*</span> <span class="pre">x_bc[i]</span></code>, where x_bc[i] is the boundary value of x[i]. Entries in x that do not have a Dirichlet condition applied to them are unchanged. The length of x must be less than or equal to the index of the greatest boundary dof index. To set values only for degrees-of-freedom that are owned by the calling rank, the length of the array <code class="docutils literal notranslate"><span class="pre">x</span></code> should be equal to the number of dofs owned by this rank. </p></li>
<li><p><strong>scale</strong> – <strong>[in]</strong> The scaling value to apply </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem11DirichletBC3setEN3xtl4spanI1TEERKN3xtl4spanIK1TEEd">
<span id="_CPPv3NK7dolfinx3fem11DirichletBC3setEN3xtl4spanI1TEERKN3xtl4spanIK1TEEd"></span><span id="_CPPv2NK7dolfinx3fem11DirichletBC3setEN3xtl4spanI1TEERKN3xtl4spanIK1TEEd"></span><span id="dolfinx::fem::DirichletBC::set__xtl::span:T:.xtl::span:TC:CR.doubleC"></span><span class="target" id="db/d9f/classdolfinx_1_1fem_1_1DirichletBC_1af575fe4a1c14f576d3d577ee2886fbb8"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem11DirichletBCE" title="dolfinx::fem::DirichletBC::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem11DirichletBCE" title="dolfinx::fem::DirichletBC::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x0</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">scale</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1.0</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem11DirichletBC3setEN3xtl4spanI1TEERKN3xtl4spanIK1TEEd" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set bc entries in <code class="docutils literal notranslate"><span class="pre">x</span></code> to <code class="docutils literal notranslate"><span class="pre">scale</span> <span class="pre">*</span> <span class="pre">(x0</span> <span class="pre">-</span> <span class="pre">x_bc)</span></code> </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – <strong>[in]</strong> The array in which to set <code class="docutils literal notranslate"><span class="pre">scale</span> <span class="pre">*</span> <span class="pre">(x0</span> <span class="pre">-</span> <span class="pre">x_bc)</span></code> </p></li>
<li><p><strong>x0</strong> – <strong>[in]</strong> The array used in compute the value to set </p></li>
<li><p><strong>scale</strong> – <strong>[in]</strong> The scaling value to apply </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem11DirichletBC10dof_valuesEN3xtl4spanI1TEE">
<span id="_CPPv3NK7dolfinx3fem11DirichletBC10dof_valuesEN3xtl4spanI1TEE"></span><span id="_CPPv2NK7dolfinx3fem11DirichletBC10dof_valuesEN3xtl4spanI1TEE"></span><span id="dolfinx::fem::DirichletBC::dof_values__xtl::span:T:C"></span><span class="target" id="db/d9f/classdolfinx_1_1fem_1_1DirichletBC_1a8014296974ca41fb1389ed9f92c9d1be"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dof_values</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem11DirichletBCE" title="dolfinx::fem::DirichletBC::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">values</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem11DirichletBC10dof_valuesEN3xtl4spanI1TEE" title="Permalink to this definition"></a><br /></dt>
<dd><p><dl>
<dt class="sig sig-object cpp">
<em><span class="pre">Todo:</span></em></dt>
<dd><p>Review this function - it is almost identical to the ‘<a class="reference internal" href="#db/d9f/classdolfinx_1_1fem_1_1DirichletBC_1a18ea3616121441c4c837a0c432cb4d32"><span class="std std-ref">DirichletBC::set</span></a>’ function</p>
</dd></dl>

</p>
<p>Set boundary condition value for entries with an applied boundary condition. Other entries are not modified. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>values</strong> – <strong>[out]</strong> The array in which to set the dof values. The array must be at least as long as the array associated with V1 (the space of the function that provides the dof values) </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem11DirichletBC9mark_dofsERKN3xtl4spanINSt6int8_tEEE">
<span id="_CPPv3NK7dolfinx3fem11DirichletBC9mark_dofsERKN3xtl4spanINSt6int8_tEEE"></span><span id="_CPPv2NK7dolfinx3fem11DirichletBC9mark_dofsERKN3xtl4spanINSt6int8_tEEE"></span><span id="dolfinx::fem::DirichletBC::mark_dofs__xtl::span:std::int8_t:CRC"></span><span class="target" id="db/d9f/classdolfinx_1_1fem_1_1DirichletBC_1a8bddd326cbaf91913c3e7c8179204084"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mark_dofs</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int8_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">markers</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem11DirichletBC9mark_dofsERKN3xtl4spanINSt6int8_tEEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set markers[i] = true if dof i has a boundary condition applied. Value of markers[i] is not changed otherwise. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>markers</strong> – <strong>[inout]</strong> Entry makers[i] is set to true if dof i in V0 had a boundary condition applied, i.e. dofs which are fixed by a boundary condition. Other entries in <code class="docutils literal notranslate"><span class="pre">markers</span></code> are left unchanged. </p>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="degree-of-freedom-maps">
<h2>Degree-of-freedom maps<a class="headerlink" href="#degree-of-freedom-maps" title="Permalink to this headline"></a></h2>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem16transpose_dofmapERKN5graph13AdjacencyListINSt7int32_tEEENSt7int32_tE">
<span id="_CPPv3N7dolfinx3fem16transpose_dofmapERKN5graph13AdjacencyListINSt7int32_tEEENSt7int32_tE"></span><span id="_CPPv2N7dolfinx3fem16transpose_dofmapERKN5graph13AdjacencyListINSt7int32_tEEENSt7int32_tE"></span><span id="dolfinx::fem::transpose_dofmap__graph::AdjacencyList:std::int32_t:CR.std::int32_t"></span><span class="target" id="d8/dbf/namespacedolfinx_1_1fem_1aa80fbbb7d5da42a5be17e8f9b7ba90c2"></span><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="graph.html#_CPPv4I0EN7dolfinx5graph13AdjacencyListE" title="dolfinx::graph::AdjacencyList"><span class="n"><span class="pre">AdjacencyList</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">dolfinx</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">transpose_dofmap</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="graph.html#_CPPv4I0EN7dolfinx5graph13AdjacencyListE" title="dolfinx::graph::AdjacencyList"><span class="n"><span class="pre">AdjacencyList</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dofmap</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_cells</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx3fem16transpose_dofmapERKN5graph13AdjacencyListINSt7int32_tEEENSt7int32_tE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Create an adjacency list that maps a global index (process-wise) to the ‘unassembled’ cell-wise contributions. </p>
<p>It is built from the usual (cell, local index) -&gt; global index dof map. An ‘unassembled’ vector is the stacked cell contributions, ordered by cell index. If the usual dof map is:</p>
<p><code class="docutils literal notranslate"><span class="pre">Cell:</span> <span class="pre">0</span> <span class="pre">1</span> <span class="pre">2</span> <span class="pre">3</span></code> <code class="docutils literal notranslate"><span class="pre">Global</span> <span class="pre">index:</span> <span class="pre">[</span> <span class="pre">[0,</span> <span class="pre">3,</span> <span class="pre">5],</span> <span class="pre">[3,</span> <span class="pre">2,</span> <span class="pre">4],</span> <span class="pre">[4,</span> <span class="pre">3,</span> <span class="pre">2],</span> <span class="pre">[2,</span> <span class="pre">1,</span> <span class="pre">0]]</span></code></p>
<p>the ‘transpose’ dof map will be:</p>
<p><code class="docutils literal notranslate"><span class="pre">Global</span> <span class="pre">index:</span> <span class="pre">0</span> <span class="pre">1</span> <span class="pre">2</span> <span class="pre">3</span> <span class="pre">4</span> <span class="pre">5</span></code> <code class="docutils literal notranslate"><span class="pre">Unassembled</span> <span class="pre">index:</span> <span class="pre">[</span> <span class="pre">[0,</span> <span class="pre">11],</span> <span class="pre">[10],</span> <span class="pre">[4,</span> <span class="pre">8,</span> <span class="pre">9],</span> <span class="pre">[1,</span> <span class="pre">3,</span> <span class="pre">7],</span> <span class="pre">[5,</span> <span class="pre">6],</span> <span class="pre">[2]</span> <span class="pre">]</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dofmap</strong> – <strong>[in]</strong> The standard dof map that for each cell (node) gives the global (process-wise) index of each local (cell-wise) index. </p></li>
<li><p><strong>num_cells</strong> – <strong>[in]</strong> The number of cells (nodes) in <code class="docutils literal notranslate"><span class="pre">dofmap</span></code> to consider. The first <code class="docutils literal notranslate"><span class="pre">num_cells</span></code> are used. This is argument is typically used to exclude ghost cell contributions. </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Map from global (process-wise) index to positions in an unaassembled array. The links for each node are sorted. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem6DofMapE">
<span id="_CPPv3N7dolfinx3fem6DofMapE"></span><span id="_CPPv2N7dolfinx3fem6DofMapE"></span><span id="dolfinx::fem::DofMap"></span><span class="target" id="d2/d3c/classdolfinx_1_1fem_1_1DofMap"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">dolfinx</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">DofMap</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx3fem6DofMapE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Degree-of-freedom map. </p>
<p>This class handles the mapping of degrees of freedom. It builds a dof map based on an ElementDofLayout on a specific mesh topology. It will reorder the dofs when running in parallel. Sub-dofmaps, both views and copies, are supported. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000EN7dolfinx3fem6DofMap6DofMapERR1ENSt10shared_ptrIKN6common8IndexMapEEEiRR1Ui">
<span id="_CPPv3I000EN7dolfinx3fem6DofMap6DofMapERR1ENSt10shared_ptrIKN6common8IndexMapEEEiRR1Ui"></span><span id="_CPPv2I000EN7dolfinx3fem6DofMap6DofMapERR1ENSt10shared_ptrIKN6common8IndexMapEEEiRR1Ui"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">E</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">U</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">enable_if_t</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">is_same</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="graph.html#_CPPv4I0EN7dolfinx5graph13AdjacencyListE" title="dolfinx::graph::AdjacencyList"><span class="n"><span class="pre">AdjacencyList</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">decay_t</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000EN7dolfinx3fem6DofMap6DofMapERR1ENSt10shared_ptrIKN6common8IndexMapEEEiRR1Ui" title="dolfinx::fem::DofMap::DofMap::U"><span class="n"><span class="pre">U</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d2/d3c/classdolfinx_1_1fem_1_1DofMap_1a43d7ff21b32aeea2b15b390bdc0f05e4"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DofMap</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I000EN7dolfinx3fem6DofMap6DofMapERR1ENSt10shared_ptrIKN6common8IndexMapEEEiRR1Ui" title="dolfinx::fem::DofMap::DofMap::E"><span class="n"><span class="pre">E</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">element</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6commonE" title="dolfinx::common"><span class="n"><span class="pre">common</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6common8IndexMapE" title="dolfinx::common::IndexMap"><span class="n"><span class="pre">IndexMap</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">index_map</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">index_map_bs</span></span>, <a class="reference internal" href="#_CPPv4I000EN7dolfinx3fem6DofMap6DofMapERR1ENSt10shared_ptrIKN6common8IndexMapEEEiRR1Ui" title="dolfinx::fem::DofMap::DofMap::U"><span class="n"><span class="pre">U</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dofmap</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">bs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000EN7dolfinx3fem6DofMap6DofMapERR1ENSt10shared_ptrIKN6common8IndexMapEEEiRR1Ui" title="Permalink to this definition"></a><br /></dt>
<dd><p>Create a <a class="reference internal" href="#d2/d3c/classdolfinx_1_1fem_1_1DofMap"><span class="std std-ref">DofMap</span></a> from the layout of dofs on a reference element, an IndexMap defining the distribution of dofs across processes and a vector of indices. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>element</strong> – <strong>[in]</strong> The layout of the degrees of freedom on an element (fem::ElementDofLayout) </p></li>
<li><p><strong>index_map</strong> – <strong>[in]</strong> The map describing the parallel distribution of the degrees of freedom </p></li>
<li><p><strong>index_map_bs</strong> – <strong>[in]</strong> The block size associated with the <code class="docutils literal notranslate"><span class="pre">index_map</span></code> </p></li>
<li><p><strong>dofmap</strong> – <strong>[in]</strong> Adjacency list (graph::AdjacencyList&lt;std::int32_t&gt;) with the degrees-of-freedom for each cell </p></li>
<li><p><strong>bs</strong> – <strong>[in]</strong> The block size of the <code class="docutils literal notranslate"><span class="pre">dofmap</span></code> </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem6DofMap6DofMapERR6DofMap">
<span id="_CPPv3N7dolfinx3fem6DofMap6DofMapERR6DofMap"></span><span id="_CPPv2N7dolfinx3fem6DofMap6DofMapERR6DofMap"></span><span id="dolfinx::fem::DofMap::DofMap__DofMapRR"></span><span class="target" id="d2/d3c/classdolfinx_1_1fem_1_1DofMap_1a0e614e2682ad35f4f637b96b06581c01"></span><span class="sig-name descname"><span class="n"><span class="pre">DofMap</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx3fem6DofMap6DofMapERR6DofMap" title="dolfinx::fem::DofMap::DofMap"><span class="n"><span class="pre">DofMap</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dofmap</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx3fem6DofMap6DofMapERR6DofMap" title="Permalink to this definition"></a><br /></dt>
<dd><p>Move constructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem6DofMapaSERR6DofMap">
<span id="_CPPv3N7dolfinx3fem6DofMapaSERR6DofMap"></span><span id="_CPPv2N7dolfinx3fem6DofMapaSERR6DofMap"></span><span id="dolfinx::fem::DofMap::assign-operator__DofMapRR"></span><span class="target" id="d2/d3c/classdolfinx_1_1fem_1_1DofMap_1a4aacf43889b355a948eb30fcaebcb036"></span><a class="reference internal" href="#_CPPv4N7dolfinx3fem6DofMapE" title="dolfinx::fem::DofMap"><span class="n"><span class="pre">DofMap</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx3fem6DofMapE" title="dolfinx::fem::DofMap"><span class="n"><span class="pre">DofMap</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dofmap</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx3fem6DofMapaSERR6DofMap" title="Permalink to this definition"></a><br /></dt>
<dd><p>Move assignment. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem6DofMapeqERK6DofMap">
<span id="_CPPv3NK7dolfinx3fem6DofMapeqERK6DofMap"></span><span id="_CPPv2NK7dolfinx3fem6DofMapeqERK6DofMap"></span><span id="dolfinx::fem::DofMap::eq-operator__DofMapCRC"></span><span class="target" id="d2/d3c/classdolfinx_1_1fem_1_1DofMap_1ace379afdfc559c64b5f0694bc3c8be3d"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">==</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx3fem6DofMapE" title="dolfinx::fem::DofMap"><span class="n"><span class="pre">DofMap</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">map</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem6DofMapeqERK6DofMap" title="Permalink to this definition"></a><br /></dt>
<dd><p>Equality operator. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Returns true if the data for the two dofmaps is equal </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem6DofMap9cell_dofsEi">
<span id="_CPPv3NK7dolfinx3fem6DofMap9cell_dofsEi"></span><span id="_CPPv2NK7dolfinx3fem6DofMap9cell_dofsEi"></span><span id="dolfinx::fem::DofMap::cell_dofs__iC"></span><span class="target" id="d2/d3c/classdolfinx_1_1fem_1_1DofMap_1a056447fe2677696602967b6640c5f69f"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">cell_dofs</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">cell</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem6DofMap9cell_dofsEi" title="Permalink to this definition"></a><br /></dt>
<dd><p>Local-to-global mapping of dofs on a cell. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cell</strong> – <strong>[in]</strong> The cell index </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Local-global dof map for the cell (using process-local indices) </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem6DofMap2bsEv">
<span id="_CPPv3NK7dolfinx3fem6DofMap2bsEv"></span><span id="_CPPv2NK7dolfinx3fem6DofMap2bsEv"></span><span id="dolfinx::fem::DofMap::bsC"></span><span class="target" id="d2/d3c/classdolfinx_1_1fem_1_1DofMap_1ae871aafbf2303beaf6b19cedb13c4179"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">bs</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">noexcept</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem6DofMap2bsEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Return the block size for the dofmap. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem6DofMap18extract_sub_dofmapERKNSt6vectorIiEE">
<span id="_CPPv3NK7dolfinx3fem6DofMap18extract_sub_dofmapERKNSt6vectorIiEE"></span><span id="_CPPv2NK7dolfinx3fem6DofMap18extract_sub_dofmapERKNSt6vectorIiEE"></span><span id="dolfinx::fem::DofMap::extract_sub_dofmap__std::vector:i:CRC"></span><span class="target" id="d2/d3c/classdolfinx_1_1fem_1_1DofMap_1a3714da58e3c2840d0549faacd9bcf4b4"></span><a class="reference internal" href="#_CPPv4N7dolfinx3fem6DofMapE" title="dolfinx::fem::DofMap"><span class="n"><span class="pre">DofMap</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">extract_sub_dofmap</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">component</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem6DofMap18extract_sub_dofmapERKNSt6vectorIiEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Extract subdofmap component. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>component</strong> – <strong>[in]</strong> The component indices </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The dofmap for the component </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem6DofMap8collapseE8MPI_CommRKN4mesh8TopologyERKNSt8functionIFNSt6vectorIiEERKN5graph13AdjacencyListINSt7int32_tEEEEEE">
<span id="_CPPv3NK7dolfinx3fem6DofMap8collapseE8MPI_CommRKN4mesh8TopologyERKNSt8functionIFNSt6vectorIiEERKN5graph13AdjacencyListINSt7int32_tEEEEEE"></span><span id="_CPPv2NK7dolfinx3fem6DofMap8collapseE8MPI_CommRKN4mesh8TopologyERKNSt8functionIFNSt6vectorIiEERKN5graph13AdjacencyListINSt7int32_tEEEEEE"></span><span class="target" id="d2/d3c/classdolfinx_1_1fem_1_1DofMap_1a679dfec61e0b9660989f2ea6af818e92"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4N7dolfinx3fem6DofMapE" title="dolfinx::fem::DofMap"><span class="n"><span class="pre">DofMap</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">collapse</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPI_Comm</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">comm</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="mesh.html#_CPPv4N7dolfinx4meshE" title="dolfinx::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mesh.html#_CPPv4N7dolfinx4mesh8TopologyE" title="dolfinx::mesh::Topology"><span class="n"><span class="pre">Topology</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">topology</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="graph.html#_CPPv4I0EN7dolfinx5graph13AdjacencyListE" title="dolfinx::graph::AdjacencyList"><span class="n"><span class="pre">AdjacencyList</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">reorder_fn</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><code class="docutils literal notranslate"><span class="pre">[](const</span> <span class="pre">graph::AdjacencyList&lt;</span> <span class="pre">std::int32_t</span> <span class="pre">&gt;</span> <span class="pre">&amp;g)</span> <span class="pre">{</span> <span class="pre">return</span> <span class="pre">graph::reorder_gps(g);}</span></code><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem6DofMap8collapseE8MPI_CommRKN4mesh8TopologyERKNSt8functionIFNSt6vectorIiEERKN5graph13AdjacencyListINSt7int32_tEEEEEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Create a “collapsed” dofmap (collapses a sub-dofmap) </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>comm</strong> – <strong>[in]</strong> MPI Communicator </p></li>
<li><p><strong>topology</strong> – <strong>[in]</strong> The mesh topology that the dofmap is defined on </p></li>
<li><p><strong>reorder_fn</strong> – <strong>[in]</strong> The graph re-ordering function to apply to the dof data </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The collapsed dofmap </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem6DofMap4listEv">
<span id="_CPPv3NK7dolfinx3fem6DofMap4listEv"></span><span id="_CPPv2NK7dolfinx3fem6DofMap4listEv"></span><span id="dolfinx::fem::DofMap::listC"></span><span class="target" id="d2/d3c/classdolfinx_1_1fem_1_1DofMap_1ad0dce8d45123908bef625ff0364c8c78"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="graph.html#_CPPv4I0EN7dolfinx5graph13AdjacencyListE" title="dolfinx::graph::AdjacencyList"><span class="n"><span class="pre">AdjacencyList</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">list</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem6DofMap4listEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get dofmap data. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The adjacency list with dof indices for each cell </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem6DofMap18element_dof_layoutEv">
<span id="_CPPv3NK7dolfinx3fem6DofMap18element_dof_layoutEv"></span><span id="_CPPv2NK7dolfinx3fem6DofMap18element_dof_layoutEv"></span><span id="dolfinx::fem::DofMap::element_dof_layoutC"></span><span class="target" id="d2/d3c/classdolfinx_1_1fem_1_1DofMap_1a4acbbca9ac40f4d40147ac5680025aff"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">ElementDofLayout</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">element_dof_layout</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem6DofMap18element_dof_layoutEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Layout of dofs on an element. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx3fem6DofMap12index_map_bsEv">
<span id="_CPPv3NK7dolfinx3fem6DofMap12index_map_bsEv"></span><span id="_CPPv2NK7dolfinx3fem6DofMap12index_map_bsEv"></span><span id="dolfinx::fem::DofMap::index_map_bsC"></span><span class="target" id="d2/d3c/classdolfinx_1_1fem_1_1DofMap_1ac3be09979f4abad037ccdb7c229eae0c"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index_map_bs</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx3fem6DofMap12index_map_bsEv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Block size associated with the index_map. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem6DofMap9index_mapE">
<span id="_CPPv3N7dolfinx3fem6DofMap9index_mapE"></span><span id="_CPPv2N7dolfinx3fem6DofMap9index_mapE"></span><span id="dolfinx::fem::DofMap::index_map__std::shared_ptr:common::IndexMapC:"></span><span class="target" id="d2/d3c/classdolfinx_1_1fem_1_1DofMap_1a27ab5a4eaf813a5c1c8b637d27458c72"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6commonE" title="dolfinx::common"><span class="n"><span class="pre">common</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6common8IndexMapE" title="dolfinx::common::IndexMap"><span class="n"><span class="pre">IndexMap</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index_map</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx3fem6DofMap9index_mapE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Index map that describes the parallel distribution of the dofmap. </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="assembly">
<h2>Assembly<a class="headerlink" href="#assembly" title="Permalink to this headline"></a></h2>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0E22make_coefficients_spanNSt3mapINSt4pairIN7dolfinx3fem12IntegralTypeEiEENSt4pairIN3xtl4spanIK1TEEiEEEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairINSt6vectorI1TEEiEEEE">
<span id="_CPPv3I0E22make_coefficients_spanRKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairINSt6vectorI1TEEiEEEE"></span><span id="_CPPv2I0E22make_coefficients_spanRKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairINSt6vectorI1TEEiEEEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d8/dbf/namespacedolfinx_1_1fem_1aea7f29b20e88c60ed9098eece047eb6f"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">dolfinx</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">IntegralType</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0E22make_coefficients_spanNSt3mapINSt4pairIN7dolfinx3fem12IntegralTypeEiEENSt4pairIN3xtl4spanIK1TEEiEEEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairINSt6vectorI1TEEiEEEE" title="make_coefficients_span::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">make_coefficients_span</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">IntegralType</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E22make_coefficients_spanNSt3mapINSt4pairIN7dolfinx3fem12IntegralTypeEiEENSt4pairIN3xtl4spanIK1TEEiEEEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairINSt6vectorI1TEEiEEEE" title="make_coefficients_span::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">coeffs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0E22make_coefficients_spanNSt3mapINSt4pairIN7dolfinx3fem12IntegralTypeEiEENSt4pairIN3xtl4spanIK1TEEiEEEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairINSt6vectorI1TEEiEEEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Create a map xtl::span from a map of std::vector. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0E15assemble_scalar1TRK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEE">
<span id="_CPPv3I0E15assemble_scalarRK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEE"></span><span id="_CPPv2I0E15assemble_scalarRK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d8/dbf/namespacedolfinx_1_1fem_1aea9d6f1e1c3dd48089cba92ea7b4ce48"></span><a class="reference internal" href="#_CPPv4I0E15assemble_scalar1TRK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEE" title="assemble_scalar::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">assemble_scalar</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Form</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E15assemble_scalar1TRK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEE" title="assemble_scalar::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">M</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0E15assemble_scalar1TRK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEE" title="assemble_scalar::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">constants</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">IntegralType</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0E15assemble_scalar1TRK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEE" title="assemble_scalar::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">coefficients</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0E15assemble_scalar1TRK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Assemble functional into scalar. The caller supplies the form constants and coefficients for this version, which has efficiency benefits if the data can be re-used for multiple calls. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Caller is responsible for accumulation across processes. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>M</strong> – <strong>[in]</strong> The form (functional) to assemble </p></li>
<li><p><strong>constants</strong> – <strong>[in]</strong> The constants that appear in <code class="docutils literal notranslate"><span class="pre">M</span></code> </p></li>
<li><p><strong>coefficients</strong> – <strong>[in]</strong> The coefficients that appear in <code class="docutils literal notranslate"><span class="pre">M</span></code> </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The contribution to the form (functional) from the local process </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0E15assemble_scalar1TRK4FormI1TE">
<span id="_CPPv3I0E15assemble_scalarRK4FormI1TE"></span><span id="_CPPv2I0E15assemble_scalarRK4FormI1TE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d8/dbf/namespacedolfinx_1_1fem_1a7a1bf9501710367c63159980f429bda3"></span><a class="reference internal" href="#_CPPv4I0E15assemble_scalar1TRK4FormI1TE" title="assemble_scalar::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">assemble_scalar</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Form</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E15assemble_scalar1TRK4FormI1TE" title="assemble_scalar::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">M</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0E15assemble_scalar1TRK4FormI1TE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Assemble functional into scalar. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Caller is responsible for accumulation across processes. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>M</strong> – <strong>[in]</strong> The form (functional) to assemble </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The contribution to the form (functional) from the local process </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0E15assemble_vectorvN3xtl4spanI1TEERK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEE">
<span id="_CPPv3I0E15assemble_vectorN3xtl4spanI1TEERK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEE"></span><span id="_CPPv2I0E15assemble_vectorN3xtl4spanI1TEERK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d8/dbf/namespacedolfinx_1_1fem_1aab37f8600c9f1eff0d550872fd1a1d6a"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">assemble_vector</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E15assemble_vectorvN3xtl4spanI1TEERK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEE" title="assemble_vector::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">b</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Form</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E15assemble_vectorvN3xtl4spanI1TEERK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEE" title="assemble_vector::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">L</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0E15assemble_vectorvN3xtl4spanI1TEERK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEE" title="assemble_vector::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">constants</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">IntegralType</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0E15assemble_vectorvN3xtl4spanI1TEERK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEE" title="assemble_vector::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">coefficients</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0E15assemble_vectorvN3xtl4spanI1TEERK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Assemble linear form into a vector, The caller supplies the form constants and coefficients for this version, which has efficiency benefits if the data can be re-used for multiple calls. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b</strong> – <strong>[inout]</strong> The vector to be assembled. It will not be zeroed before assembly. </p></li>
<li><p><strong>L</strong> – <strong>[in]</strong> The linear forms to assemble into b </p></li>
<li><p><strong>constants</strong> – <strong>[in]</strong> The constants that appear in <code class="docutils literal notranslate"><span class="pre">L</span></code> </p></li>
<li><p><strong>coefficients</strong> – <strong>[in]</strong> The coefficients that appear in <code class="docutils literal notranslate"><span class="pre">L</span></code> </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0E15assemble_vectorvN3xtl4spanI1TEERK4FormI1TE">
<span id="_CPPv3I0E15assemble_vectorN3xtl4spanI1TEERK4FormI1TE"></span><span id="_CPPv2I0E15assemble_vectorN3xtl4spanI1TEERK4FormI1TE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d8/dbf/namespacedolfinx_1_1fem_1a49626b25e5a7804b776b0fb59529bc4a"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">assemble_vector</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E15assemble_vectorvN3xtl4spanI1TEERK4FormI1TE" title="assemble_vector::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">b</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Form</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E15assemble_vectorvN3xtl4spanI1TEERK4FormI1TE" title="assemble_vector::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">L</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0E15assemble_vectorvN3xtl4spanI1TEERK4FormI1TE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Assemble linear form into a vector. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b</strong> – <strong>[inout]</strong> The vector to be assembled. It will not be zeroed before assembly. </p></li>
<li><p><strong>L</strong> – <strong>[in]</strong> The linear forms to assemble into b </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0E13apply_liftingvN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK4FormI1TEEEEERKNSt6vectorIN3xtl4spanIK1TEEEERKNSt6vectorINSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEEEERKNSt6vectorINSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEEEERKNSt6vectorIN3xtl4spanIK1TEEEEd">
<span id="_CPPv3I0E13apply_liftingN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK4FormI1TEEEEERKNSt6vectorIN3xtl4spanIK1TEEEERKNSt6vectorINSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEEEERKNSt6vectorINSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEEEERKNSt6vectorIN3xtl4spanIK1TEEEEd"></span><span id="_CPPv2I0E13apply_liftingN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK4FormI1TEEEEERKNSt6vectorIN3xtl4spanIK1TEEEERKNSt6vectorINSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEEEERKNSt6vectorINSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEEEERKNSt6vectorIN3xtl4spanIK1TEEEEd"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d8/dbf/namespacedolfinx_1_1fem_1a60fc3c8fb15d06a35682db45835c04aa"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">apply_lifting</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E13apply_liftingvN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK4FormI1TEEEEERKNSt6vectorIN3xtl4spanIK1TEEEERKNSt6vectorINSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEEEERKNSt6vectorINSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEEEERKNSt6vectorIN3xtl4spanIK1TEEEEd" title="apply_lifting::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">b</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Form</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E13apply_liftingvN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK4FormI1TEEEEERKNSt6vectorIN3xtl4spanIK1TEEEERKNSt6vectorINSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEEEERKNSt6vectorINSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEEEERKNSt6vectorIN3xtl4spanIK1TEEEEd" title="apply_lifting::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0E13apply_liftingvN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK4FormI1TEEEEERKNSt6vectorIN3xtl4spanIK1TEEEERKNSt6vectorINSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEEEERKNSt6vectorINSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEEEERKNSt6vectorIN3xtl4spanIK1TEEEEd" title="apply_lifting::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">constants</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">IntegralType</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0E13apply_liftingvN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK4FormI1TEEEEERKNSt6vectorIN3xtl4spanIK1TEEEERKNSt6vectorINSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEEEERKNSt6vectorINSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEEEERKNSt6vectorIN3xtl4spanIK1TEEEEd" title="apply_lifting::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">coeffs</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">DirichletBC</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E13apply_liftingvN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK4FormI1TEEEEERKNSt6vectorIN3xtl4spanIK1TEEEERKNSt6vectorINSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEEEERKNSt6vectorINSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEEEERKNSt6vectorIN3xtl4spanIK1TEEEEd" title="apply_lifting::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">bcs1</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0E13apply_liftingvN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK4FormI1TEEEEERKNSt6vectorIN3xtl4spanIK1TEEEERKNSt6vectorINSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEEEERKNSt6vectorINSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEEEERKNSt6vectorIN3xtl4spanIK1TEEEEd" title="apply_lifting::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x0</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">scale</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0E13apply_liftingvN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK4FormI1TEEEEERKNSt6vectorIN3xtl4spanIK1TEEEERKNSt6vectorINSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEEEERKNSt6vectorINSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEEEERKNSt6vectorIN3xtl4spanIK1TEEEEd" title="Permalink to this definition"></a><br /></dt>
<dd><p>Modify b such that: </p>
<p>b &lt;- b - scale * A_j (g_j - x0_j)</p>
<p>where j is a block (nest) index. For a non-blocked problem j = 0. The boundary conditions bcs1 are on the trial spaces V_j. The forms in [a] must have the same test space as L (from which b was built), but the trial space may differ. If x0 is not supplied, then it is treated as zero.</p>
<p>Ghost contributions are not accumulated (not sent to owner). Caller is responsible for calling VecGhostUpdateBegin/End. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0E13apply_liftingvN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK4FormI1TEEEEERKNSt6vectorINSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEEEERKNSt6vectorIN3xtl4spanIK1TEEEEd">
<span id="_CPPv3I0E13apply_liftingN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK4FormI1TEEEEERKNSt6vectorINSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEEEERKNSt6vectorIN3xtl4spanIK1TEEEEd"></span><span id="_CPPv2I0E13apply_liftingN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK4FormI1TEEEEERKNSt6vectorINSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEEEERKNSt6vectorIN3xtl4spanIK1TEEEEd"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d8/dbf/namespacedolfinx_1_1fem_1a3418f00b84aa9095bf3c60af46e428d2"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">apply_lifting</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E13apply_liftingvN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK4FormI1TEEEEERKNSt6vectorINSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEEEERKNSt6vectorIN3xtl4spanIK1TEEEEd" title="apply_lifting::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">b</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Form</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E13apply_liftingvN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK4FormI1TEEEEERKNSt6vectorINSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEEEERKNSt6vectorIN3xtl4spanIK1TEEEEd" title="apply_lifting::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">DirichletBC</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E13apply_liftingvN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK4FormI1TEEEEERKNSt6vectorINSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEEEERKNSt6vectorIN3xtl4spanIK1TEEEEd" title="apply_lifting::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">bcs1</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0E13apply_liftingvN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK4FormI1TEEEEERKNSt6vectorINSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEEEERKNSt6vectorIN3xtl4spanIK1TEEEEd" title="apply_lifting::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x0</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">scale</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0E13apply_liftingvN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK4FormI1TEEEEERKNSt6vectorINSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEEEERKNSt6vectorIN3xtl4spanIK1TEEEEd" title="Permalink to this definition"></a><br /></dt>
<dd><p>Modify b such that: </p>
<p>b &lt;- b - scale * A_j (g_j - x0_j)</p>
<p>where j is a block (nest) index. For a non-blocked problem j = 0. The boundary conditions bcs1 are on the trial spaces V_j. The forms in [a] must have the same test space as L (from which b was built), but the trial space may differ. If x0 is not supplied, then it is treated as zero.</p>
<p>Ghost contributions are not accumulated (not sent to owner). Caller is responsible for calling VecGhostUpdateBegin/End. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00E15assemble_matrixv1URK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEE">
<span id="_CPPv3I00E15assemble_matrix1URK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEE"></span><span id="_CPPv2I00E15assemble_matrix1URK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">U</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d8/dbf/namespacedolfinx_1_1fem_1ad7b8fea331f3be7635a89741a80c2aa9"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">assemble_matrix</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00E15assemble_matrixv1URK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEE" title="assemble_matrix::U"><span class="n"><span class="pre">U</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">mat_add</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Form</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00E15assemble_matrixv1URK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEE" title="assemble_matrix::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00E15assemble_matrixv1URK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEE" title="assemble_matrix::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">constants</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">IntegralType</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00E15assemble_matrixv1URK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEE" title="assemble_matrix::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">coefficients</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">DirichletBC</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00E15assemble_matrixv1URK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEE" title="assemble_matrix::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">bcs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00E15assemble_matrixv1URK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Assemble bilinear form into a matrix. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mat_add</strong> – <strong>[in]</strong> The function for adding values into the matrix </p></li>
<li><p><strong>a</strong> – <strong>[in]</strong> The bilinear from to assemble </p></li>
<li><p><strong>constants</strong> – <strong>[in]</strong> Constants that appear in <code class="docutils literal notranslate"><span class="pre">a</span></code> </p></li>
<li><p><strong>coefficients</strong> – <strong>[in]</strong> Coefficients that appear in <code class="docutils literal notranslate"><span class="pre">a</span></code> </p></li>
<li><p><strong>bcs</strong> – <strong>[in]</strong> Boundary conditions to apply. For boundary condition dofs the row and column are zeroed. The diagonal entry is not set. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00E15assemble_matrixv1URK4FormI1TERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEE">
<span id="_CPPv3I00E15assemble_matrix1URK4FormI1TERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEE"></span><span id="_CPPv2I00E15assemble_matrix1URK4FormI1TERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">U</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d8/dbf/namespacedolfinx_1_1fem_1abc95ef57ef6ca26cc3841d241b291544"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">assemble_matrix</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00E15assemble_matrixv1URK4FormI1TERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEE" title="assemble_matrix::U"><span class="n"><span class="pre">U</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">mat_add</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Form</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00E15assemble_matrixv1URK4FormI1TERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEE" title="assemble_matrix::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">DirichletBC</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00E15assemble_matrixv1URK4FormI1TERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEE" title="assemble_matrix::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">bcs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00E15assemble_matrixv1URK4FormI1TERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Assemble bilinear form into a matrix. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mat_add</strong> – <strong>[in]</strong> The function for adding values into the matrix </p></li>
<li><p><strong>a</strong> – <strong>[in]</strong> The bilinear from to assemble </p></li>
<li><p><strong>bcs</strong> – <strong>[in]</strong> Boundary conditions to apply. For boundary condition dofs the row and column are zeroed. The diagonal entry is not set. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00E15assemble_matrixv1URK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEERKN3xtl4spanIKNSt6int8_tEEERKN3xtl4spanIKNSt6int8_tEEE">
<span id="_CPPv3I00E15assemble_matrix1URK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEERKN3xtl4spanIKNSt6int8_tEEERKN3xtl4spanIKNSt6int8_tEEE"></span><span id="_CPPv2I00E15assemble_matrix1URK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEERKN3xtl4spanIKNSt6int8_tEEERKN3xtl4spanIKNSt6int8_tEEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">U</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d8/dbf/namespacedolfinx_1_1fem_1a393d8ac993c86353ded7c613f6e0d949"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">assemble_matrix</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00E15assemble_matrixv1URK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEERKN3xtl4spanIKNSt6int8_tEEERKN3xtl4spanIKNSt6int8_tEEE" title="assemble_matrix::U"><span class="n"><span class="pre">U</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">mat_add</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Form</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00E15assemble_matrixv1URK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEERKN3xtl4spanIKNSt6int8_tEEERKN3xtl4spanIKNSt6int8_tEEE" title="assemble_matrix::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00E15assemble_matrixv1URK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEERKN3xtl4spanIKNSt6int8_tEEERKN3xtl4spanIKNSt6int8_tEEE" title="assemble_matrix::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">constants</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">IntegralType</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I00E15assemble_matrixv1URK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEERKN3xtl4spanIKNSt6int8_tEEERKN3xtl4spanIKNSt6int8_tEEE" title="assemble_matrix::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">coefficients</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int8_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dof_marker0</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int8_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dof_marker1</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00E15assemble_matrixv1URK4FormI1TERKN3xtl4spanIK1TEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK1TEEiEEEERKN3xtl4spanIKNSt6int8_tEEERKN3xtl4spanIKNSt6int8_tEEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Assemble bilinear form into a matrix. Matrix must already be initialised. Does not zero or finalise the matrix. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mat_add</strong> – <strong>[in]</strong> The function for adding values into the matrix </p></li>
<li><p><strong>a</strong> – <strong>[in]</strong> The bilinear form to assemble </p></li>
<li><p><strong>constants</strong> – <strong>[in]</strong> Constants that appear in <code class="docutils literal notranslate"><span class="pre">a</span></code> </p></li>
<li><p><strong>coefficients</strong> – <strong>[in]</strong> Coefficients that appear in <code class="docutils literal notranslate"><span class="pre">a</span></code> </p></li>
<li><p><strong>dof_marker0</strong> – <strong>[in]</strong> Boundary condition markers for the rows. If bc[i] is true then rows i in A will be zeroed. The index i is a local index. </p></li>
<li><p><strong>dof_marker1</strong> – <strong>[in]</strong> Boundary condition markers for the columns. If bc[i] is true then rows i in A will be zeroed. The index i is a local index. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00E15assemble_matrixv1URK4FormI1TERKN3xtl4spanIKNSt6int8_tEEERKN3xtl4spanIKNSt6int8_tEEE">
<span id="_CPPv3I00E15assemble_matrix1URK4FormI1TERKN3xtl4spanIKNSt6int8_tEEERKN3xtl4spanIKNSt6int8_tEEE"></span><span id="_CPPv2I00E15assemble_matrix1URK4FormI1TERKN3xtl4spanIKNSt6int8_tEEERKN3xtl4spanIKNSt6int8_tEEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">U</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d8/dbf/namespacedolfinx_1_1fem_1a4438dab6a0b7d1bbb9ac7776538db0d9"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">assemble_matrix</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00E15assemble_matrixv1URK4FormI1TERKN3xtl4spanIKNSt6int8_tEEERKN3xtl4spanIKNSt6int8_tEEE" title="assemble_matrix::U"><span class="n"><span class="pre">U</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">mat_add</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Form</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00E15assemble_matrixv1URK4FormI1TERKN3xtl4spanIKNSt6int8_tEEERKN3xtl4spanIKNSt6int8_tEEE" title="assemble_matrix::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int8_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dof_marker0</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int8_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dof_marker1</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00E15assemble_matrixv1URK4FormI1TERKN3xtl4spanIKNSt6int8_tEEERKN3xtl4spanIKNSt6int8_tEEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Assemble bilinear form into a matrix. Matrix must already be initialised. Does not zero or finalise the matrix. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mat_add</strong> – <strong>[in]</strong> The function for adding values into the matrix </p></li>
<li><p><strong>a</strong> – <strong>[in]</strong> The bilinear form to assemble </p></li>
<li><p><strong>dof_marker0</strong> – <strong>[in]</strong> Boundary condition markers for the rows. If bc[i] is true then rows i in A will be zeroed. The index i is a local index. </p></li>
<li><p><strong>dof_marker1</strong> – <strong>[in]</strong> Boundary condition markers for the columns. If bc[i] is true then rows i in A will be zeroed. The index i is a local index. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00E12set_diagonalv1URKN3xtl4spanIKNSt7int32_tEEE1T">
<span id="_CPPv3I00E12set_diagonal1URKN3xtl4spanIKNSt7int32_tEEE1T"></span><span id="_CPPv2I00E12set_diagonal1URKN3xtl4spanIKNSt7int32_tEEE1T"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">U</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d8/dbf/namespacedolfinx_1_1fem_1a65133ff0094cd046b6795172d4b36def"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_diagonal</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00E12set_diagonalv1URKN3xtl4spanIKNSt7int32_tEEE1T" title="set_diagonal::U"><span class="n"><span class="pre">U</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">set_fn</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">rows</span></span>, <a class="reference internal" href="#_CPPv4I00E12set_diagonalv1URKN3xtl4spanIKNSt7int32_tEEE1T" title="set_diagonal::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">diagonal</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1.0</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00E12set_diagonalv1URKN3xtl4spanIKNSt7int32_tEEE1T" title="Permalink to this definition"></a><br /></dt>
<dd><p>Sets a value to the diagonal of a matrix for specified rows. It is typically called after assembly. The assembly function zeroes Dirichlet rows and columns. For block matrices, this function should normally be called only on the diagonal blocks, i.e. blocks for which the test and trial spaces are the same. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>set_fn</strong> – <strong>[in]</strong> The function for setting values to a matrix </p></li>
<li><p><strong>rows</strong> – <strong>[in]</strong> The row blocks, in local indices, for which to add a value to the diagonal </p></li>
<li><p><strong>diagonal</strong> – <strong>[in]</strong> The value to add to the diagonal for the specified rows </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00E12set_diagonalv1URKN3fem13FunctionSpaceERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEE1T">
<span id="_CPPv3I00E12set_diagonal1URKN3fem13FunctionSpaceERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEE1T"></span><span id="_CPPv2I00E12set_diagonal1URKN3fem13FunctionSpaceERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEE1T"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">U</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d8/dbf/namespacedolfinx_1_1fem_1ae6b4411ae79d2ac137b4328c5934adcd"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_diagonal</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00E12set_diagonalv1URKN3fem13FunctionSpaceERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEE1T" title="set_diagonal::U"><span class="n"><span class="pre">U</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">set_fn</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">FunctionSpace</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">V</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">DirichletBC</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I00E12set_diagonalv1URKN3fem13FunctionSpaceERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEE1T" title="set_diagonal::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">bcs</span></span>, <a class="reference internal" href="#_CPPv4I00E12set_diagonalv1URKN3fem13FunctionSpaceERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEE1T" title="set_diagonal::T"><span class="n"><span class="pre">T</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">diagonal</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1.0</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00E12set_diagonalv1URKN3fem13FunctionSpaceERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEE1T" title="Permalink to this definition"></a><br /></dt>
<dd><p>Sets a value to the diagonal of the matrix for rows with a Dirichlet boundary conditions applied. This function is typically called after assembly. The assembly function zeroes Dirichlet rows and columns. This function adds the value only to rows that are locally owned, and therefore does not create a need for parallel communication. For block matrices, this function should normally be called only on the diagonal blocks, i.e. blocks for which the test and trial spaces are the same. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>set_fn</strong> – <strong>[in]</strong> The function for setting values to a matrix </p></li>
<li><p><strong>V</strong> – <strong>[in]</strong> The function space for the rows and columns of the matrix. It is used to extract only the Dirichlet boundary conditions that are define on V or subspaces of V. </p></li>
<li><p><strong>bcs</strong> – <strong>[in]</strong> The Dirichlet boundary condtions </p></li>
<li><p><strong>diagonal</strong> – <strong>[in]</strong> The value to add to the diagonal for rows with a boundary condition applied </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0E6set_bcvN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEERKN3xtl4spanIK1TEEd">
<span id="_CPPv3I0E6set_bcN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEERKN3xtl4spanIK1TEEd"></span><span id="_CPPv2I0E6set_bcN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEERKN3xtl4spanIK1TEEd"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d8/dbf/namespacedolfinx_1_1fem_1add975f1a917a766ec8beec3bb0a4ee2d"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_bc</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E6set_bcvN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEERKN3xtl4spanIK1TEEd" title="set_bc::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">b</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">DirichletBC</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E6set_bcvN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEERKN3xtl4spanIK1TEEd" title="set_bc::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">bcs</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0E6set_bcvN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEERKN3xtl4spanIK1TEEd" title="set_bc::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x0</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">scale</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1.0</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0E6set_bcvN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEERKN3xtl4spanIK1TEEd" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set bc values in owned (local) part of the vector, multiplied by ‘scale’. The vectors b and x0 must have the same local size. The bcs should be on (sub-)spaces of the form L that b represents. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0E6set_bcvN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEEd">
<span id="_CPPv3I0E6set_bcN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEEd"></span><span id="_CPPv2I0E6set_bcN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEEd"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d8/dbf/namespacedolfinx_1_1fem_1a7741794a8c818a22f8e30cf5a35cbbd1"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set_bc</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E6set_bcvN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEEd" title="set_bc::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">b</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">DirichletBC</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E6set_bcvN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEEd" title="set_bc::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">bcs</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">scale</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1.0</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0E6set_bcvN3xtl4spanI1TEERKNSt6vectorINSt10shared_ptrIK11DirichletBCI1TEEEEEd" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set bc values in owned (local) part of the vector, multiplied by ‘scale’. The bcs should be on (sub-)spaces of the form L that b represents. </p>
</dd></dl>

</div>
</section>
<section id="interpolation">
<h2>Interpolation<a class="headerlink" href="#interpolation" title="Permalink to this headline"></a></h2>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem20interpolation_coordsERKN3fem13FiniteElementERKN4mesh4MeshERKN3xtl4spanIKNSt7int32_tEEE">
<span id="_CPPv3N7dolfinx3fem20interpolation_coordsERKN3fem13FiniteElementERKN4mesh4MeshERKN3xtl4spanIKNSt7int32_tEEE"></span><span id="_CPPv2N7dolfinx3fem20interpolation_coordsERKN3fem13FiniteElementERKN4mesh4MeshERKN3xtl4spanIKNSt7int32_tEEE"></span><span id="dolfinx::fem::interpolation_coords__fem::FiniteElementCR.mesh::MeshCR.xtl::span:std::int32_tC:CR"></span><span class="target" id="d8/dbf/namespacedolfinx_1_1fem_1a701fdfb2e48625118269e1dc30a614c0"></span><span class="n"><span class="pre">xt</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">xtensor</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">double</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">dolfinx</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">interpolation_coords</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N7dolfinx3fem13FiniteElementE" title="dolfinx::fem::FiniteElement"><span class="n"><span class="pre">FiniteElement</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">element</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx3fem20interpolation_coordsERKN3fem13FiniteElementERKN4mesh4MeshERKN3xtl4spanIKNSt7int32_tEEE" title="dolfinx::fem::interpolation_coords::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Mesh</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">mesh</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">cells</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx3fem20interpolation_coordsERKN3fem13FiniteElementERKN4mesh4MeshERKN3xtl4spanIKNSt7int32_tEEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Compute the evaluation points in the physical space at which an expression should be computed to interpolate it in a finite elemenet space. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>element</strong> – <strong>[in]</strong> The element to be interpolated into </p></li>
<li><p><strong>mesh</strong> – <strong>[in]</strong> The domain </p></li>
<li><p><strong>cells</strong> – <strong>[in]</strong> Indices of the cells in the mesh to compute interpolation coordinates for </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The coordinates in the physical space at which to evaluate an expression. The shape is (3, num_points). </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN7dolfinx3fem11interpolateEvR8FunctionI1TERK8FunctionI1TERKN3xtl4spanIKNSt7int32_tEEE">
<span id="_CPPv3I0EN7dolfinx3fem11interpolateER8FunctionI1TERK8FunctionI1TERKN3xtl4spanIKNSt7int32_tEEE"></span><span id="_CPPv2I0EN7dolfinx3fem11interpolateER8FunctionI1TERK8FunctionI1TERKN3xtl4spanIKNSt7int32_tEEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d8/dbf/namespacedolfinx_1_1fem_1aa6a201c8b337f7d371d2898f1ec3d18b"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">dolfinx</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">interpolate</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8FunctionE" title="dolfinx::fem::Function"><span class="n"><span class="pre">Function</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem11interpolateEvR8FunctionI1TERK8FunctionI1TERKN3xtl4spanIKNSt7int32_tEEE" title="dolfinx::fem::interpolate::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">u</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8FunctionE" title="dolfinx::fem::Function"><span class="n"><span class="pre">Function</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem11interpolateEvR8FunctionI1TERK8FunctionI1TERKN3xtl4spanIKNSt7int32_tEEE" title="dolfinx::fem::interpolate::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">v</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">cells</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN7dolfinx3fem11interpolateEvR8FunctionI1TERK8FunctionI1TERKN3xtl4spanIKNSt7int32_tEEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Interpolate from one finite element <a class="reference internal" href="#d7/d76/classdolfinx_1_1fem_1_1Function"><span class="std std-ref">Function</span></a> to another on the same mesh. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> – <strong>[out]</strong> The function to interpolate into </p></li>
<li><p><strong>v</strong> – <strong>[in]</strong> The function to be interpolated </p></li>
<li><p><strong>cells</strong> – <strong>[in]</strong> List of cell indices to interpolate on </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN7dolfinx3fem11interpolateEvR8FunctionI1TERKN2xt6xarrayI1TEERKN3xtl4spanIKNSt7int32_tEEE">
<span id="_CPPv3I0EN7dolfinx3fem11interpolateER8FunctionI1TERKN2xt6xarrayI1TEERKN3xtl4spanIKNSt7int32_tEEE"></span><span id="_CPPv2I0EN7dolfinx3fem11interpolateER8FunctionI1TERKN2xt6xarrayI1TEERKN3xtl4spanIKNSt7int32_tEEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d8/dbf/namespacedolfinx_1_1fem_1a4f8d9eced653d7d277852e67f39805dd"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">dolfinx</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">interpolate</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem8FunctionE" title="dolfinx::fem::Function"><span class="n"><span class="pre">Function</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem11interpolateEvR8FunctionI1TERKN2xt6xarrayI1TEERKN3xtl4spanIKNSt7int32_tEEE" title="dolfinx::fem::interpolate::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">u</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xt</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">xarray</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem11interpolateEvR8FunctionI1TERKN2xt6xarrayI1TEERKN3xtl4spanIKNSt7int32_tEEE" title="dolfinx::fem::interpolate::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">f</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">cells</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN7dolfinx3fem11interpolateEvR8FunctionI1TERKN2xt6xarrayI1TEERKN3xtl4spanIKNSt7int32_tEEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Interpolate an expression f(x) in a finite element space. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> – <strong>[out]</strong> The function to interpolate into </p></li>
<li><p><strong>f</strong> – <strong>[in]</strong> Evaluation of the function <code class="docutils literal notranslate"><span class="pre">f(x)</span></code> at the physical points <code class="docutils literal notranslate"><span class="pre">x</span></code> given by <a class="reference internal" href="#d8/dbf/namespacedolfinx_1_1fem_1a701fdfb2e48625118269e1dc30a614c0"><span class="std std-ref">fem::interpolation_coords</span></a>. The element used in <a class="reference internal" href="#d8/dbf/namespacedolfinx_1_1fem_1a701fdfb2e48625118269e1dc30a614c0"><span class="std std-ref">fem::interpolation_coords</span></a> should be the same element as associated with <code class="docutils literal notranslate"><span class="pre">u</span></code>. The shape of <code class="docutils literal notranslate"><span class="pre">f</span></code> should be (value_size, num_points), or if value_size=1 the shape can be (num_points,). </p></li>
<li><p><strong>cells</strong> – <strong>[in]</strong> Indices of the cells in the mesh on which to interpolate. Should be the same as the list used when calling <a class="reference internal" href="#d8/dbf/namespacedolfinx_1_1fem_1a701fdfb2e48625118269e1dc30a614c0"><span class="std std-ref">fem::interpolation_coords</span></a>. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="sparsity-pattern-construction">
<h2>Sparsity pattern construction<a class="headerlink" href="#sparsity-pattern-construction" title="Permalink to this headline"></a></h2>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN7dolfinx3fem23create_sparsity_patternEN2la15SparsityPatternERK4FormI1TE">
<span id="_CPPv3I0EN7dolfinx3fem23create_sparsity_patternERK4FormI1TE"></span><span id="_CPPv2I0EN7dolfinx3fem23create_sparsity_patternERK4FormI1TE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d8/dbf/namespacedolfinx_1_1fem_1afefced23767b97f6cc040b07627f9522"></span><a class="reference internal" href="la.html#_CPPv4N7dolfinx2laE" title="dolfinx::la"><span class="n"><span class="pre">la</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="la.html#_CPPv4N7dolfinx2la15SparsityPatternE" title="dolfinx::la::SparsityPattern"><span class="n"><span class="pre">SparsityPattern</span></span></a><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">dolfinx</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">create_sparsity_pattern</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem4FormE" title="dolfinx::fem::Form"><span class="n"><span class="pre">Form</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem23create_sparsity_patternEN2la15SparsityPatternERK4FormI1TE" title="dolfinx::fem::create_sparsity_pattern::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">a</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN7dolfinx3fem23create_sparsity_patternEN2la15SparsityPatternERK4FormI1TE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Create a sparsity pattern for a given form. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The pattern is not finalised, i.e. the caller is responsible for calling SparsityPattern::assemble. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> – <strong>[in]</strong> A bilinear form </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The corresponding sparsity pattern </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem23create_sparsity_patternERKN4mesh8TopologyERKNSt5arrayINSt17reference_wrapperIK6DofMapEEXL2EEEERKNSt3setI12IntegralTypeEE">
<span id="_CPPv3N7dolfinx3fem23create_sparsity_patternERKN4mesh8TopologyERKNSt5arrayINSt17reference_wrapperIK6DofMapEEXL2EEEERKNSt3setI12IntegralTypeEE"></span><span id="_CPPv2N7dolfinx3fem23create_sparsity_patternERKN4mesh8TopologyERKNSt5arrayINSt17reference_wrapperIK6DofMapEEX2EEERKNSt3setI12IntegralTypeEE"></span><span id="dolfinx::fem::create_sparsity_pattern__mesh::TopologyCR.std::array:std::reference_wrapper:DofMapC:.2:CR.std::set:IntegralType:CR"></span><span class="target" id="d8/dbf/namespacedolfinx_1_1fem_1ad3eed6f60241daa4b02ff2be90c54bcd"></span><a class="reference internal" href="la.html#_CPPv4N7dolfinx2laE" title="dolfinx::la"><span class="n"><span class="pre">la</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="la.html#_CPPv4N7dolfinx2la15SparsityPatternE" title="dolfinx::la::SparsityPattern"><span class="n"><span class="pre">SparsityPattern</span></span></a><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">dolfinx</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">create_sparsity_pattern</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="mesh.html#_CPPv4N7dolfinx4meshE" title="dolfinx::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mesh.html#_CPPv4N7dolfinx4mesh8TopologyE" title="dolfinx::mesh::Topology"><span class="n"><span class="pre">Topology</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">topology</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">reference_wrapper</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx3fem6DofMapE" title="dolfinx::fem::DofMap"><span class="n"><span class="pre">DofMap</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dofmaps</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">set</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">IntegralType</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">integrals</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx3fem23create_sparsity_patternERKN4mesh8TopologyERKNSt5arrayINSt17reference_wrapperIK6DofMapEEXL2EEEERKNSt3setI12IntegralTypeEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Create a sparsity pattern for a given form. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The pattern is not finalised, i.e. the caller is responsible for calling SparsityPattern::assemble. </p>
</div>
</dd></dl>

</section>
<section id="petsc-helpers">
<h2>PETSc helpers<a class="headerlink" href="#petsc-helpers" title="Permalink to this headline"></a></h2>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem5petsc13create_matrixERK4FormI11PetscScalarERKNSt6stringE">
<span id="_CPPv3N7dolfinx3fem5petsc13create_matrixERK4FormI11PetscScalarERKNSt6stringE"></span><span id="_CPPv2N7dolfinx3fem5petsc13create_matrixERK4FormI11PetscScalarERKNSt6stringE"></span><span id="dolfinx::fem::petsc::create_matrix__Form:PetscScalar:CR.ssCR"></span><span class="target" id="d4/d44/namespacedolfinx_1_1fem_1_1petsc_1ab3eb6b5d876ebe445760a01b57856de9"></span><span class="n"><span class="pre">Mat</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">dolfinx</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">petsc</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">create_matrix</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem4FormE" title="dolfinx::fem::Form"><span class="n"><span class="pre">Form</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">PetscScalar</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">type</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">)</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx3fem5petsc13create_matrixERK4FormI11PetscScalarERKNSt6stringE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Create a matrix. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> – <strong>[in]</strong> A bilinear form </p></li>
<li><p><strong>type</strong> – <strong>[in]</strong> The PETSc matrix type to create </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A sparse matrix with a layout and sparsity that matches the bilinear form. The caller is responsible for destroying the Mat object. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem5petsc19create_matrix_blockERKNSt6vectorINSt6vectorIPKN3fem4FormI11PetscScalarEEEEEERKNSt6stringE">
<span id="_CPPv3N7dolfinx3fem5petsc19create_matrix_blockERKNSt6vectorINSt6vectorIPKN3fem4FormI11PetscScalarEEEEEERKNSt6stringE"></span><span id="_CPPv2N7dolfinx3fem5petsc19create_matrix_blockERKNSt6vectorINSt6vectorIPKN3fem4FormI11PetscScalarEEEEEERKNSt6stringE"></span><span id="dolfinx::fem::petsc::create_matrix_block__std::vector:std::vector:fem::Form:PetscScalar:CP::CR.ssCR"></span><span class="target" id="d4/d44/namespacedolfinx_1_1fem_1_1petsc_1a7fa02d7269d944afc582a55a54957e42"></span><span class="n"><span class="pre">Mat</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">dolfinx</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">petsc</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">create_matrix_block</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem4FormE" title="dolfinx::fem::Form"><span class="n"><span class="pre">Form</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">PetscScalar</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">type</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">)</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx3fem5petsc19create_matrix_blockERKNSt6vectorINSt6vectorIPKN3fem4FormI11PetscScalarEEEEEERKNSt6stringE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Initialise a monolithic matrix for an array of bilinear forms. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> – <strong>[in]</strong> Rectangular array of bilinear forms. The <code class="docutils literal notranslate"><span class="pre">a(i,</span> <span class="pre">j)</span></code> form will correspond to the <code class="docutils literal notranslate"><span class="pre">(i,</span> <span class="pre">j)</span></code> block in the returned matrix </p></li>
<li><p><strong>type</strong> – <strong>[in]</strong> The type of PETSc Mat. If empty the PETSc default is used. </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A sparse matrix with a layout and sparsity that matches the bilinear forms. The caller is responsible for destroying the Mat object. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem5petsc18create_matrix_nestERKNSt6vectorINSt6vectorIPKN3fem4FormI11PetscScalarEEEEEERKNSt6vectorINSt6vectorINSt6stringEEEEE">
<span id="_CPPv3N7dolfinx3fem5petsc18create_matrix_nestERKNSt6vectorINSt6vectorIPKN3fem4FormI11PetscScalarEEEEEERKNSt6vectorINSt6vectorINSt6stringEEEEE"></span><span id="_CPPv2N7dolfinx3fem5petsc18create_matrix_nestERKNSt6vectorINSt6vectorIPKN3fem4FormI11PetscScalarEEEEEERKNSt6vectorINSt6vectorINSt6stringEEEEE"></span><span id="dolfinx::fem::petsc::create_matrix_nest__std::vector:std::vector:fem::Form:PetscScalar:CP::CR.std::vector:std::vector:ss::CR"></span><span class="target" id="d4/d44/namespacedolfinx_1_1fem_1_1petsc_1ad16725c61d68bcf18ad8617251ea4dcd"></span><span class="n"><span class="pre">Mat</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">dolfinx</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">petsc</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">create_matrix_nest</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem4FormE" title="dolfinx::fem::Form"><span class="n"><span class="pre">Form</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">PetscScalar</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">types</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx3fem5petsc18create_matrix_nestERKNSt6vectorINSt6vectorIPKN3fem4FormI11PetscScalarEEEEEERKNSt6vectorINSt6vectorINSt6stringEEEEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Create nested (MatNest) matrix. </p>
<p>The caller is responsible for destroying the Mat object </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem5petsc19create_vector_blockERKNSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEE">
<span id="_CPPv3N7dolfinx3fem5petsc19create_vector_blockERKNSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEE"></span><span id="_CPPv2N7dolfinx3fem5petsc19create_vector_blockERKNSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEE"></span><span id="dolfinx::fem::petsc::create_vector_block__std::vector:std::pair:std::reference_wrapper:common::IndexMapC:.i::CR"></span><span class="target" id="d4/d44/namespacedolfinx_1_1fem_1_1petsc_1ad2071984b7c4246770228ad79e49672b"></span><span class="n"><span class="pre">Vec</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">dolfinx</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">petsc</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">create_vector_block</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">reference_wrapper</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6commonE" title="dolfinx::common"><span class="n"><span class="pre">common</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6common8IndexMapE" title="dolfinx::common::IndexMap"><span class="n"><span class="pre">IndexMap</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">maps</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx3fem5petsc19create_vector_blockERKNSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Initialise monolithic vector. Vector is not zeroed. </p>
<p>The caller is responsible for destroying the Mat object </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem5petsc18create_vector_nestERKNSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEE">
<span id="_CPPv3N7dolfinx3fem5petsc18create_vector_nestERKNSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEE"></span><span id="_CPPv2N7dolfinx3fem5petsc18create_vector_nestERKNSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEE"></span><span id="dolfinx::fem::petsc::create_vector_nest__std::vector:std::pair:std::reference_wrapper:common::IndexMapC:.i::CR"></span><span class="target" id="d4/d44/namespacedolfinx_1_1fem_1_1petsc_1a7a82687b9bf261027e466f0267927f4f"></span><span class="n"><span class="pre">Vec</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">dolfinx</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">petsc</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">create_vector_nest</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">reference_wrapper</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6commonE" title="dolfinx::common"><span class="n"><span class="pre">common</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6common8IndexMapE" title="dolfinx::common::IndexMap"><span class="n"><span class="pre">IndexMap</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">maps</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx3fem5petsc18create_vector_nestERKNSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Create nested (VecNest) vector. Vector is not zeroed. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem5petsc15assemble_vectorE3VecRK4FormI11PetscScalarERKN3xtl4spanIK11PetscScalarEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK11PetscScalarEEiEEEE">
<span id="_CPPv3N7dolfinx3fem5petsc15assemble_vectorE3VecRK4FormI11PetscScalarERKN3xtl4spanIK11PetscScalarEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK11PetscScalarEEiEEEE"></span><span id="_CPPv2N7dolfinx3fem5petsc15assemble_vectorE3VecRK4FormI11PetscScalarERKN3xtl4spanIK11PetscScalarEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK11PetscScalarEEiEEEE"></span><span id="dolfinx::fem::petsc::assemble_vector__Vec.Form:PetscScalar:CR.xtl::span:PetscScalarC:CR.std::map:std::pair:IntegralType.i:.std::pair:xtl::span:PetscScalarC:.i::CR"></span><span class="target" id="d4/d44/namespacedolfinx_1_1fem_1_1petsc_1afa6c4ef974b6ff7f7e4be3af9abcf8fb"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">dolfinx</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">petsc</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">assemble_vector</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Vec</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">b</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem4FormE" title="dolfinx::fem::Form"><span class="n"><span class="pre">Form</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">PetscScalar</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">L</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">PetscScalar</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">constants</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">IntegralType</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">PetscScalar</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">coeffs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx3fem5petsc15assemble_vectorE3VecRK4FormI11PetscScalarERKN3xtl4spanIK11PetscScalarEERKNSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK11PetscScalarEEiEEEE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Assemble linear form into an already allocated PETSc vector. Ghost contributions are not accumulated (not sent to owner). Caller is responsible for calling VecGhostUpdateBegin/End. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b</strong> – <strong>[inout]</strong> The PETsc vector to assemble the form into. The vector must already be initialised with the correct size. The process-local contribution of the form is assembled into this vector. It is not zeroed before assembly. </p></li>
<li><p><strong>L</strong> – <strong>[in]</strong> The linear form to assemble </p></li>
<li><p><strong>constants</strong> – <strong>[in]</strong> The constants that appear in <code class="docutils literal notranslate"><span class="pre">L</span></code> </p></li>
<li><p><strong>coeffs</strong> – <strong>[in]</strong> The coefficients that appear in <code class="docutils literal notranslate"><span class="pre">L</span></code> </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem5petsc15assemble_vectorE3VecRK4FormI11PetscScalarE">
<span id="_CPPv3N7dolfinx3fem5petsc15assemble_vectorE3VecRK4FormI11PetscScalarE"></span><span id="_CPPv2N7dolfinx3fem5petsc15assemble_vectorE3VecRK4FormI11PetscScalarE"></span><span id="dolfinx::fem::petsc::assemble_vector__Vec.Form:PetscScalar:CR"></span><span class="target" id="d4/d44/namespacedolfinx_1_1fem_1_1petsc_1abaa6fc82e185b0c035b3914022f926d0"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">dolfinx</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">petsc</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">assemble_vector</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Vec</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">b</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem4FormE" title="dolfinx::fem::Form"><span class="n"><span class="pre">Form</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">PetscScalar</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">L</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx3fem5petsc15assemble_vectorE3VecRK4FormI11PetscScalarE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Assemble linear form into an already allocated PETSc vector. Ghost contributions are not accumulated (not sent to owner). Caller is responsible for calling VecGhostUpdateBegin/End. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>b</strong> – <strong>[inout]</strong> The PETsc vector to assemble the form into. The vector must already be initialised with the correct size. The process-local contribution of the form is assembled into this vector. It is not zeroed before assembly. </p></li>
<li><p><strong>L</strong> – <strong>[in]</strong> The linear form to assemble </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem5petsc13apply_liftingE3VecRKNSt6vectorINSt10shared_ptrIK4FormI11PetscScalarEEEEERKNSt6vectorIN3xtl4spanIK11PetscScalarEEEERKNSt6vectorINSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK11PetscScalarEEiEEEEEERKNSt6vectorINSt6vectorINSt10shared_ptrIK11DirichletBCI11PetscScalarEEEEEEERKNSt6vectorI3VecEEd">
<span id="_CPPv3N7dolfinx3fem5petsc13apply_liftingE3VecRKNSt6vectorINSt10shared_ptrIK4FormI11PetscScalarEEEEERKNSt6vectorIN3xtl4spanIK11PetscScalarEEEERKNSt6vectorINSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK11PetscScalarEEiEEEEEERKNSt6vectorINSt6vectorINSt10shared_ptrIK11DirichletBCI11PetscScalarEEEEEEERKNSt6vectorI3VecEEd"></span><span id="_CPPv2N7dolfinx3fem5petsc13apply_liftingE3VecRKNSt6vectorINSt10shared_ptrIK4FormI11PetscScalarEEEEERKNSt6vectorIN3xtl4spanIK11PetscScalarEEEERKNSt6vectorINSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK11PetscScalarEEiEEEEEERKNSt6vectorINSt6vectorINSt10shared_ptrIK11DirichletBCI11PetscScalarEEEEEEERKNSt6vectorI3VecEEd"></span><span id="dolfinx::fem::petsc::apply_lifting__Vec.std::vector:std::shared_ptr:Form:PetscScalar:C::CR.std::vector:xtl::span:PetscScalarC::CR.std::vector:std::map:std::pair:IntegralType.i:.std::pair:xtl::span:PetscScalarC:.i:::CR.std::vector:std::vector:std::shared_ptr:DirichletBC:PetscScalar:C:::CR.std::vector:Vec:CR.double"></span><span class="target" id="d4/d44/namespacedolfinx_1_1fem_1_1petsc_1a5c5d24417614da2931f6b60a0737e902"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">dolfinx</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">petsc</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">apply_lifting</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Vec</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">b</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem4FormE" title="dolfinx::fem::Form"><span class="n"><span class="pre">Form</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">PetscScalar</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">PetscScalar</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">constants</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">IntegralType</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">PetscScalar</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">coeffs</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem11DirichletBCE" title="dolfinx::fem::DirichletBC"><span class="n"><span class="pre">DirichletBC</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">PetscScalar</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">bcs1</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">Vec</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x0</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">scale</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx3fem5petsc13apply_liftingE3VecRKNSt6vectorINSt10shared_ptrIK4FormI11PetscScalarEEEEERKNSt6vectorIN3xtl4spanIK11PetscScalarEEEERKNSt6vectorINSt3mapINSt4pairI12IntegralTypeiEENSt4pairIN3xtl4spanIK11PetscScalarEEiEEEEEERKNSt6vectorINSt6vectorINSt10shared_ptrIK11DirichletBCI11PetscScalarEEEEEEERKNSt6vectorI3VecEEd" title="Permalink to this definition"></a><br /></dt>
<dd><p>Modify b such that: </p>
<p>b &lt;- b - scale * A_j (g_j - x0_j)</p>
<p>where j is a block (nest) index. For a non-blocked problem j = 0. The boundary conditions bcs1 are on the trial spaces V_j. The forms in [a] must have the same test space as L (from which b was built), but the trial space may differ. If x0 is not supplied, then it is treated as zero.</p>
<p>Ghost contributions are not accumulated (not sent to owner). Caller is responsible for calling VecGhostUpdateBegin/End. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem5petsc13apply_liftingE3VecRKNSt6vectorINSt10shared_ptrIK4FormI11PetscScalarEEEEERKNSt6vectorINSt6vectorINSt10shared_ptrIK11DirichletBCI11PetscScalarEEEEEEERKNSt6vectorI3VecEEd">
<span id="_CPPv3N7dolfinx3fem5petsc13apply_liftingE3VecRKNSt6vectorINSt10shared_ptrIK4FormI11PetscScalarEEEEERKNSt6vectorINSt6vectorINSt10shared_ptrIK11DirichletBCI11PetscScalarEEEEEEERKNSt6vectorI3VecEEd"></span><span id="_CPPv2N7dolfinx3fem5petsc13apply_liftingE3VecRKNSt6vectorINSt10shared_ptrIK4FormI11PetscScalarEEEEERKNSt6vectorINSt6vectorINSt10shared_ptrIK11DirichletBCI11PetscScalarEEEEEEERKNSt6vectorI3VecEEd"></span><span id="dolfinx::fem::petsc::apply_lifting__Vec.std::vector:std::shared_ptr:Form:PetscScalar:C::CR.std::vector:std::vector:std::shared_ptr:DirichletBC:PetscScalar:C:::CR.std::vector:Vec:CR.double"></span><span class="target" id="d4/d44/namespacedolfinx_1_1fem_1_1petsc_1ac139c8226dd220355eface0c830da4a7"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">dolfinx</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">petsc</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">apply_lifting</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Vec</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">b</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem4FormE" title="dolfinx::fem::Form"><span class="n"><span class="pre">Form</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">PetscScalar</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem11DirichletBCE" title="dolfinx::fem::DirichletBC"><span class="n"><span class="pre">DirichletBC</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">PetscScalar</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">bcs1</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">Vec</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x0</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">scale</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx3fem5petsc13apply_liftingE3VecRKNSt6vectorINSt10shared_ptrIK4FormI11PetscScalarEEEEERKNSt6vectorINSt6vectorINSt10shared_ptrIK11DirichletBCI11PetscScalarEEEEEEERKNSt6vectorI3VecEEd" title="Permalink to this definition"></a><br /></dt>
<dd><p>Modify b such that: </p>
<p>b &lt;- b - scale * A_j (g_j - x0_j)</p>
<p>where j is a block (nest) index. For a non-blocked problem j = 0. The boundary conditions bcs1 are on the trial spaces V_j. The forms in [a] must have the same test space as L (from which b was built), but the trial space may differ. If x0 is not supplied, then it is treated as zero.</p>
<p>Ghost contributions are not accumulated (not sent to owner). Caller is responsible for calling VecGhostUpdateBegin/End. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx3fem5petsc6set_bcE3VecRKNSt6vectorINSt10shared_ptrIK11DirichletBCI11PetscScalarEEEEEK3Vecd">
<span id="_CPPv3N7dolfinx3fem5petsc6set_bcE3VecRKNSt6vectorINSt10shared_ptrIK11DirichletBCI11PetscScalarEEEEEK3Vecd"></span><span id="_CPPv2N7dolfinx3fem5petsc6set_bcE3VecRKNSt6vectorINSt10shared_ptrIK11DirichletBCI11PetscScalarEEEEEK3Vecd"></span><span id="dolfinx::fem::petsc::set_bc__Vec.std::vector:std::shared_ptr:DirichletBC:PetscScalar:C::CR.VecC.double"></span><span class="target" id="d4/d44/namespacedolfinx_1_1fem_1_1petsc_1a22c5accba39cf6482676524232fc68fb"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-prename descclassname"><span class="n"><span class="pre">dolfinx</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">petsc</span></span><span class="p"><span class="pre">::</span></span></span><span class="sig-name descname"><span class="n"><span class="pre">set_bc</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">Vec</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">b</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx3fem11DirichletBCE" title="dolfinx::fem::DirichletBC"><span class="n"><span class="pre">DirichletBC</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">PetscScalar</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">bcs</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Vec</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x0</span></span>, <span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">scale</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1.0</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx3fem5petsc6set_bcE3VecRKNSt6vectorINSt10shared_ptrIK11DirichletBCI11PetscScalarEEEEEK3Vecd" title="Permalink to this definition"></a><br /></dt>
<dd><p>Set bc values in owned (local) part of the PETSc vector, multiplied by ‘scale’. The vectors b and x0 must have the same local size. The bcs should be on (sub-)spaces of the form L that b represents. </p>
</dd></dl>

</section>
<section id="misc">
<h2>Misc<a class="headerlink" href="#misc" title="Permalink to this headline"></a></h2>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">FunctionSpace</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">extract_function_spaces</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Form</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E23extract_function_spacesNSt6vectorINSt6vectorINSt5arrayINSt10shared_ptrIK13FunctionSpaceEEXL2EEEEEEEERKNSt6vectorINSt6vectorIPK4FormI1TEEEEE" title="extract_function_spaces::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">a</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Extract test (0) and trial (1) function spaces pairs for each bilinear form for a rectangular array of forms. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> – <strong>[in]</strong> A rectangular block on bilinear forms </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Rectangular array of the same shape as <code class="docutils literal notranslate"><span class="pre">a</span></code> with a pair of function spaces in each array entry. If a form is null, then the returned function space pair is (null, null). </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="n"><span class="pre">la</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">SparsityPattern</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">create_sparsity_pattern</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">mesh</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Topology</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">topology</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">reference_wrapper</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">DofMap</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dofmaps</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">set</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">IntegralType</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">integrals</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Create a sparsity pattern for a given form. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The pattern is not finalised, i.e. the caller is responsible for calling SparsityPattern::assemble. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="n"><span class="pre">la</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">SparsityPattern</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">create_sparsity_pattern</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Form</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E23create_sparsity_patternN2la15SparsityPatternERK4FormI1TE" title="create_sparsity_pattern::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">a</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Create a sparsity pattern for a given form. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The pattern is not finalised, i.e. the caller is responsible for calling SparsityPattern::assemble. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>a</strong> – <strong>[in]</strong> A bilinear form </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The corresponding sparsity pattern </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="n"><span class="pre">ElementDofLayout</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">create_element_dof_layout</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">ufcx_dofmap</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dofmap</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">mesh</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">CellType</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">cell_type</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">parent_map</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="p"><span class="pre">}</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Create an ElementDofLayout from a ufcx_dofmap. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="n"><span class="pre">DofMap</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">create_dofmap</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPI_Comm</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">comm</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">ElementDofLayout</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">layout</span></span>, <span class="n"><span class="pre">mesh</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Topology</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">topology</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">AdjacencyList</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">reorder_fn</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">FiniteElement</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">element</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Create a dof map on mesh. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>comm</strong> – <strong>[in]</strong> MPI communicator </p></li>
<li><p><strong>layout</strong> – <strong>[in]</strong> The dof layout on an element </p></li>
<li><p><strong>topology</strong> – <strong>[in]</strong> The mesh topology </p></li>
<li><p><strong>element</strong> – <strong>[in]</strong> The finite element </p></li>
<li><p><strong>reorder_fn</strong> – <strong>[in]</strong> The graph reordering function called on the dofmap </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A new dof map </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_coefficient_names</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv421get_coefficient_namesRK9ufcx_form" title="get_coefficient_names::ufcx_form"><span class="n"><span class="pre">ufcx_form</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ufcx_form</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Get the name of each coefficient in a UFC form. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ufcx_form</strong> – <strong>[in]</strong> The UFC form return The name of each coefficient </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_constant_names</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv418get_constant_namesRK9ufcx_form" title="get_constant_names::ufcx_form"><span class="n"><span class="pre">ufcx_form</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ufcx_form</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Get the name of each constant in a UFC form. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ufcx_form</strong> – <strong>[in]</strong> The UFC form </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The name of each constant </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="n"><span class="pre">Form</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E11create_form4FormI1TERK9ufcx_formRKNSt6vectorINSt10shared_ptrIK13FunctionSpaceEEEERKNSt6vectorINSt10shared_ptrIK8FunctionI1TEEEEERKNSt6vectorINSt10shared_ptrIK8ConstantI1TEEEEERKNSt3mapI12IntegralTypePKN4mesh8MeshTagsIiEEEERKNSt10shared_ptrIKN4mesh4MeshEEE" title="create_form::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">create_form</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0E11create_form4FormI1TERK9ufcx_formRKNSt6vectorINSt10shared_ptrIK13FunctionSpaceEEEERKNSt6vectorINSt10shared_ptrIK8FunctionI1TEEEEERKNSt6vectorINSt10shared_ptrIK8ConstantI1TEEEEERKNSt3mapI12IntegralTypePKN4mesh8MeshTagsIiEEEERKNSt10shared_ptrIKN4mesh4MeshEEE" title="create_form::ufcx_form"><span class="n"><span class="pre">ufcx_form</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ufcx_form</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">FunctionSpace</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">spaces</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Function</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E11create_form4FormI1TERK9ufcx_formRKNSt6vectorINSt10shared_ptrIK13FunctionSpaceEEEERKNSt6vectorINSt10shared_ptrIK8FunctionI1TEEEEERKNSt6vectorINSt10shared_ptrIK8ConstantI1TEEEEERKNSt3mapI12IntegralTypePKN4mesh8MeshTagsIiEEEERKNSt10shared_ptrIKN4mesh4MeshEEE" title="create_form::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">coefficients</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Constant</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E11create_form4FormI1TERK9ufcx_formRKNSt6vectorINSt10shared_ptrIK13FunctionSpaceEEEERKNSt6vectorINSt10shared_ptrIK8FunctionI1TEEEEERKNSt6vectorINSt10shared_ptrIK8ConstantI1TEEEEERKNSt3mapI12IntegralTypePKN4mesh8MeshTagsIiEEEERKNSt10shared_ptrIKN4mesh4MeshEEE" title="create_form::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">constants</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">IntegralType</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0E11create_form4FormI1TERK9ufcx_formRKNSt6vectorINSt10shared_ptrIK13FunctionSpaceEEEERKNSt6vectorINSt10shared_ptrIK8FunctionI1TEEEEERKNSt6vectorINSt10shared_ptrIK8ConstantI1TEEEEERKNSt3mapI12IntegralTypePKN4mesh8MeshTagsIiEEEERKNSt10shared_ptrIKN4mesh4MeshEEE" title="create_form::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MeshTags</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">subdomains</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0E11create_form4FormI1TERK9ufcx_formRKNSt6vectorINSt10shared_ptrIK13FunctionSpaceEEEERKNSt6vectorINSt10shared_ptrIK8FunctionI1TEEEEERKNSt6vectorINSt10shared_ptrIK8ConstantI1TEEEEERKNSt3mapI12IntegralTypePKN4mesh8MeshTagsIiEEEERKNSt10shared_ptrIKN4mesh4MeshEEE" title="create_form::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Mesh</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">mesh</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Create a <a class="reference internal" href="#df/d02/classdolfinx_1_1fem_1_1Form"><span class="std std-ref">Form</span></a> from UFC input. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ufcx_form</strong> – <strong>[in]</strong> The UFC form </p></li>
<li><p><strong>spaces</strong> – <strong>[in]</strong> Vector of function spaces </p></li>
<li><p><strong>coefficients</strong> – <strong>[in]</strong> Coefficient fields in the form </p></li>
<li><p><strong>constants</strong> – <strong>[in]</strong> Spatial constants in the form </p></li>
<li><p><strong>subdomains</strong> – <strong>[in]</strong> Subdomain markers </p></li>
<li><p><strong>mesh</strong> – <strong>[in]</strong> The mesh of the domain </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="n"><span class="pre">Form</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E11create_form4FormI1TERK9ufcx_formRKNSt6vectorINSt10shared_ptrIK13FunctionSpaceEEEERKNSt3mapINSt6stringENSt10shared_ptrIK8FunctionI1TEEEEERKNSt3mapINSt6stringENSt10shared_ptrIK8ConstantI1TEEEEERKNSt3mapI12IntegralTypePKN4mesh8MeshTagsIiEEEERKNSt10shared_ptrIKN4mesh4MeshEEE" title="create_form::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">create_form</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0E11create_form4FormI1TERK9ufcx_formRKNSt6vectorINSt10shared_ptrIK13FunctionSpaceEEEERKNSt3mapINSt6stringENSt10shared_ptrIK8FunctionI1TEEEEERKNSt3mapINSt6stringENSt10shared_ptrIK8ConstantI1TEEEEERKNSt3mapI12IntegralTypePKN4mesh8MeshTagsIiEEEERKNSt10shared_ptrIKN4mesh4MeshEEE" title="create_form::ufcx_form"><span class="n"><span class="pre">ufcx_form</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ufcx_form</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">FunctionSpace</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">spaces</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Function</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E11create_form4FormI1TERK9ufcx_formRKNSt6vectorINSt10shared_ptrIK13FunctionSpaceEEEERKNSt3mapINSt6stringENSt10shared_ptrIK8FunctionI1TEEEEERKNSt3mapINSt6stringENSt10shared_ptrIK8ConstantI1TEEEEERKNSt3mapI12IntegralTypePKN4mesh8MeshTagsIiEEEERKNSt10shared_ptrIKN4mesh4MeshEEE" title="create_form::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">coefficients</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Constant</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E11create_form4FormI1TERK9ufcx_formRKNSt6vectorINSt10shared_ptrIK13FunctionSpaceEEEERKNSt3mapINSt6stringENSt10shared_ptrIK8FunctionI1TEEEEERKNSt3mapINSt6stringENSt10shared_ptrIK8ConstantI1TEEEEERKNSt3mapI12IntegralTypePKN4mesh8MeshTagsIiEEEERKNSt10shared_ptrIKN4mesh4MeshEEE" title="create_form::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">constants</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">IntegralType</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0E11create_form4FormI1TERK9ufcx_formRKNSt6vectorINSt10shared_ptrIK13FunctionSpaceEEEERKNSt3mapINSt6stringENSt10shared_ptrIK8FunctionI1TEEEEERKNSt3mapINSt6stringENSt10shared_ptrIK8ConstantI1TEEEEERKNSt3mapI12IntegralTypePKN4mesh8MeshTagsIiEEEERKNSt10shared_ptrIKN4mesh4MeshEEE" title="create_form::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MeshTags</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">subdomains</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0E11create_form4FormI1TERK9ufcx_formRKNSt6vectorINSt10shared_ptrIK13FunctionSpaceEEEERKNSt3mapINSt6stringENSt10shared_ptrIK8FunctionI1TEEEEERKNSt3mapINSt6stringENSt10shared_ptrIK8ConstantI1TEEEEERKNSt3mapI12IntegralTypePKN4mesh8MeshTagsIiEEEERKNSt10shared_ptrIKN4mesh4MeshEEE" title="create_form::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Mesh</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">mesh</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Create a <a class="reference internal" href="#df/d02/classdolfinx_1_1fem_1_1Form"><span class="std std-ref">Form</span></a> from UFC input. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ufcx_form</strong> – <strong>[in]</strong> The UFC form </p></li>
<li><p><strong>spaces</strong> – <strong>[in]</strong> The function spaces for the <a class="reference internal" href="#df/d02/classdolfinx_1_1fem_1_1Form"><span class="std std-ref">Form</span></a> arguments </p></li>
<li><p><strong>coefficients</strong> – <strong>[in]</strong> Coefficient fields in the form (by name) </p></li>
<li><p><strong>constants</strong> – <strong>[in]</strong> Spatial constants in the form (by name) </p></li>
<li><p><strong>subdomains</strong> – <strong>[in]</strong> Subdomain makers </p></li>
<li><p><strong>mesh</strong> – <strong>[in]</strong> The mesh of the domain. This is required if the form has no arguments, e.g. a functional </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference internal" href="#df/d02/classdolfinx_1_1fem_1_1Form"><span class="std std-ref">Form</span></a> </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="n"><span class="pre">Form</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E11create_form4FormI1TEPFP9ufcx_formvERKNSt6vectorINSt10shared_ptrIK13FunctionSpaceEEEERKNSt3mapINSt6stringENSt10shared_ptrIK8FunctionI1TEEEEERKNSt3mapINSt6stringENSt10shared_ptrIK8ConstantI1TEEEEERKNSt3mapI12IntegralTypePKN4mesh8MeshTagsIiEEEERKNSt10shared_ptrIKN4mesh4MeshEEE" title="create_form::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">create_form</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">ufcx_form</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">fptr</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">)</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">FunctionSpace</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">spaces</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Function</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E11create_form4FormI1TEPFP9ufcx_formvERKNSt6vectorINSt10shared_ptrIK13FunctionSpaceEEEERKNSt3mapINSt6stringENSt10shared_ptrIK8FunctionI1TEEEEERKNSt3mapINSt6stringENSt10shared_ptrIK8ConstantI1TEEEEERKNSt3mapI12IntegralTypePKN4mesh8MeshTagsIiEEEERKNSt10shared_ptrIKN4mesh4MeshEEE" title="create_form::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">coefficients</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Constant</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E11create_form4FormI1TEPFP9ufcx_formvERKNSt6vectorINSt10shared_ptrIK13FunctionSpaceEEEERKNSt3mapINSt6stringENSt10shared_ptrIK8FunctionI1TEEEEERKNSt3mapINSt6stringENSt10shared_ptrIK8ConstantI1TEEEEERKNSt3mapI12IntegralTypePKN4mesh8MeshTagsIiEEEERKNSt10shared_ptrIKN4mesh4MeshEEE" title="create_form::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">constants</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">IntegralType</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0E11create_form4FormI1TEPFP9ufcx_formvERKNSt6vectorINSt10shared_ptrIK13FunctionSpaceEEEERKNSt3mapINSt6stringENSt10shared_ptrIK8FunctionI1TEEEEERKNSt3mapINSt6stringENSt10shared_ptrIK8ConstantI1TEEEEERKNSt3mapI12IntegralTypePKN4mesh8MeshTagsIiEEEERKNSt10shared_ptrIKN4mesh4MeshEEE" title="create_form::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">MeshTags</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">subdomains</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0E11create_form4FormI1TEPFP9ufcx_formvERKNSt6vectorINSt10shared_ptrIK13FunctionSpaceEEEERKNSt3mapINSt6stringENSt10shared_ptrIK8FunctionI1TEEEEERKNSt3mapINSt6stringENSt10shared_ptrIK8ConstantI1TEEEEERKNSt3mapI12IntegralTypePKN4mesh8MeshTagsIiEEEERKNSt10shared_ptrIKN4mesh4MeshEEE" title="create_form::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Mesh</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">mesh</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Create a <a class="reference internal" href="#df/d02/classdolfinx_1_1fem_1_1Form"><span class="std std-ref">Form</span></a> using a factory function that returns a pointer to a ufcx_form. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fptr</strong> – <strong>[in]</strong> pointer to a function returning a pointer to ufcx_form </p></li>
<li><p><strong>spaces</strong> – <strong>[in]</strong> The function spaces for the <a class="reference internal" href="#df/d02/classdolfinx_1_1fem_1_1Form"><span class="std std-ref">Form</span></a> arguments </p></li>
<li><p><strong>coefficients</strong> – <strong>[in]</strong> Coefficient fields in the form (by name) </p></li>
<li><p><strong>constants</strong> – <strong>[in]</strong> Spatial constants in the form (by name) </p></li>
<li><p><strong>subdomains</strong> – <strong>[in]</strong> Subdomain markers </p></li>
<li><p><strong>mesh</strong> – <strong>[in]</strong> The mesh of the domain. This is required if the form has no arguments, e.g. a functional. </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A <a class="reference internal" href="#df/d02/classdolfinx_1_1fem_1_1Form"><span class="std std-ref">Form</span></a> </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="n"><span class="pre">FunctionSpace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">create_functionspace</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv420create_functionspaceRKNSt10shared_ptrIN4mesh4MeshEEERKN5basix13FiniteElementEiRKNSt8functionIFNSt6vectorIiEERKN5graph13AdjacencyListINSt7int32_tEEEEEE" title="create_functionspace::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Mesh</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">mesh</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">basix</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">FiniteElement</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">e</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">bs</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">AdjacencyList</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">reorder_fn</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Create a <a class="reference internal" href="#d9/d69/classdolfinx_1_1fem_1_1FunctionSpace"><span class="std std-ref">FunctionSpace</span></a> from a Basix element. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – <strong>[in]</strong> Mesh </p></li>
<li><p><strong>e</strong> – <strong>[in]</strong> Basix finite element </p></li>
<li><p><strong>bs</strong> – <strong>[in]</strong> The block size, e.g. 3 for a ‘vector’ Lagrange element in 3D </p></li>
<li><p><strong>reorder_fn</strong> – <strong>[in]</strong> The graph reordering function to call on the dofmap. If <code class="docutils literal notranslate"><span class="pre">nullptr</span></code>, the default re-ordering is used. </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The created function space </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="n"><span class="pre">FunctionSpace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">create_functionspace</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">ufcx_function_space</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">fptr</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">char</span></span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">)</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">function_name</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv420create_functionspacePFP19ufcx_function_spacePKcERKNSt6stringERKNSt10shared_ptrIN4mesh4MeshEEERKNSt8functionIFNSt6vectorIiEERKN5graph13AdjacencyListINSt7int32_tEEEEEE" title="create_functionspace::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Mesh</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">mesh</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">function</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">(</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">AdjacencyList</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">)</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">reorder_fn</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Create a <a class="reference internal" href="#d9/d69/classdolfinx_1_1fem_1_1FunctionSpace"><span class="std std-ref">FunctionSpace</span></a> from UFC data. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fptr</strong> – <strong>[in]</strong> <a class="reference internal" href="#d7/d76/classdolfinx_1_1fem_1_1Function"><span class="std std-ref">Function</span></a> Pointer to a ufcx_function_space_create function </p></li>
<li><p><strong>function_name</strong> – <strong>[in]</strong> Name of a function whose function space to create. <a class="reference internal" href="#d7/d76/classdolfinx_1_1fem_1_1Function"><span class="std std-ref">Function</span></a> name is the name of Python variable for ufl.Coefficient, ufl.TrialFunction or ufl.TestFunction as defined in the UFL file. </p></li>
<li><p><strong>mesh</strong> – <strong>[in]</strong> Mesh </p></li>
<li><p><strong>reorder_fn</strong> – <strong>[in]</strong> The graph reordering function to call on the dofmap. If <code class="docutils literal notranslate"><span class="pre">nullptr</span></code>, the default re-ordering is used. </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The created function space </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_cell_orientation_info</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Function</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E25get_cell_orientation_infoN3xtl4spanIKNSt8uint32_tEEERKNSt6vectorINSt10shared_ptrIK8FunctionI1TEEEEE" title="get_cell_orientation_info::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">coefficients</span></span><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">_bs</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Functor</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="k"><span class="pre">static</span></span><span class="w"> </span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pack</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0_i0E4packvRKN3xtl4spanI1TEENSt7int32_tEiRKN3xtl4spanIK1TEERKN3xtl4spanIKNSt8uint32_tEEERK6DofMap7Functor" title="pack::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">coeffs</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">cell</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">bs</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0_i0E4packvRKN3xtl4spanI1TEENSt7int32_tEiRKN3xtl4spanIK1TEERKN3xtl4spanIKNSt8uint32_tEEERK6DofMap7Functor" title="pack::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">v</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">cell_info</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">DofMap</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">dofmap</span></span>, <a class="reference internal" href="#_CPPv4I0_i0E4packvRKN3xtl4spanI1TEENSt7int32_tEiRKN3xtl4spanIK1TEERKN3xtl4spanIKNSt8uint32_tEEERK6DofMap7Functor" title="pack::Functor"><span class="n"><span class="pre">Functor</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">transform</span></span><span class="sig-paren">)</span><br /></dt>
<dd></dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">E</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Functor</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pack_coefficient_entity</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000E23pack_coefficient_entityvRKN3xtl4spanI1TEEiRK8FunctionI1TERKN3xtl4spanIKNSt8uint32_tEEERK1E7FunctorNSt7int32_tE" title="pack_coefficient_entity::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">c</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">cstride</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Function</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000E23pack_coefficient_entityvRKN3xtl4spanI1TEEiRK8FunctionI1TERKN3xtl4spanIKNSt8uint32_tEEERK1E7FunctorNSt7int32_tE" title="pack_coefficient_entity::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">u</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">uint32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">cell_info</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000E23pack_coefficient_entityvRKN3xtl4spanI1TEEiRK8FunctionI1TERKN3xtl4spanIKNSt8uint32_tEEERK1E7FunctorNSt7int32_tE" title="pack_coefficient_entity::E"><span class="n"><span class="pre">E</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">entities</span></span>, <a class="reference internal" href="#_CPPv4I000E23pack_coefficient_entityvRKN3xtl4spanI1TEEiRK8FunctionI1TERKN3xtl4spanIKNSt8uint32_tEEERK1E7FunctorNSt7int32_tE" title="pack_coefficient_entity::Functor"><span class="n"><span class="pre">Functor</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">fetch_cells</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">offset</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Pack a single coefficient for a set of active entities. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c</strong> – <strong>[out]</strong> The coefficient to be packed </p></li>
<li><p><strong>cstride</strong> – <strong>[in]</strong> The total number of coefficient values to pack for each entity </p></li>
<li><p><strong>u</strong> – <strong>[in]</strong> The function to extract data from </p></li>
<li><p><strong>cell_info</strong> – <strong>[in]</strong> Array of bytes describing which transformation has to be applied on the cell to map it to the reference element </p></li>
<li><p><strong>entities</strong> – <strong>[in]</strong> The set of active entities </p></li>
<li><p><strong>fetch_cells</strong> – <strong>[in]</strong> <a class="reference internal" href="#d7/d76/classdolfinx_1_1fem_1_1Function"><span class="std std-ref">Function</span></a> that fetches the cell index for an entity in active_entities (signature: <code class="docutils literal notranslate"><span class="pre">std::function&lt;std::int32_t(E::value_type)&gt;</span></code>) </p></li>
<li><p><strong>offset</strong> – <strong>[in]</strong> The offset for c </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E28allocate_coefficient_storageNSt4pairINSt6vectorI1TEEiEERK4FormI1TE12IntegralTypei" title="allocate_coefficient_storage::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">allocate_coefficient_storage</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Form</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E28allocate_coefficient_storageNSt4pairINSt6vectorI1TEEiEERK4FormI1TE12IntegralTypei" title="allocate_coefficient_storage::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">form</span></span>, <span class="n"><span class="pre">IntegralType</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">integral_type</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">id</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Allocate storage for coefficients of a pair (integral_type, id) from a <a class="reference internal" href="#df/d02/classdolfinx_1_1fem_1_1Form"><span class="std std-ref">fem::Form</span></a> form. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>form</strong> – <strong>[in]</strong> The <a class="reference internal" href="#df/d02/classdolfinx_1_1fem_1_1Form"><span class="std std-ref">Form</span></a> </p></li>
<li><p><strong>integral_type</strong> – <strong>[in]</strong> Type of integral </p></li>
<li><p><strong>id</strong> – <strong>[in]</strong> The id of the integration domain </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A storage container and the column stride </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">IntegralType</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E28allocate_coefficient_storageNSt3mapINSt4pairI12IntegralTypeiEENSt4pairINSt6vectorI1TEEiEEEERK4FormI1TE" title="allocate_coefficient_storage::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">allocate_coefficient_storage</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Form</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E28allocate_coefficient_storageNSt3mapINSt4pairI12IntegralTypeiEENSt4pairINSt6vectorI1TEEiEEEERK4FormI1TE" title="allocate_coefficient_storage::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">form</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Allocate memory for packed coefficients of a <a class="reference internal" href="#df/d02/classdolfinx_1_1fem_1_1Form"><span class="std std-ref">Form</span></a>. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>form</strong> – <strong>[in]</strong> The <a class="reference internal" href="#df/d02/classdolfinx_1_1fem_1_1Form"><span class="std std-ref">Form</span></a> </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A map from a form (integral_type, domain_id) pair to a (coeffs, cstride) pair </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pack_coefficients</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Form</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E17pack_coefficientsvRK4FormI1TE12IntegralTypeiRKN3xtl4spanI1TEEi" title="pack_coefficients::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">form</span></span>, <span class="n"><span class="pre">IntegralType</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">integral_type</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">id</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E17pack_coefficientsvRK4FormI1TE12IntegralTypeiRKN3xtl4spanI1TEEi" title="pack_coefficients::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">c</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">cstride</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Pack coefficients of a <a class="reference internal" href="#df/d02/classdolfinx_1_1fem_1_1Form"><span class="std std-ref">Form</span></a> for a given integral type and domain id. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>form</strong> – <strong>[in]</strong> The <a class="reference internal" href="#df/d02/classdolfinx_1_1fem_1_1Form"><span class="std std-ref">Form</span></a> </p></li>
<li><p><strong>integral_type</strong> – <strong>[in]</strong> Type of integral </p></li>
<li><p><strong>id</strong> – <strong>[in]</strong> The id of the integration domain </p></li>
<li><p><strong>c</strong> – <strong>[in]</strong> The coefficient array </p></li>
<li><p><strong>cstride</strong> – <strong>[in]</strong> The coefficient stride </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Expression</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E17create_expressionN3fem10ExpressionI1TEERK15ufcx_expressionRKNSt6vectorINSt10shared_ptrIKN3fem8FunctionI1TEEEEEERKNSt6vectorINSt10shared_ptrIKN3fem8ConstantI1TEEEEEERKNSt10shared_ptrIKN4mesh4MeshEEERKNSt10shared_ptrIKN3fem13FunctionSpaceEEE" title="create_expression::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">create_expression</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">ufcx_expression</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">expression</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Function</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E17create_expressionN3fem10ExpressionI1TEERK15ufcx_expressionRKNSt6vectorINSt10shared_ptrIKN3fem8FunctionI1TEEEEEERKNSt6vectorINSt10shared_ptrIKN3fem8ConstantI1TEEEEEERKNSt10shared_ptrIKN4mesh4MeshEEERKNSt10shared_ptrIKN3fem13FunctionSpaceEEE" title="create_expression::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">coefficients</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Constant</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E17create_expressionN3fem10ExpressionI1TEERK15ufcx_expressionRKNSt6vectorINSt10shared_ptrIKN3fem8FunctionI1TEEEEEERKNSt6vectorINSt10shared_ptrIKN3fem8ConstantI1TEEEEEERKNSt10shared_ptrIKN4mesh4MeshEEERKNSt10shared_ptrIKN3fem13FunctionSpaceEEE" title="create_expression::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">constants</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0E17create_expressionN3fem10ExpressionI1TEERK15ufcx_expressionRKNSt6vectorINSt10shared_ptrIKN3fem8FunctionI1TEEEEEERKNSt6vectorINSt10shared_ptrIKN3fem8ConstantI1TEEEEEERKNSt10shared_ptrIKN4mesh4MeshEEERKNSt10shared_ptrIKN3fem13FunctionSpaceEEE" title="create_expression::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Mesh</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">mesh</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">FunctionSpace</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">argument_function_space</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Create Expression from UFC. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Expression</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E17create_expressionN3fem10ExpressionI1TEERK15ufcx_expressionRKNSt3mapINSt6stringENSt10shared_ptrIKN3fem8FunctionI1TEEEEEERKNSt3mapINSt6stringENSt10shared_ptrIKN3fem8ConstantI1TEEEEEERKNSt10shared_ptrIKN4mesh4MeshEEERKNSt10shared_ptrIKN3fem13FunctionSpaceEEE" title="create_expression::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">create_expression</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">ufcx_expression</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">expression</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Function</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E17create_expressionN3fem10ExpressionI1TEERK15ufcx_expressionRKNSt3mapINSt6stringENSt10shared_ptrIKN3fem8FunctionI1TEEEEEERKNSt3mapINSt6stringENSt10shared_ptrIKN3fem8ConstantI1TEEEEEERKNSt10shared_ptrIKN4mesh4MeshEEERKNSt10shared_ptrIKN3fem13FunctionSpaceEEE" title="create_expression::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">coefficients</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Constant</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E17create_expressionN3fem10ExpressionI1TEERK15ufcx_expressionRKNSt3mapINSt6stringENSt10shared_ptrIKN3fem8FunctionI1TEEEEEERKNSt3mapINSt6stringENSt10shared_ptrIKN3fem8ConstantI1TEEEEEERKNSt10shared_ptrIKN4mesh4MeshEEERKNSt10shared_ptrIKN3fem13FunctionSpaceEEE" title="create_expression::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">constants</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0E17create_expressionN3fem10ExpressionI1TEERK15ufcx_expressionRKNSt3mapINSt6stringENSt10shared_ptrIKN3fem8FunctionI1TEEEEEERKNSt3mapINSt6stringENSt10shared_ptrIKN3fem8ConstantI1TEEEEEERKNSt10shared_ptrIKN4mesh4MeshEEERKNSt10shared_ptrIKN3fem13FunctionSpaceEEE" title="create_expression::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Mesh</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">mesh</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">fem</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">FunctionSpace</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">argument_function_space</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">nullptr</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Create Expression from UFC input (with named coefficients and constants) </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pack_coefficients</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Form</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E17pack_coefficientsvRK4FormI1TERNSt3mapINSt4pairI12IntegralTypeiEENSt4pairINSt6vectorI1TEEiEEEE" title="pack_coefficients::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">form</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">IntegralType</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E17pack_coefficientsvRK4FormI1TERNSt3mapINSt4pairI12IntegralTypeiEENSt4pairINSt6vectorI1TEEiEEEE" title="pack_coefficients::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">coeffs</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Pack coefficients of a <a class="reference internal" href="#df/d02/classdolfinx_1_1fem_1_1Form"><span class="std std-ref">Form</span></a>. </p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is subject to change </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>form</strong> – <strong>[in]</strong> The <a class="reference internal" href="#df/d02/classdolfinx_1_1fem_1_1Form"><span class="std std-ref">Form</span></a> </p></li>
<li><p><strong>coeffs</strong> – <strong>[in]</strong> A map from a (integral_type, domain_id) pair to a (coeffs, cstride) pair </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E17pack_coefficientsNSt4pairINSt6vectorI1TEEiEERK10ExpressionI1TERKN3xtl4spanIKNSt7int32_tEEE" title="pack_coefficients::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pack_coefficients</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">Expression</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0E17pack_coefficientsNSt4pairINSt6vectorI1TEEiEERK10ExpressionI1TERKN3xtl4spanIKNSt7int32_tEEE" title="pack_coefficients::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">u</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">xtl</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">cells</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Pack coefficients of a Expression u for a give list of active cells. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>u</strong> – <strong>[in]</strong> The Expression </p></li>
<li><p><strong>cells</strong> – <strong>[in]</strong> A list of active cells </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A pair of the form (coeffs, cstride) </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp">
<span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">U</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0E14pack_constantsNSt6vectorIN1U11scalar_typeEEERK1U" title="pack_constants::U"><span class="n"><span class="pre">U</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">scalar_type</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">pack_constants</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0E14pack_constantsNSt6vectorIN1U11scalar_typeEEERK1U" title="pack_constants::U"><span class="n"><span class="pre">U</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">u</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Pack constants of u of generic type U ready for assembly. </p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This function is subject to change </p>
</div>
</dd></dl>

</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="graph.html" class="btn btn-neutral float-left" title="Graph (dolfinx::graph)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="io.html" class="btn btn-neutral float-right" title="IO (dolfinx::io)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, FEniCS Project.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>