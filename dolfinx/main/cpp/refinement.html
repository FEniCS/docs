<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Refinement (dolfinx::refinement) &mdash; DOLFINx 0.3.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=4621528c"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Mesh (dolfinx::mesh)" href="mesh.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            DOLFINx
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="demo.html">Demos</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="api.html">API documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="common.html">Common (<code class="docutils literal notranslate"><span class="pre">dolfinx::common</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry.html">Geometry (<code class="docutils literal notranslate"><span class="pre">dolfinx::geometry</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="graph.html">Graph (<code class="docutils literal notranslate"><span class="pre">dolfinx::graph</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="fem.html">Finite element (<code class="docutils literal notranslate"><span class="pre">dolfinx::fem</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="io.html">IO (<code class="docutils literal notranslate"><span class="pre">dolfinx::io</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="la.html">Linear algebra (<code class="docutils literal notranslate"><span class="pre">dolfinx::la</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="mesh.html">Mesh (<code class="docutils literal notranslate"><span class="pre">dolfinx::mesh</span></code>)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Refinement (<code class="docutils literal notranslate"><span class="pre">dolfinx::refinement</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4N7dolfinx10refinementE"><code class="docutils literal notranslate"><span class="pre">refinement</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx10refinement6OptionE"><code class="docutils literal notranslate"><span class="pre">refinement::Option</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx10refinementorE6Option6Option"><code class="docutils literal notranslate"><span class="pre">refinement::operator|()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx10refinement19option_parent_facetE6Option"><code class="docutils literal notranslate"><span class="pre">refinement::option_parent_facet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx10refinement18option_parent_cellE6Option"><code class="docutils literal notranslate"><span class="pre">refinement::option_parent_cell()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement6refineENSt5tupleIN4mesh4MeshI1TEENSt8optionalINSt6vectorINSt7int32_tEEEEENSt8optionalINSt6vectorINSt6int8_tEEEEEEERKN4mesh4MeshI1TEENSt8optionalINSt4spanIKNSt7int32_tEEEEERKN4mesh21CellPartitionFunctionE6Option"><code class="docutils literal notranslate"><span class="pre">refinement::refine()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx10refinement27update_logical_edgefunctionE8MPI_CommRKNSt6vectorINSt6vectorINSt7int32_tEEEEENSt4spanINSt6int8_tEEERKN6common8IndexMapE"><code class="docutils literal notranslate"><span class="pre">refinement::update_logical_edgefunction()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement19create_new_verticesENSt5tupleINSt3mapINSt7int32_tENSt7int64_tEEENSt6vectorI1TEENSt5arrayINSt6size_tEXL2EEEEEE8MPI_CommRKN5graph13AdjacencyListIiEERKN4mesh4MeshI1TEENSt4spanIKNSt6int8_tEEE"><code class="docutils literal notranslate"><span class="pre">refinement::create_new_vertices()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx10refinement14adjust_indicesERKN6common8IndexMapENSt7int32_tE"><code class="docutils literal notranslate"><span class="pre">refinement::adjust_indices()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx10refinement22transfer_facet_meshtagERKN4mesh8MeshTagsINSt7int32_tEEERKN4mesh8TopologyENSt4spanIKNSt7int32_tEEENSt4spanIKNSt6int8_tEEE"><code class="docutils literal notranslate"><span class="pre">refinement::transfer_facet_meshtag()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx10refinement21transfer_cell_meshtagERKN4mesh8MeshTagsINSt7int32_tEEERKN4mesh8TopologyENSt4spanIKNSt7int32_tEEE"><code class="docutils literal notranslate"><span class="pre">refinement::transfer_cell_meshtag()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx10refinement4implE"><code class="docutils literal notranslate"><span class="pre">refinement::impl</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx10refinement8intervalE"><code class="docutils literal notranslate"><span class="pre">refinement::interval</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx10refinement5plazaE"><code class="docutils literal notranslate"><span class="pre">refinement::plaza</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">DOLFINx</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="api.html">API documentation</a></li>
      <li class="breadcrumb-item active">Refinement (<code class="docutils literal notranslate"><span class="pre">dolfinx::refinement</span></code>)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/refinement.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="refinement-dolfinx-refinement">
<h1>Refinement (<code class="docutils literal notranslate"><span class="pre">dolfinx::refinement</span></code>)<a class="headerlink" href="#refinement-dolfinx-refinement" title="Link to this heading"></a></h1>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx10refinementE">
<span id="_CPPv3N7dolfinx10refinementE"></span><span id="_CPPv2N7dolfinx10refinementE"></span><span id="dolfinx::refinement"></span><span class="target" id="d9/dd6/namespacedolfinx_1_1refinement"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">refinement</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx10refinementE" title="Link to this definition"></a><br /></dt>
<dd><p>Mesh refinement algorithms. </p>
<p>Methods for refining meshes uniformly, or with markers, using edge bisection. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-enums">Enums</p>
<dl class="cpp enum-class">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx10refinement6OptionE">
<span id="_CPPv3N7dolfinx10refinement6OptionE"></span><span id="_CPPv2N7dolfinx10refinement6OptionE"></span><span class="target" id="d9/dd6/namespacedolfinx_1_1refinement_1a6c691bb389aec7339fcaba9d1d36f409"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Option</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">uint8_t</span></span><a class="headerlink" href="#_CPPv4N7dolfinx10refinement6OptionE" title="Link to this definition"></a><br /></dt>
<dd><p>Options for data to compute during mesh refinement. </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx10refinement6Option4noneE">
<span id="_CPPv3N7dolfinx10refinement6Option4noneE"></span><span id="_CPPv2N7dolfinx10refinement6Option4noneE"></span><span class="target" id="d9/dd6/namespacedolfinx_1_1refinement_1a6c691bb389aec7339fcaba9d1d36f409a334c4a4c42fdb79d7ebc3e73b517e6f8"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">none</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx10refinement6Option4noneE" title="Link to this definition"></a><br /></dt>
<dd><p>No extra data </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx10refinement6Option12parent_facetE">
<span id="_CPPv3N7dolfinx10refinement6Option12parent_facetE"></span><span id="_CPPv2N7dolfinx10refinement6Option12parent_facetE"></span><span class="target" id="d9/dd6/namespacedolfinx_1_1refinement_1a6c691bb389aec7339fcaba9d1d36f409afaaa6ae5cd96d1dd51447fb6afb7d6f8"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">parent_facet</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx10refinement6Option12parent_facetE" title="Link to this definition"></a><br /></dt>
<dd><p>Compute list of the cell-local facet indices in the parent cell of each facet in each new cell (or -1 if no match) </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx10refinement6Option11parent_cellE">
<span id="_CPPv3N7dolfinx10refinement6Option11parent_cellE"></span><span id="_CPPv2N7dolfinx10refinement6Option11parent_cellE"></span><span class="target" id="d9/dd6/namespacedolfinx_1_1refinement_1a6c691bb389aec7339fcaba9d1d36f409a8590651f92c51895ca7d8effbf26e3a6"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">parent_cell</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx10refinement6Option11parent_cellE" title="Link to this definition"></a><br /></dt>
<dd><p>Compute list with the parent cell index for each new cell </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx10refinement6Option21parent_cell_and_facetE">
<span id="_CPPv3N7dolfinx10refinement6Option21parent_cell_and_facetE"></span><span id="_CPPv2N7dolfinx10refinement6Option21parent_cell_and_facetE"></span><span class="target" id="d9/dd6/namespacedolfinx_1_1refinement_1a6c691bb389aec7339fcaba9d1d36f409aa564af488c12ee346fdbc0f50825f5e8"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">parent_cell_and_facet</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx10refinement6Option21parent_cell_and_facetE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx10refinementorE6Option6Option">
<span id="_CPPv3N7dolfinx10refinementorE6Option6Option"></span><span id="_CPPv2N7dolfinx10refinementorE6Option6Option"></span><span id="dolfinx::refinement::or-operator__Option.Option"></span><span class="target" id="d9/dd6/namespacedolfinx_1_1refinement_1a1a3e4850480328f7d212eb5c902f885a"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx10refinement6OptionE" title="dolfinx::refinement::Option"><span class="n"><span class="pre">Option</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">|</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx10refinement6OptionE" title="dolfinx::refinement::Option"><span class="n"><span class="pre">Option</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">a</span></span>, <a class="reference internal" href="#_CPPv4N7dolfinx10refinement6OptionE" title="dolfinx::refinement::Option"><span class="n"><span class="pre">Option</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">b</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx10refinementorE6Option6Option" title="Link to this definition"></a><br /></dt>
<dd><p>Combine two refinement options into one, both flags will be set for the resulting option. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx10refinement19option_parent_facetE6Option">
<span id="_CPPv3N7dolfinx10refinement19option_parent_facetE6Option"></span><span id="_CPPv2N7dolfinx10refinement19option_parent_facetE6Option"></span><span id="dolfinx::refinement::option_parent_facet__Option"></span><span class="target" id="d9/dd6/namespacedolfinx_1_1refinement_1a78a98580896f45de9e5bc70791e90417"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">option_parent_facet</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx10refinement6OptionE" title="dolfinx::refinement::Option"><span class="n"><span class="pre">Option</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">a</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx10refinement19option_parent_facetE6Option" title="Link to this definition"></a><br /></dt>
<dd><p>Check if parent_facet flag is set. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx10refinement18option_parent_cellE6Option">
<span id="_CPPv3N7dolfinx10refinement18option_parent_cellE6Option"></span><span id="_CPPv2N7dolfinx10refinement18option_parent_cellE6Option"></span><span id="dolfinx::refinement::option_parent_cell__Option"></span><span class="target" id="d9/dd6/namespacedolfinx_1_1refinement_1a47c33edb7c32f008df5acf88566c3658"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">option_parent_cell</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx10refinement6OptionE" title="dolfinx::refinement::Option"><span class="n"><span class="pre">Option</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">a</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx10refinement18option_parent_cellE6Option" title="Link to this definition"></a><br /></dt>
<dd><p>Check if parent_cell flag is set. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement6refineENSt5tupleIN4mesh4MeshI1TEENSt8optionalINSt6vectorINSt7int32_tEEEEENSt8optionalINSt6vectorINSt6int8_tEEEEEEERKN4mesh4MeshI1TEENSt8optionalINSt4spanIKNSt7int32_tEEEEERKN4mesh21CellPartitionFunctionE6Option">
<span id="_CPPv3I_NSt14floating_pointEEN7dolfinx10refinement6refineERKN4mesh4MeshI1TEENSt8optionalINSt4spanIKNSt7int32_tEEEEERKN4mesh21CellPartitionFunctionE6Option"></span><span id="_CPPv2I_NSt14floating_pointEEN7dolfinx10refinement6refineERKN4mesh4MeshI1TEENSt8optionalINSt4spanIKNSt7int32_tEEEEERKN4mesh21CellPartitionFunctionE6Option"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">floating_point</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d9/dd6/namespacedolfinx_1_1refinement_1a0280000a517fc2e759b8ce4e4e9f6afd"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">tuple</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement6refineENSt5tupleIN4mesh4MeshI1TEENSt8optionalINSt6vectorINSt7int32_tEEEEENSt8optionalINSt6vectorINSt6int8_tEEEEEEERKN4mesh4MeshI1TEENSt8optionalINSt4spanIKNSt7int32_tEEEEERKN4mesh21CellPartitionFunctionE6Option" title="dolfinx::refinement::refine::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Mesh</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement6refineENSt5tupleIN4mesh4MeshI1TEENSt8optionalINSt6vectorINSt7int32_tEEEEENSt8optionalINSt6vectorINSt6int8_tEEEEEEERKN4mesh4MeshI1TEENSt8optionalINSt4spanIKNSt7int32_tEEEEERKN4mesh21CellPartitionFunctionE6Option" title="dolfinx::refinement::refine::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int8_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">refine</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement6refineENSt5tupleIN4mesh4MeshI1TEENSt8optionalINSt6vectorINSt7int32_tEEEEENSt8optionalINSt6vectorINSt6int8_tEEEEEEERKN4mesh4MeshI1TEENSt8optionalINSt4spanIKNSt7int32_tEEEEERKN4mesh21CellPartitionFunctionE6Option" title="dolfinx::refinement::refine::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Mesh</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement6refineENSt5tupleIN4mesh4MeshI1TEENSt8optionalINSt6vectorINSt7int32_tEEEEENSt8optionalINSt6vectorINSt6int8_tEEEEEEERKN4mesh4MeshI1TEENSt8optionalINSt4spanIKNSt7int32_tEEEEERKN4mesh21CellPartitionFunctionE6Option" title="dolfinx::refinement::refine::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">mesh</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">edges</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement6refineENSt5tupleIN4mesh4MeshI1TEENSt8optionalINSt6vectorINSt7int32_tEEEEENSt8optionalINSt6vectorINSt6int8_tEEEEEEERKN4mesh4MeshI1TEENSt8optionalINSt4spanIKNSt7int32_tEEEEERKN4mesh21CellPartitionFunctionE6Option" title="dolfinx::refinement::refine::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">CellPartitionFunction</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">partitioner</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement6refineENSt5tupleIN4mesh4MeshI1TEENSt8optionalINSt6vectorINSt7int32_tEEEEENSt8optionalINSt6vectorINSt6int8_tEEEEEEERKN4mesh4MeshI1TEENSt8optionalINSt4spanIKNSt7int32_tEEEEERKN4mesh21CellPartitionFunctionE6Option" title="dolfinx::refinement::refine::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">create_cell_partitioner</span></span><span class="p"><span class="pre">(</span></span><a class="reference internal" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement6refineENSt5tupleIN4mesh4MeshI1TEENSt8optionalINSt6vectorINSt7int32_tEEEEENSt8optionalINSt6vectorINSt6int8_tEEEEEEERKN4mesh4MeshI1TEENSt8optionalINSt4spanIKNSt7int32_tEEEEERKN4mesh21CellPartitionFunctionE6Option" title="dolfinx::refinement::refine::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">GhostMode</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">none</span></span><span class="p"><span class="pre">)</span></span>, <a class="reference internal" href="#_CPPv4N7dolfinx10refinement6OptionE" title="dolfinx::refinement::Option"><span class="n"><span class="pre">Option</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">option</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx10refinement6OptionE" title="dolfinx::refinement::Option"><span class="n"><span class="pre">Option</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N7dolfinx10refinement6Option4noneE" title="dolfinx::refinement::Option::none"><span class="n"><span class="pre">none</span></span></a><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement6refineENSt5tupleIN4mesh4MeshI1TEENSt8optionalINSt6vectorINSt7int32_tEEEEENSt8optionalINSt6vectorINSt6int8_tEEEEEEERKN4mesh4MeshI1TEENSt8optionalINSt4spanIKNSt7int32_tEEEEERKN4mesh21CellPartitionFunctionE6Option" title="Link to this definition"></a><br /></dt>
<dd><p>Refine a mesh with markers. </p>
<p>The refined mesh can be optionally re-partitioned across processes. Passing <code class="docutils literal notranslate"><span class="pre">nullptr</span></code> for <code class="docutils literal notranslate"><span class="pre">partitioner</span></code>, refined cells will be on the same process as the parent cell.</p>
<p>Parent-child relationships can be optionally computed. Parent-child relationships can be used to create MeshTags on the refined mesh from MeshTags on the parent mesh.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Using the default partitioner for a refined mesh, the refined mesh will <strong>not</strong> include ghosts cells (cells connected by facet to an owned cell) even if the parent mesh is ghosted.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Passing <code class="docutils literal notranslate"><span class="pre">nullptr</span></code> for <code class="docutils literal notranslate"><span class="pre">partitioner</span></code>, the refined mesh will <strong>not</strong> have ghosts cells even if the parent mesh is ghosted. The possibility to not re-partition the refined mesh and include ghost cells in the refined mesh will be added in a future release.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – <strong>[in]</strong> Input mesh to be refined. </p></li>
<li><p><strong>edges</strong> – <strong>[in]</strong> Indices of the edges that should be split in the refinement. If not provided (<code class="docutils literal notranslate"><span class="pre">std::nullopt</span></code>), uniform refinement is performed. </p></li>
<li><p><strong>partitioner</strong> – <strong>[in]</strong> Partitioner to be used to distribute the refined mesh. If not callable, refined cells will be on the same process as the parent cell. </p></li>
<li><p><strong>option</strong> – <strong>[in]</strong> Control the computation of parent facets, parent cells. If an option is not selected, an empty list is returned. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>New mesh, and optional parent cell indices and parent facet indices. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx10refinement27update_logical_edgefunctionE8MPI_CommRKNSt6vectorINSt6vectorINSt7int32_tEEEEENSt4spanINSt6int8_tEEERKN6common8IndexMapE">
<span id="_CPPv3N7dolfinx10refinement27update_logical_edgefunctionE8MPI_CommRKNSt6vectorINSt6vectorINSt7int32_tEEEEENSt4spanINSt6int8_tEEERKN6common8IndexMapE"></span><span id="_CPPv2N7dolfinx10refinement27update_logical_edgefunctionE8MPI_CommRKNSt6vectorINSt6vectorINSt7int32_tEEEEENSt4spanINSt6int8_tEEERKN6common8IndexMapE"></span><span id="dolfinx::refinement::update_logical_edgefunction__MPI_Comm.std::vector:std::vector:std::int32_t::CR.std::span:std::int8_t:.common::IndexMapCR"></span><span class="target" id="d9/dd6/namespacedolfinx_1_1refinement_1afa85a686a29278fad31cf3a01d36fc69"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">update_logical_edgefunction</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPI_Comm</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">comm</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">marked_for_update</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int8_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">marked_edges</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6commonE" title="dolfinx::common"><span class="n"><span class="pre">common</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6common8IndexMapE" title="dolfinx::common::IndexMap"><span class="n"><span class="pre">IndexMap</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">map</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx10refinement27update_logical_edgefunctionE8MPI_CommRKNSt6vectorINSt6vectorINSt7int32_tEEEEENSt4spanINSt6int8_tEEERKN6common8IndexMapE" title="Link to this definition"></a><br /></dt>
<dd><p>Communicate edge markers between processes that share edges. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>comm</strong> – <strong>[in]</strong> MPI Communicator for neighborhood </p></li>
<li><p><strong>marked_for_update</strong> – <strong>[in]</strong> Lists of edges to be updated on each neighbor. <code class="docutils literal notranslate"><span class="pre">marked_for_update[r]</span></code> is the list of edge indices that are marked by the caller and are shared with local MPI rank <code class="docutils literal notranslate"><span class="pre">r</span></code>. </p></li>
<li><p><strong>marked_edges</strong> – <strong>[inout]</strong> Marker for each edge on the calling process </p></li>
<li><p><strong>map</strong> – <strong>[in]</strong> Index map for the mesh edges </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement19create_new_verticesENSt5tupleINSt3mapINSt7int32_tENSt7int64_tEEENSt6vectorI1TEENSt5arrayINSt6size_tEXL2EEEEEE8MPI_CommRKN5graph13AdjacencyListIiEERKN4mesh4MeshI1TEENSt4spanIKNSt6int8_tEEE">
<span id="_CPPv3I_NSt14floating_pointEEN7dolfinx10refinement19create_new_verticesE8MPI_CommRKN5graph13AdjacencyListIiEERKN4mesh4MeshI1TEENSt4spanIKNSt6int8_tEEE"></span><span id="_CPPv2I_NSt14floating_pointEEN7dolfinx10refinement19create_new_verticesE8MPI_CommRKN5graph13AdjacencyListIiEERKN4mesh4MeshI1TEENSt4spanIKNSt6int8_tEEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">floating_point</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d9/dd6/namespacedolfinx_1_1refinement_1aa7defb6e3ffb2fb8a62fb5280543e948"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">tuple</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement19create_new_verticesENSt5tupleINSt3mapINSt7int32_tENSt7int64_tEEENSt6vectorI1TEENSt5arrayINSt6size_tEXL2EEEEEE8MPI_CommRKN5graph13AdjacencyListIiEERKN4mesh4MeshI1TEENSt4spanIKNSt6int8_tEEE" title="dolfinx::refinement::create_new_vertices::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">size_t</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">create_new_vertices</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPI_Comm</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">comm</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="graph.html#_CPPv4I0EN7dolfinx5graph13AdjacencyListE" title="dolfinx::graph::AdjacencyList"><span class="n"><span class="pre">AdjacencyList</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">shared_edges</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement19create_new_verticesENSt5tupleINSt3mapINSt7int32_tENSt7int64_tEEENSt6vectorI1TEENSt5arrayINSt6size_tEXL2EEEEEE8MPI_CommRKN5graph13AdjacencyListIiEERKN4mesh4MeshI1TEENSt4spanIKNSt6int8_tEEE" title="dolfinx::refinement::create_new_vertices::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Mesh</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement19create_new_verticesENSt5tupleINSt3mapINSt7int32_tENSt7int64_tEEENSt6vectorI1TEENSt5arrayINSt6size_tEXL2EEEEEE8MPI_CommRKN5graph13AdjacencyListIiEERKN4mesh4MeshI1TEENSt4spanIKNSt6int8_tEEE" title="dolfinx::refinement::create_new_vertices::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">mesh</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int8_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">marked_edges</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement19create_new_verticesENSt5tupleINSt3mapINSt7int32_tENSt7int64_tEEENSt6vectorI1TEENSt5arrayINSt6size_tEXL2EEEEEE8MPI_CommRKN5graph13AdjacencyListIiEERKN4mesh4MeshI1TEENSt4spanIKNSt6int8_tEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Add new vertex for each marked edge, and create new_vertex_coordinates and global_edge-&gt;new_vertex map. </p>
<p>Communicate new vertices with MPI to all affected processes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>comm</strong> – <strong>[in]</strong> MPI Communicator for neighborhood </p></li>
<li><p><strong>shared_edges</strong> – <strong>[in]</strong> For each local edge on a process map to ghost processes </p></li>
<li><p><strong>mesh</strong> – <strong>[in]</strong> Existing mesh </p></li>
<li><p><strong>marked_edges</strong> – <strong>[in]</strong> A marker for all edges on the process (local + ghosts) indicating if an edge should be refined </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(0) map from local edge index to new vertex global index, (1) the coordinates of the new vertices (row-major storage) and (2) the shape of the new coordinates. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx10refinement14adjust_indicesERKN6common8IndexMapENSt7int32_tE">
<span id="_CPPv3N7dolfinx10refinement14adjust_indicesERKN6common8IndexMapENSt7int32_tE"></span><span id="_CPPv2N7dolfinx10refinement14adjust_indicesERKN6common8IndexMapENSt7int32_tE"></span><span id="dolfinx::refinement::adjust_indices__common::IndexMapCR.std::int32_t"></span><span class="target" id="d9/dd6/namespacedolfinx_1_1refinement_1aaa134a721f1c98625a950d8da05a29f4"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">adjust_indices</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6commonE" title="dolfinx::common"><span class="n"><span class="pre">common</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6common8IndexMapE" title="dolfinx::common::IndexMap"><span class="n"><span class="pre">IndexMap</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">map</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">n</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx10refinement14adjust_indicesERKN6common8IndexMapENSt7int32_tE" title="Link to this definition"></a><br /></dt>
<dd><p>Given an index map, add “n” extra indices at the end of local range. </p>
<p><dl>
<dt class="sig sig-object cpp">
<em><span class="pre">Todo:</span></em></dt>
<dd><p>Improve docstring.</p>
</dd></dl>

</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The returned global indices (local and ghosts) are adjust for the addition of new local indices.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>map</strong> – <strong>[in]</strong> Index map. </p></li>
<li><p><strong>n</strong> – <strong>[in]</strong> Number of new local indices. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>New global indices for both owned and ghosted indices in input index map. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx10refinement22transfer_facet_meshtagERKN4mesh8MeshTagsINSt7int32_tEEERKN4mesh8TopologyENSt4spanIKNSt7int32_tEEENSt4spanIKNSt6int8_tEEE">
<span id="_CPPv3N7dolfinx10refinement22transfer_facet_meshtagERKN4mesh8MeshTagsINSt7int32_tEEERKN4mesh8TopologyENSt4spanIKNSt7int32_tEEENSt4spanIKNSt6int8_tEEE"></span><span id="_CPPv2N7dolfinx10refinement22transfer_facet_meshtagERKN4mesh8MeshTagsINSt7int32_tEEERKN4mesh8TopologyENSt4spanIKNSt7int32_tEEENSt4spanIKNSt6int8_tEEE"></span><span id="dolfinx::refinement::transfer_facet_meshtag__mesh::MeshTags:std::int32_t:CR.mesh::TopologyCR.std::span:std::int32_tC:.std::span:std::int8_tC:"></span><span class="target" id="d9/dd6/namespacedolfinx_1_1refinement_1a069715b9c9820982b5d13ff66a2add48"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">transfer_facet_meshtag</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="mesh.html#_CPPv4N7dolfinx4meshE" title="dolfinx::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mesh.html#_CPPv4I0EN7dolfinx4mesh8MeshTagsE" title="dolfinx::mesh::MeshTags"><span class="n"><span class="pre">MeshTags</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">tags0</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="mesh.html#_CPPv4N7dolfinx4meshE" title="dolfinx::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mesh.html#_CPPv4N7dolfinx4mesh8TopologyE" title="dolfinx::mesh::Topology"><span class="n"><span class="pre">Topology</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">topology1</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">cell</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int8_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">facet</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx10refinement22transfer_facet_meshtagERKN4mesh8MeshTagsINSt7int32_tEEERKN4mesh8TopologyENSt4spanIKNSt7int32_tEEENSt4spanIKNSt6int8_tEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Transfer facet MeshTags from coarse mesh to refined mesh. </p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The refined mesh must not have been redistributed during refinement.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Mesh/topology <code class="docutils literal notranslate"><span class="pre">GhostMode</span></code> must be mesh::GhostMode::none.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tags0</strong> – <strong>[in]</strong> Tags on the parent mesh. </p></li>
<li><p><strong>topology1</strong> – <strong>[in]</strong> Refined mesh topology. </p></li>
<li><p><strong>cell</strong> – <strong>[in]</strong> Parent cell of each cell in refined mesh </p></li>
<li><p><strong>facet</strong> – <strong>[in]</strong> Local facets of parent in each cell in refined mesh. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(0) entities and (1) values on the refined topology. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx10refinement21transfer_cell_meshtagERKN4mesh8MeshTagsINSt7int32_tEEERKN4mesh8TopologyENSt4spanIKNSt7int32_tEEE">
<span id="_CPPv3N7dolfinx10refinement21transfer_cell_meshtagERKN4mesh8MeshTagsINSt7int32_tEEERKN4mesh8TopologyENSt4spanIKNSt7int32_tEEE"></span><span id="_CPPv2N7dolfinx10refinement21transfer_cell_meshtagERKN4mesh8MeshTagsINSt7int32_tEEERKN4mesh8TopologyENSt4spanIKNSt7int32_tEEE"></span><span id="dolfinx::refinement::transfer_cell_meshtag__mesh::MeshTags:std::int32_t:CR.mesh::TopologyCR.std::span:std::int32_tC:"></span><span class="target" id="d9/dd6/namespacedolfinx_1_1refinement_1aafc960d3126a66bdfb1a246e2f539e3a"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">transfer_cell_meshtag</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="mesh.html#_CPPv4N7dolfinx4meshE" title="dolfinx::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mesh.html#_CPPv4I0EN7dolfinx4mesh8MeshTagsE" title="dolfinx::mesh::MeshTags"><span class="n"><span class="pre">MeshTags</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">tags0</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="mesh.html#_CPPv4N7dolfinx4meshE" title="dolfinx::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mesh.html#_CPPv4N7dolfinx4mesh8TopologyE" title="dolfinx::mesh::Topology"><span class="n"><span class="pre">Topology</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">topology1</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">parent_cell</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx10refinement21transfer_cell_meshtagERKN4mesh8MeshTagsINSt7int32_tEEERKN4mesh8TopologyENSt4spanIKNSt7int32_tEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Transfer cell MeshTags from coarse mesh to refined mesh. </p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The refined mesh must not have been redistributed during refinement.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Mesh/topology <code class="docutils literal notranslate"><span class="pre">GhostMode</span></code> must be mesh::GhostMode::none.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tags0</strong> – <strong>[in]</strong> Tags on the parent mesh. </p></li>
<li><p><strong>topology1</strong> – <strong>[in]</strong> Refined mesh topology. </p></li>
<li><p><strong>parent_cell</strong> – <strong>[in]</strong> Parent cell of each cell in refined mesh. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(0) entities and (1) values on the refined topology. </p>
</dd>
</dl>
</dd></dl>

</div>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx10refinement4implE">
<span id="_CPPv3N7dolfinx10refinement4implE"></span><span id="_CPPv2N7dolfinx10refinement4implE"></span><span id="dolfinx::refinement::impl"></span><span class="target" id="d9/d37/namespacedolfinx_1_1refinement_1_1impl"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">impl</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx10refinement4implE" title="Link to this definition"></a><br /></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx10refinement4impl15local_to_globalENSt7int32_tERKN6common8IndexMapE">
<span id="_CPPv3N7dolfinx10refinement4impl15local_to_globalENSt7int32_tERKN6common8IndexMapE"></span><span id="_CPPv2N7dolfinx10refinement4impl15local_to_globalENSt7int32_tERKN6common8IndexMapE"></span><span id="dolfinx::refinement::impl::local_to_global__std::int32_t.common::IndexMapCR"></span><span class="target" id="de/d78/refinement_2utils_8h_1a0f1faad9802d03ecda2f613e097f84d9"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">local_to_global</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">local_index</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6commonE" title="dolfinx::common"><span class="n"><span class="pre">common</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6common8IndexMapE" title="dolfinx::common::IndexMap"><span class="n"><span class="pre">IndexMap</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">map</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx10refinement4impl15local_to_globalENSt7int32_tERKN6common8IndexMapE" title="Link to this definition"></a><br /></dt>
<dd><p>Compute global index. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement4impl19create_new_geometryENSt4pairINSt6vectorI1TEENSt5arrayINSt6size_tEXL2EEEEEERKN4mesh4MeshI1TEERKNSt3mapINSt7int32_tENSt7int64_tEEE">
<span id="_CPPv3I_NSt14floating_pointEEN7dolfinx10refinement4impl19create_new_geometryERKN4mesh4MeshI1TEERKNSt3mapINSt7int32_tENSt7int64_tEEE"></span><span id="_CPPv2I_NSt14floating_pointEEN7dolfinx10refinement4impl19create_new_geometryERKN4mesh4MeshI1TEERKNSt3mapINSt7int32_tENSt7int64_tEEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">floating_point</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="de/d78/refinement_2utils_8h_1a24f8ab2b31d6e1b0e2f2a7e81a8a80a9"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement4impl19create_new_geometryENSt4pairINSt6vectorI1TEENSt5arrayINSt6size_tEXL2EEEEEERKN4mesh4MeshI1TEERKNSt3mapINSt7int32_tENSt7int64_tEEE" title="dolfinx::refinement::impl::create_new_geometry::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">size_t</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">create_new_geometry</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement4impl19create_new_geometryENSt4pairINSt6vectorI1TEENSt5arrayINSt6size_tEXL2EEEEEERKN4mesh4MeshI1TEERKNSt3mapINSt7int32_tENSt7int64_tEEE" title="dolfinx::refinement::impl::create_new_geometry::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Mesh</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement4impl19create_new_geometryENSt4pairINSt6vectorI1TEENSt5arrayINSt6size_tEXL2EEEEEERKN4mesh4MeshI1TEERKNSt3mapINSt7int32_tENSt7int64_tEEE" title="dolfinx::refinement::impl::create_new_geometry::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">mesh</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">map</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">local_edge_to_new_vertex</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement4impl19create_new_geometryENSt4pairINSt6vectorI1TEENSt5arrayINSt6size_tEXL2EEEEEERKN4mesh4MeshI1TEERKNSt3mapINSt7int32_tENSt7int64_tEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Create geometric points of new Mesh, from current Mesh and a edge_to_vertex map listing the new local points (midpoints of those edges). </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – Current mesh. </p></li>
<li><p><strong>local_edge_to_new_vertex</strong> – A map from a local edge to the new global vertex index that will be inserted at its midpoint. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(1) Array of new (flattened) mesh geometry and (2) its multi-dimensional shape. </p>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx10refinement8intervalE">
<span id="_CPPv3N7dolfinx10refinement8intervalE"></span><span id="_CPPv2N7dolfinx10refinement8intervalE"></span><span id="dolfinx::refinement::interval"></span><span class="target" id="dc/dfc/namespacedolfinx_1_1refinement_1_1interval"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">interval</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx10refinement8intervalE" title="Link to this definition"></a><br /></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement8interval23compute_refinement_dataENSt5tupleIN5graph13AdjacencyListINSt7int64_tEEENSt6vectorI1TEENSt5arrayINSt6size_tEXL2EEEENSt8optionalINSt6vectorINSt7int32_tEEEEENSt8optionalINSt6vectorINSt6int8_tEEEEEEERKN4mesh4MeshI1TEENSt8optionalINSt4spanIKNSt7int32_tEEEEE6Option">
<span id="_CPPv3I_NSt14floating_pointEEN7dolfinx10refinement8interval23compute_refinement_dataERKN4mesh4MeshI1TEENSt8optionalINSt4spanIKNSt7int32_tEEEEE6Option"></span><span id="_CPPv2I_NSt14floating_pointEEN7dolfinx10refinement8interval23compute_refinement_dataERKN4mesh4MeshI1TEENSt8optionalINSt4spanIKNSt7int32_tEEEEE6Option"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">floating_point</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d2/d8a/interval_8h_1a5a1d91218a2b3f33fdea48cc094a3fb3"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">tuple</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="graph.html#_CPPv4I0EN7dolfinx5graph13AdjacencyListE" title="dolfinx::graph::AdjacencyList"><span class="n"><span class="pre">AdjacencyList</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement8interval23compute_refinement_dataENSt5tupleIN5graph13AdjacencyListINSt7int64_tEEENSt6vectorI1TEENSt5arrayINSt6size_tEXL2EEEENSt8optionalINSt6vectorINSt7int32_tEEEEENSt8optionalINSt6vectorINSt6int8_tEEEEEEERKN4mesh4MeshI1TEENSt8optionalINSt4spanIKNSt7int32_tEEEEE6Option" title="dolfinx::refinement::interval::compute_refinement_data::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">size_t</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int8_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">compute_refinement_data</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement8interval23compute_refinement_dataENSt5tupleIN5graph13AdjacencyListINSt7int64_tEEENSt6vectorI1TEENSt5arrayINSt6size_tEXL2EEEENSt8optionalINSt6vectorINSt7int32_tEEEEENSt8optionalINSt6vectorINSt6int8_tEEEEEEERKN4mesh4MeshI1TEENSt8optionalINSt4spanIKNSt7int32_tEEEEE6Option" title="dolfinx::refinement::interval::compute_refinement_data::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Mesh</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement8interval23compute_refinement_dataENSt5tupleIN5graph13AdjacencyListINSt7int64_tEEENSt6vectorI1TEENSt5arrayINSt6size_tEXL2EEEENSt8optionalINSt6vectorINSt7int32_tEEEEENSt8optionalINSt6vectorINSt6int8_tEEEEEEERKN4mesh4MeshI1TEENSt8optionalINSt4spanIKNSt7int32_tEEEEE6Option" title="dolfinx::refinement::interval::compute_refinement_data::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">mesh</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">cells</span></span>, <a class="reference internal" href="#_CPPv4N7dolfinx10refinement6OptionE" title="dolfinx::refinement::Option"><span class="n"><span class="pre">Option</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">option</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement8interval23compute_refinement_dataENSt5tupleIN5graph13AdjacencyListINSt7int64_tEEENSt6vectorI1TEENSt5arrayINSt6size_tEXL2EEEENSt8optionalINSt6vectorINSt7int32_tEEEEENSt8optionalINSt6vectorINSt6int8_tEEEEEEERKN4mesh4MeshI1TEENSt8optionalINSt4spanIKNSt7int32_tEEEEE6Option" title="Link to this definition"></a><br /></dt>
<dd><p>Refine with markers returning new mesh data. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – <strong>[in]</strong> Input mesh to be refined </p></li>
<li><p><strong>cells</strong> – <strong>[in]</strong> Indices of the cells that are marked for refinement </p></li>
<li><p><strong>option</strong> – <strong>[in]</strong> Refinement option indicating if parent cells and/or facets are to be computed. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>New mesh data: cell topology, vertex coordinates and parent cell indices. </p>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx10refinement5plazaE">
<span id="_CPPv3N7dolfinx10refinement5plazaE"></span><span id="_CPPv2N7dolfinx10refinement5plazaE"></span><span id="dolfinx::refinement::plaza"></span><span class="target" id="df/dfe/namespacedolfinx_1_1refinement_1_1plaza"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">plaza</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx10refinement5plazaE" title="Link to this definition"></a><br /></dt>
<dd><p>Plaza mesh refinement. </p>
<p>Functions for the refinement method described in Plaza and Carey “Local refinement of simplicial grids based on the skeleton”, Applied Numerical Mathematics 32 (2000), 195-218. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement5plaza23compute_refinement_dataENSt5tupleIN5graph13AdjacencyListINSt7int64_tEEENSt6vectorI1TEENSt5arrayINSt6size_tEXL2EEEENSt8optionalINSt6vectorINSt7int32_tEEEEENSt8optionalINSt6vectorINSt6int8_tEEEEEEERKN4mesh4MeshI1TEENSt8optionalINSt4spanIKNSt7int32_tEEEEE6Option">
<span id="_CPPv3I_NSt14floating_pointEEN7dolfinx10refinement5plaza23compute_refinement_dataERKN4mesh4MeshI1TEENSt8optionalINSt4spanIKNSt7int32_tEEEEE6Option"></span><span id="_CPPv2I_NSt14floating_pointEEN7dolfinx10refinement5plaza23compute_refinement_dataERKN4mesh4MeshI1TEENSt8optionalINSt4spanIKNSt7int32_tEEEEE6Option"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">floating_point</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="df/dfe/namespacedolfinx_1_1refinement_1_1plaza_1aa249aae0994eb212138ad11016150709"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">tuple</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="graph.html#_CPPv4I0EN7dolfinx5graph13AdjacencyListE" title="dolfinx::graph::AdjacencyList"><span class="n"><span class="pre">AdjacencyList</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement5plaza23compute_refinement_dataENSt5tupleIN5graph13AdjacencyListINSt7int64_tEEENSt6vectorI1TEENSt5arrayINSt6size_tEXL2EEEENSt8optionalINSt6vectorINSt7int32_tEEEEENSt8optionalINSt6vectorINSt6int8_tEEEEEEERKN4mesh4MeshI1TEENSt8optionalINSt4spanIKNSt7int32_tEEEEE6Option" title="dolfinx::refinement::plaza::compute_refinement_data::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">size_t</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int8_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">compute_refinement_data</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement5plaza23compute_refinement_dataENSt5tupleIN5graph13AdjacencyListINSt7int64_tEEENSt6vectorI1TEENSt5arrayINSt6size_tEXL2EEEENSt8optionalINSt6vectorINSt7int32_tEEEEENSt8optionalINSt6vectorINSt6int8_tEEEEEEERKN4mesh4MeshI1TEENSt8optionalINSt4spanIKNSt7int32_tEEEEE6Option" title="dolfinx::refinement::plaza::compute_refinement_data::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Mesh</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement5plaza23compute_refinement_dataENSt5tupleIN5graph13AdjacencyListINSt7int64_tEEENSt6vectorI1TEENSt5arrayINSt6size_tEXL2EEEENSt8optionalINSt6vectorINSt7int32_tEEEEENSt8optionalINSt6vectorINSt6int8_tEEEEEEERKN4mesh4MeshI1TEENSt8optionalINSt4spanIKNSt7int32_tEEEEE6Option" title="dolfinx::refinement::plaza::compute_refinement_data::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">mesh</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">edges</span></span>, <a class="reference internal" href="#_CPPv4N7dolfinx10refinement6OptionE" title="dolfinx::refinement::Option"><span class="n"><span class="pre">Option</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">option</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement5plaza23compute_refinement_dataENSt5tupleIN5graph13AdjacencyListINSt7int64_tEEENSt6vectorI1TEENSt5arrayINSt6size_tEXL2EEEENSt8optionalINSt6vectorINSt7int32_tEEEEENSt8optionalINSt6vectorINSt6int8_tEEEEEEERKN4mesh4MeshI1TEENSt8optionalINSt4spanIKNSt7int32_tEEEEE6Option" title="Link to this definition"></a><br /></dt>
<dd><p>Refine with markers returning new mesh data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh</strong> – <strong>[in]</strong> Input mesh to be refined </p></li>
<li><p><strong>edges</strong> – <strong>[in]</strong> Indices of the edges that should be split by this refinement </p></li>
<li><p><strong>option</strong> – <strong>[in]</strong> Control the computation of parent facets, parent cells. If an option is unselected, an empty list is returned. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>New mesh data: cell topology, vertex coordinates and parent cell index, and stored parent facet indices (if requested). </p>
</dd>
</dl>
</dd></dl>

</div>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx10refinement5plaza4implE">
<span id="_CPPv3N7dolfinx10refinement5plaza4implE"></span><span id="_CPPv2N7dolfinx10refinement5plaza4implE"></span><span id="dolfinx::refinement::plaza::impl"></span><span class="target" id="d2/db4/namespacedolfinx_1_1refinement_1_1plaza_1_1impl"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">impl</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx10refinement5plaza4implE" title="Link to this definition"></a><br /></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_iEN7dolfinx10refinement5plaza4impl21compute_parent_facetsEDaNSt4spanIKNSt7int32_tEEE">
<span id="_CPPv3I_iEN7dolfinx10refinement5plaza4impl21compute_parent_facetsENSt4spanIKNSt7int32_tEEE"></span><span id="_CPPv2I_iEN7dolfinx10refinement5plaza4impl21compute_parent_facetsENSt4spanIKNSt7int32_tEEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">tdim</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d6/db4/plaza_8h_1a2f148a74d495b2c280401b1e53c00276"></span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">compute_parent_facets</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">simplex_set</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_iEN7dolfinx10refinement5plaza4impl21compute_parent_facetsEDaNSt4spanIKNSt7int32_tEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Computes the parent-child facet relationship </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>simplex_set</strong> – - index into indices for each child cell </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>mapping from child to parent facets, using cell-local index </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx10refinement5plaza4impl13get_simplicesENSt4spanIKNSt7int64_tEEENSt4spanIKNSt7int32_tEEEib">
<span id="_CPPv3N7dolfinx10refinement5plaza4impl13get_simplicesENSt4spanIKNSt7int64_tEEENSt4spanIKNSt7int32_tEEEib"></span><span id="_CPPv2N7dolfinx10refinement5plaza4impl13get_simplicesENSt4spanIKNSt7int64_tEEENSt4spanIKNSt7int32_tEEEib"></span><span id="dolfinx::refinement::plaza::impl::get_simplices__std::span:std::int64_tC:.std::span:std::int32_tC:.i.b"></span><span class="target" id="d6/db4/plaza_8h_1a95256f5089ec6f9ab555b90658dc148d"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">32</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">size_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">get_simplices</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">indices</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">longest_edge</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">tdim</span></span>, <span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">uniform</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx10refinement5plaza4impl13get_simplicesENSt4spanIKNSt7int64_tEEENSt4spanIKNSt7int32_tEEEib" title="Link to this definition"></a><br /></dt>
<dd><p>Get the subdivision of an original simplex into smaller simplices, for a given set of marked edges, and the longest edge of each facet (cell local indexing). </p>
<p>A flag indicates if a uniform subdivision is preferable in 2D.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> – <strong>[in]</strong> Vector containing the global indices for the original vertices and potential new vertices at each edge. Size (num_vertices + num_edges). If an edge is not refined its corresponding entry is -1. </p></li>
<li><p><strong>longest_edge</strong> – <strong>[in]</strong> Vector indicating the longest edge for each triangle in the cell. For triangular cells (2D) there is only one value, and for tetrahedra (3D) there are four values, one for each facet. The values give the local edge indices of the cell. </p></li>
<li><p><strong>tdim</strong> – <strong>[in]</strong> Topological dimension (2 or 3). </p></li>
<li><p><strong>uniform</strong> – <strong>[in]</strong> Make a “uniform” subdivision with all triangles. being similar shape. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx10refinement5plaza4impl13enforce_rulesE8MPI_CommRKN5graph13AdjacencyListIiEENSt4spanINSt6int8_tEEERKN4mesh8TopologyENSt4spanIKNSt7int32_tEEE">
<span id="_CPPv3N7dolfinx10refinement5plaza4impl13enforce_rulesE8MPI_CommRKN5graph13AdjacencyListIiEENSt4spanINSt6int8_tEEERKN4mesh8TopologyENSt4spanIKNSt7int32_tEEE"></span><span id="_CPPv2N7dolfinx10refinement5plaza4impl13enforce_rulesE8MPI_CommRKN5graph13AdjacencyListIiEENSt4spanINSt6int8_tEEERKN4mesh8TopologyENSt4spanIKNSt7int32_tEEE"></span><span id="dolfinx::refinement::plaza::impl::enforce_rules__MPI_Comm.graph::AdjacencyList:i:CR.std::span:std::int8_t:.mesh::TopologyCR.std::span:std::int32_tC:"></span><span class="target" id="d6/db4/plaza_8h_1a38c303f8bf513807afed80cb26425094"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">enforce_rules</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPI_Comm</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">comm</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="graph.html#_CPPv4I0EN7dolfinx5graph13AdjacencyListE" title="dolfinx::graph::AdjacencyList"><span class="n"><span class="pre">AdjacencyList</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">shared_edges</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int8_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">marked_edges</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="mesh.html#_CPPv4N7dolfinx4meshE" title="dolfinx::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="mesh.html#_CPPv4N7dolfinx4mesh8TopologyE" title="dolfinx::mesh::Topology"><span class="n"><span class="pre">Topology</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">topology</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">long_edge</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx10refinement5plaza4impl13enforce_rulesE8MPI_CommRKN5graph13AdjacencyListIiEENSt4spanINSt6int8_tEEERKN4mesh8TopologyENSt4spanIKNSt7int32_tEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Propagate edge markers according to rules (longest edge of each face must be marked, if any edge of face is marked) </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement5plaza4impl14face_long_edgeENSt4pairINSt6vectorINSt7int32_tEEENSt6vectorINSt6int8_tEEEEERKN4mesh4MeshI1TEE">
<span id="_CPPv3I_NSt14floating_pointEEN7dolfinx10refinement5plaza4impl14face_long_edgeERKN4mesh4MeshI1TEE"></span><span id="_CPPv2I_NSt14floating_pointEEN7dolfinx10refinement5plaza4impl14face_long_edgeERKN4mesh4MeshI1TEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">floating_point</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d6/db4/plaza_8h_1adf5d7866dfc9453c9656f5929e466027"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int8_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">face_long_edge</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement5plaza4impl14face_long_edgeENSt4pairINSt6vectorINSt7int32_tEEENSt6vectorINSt6int8_tEEEEERKN4mesh4MeshI1TEE" title="dolfinx::refinement::plaza::impl::face_long_edge::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Mesh</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement5plaza4impl14face_long_edgeENSt4pairINSt6vectorINSt7int32_tEEENSt6vectorINSt6int8_tEEEEERKN4mesh4MeshI1TEE" title="dolfinx::refinement::plaza::impl::face_long_edge::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">mesh</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement5plaza4impl14face_long_edgeENSt4pairINSt6vectorINSt7int32_tEEENSt6vectorINSt6int8_tEEEEERKN4mesh4MeshI1TEE" title="Link to this definition"></a><br /></dt>
<dd><p>Get the longest edge of each face (using local mesh index). </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Edge ratio ok returns an array in 2D, where it checks if the ratio between the shortest and longest edge of a cell is bigger than sqrt(2)/2. In 3D an empty array is returned.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>mesh</strong> – <strong>[in]</strong> The mesh </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple (longest edge, edge ratio ok) where longest edge gives the local index of the longest edge for each face. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement5plaza4impl18compute_refinementENSt5tupleIN5graph13AdjacencyListINSt7int64_tEEENSt6vectorI1TEENSt5arrayINSt6size_tEXL2EEEENSt8optionalINSt6vectorINSt7int32_tEEEEENSt8optionalINSt6vectorINSt6int8_tEEEEEEE8MPI_CommNSt4spanIKNSt6int8_tEEERKN5graph13AdjacencyListIiEERKN4mesh4MeshI1TEENSt4spanIKNSt7int32_tEEENSt4spanIKNSt6int8_tEEE6Option">
<span id="_CPPv3I_NSt14floating_pointEEN7dolfinx10refinement5plaza4impl18compute_refinementE8MPI_CommNSt4spanIKNSt6int8_tEEERKN5graph13AdjacencyListIiEERKN4mesh4MeshI1TEENSt4spanIKNSt7int32_tEEENSt4spanIKNSt6int8_tEEE6Option"></span><span id="_CPPv2I_NSt14floating_pointEEN7dolfinx10refinement5plaza4impl18compute_refinementE8MPI_CommNSt4spanIKNSt6int8_tEEERKN5graph13AdjacencyListIiEERKN4mesh4MeshI1TEENSt4spanIKNSt7int32_tEEENSt4spanIKNSt6int8_tEEE6Option"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">floating_point</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d6/db4/plaza_8h_1a9c3d1c902265df1a68389b2e423492b1"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">tuple</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="graph.html#_CPPv4I0EN7dolfinx5graph13AdjacencyListE" title="dolfinx::graph::AdjacencyList"><span class="n"><span class="pre">AdjacencyList</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement5plaza4impl18compute_refinementENSt5tupleIN5graph13AdjacencyListINSt7int64_tEEENSt6vectorI1TEENSt5arrayINSt6size_tEXL2EEEENSt8optionalINSt6vectorINSt7int32_tEEEEENSt8optionalINSt6vectorINSt6int8_tEEEEEEE8MPI_CommNSt4spanIKNSt6int8_tEEERKN5graph13AdjacencyListIiEERKN4mesh4MeshI1TEENSt4spanIKNSt7int32_tEEENSt4spanIKNSt6int8_tEEE6Option" title="dolfinx::refinement::plaza::impl::compute_refinement::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">size_t</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">optional</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int8_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">compute_refinement</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPI_Comm</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">neighbor_comm</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int8_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">marked_edges</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">graph</span></span><span class="p"><span class="pre">::</span></span><a class="reference internal" href="graph.html#_CPPv4I0EN7dolfinx5graph13AdjacencyListE" title="dolfinx::graph::AdjacencyList"><span class="n"><span class="pre">AdjacencyList</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">shared_edges</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement5plaza4impl18compute_refinementENSt5tupleIN5graph13AdjacencyListINSt7int64_tEEENSt6vectorI1TEENSt5arrayINSt6size_tEXL2EEEENSt8optionalINSt6vectorINSt7int32_tEEEEENSt8optionalINSt6vectorINSt6int8_tEEEEEEE8MPI_CommNSt4spanIKNSt6int8_tEEERKN5graph13AdjacencyListIiEERKN4mesh4MeshI1TEENSt4spanIKNSt7int32_tEEENSt4spanIKNSt6int8_tEEE6Option" title="dolfinx::refinement::plaza::impl::compute_refinement::mesh"><span class="n"><span class="pre">mesh</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">Mesh</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement5plaza4impl18compute_refinementENSt5tupleIN5graph13AdjacencyListINSt7int64_tEEENSt6vectorI1TEENSt5arrayINSt6size_tEXL2EEEENSt8optionalINSt6vectorINSt7int32_tEEEEENSt8optionalINSt6vectorINSt6int8_tEEEEEEE8MPI_CommNSt4spanIKNSt6int8_tEEERKN5graph13AdjacencyListIiEERKN4mesh4MeshI1TEENSt4spanIKNSt7int32_tEEENSt4spanIKNSt6int8_tEEE6Option" title="dolfinx::refinement::plaza::impl::compute_refinement::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">mesh</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">long_edge</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int8_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">edge_ratio_ok</span></span>, <a class="reference internal" href="#_CPPv4N7dolfinx10refinement6OptionE" title="dolfinx::refinement::Option"><span class="n"><span class="pre">Option</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">option</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_NSt14floating_pointEEN7dolfinx10refinement5plaza4impl18compute_refinementENSt5tupleIN5graph13AdjacencyListINSt7int64_tEEENSt6vectorI1TEENSt5arrayINSt6size_tEXL2EEEENSt8optionalINSt6vectorINSt7int32_tEEEEENSt8optionalINSt6vectorINSt6int8_tEEEEEEE8MPI_CommNSt4spanIKNSt6int8_tEEERKN5graph13AdjacencyListIiEERKN4mesh4MeshI1TEENSt4spanIKNSt7int32_tEEENSt4spanIKNSt6int8_tEEE6Option" title="Link to this definition"></a><br /></dt>
<dd><p>Convenient interface for both uniform and marker refinement. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The parent facet map gives you the map from a cell given by parent cell map to the local index (relative to the cell), e.g. the i-th entry of parent facets relates to the local facet index of the i-th entry parent cell.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>neighbor_comm</strong> – <strong>[in]</strong> Neighbourhood communciator scattering owned edges to processes with ghosts </p></li>
<li><p><strong>marked_edges</strong> – <strong>[in]</strong> A marker for all edges on the process (local + ghosts) indicating if an edge should be refined </p></li>
<li><p><strong>shared_edges</strong> – <strong>[in]</strong> For each local edge on a process map to ghost processes </p></li>
<li><p><strong>mesh</strong> – <strong>[in]</strong> The mesh </p></li>
<li><p><strong>long_edge</strong> – <strong>[in]</strong> A map from each face to its longest edge. Index is local to the process. </p></li>
<li><p><strong>edge_ratio_ok</strong> – <strong>[in]</strong> For each face in a 2D mesh this error contains a marker indicating if the ratio between smallest and largest edge is bigger than sqrt(2)/2 </p></li>
<li><p><strong>option</strong> – <strong>[in]</strong> Option to compute additional information relating refined and original mesh entities </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(0) The new mesh topology, (1) the new flattened mesh geometry, (3) Shape of the new geometry_shape, (4) Map from new cells to parent cells and (5) map from refined facets to parent facets. </p>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="mesh.html" class="btn btn-neutral float-left" title="Mesh (dolfinx::mesh)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, FEniCS Project.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>