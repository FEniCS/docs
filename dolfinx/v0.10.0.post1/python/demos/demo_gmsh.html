
<!DOCTYPE html>

<html class="writer-html5" data-content_root="../" lang="en">
<head>
<meta charset="utf-8"/><meta content="width=device-width, initial-scale=1" name="viewport"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Mesh generation with Gmsh — DOLFINx 0.10.0.post1 documentation</title>
<link href="../_static/pygments.css?v=03e43079" rel="stylesheet" type="text/css"/>
<link href="../_static/css/theme.css?v=e59714d7" rel="stylesheet" type="text/css"/>
<link href="../_static/sphinx-codeautolink.css?v=b2176991" rel="stylesheet" type="text/css"/>
<script src="../_static/jquery.js?v=5d32c60e"></script>
<script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
<script src="../_static/documentation_options.js?v=758b1af6"></script>
<script src="../_static/doctools.js?v=9bcbadda"></script>
<script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
<script src="../_static/js/theme.js"></script>
<link href="../genindex.html" rel="index" title="Index"/>
<link href="../search.html" rel="search" title="Search"/>
<link href="demo_pyvista.html" rel="next" title="Visualization with PyVista"/>
<link href="demo_mixed-topology.html" rel="prev" title="Poisson equation"/>
</head>
<body class="wy-body-for-nav">
<div class="wy-grid-for-nav">
<nav class="wy-nav-side" data-toggle="wy-nav-shift">
<div class="wy-side-scroll">
<div class="wy-side-nav-search">
<a class="icon icon-home" href="../index.html">
            DOLFINx
          </a>
<div role="search">
<form action="../search.html" class="wy-form" id="rtd-search-form" method="get">
<input aria-label="Search docs" name="q" placeholder="Search docs" type="text"/>
<input name="check_keywords" type="hidden" value="yes"/>
<input name="area" type="hidden" value="default"/>
</form>
</div>
</div><div aria-label="Navigation menu" class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation">
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../demos.html">Demos</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../demos.html#pdes-introductory">PDEs (introductory)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos.html#pdes-advanced">PDEs (advanced)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos.html#nonlinear-problems">Nonlinear problems</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../demos.html#mesh-generation">Mesh generation</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Mesh generation with Gmsh</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#gmsh-model-builders">Gmsh model builders</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dolfinx-mesh-creation-and-file-output">DOLFINx mesh creation and file output</a></li>
<li class="toctree-l4"><a class="reference internal" href="#generate-meshes">Generate meshes</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../demos.html#interpolation-io-and-visualisation">Interpolation, IO and visualisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos.html#advanced-iterative-solvers">Advanced iterative solvers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos.html#user-defined-and-advanced-finite-elements">User-defined and advanced finite elements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../demos.html#parallel-communication-analysis">Parallel communication analysis</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../demos.html#list-of-all-demos">List of all demos</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="demo_poisson.html">Poisson equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_biharmonic.html">Biharmonic equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_cahn-hilliard.html">Cahn-Hilliard equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_stokes.html">Stokes equations using Taylor-Hood elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_elasticity.html">Elasticity using algebraic multigrid</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Mesh generation with Gmsh</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#gmsh-model-builders">Gmsh model builders</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dolfinx-mesh-creation-and-file-output">DOLFINx mesh creation and file output</a></li>
<li class="toctree-l4"><a class="reference internal" href="#generate-meshes">Generate meshes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="demo_helmholtz.html">Helmholtz equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_static-condensation.html">Static condensation of linear elasticity</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_pyvista.html">Visualization with PyVista</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_interpolation-io.html">Interpolation and IO</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_types.html">Solving PDEs with different scalar (float) types</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_lagrange_variants.html">Variants of Lagrange elements</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_tnt-elements.html">Creating TNT elements using Basix’s custom element interface</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_scattering_boundary_conditions.html">Electromagnetic scattering from a wire with scattering BCs</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_pml.html">Electromagnetic scattering from a wire with PML</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_pml.html#mesh-generation-with-gmsh">Mesh generation with GMSH</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_half_loaded_waveguide.html">Electromagnetic modal analysis for a waveguide</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_axis.html">Electromagnetic scattering from a sphere (axisymmetric)</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_navier-stokes.html">Divergence conforming discontinuous Galerkin method for the Navier–Stokes equations # noqa</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_mixed-poisson.html">Mixed formulation of the Poisson equation with a block-preconditioner/solver # noqa</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_pyamg.html">Solve the Poisson and linearised elasticity equations using pyamg</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_hdg.html">HDG scheme for the Poisson equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_mixed-topology.html">Poisson equation</a></li>
<li class="toctree-l3"><a class="reference internal" href="demo_comm-pattern.html">Parallel communication pattern analysis</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../release_notes.html">Release notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer.html">Developer resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
</ul>
</div>
</div>
</nav>
<section class="wy-nav-content-wrap" data-toggle="wy-nav-shift"><nav aria-label="Mobile navigation menu" class="wy-nav-top">
<i class="fa fa-bars" data-toggle="wy-nav-top"></i>
<a href="../index.html">DOLFINx</a>
</nav>
<div class="wy-nav-content">
<div class="rst-content">
<div aria-label="Page navigation" role="navigation">
<ul class="wy-breadcrumbs">
<li><a aria-label="Home" class="icon icon-home" href="../index.html"></a></li>
<li class="breadcrumb-item"><a href="../demos.html">Demos</a></li>
<li class="breadcrumb-item active">Mesh generation with Gmsh</li>
<li class="wy-breadcrumbs-aside">
<a href="../_sources/demos/demo_gmsh.md.txt" rel="nofollow"> View page source</a>
</li>
</ul>
<hr/>
</div>
<div class="document" itemscope="itemscope" itemtype="http://schema.org/Article" role="main">
<div itemprop="articleBody">
<section class="tex2jax_ignore mathjax_ignore" id="mesh-generation-with-gmsh">
<h1>Mesh generation with Gmsh<a class="headerlink" href="#mesh-generation-with-gmsh" title="Link to this heading"></a></h1>
<p>Copyright (C) 2020-2023 Garth N. Wells and Jørgen S. Dokken</p>
<div class="download admonition">
<p class="admonition-title">Download sources</p>
<ul class="simple">
<li><p><a class="reference download internal" download="" href="../_downloads/47634f247d22ee0b32df8f8c65b9f626/demo_gmsh.py"><code class="xref download docutils literal notranslate"><span class="pre">Python</span> <span class="pre">script</span></code></a></p></li>
<li><p><a class="reference download internal" download="" href="../_downloads/244d514e5e2d1484e9f045150ae16a27/demo_gmsh.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Jupyter</span> <span class="pre">notebook</span></code></a></p></li>
</ul>
</div>
<p>This demo shows how to create meshes using the Gmsh Python interface.</p>
<p>The Gmsh module is required for this demo.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="https://mpi4py.readthedocs.io/en/4.1.1/mpi4py.html#module-mpi4py" title="mpi4py"><span class="nn">mpi4py</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="https://mpi4py.readthedocs.io/en/4.1.1/reference/mpi4py.MPI.html#module-mpi4py.MPI" title="mpi4py.MPI"><span class="n">MPI</span></a>

<span class="kn">import</span><span class="w"> </span><span class="nn">gmsh</span>  <span class="c1"># type: ignore</span>

<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="../generated/dolfinx.io.html#module-dolfinx.io" title="dolfinx.io"><span class="nn">dolfinx.io</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.io.html#dolfinx.io.XDMFFile" title="dolfinx.io.utils.XDMFFile"><span class="n">XDMFFile</span></a>
<span class="kn">from</span><span class="w"> </span><a class="sphinx-codeautolink-a" href="../generated/dolfinx.io.html#module-dolfinx.io" title="dolfinx.io"><span class="nn">dolfinx.io</span></a><span class="w"> </span><span class="kn">import</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.io.gmsh.html#module-dolfinx.io.gmsh" title="dolfinx.io.gmsh"><span class="n">gmsh</span></a> <span class="k">as</span> <span class="n">gmshio</span>
</pre></div>
</div>
<section id="gmsh-model-builders">
<h2>Gmsh model builders<a class="headerlink" href="#gmsh-model-builders" title="Link to this heading"></a></h2>
<p>The following functions add Gmsh meshes to a ‘model’.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">gmsh_sphere</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Create a Gmsh model of a sphere and tag sub entitites</span>
<span class="sd">    from all co-dimensions (peaks, ridges, facets and cells).</span>

<span class="sd">    Args:</span>
<span class="sd">        model: Gmsh model to add the mesh to.</span>
<span class="sd">        name: Name (identifier) of the mesh to add.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Gmsh model with a sphere mesh added.</span>

<span class="sd">    """</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">setCurrent</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">sphere</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">addSphere</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Synchronize OpenCascade representation with gmsh model</span>
    <span class="n">model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

    <span class="c1"># Add physical tag for sphere</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add_physical_group</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="p">[</span><span class="n">sphere</span><span class="p">],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># Embed all sub-entities from the GMSH model into the sphere and tag</span>
    <span class="c1"># them</span>
    <span class="k">for</span> <span class="n">dim</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
        <span class="n">entities</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">getEntities</span><span class="p">(</span><span class="n">dim</span><span class="p">)</span>
        <span class="n">entity_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">entity</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">entity</span> <span class="ow">in</span> <span class="n">entities</span><span class="p">]</span>
        <span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">dim</span><span class="p">,</span> <span class="n">entity_ids</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">sphere</span><span class="p">)</span>
        <span class="n">model</span><span class="o">.</span><span class="n">add_physical_group</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="n">dim</span><span class="p">,</span> <span class="n">tags</span><span class="o">=</span><span class="n">entity_ids</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="n">dim</span><span class="p">)</span>

    <span class="c1"># Generate the mesh</span>
    <span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span>


<span class="k">def</span><span class="w"> </span><span class="nf">gmsh_sphere_minus_box</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Create a Gmsh model of a sphere with a box from the sphere removed.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: Gmsh model to add the mesh to.</span>
<span class="sd">        name: Name (identifier) of the mesh to add.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Gmsh model with a sphere mesh added.</span>
<span class="sd">    """</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">setCurrent</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="n">sphere_dim_tags</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">addSphere</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">box_dim_tags</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">addBox</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">model_dim_tags</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">cut</span><span class="p">([(</span><span class="mi">3</span><span class="p">,</span> <span class="n">sphere_dim_tags</span><span class="p">)],</span> <span class="p">[(</span><span class="mi">3</span><span class="p">,</span> <span class="n">box_dim_tags</span><span class="p">)])</span>
    <span class="n">model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

    <span class="c1"># Add physical tag 1 for exterior surfaces</span>
    <span class="n">boundary</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">getBoundary</span><span class="p">(</span><span class="n">model_dim_tags</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">oriented</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">boundary_ids</span> <span class="o">=</span> <span class="p">[</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">boundary</span><span class="p">]</span>
    <span class="n">model</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">boundary_ids</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">setPhysicalName</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">"Sphere surface"</span><span class="p">)</span>

    <span class="c1"># Add physical tag 2 for the volume</span>
    <span class="n">volume_entities</span> <span class="o">=</span> <span class="p">[</span><span class="n">model</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">getEntities</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>
    <span class="n">model</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">volume_entities</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">setPhysicalName</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">"Sphere volume"</span><span class="p">)</span>

    <span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span>


<span class="k">def</span><span class="w"> </span><span class="nf">gmsh_ring</span><span class="p">(</span><span class="n">model</span><span class="p">:</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="p">:</span>
<span class="w">    </span><span class="sd">"""Create a Gmsh model of a ring-type geometry using hexahedral cells.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: Gmsh model to add the mesh to.</span>
<span class="sd">        name: Name (identifier) of the mesh to add.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Gmsh model with a sphere mesh added.</span>
<span class="sd">    """</span>
    <span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">setCurrent</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

    <span class="c1"># Recombine tetrahedra to hexahedra</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">"Mesh.RecombinationAlgorithm"</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">"Mesh.RecombineAll"</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">"Mesh.CharacteristicLengthFactor"</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">circle</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">addDisk</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">circle_inner</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">addDisk</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="n">cut</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">cut</span><span class="p">([(</span><span class="mi">2</span><span class="p">,</span> <span class="n">circle</span><span class="p">)],</span> <span class="p">[(</span><span class="mi">2</span><span class="p">,</span> <span class="n">circle_inner</span><span class="p">)])[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">extruded_geometry</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">extrude</span><span class="p">(</span><span class="n">cut</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="n">numElements</span><span class="o">=</span><span class="p">[</span><span class="mi">5</span><span class="p">],</span> <span class="n">recombine</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">occ</span><span class="o">.</span><span class="n">synchronize</span><span class="p">()</span>

    <span class="n">model</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="n">cut</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]],</span> <span class="n">tag</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">setPhysicalName</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">"2D cylinder"</span><span class="p">)</span>
    <span class="n">boundary_entities</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">getEntities</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">other_boundary_entities</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">entity</span> <span class="ow">in</span> <span class="n">boundary_entities</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">entity</span> <span class="o">!=</span> <span class="n">cut</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">other_boundary_entities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entity</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">model</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">other_boundary_entities</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">setPhysicalName</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">"Remaining boundaries"</span><span class="p">)</span>

    <span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setOrder</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">volume_entities</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">entity</span> <span class="ow">in</span> <span class="n">extruded_geometry</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">entity</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">volume_entities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">entity</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">model</span><span class="o">.</span><span class="n">addPhysicalGroup</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">volume_entities</span><span class="p">,</span> <span class="n">tag</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">setPhysicalName</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">"Mesh volume"</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">model</span>
</pre></div>
</div>
</section>
<section id="dolfinx-mesh-creation-and-file-output">
<h2>DOLFINx mesh creation and file output<a class="headerlink" href="#dolfinx-mesh-creation-and-file-output" title="Link to this heading"></a></h2>
<p>The following function creates a DOLFINx mesh from a Gmsh model, and
cell and facets tags. The mesh and the tags are written to an XDMF file
for visualisation, e.g. using ParaView.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>

<span class="k">def</span><span class="w"> </span><span class="nf">create_mesh</span><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://mpi4py.readthedocs.io/en/4.1.1/reference/mpi4py.MPI.Comm.html#mpi4py.MPI.Comm" title="mpi4py.MPI.Comm"><span class="n">comm</span></a><span class="p">:</span> <a class="sphinx-codeautolink-a" href="https://mpi4py.readthedocs.io/en/4.1.1/reference/mpi4py.MPI.Comm.html#mpi4py.MPI.Comm" title="mpi4py.MPI.Comm"><span class="n">MPI</span><span class="o">.</span><span class="n">Comm</span></a><span class="p">,</span> <span class="n">model</span><span class="p">:</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">filename</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
<span class="w">    </span><span class="sd">"""Create a DOLFINx from a Gmsh model and output to file.</span>

<span class="sd">    Args:</span>
<span class="sd">        comm: MPI communicator top create the mesh on.</span>
<span class="sd">        model: Gmsh model.</span>
<span class="sd">        name: Name (identifier) of the mesh to add.</span>
<span class="sd">        filename: XDMF filename.</span>
<span class="sd">        mode: XDMF file mode. "w" (write) or "a" (append).</span>
<span class="sd">    """</span>
    <a class="sphinx-codeautolink-a" href="../generated/dolfinx.io.gmsh.html#dolfinx.io.gmsh.MeshData" title="dolfinx.io.gmsh.MeshData"><span class="n">mesh_data</span></a> <span class="o">=</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.io.gmsh.html#dolfinx.io.gmsh.model_to_mesh" title="dolfinx.io.gmsh.model_to_mesh"><span class="n">gmshio</span><span class="o">.</span><span class="n">model_to_mesh</span></a><span class="p">(</span><span class="n">model</span><span class="p">,</span> <a class="sphinx-codeautolink-a" href="https://mpi4py.readthedocs.io/en/4.1.1/reference/mpi4py.MPI.Comm.html#mpi4py.MPI.Comm" title="mpi4py.MPI.Comm"><span class="n">comm</span></a><span class="p">,</span> <span class="n">rank</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">mesh_data</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="k">if</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.io.gmsh.html#dolfinx.io.gmsh.MeshData.cell_tags" title="dolfinx.io.gmsh.MeshData.cell_tags"><span class="n">mesh_data</span><span class="o">.</span><span class="n">cell_tags</span></a> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">mesh_data</span><span class="o">.</span><span class="n">cell_tags</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">_cells"</span>
    <span class="k">if</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.io.gmsh.html#dolfinx.io.gmsh.MeshData.facet_tags" title="dolfinx.io.gmsh.MeshData.facet_tags"><span class="n">mesh_data</span><span class="o">.</span><span class="n">facet_tags</span></a> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">mesh_data</span><span class="o">.</span><span class="n">facet_tags</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">_facets"</span>
    <span class="k">if</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.io.gmsh.html#dolfinx.io.gmsh.MeshData.ridge_tags" title="dolfinx.io.gmsh.MeshData.ridge_tags"><span class="n">mesh_data</span><span class="o">.</span><span class="n">ridge_tags</span></a> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">mesh_data</span><span class="o">.</span><span class="n">ridge_tags</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">_ridges"</span>
    <span class="k">if</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.io.gmsh.html#dolfinx.io.gmsh.MeshData.peak_tags" title="dolfinx.io.gmsh.MeshData.peak_tags"><span class="n">mesh_data</span><span class="o">.</span><span class="n">peak_tags</span></a> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">mesh_data</span><span class="o">.</span><span class="n">peak_tags</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">_peaks"</span>
    <span class="k">with</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.io.html#dolfinx.io.XDMFFile" title="dolfinx.io.utils.XDMFFile"><span class="n">XDMFFile</span></a><span class="p">(</span><span class="n">mesh_data</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">comm</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
        <span class="n">mesh_data</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">topology</span><span class="o">.</span><span class="n">create_connectivity</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">mesh_data</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">topology</span><span class="o">.</span><span class="n">create_connectivity</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">mesh_data</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">topology</span><span class="o">.</span><span class="n">create_connectivity</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">write_mesh</span><span class="p">(</span><a class="sphinx-codeautolink-a" href="../generated/dolfinx.io.gmsh.html#dolfinx.io.gmsh.MeshData.mesh" title="dolfinx.io.gmsh.MeshData.mesh"><span class="n">mesh_data</span><span class="o">.</span><span class="n">mesh</span></a><span class="p">)</span>
        <span class="k">if</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.io.gmsh.html#dolfinx.io.gmsh.MeshData.cell_tags" title="dolfinx.io.gmsh.MeshData.cell_tags"><span class="n">mesh_data</span><span class="o">.</span><span class="n">cell_tags</span></a> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write_meshtags</span><span class="p">(</span>
                <a class="sphinx-codeautolink-a" href="../generated/dolfinx.io.gmsh.html#dolfinx.io.gmsh.MeshData.cell_tags" title="dolfinx.io.gmsh.MeshData.cell_tags"><span class="n">mesh_data</span><span class="o">.</span><span class="n">cell_tags</span></a><span class="p">,</span>
                <span class="n">mesh_data</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">geometry</span><span class="p">,</span>
                <span class="n">geometry_xpath</span><span class="o">=</span><span class="sa">f</span><span class="s2">"/Xdmf/Domain/Grid[@Name='</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">']/Geometry"</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">if</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.io.gmsh.html#dolfinx.io.gmsh.MeshData.facet_tags" title="dolfinx.io.gmsh.MeshData.facet_tags"><span class="n">mesh_data</span><span class="o">.</span><span class="n">facet_tags</span></a> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write_meshtags</span><span class="p">(</span>
                <a class="sphinx-codeautolink-a" href="../generated/dolfinx.io.gmsh.html#dolfinx.io.gmsh.MeshData.facet_tags" title="dolfinx.io.gmsh.MeshData.facet_tags"><span class="n">mesh_data</span><span class="o">.</span><span class="n">facet_tags</span></a><span class="p">,</span>
                <span class="n">mesh_data</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">geometry</span><span class="p">,</span>
                <span class="n">geometry_xpath</span><span class="o">=</span><span class="sa">f</span><span class="s2">"/Xdmf/Domain/Grid[@Name='</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">']/Geometry"</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">if</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.io.gmsh.html#dolfinx.io.gmsh.MeshData.ridge_tags" title="dolfinx.io.gmsh.MeshData.ridge_tags"><span class="n">mesh_data</span><span class="o">.</span><span class="n">ridge_tags</span></a> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write_meshtags</span><span class="p">(</span>
                <a class="sphinx-codeautolink-a" href="../generated/dolfinx.io.gmsh.html#dolfinx.io.gmsh.MeshData.ridge_tags" title="dolfinx.io.gmsh.MeshData.ridge_tags"><span class="n">mesh_data</span><span class="o">.</span><span class="n">ridge_tags</span></a><span class="p">,</span>
                <span class="n">mesh_data</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">geometry</span><span class="p">,</span>
                <span class="n">geometry_xpath</span><span class="o">=</span><span class="sa">f</span><span class="s2">"/Xdmf/Domain/Grid[@Name='</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">']/Geometry"</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">if</span> <a class="sphinx-codeautolink-a" href="../generated/dolfinx.io.gmsh.html#dolfinx.io.gmsh.MeshData.peak_tags" title="dolfinx.io.gmsh.MeshData.peak_tags"><span class="n">mesh_data</span><span class="o">.</span><span class="n">peak_tags</span></a> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write_meshtags</span><span class="p">(</span>
                <a class="sphinx-codeautolink-a" href="../generated/dolfinx.io.gmsh.html#dolfinx.io.gmsh.MeshData.peak_tags" title="dolfinx.io.gmsh.MeshData.peak_tags"><span class="n">mesh_data</span><span class="o">.</span><span class="n">peak_tags</span></a><span class="p">,</span>
                <span class="n">mesh_data</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">geometry</span><span class="p">,</span>
                <span class="n">geometry_xpath</span><span class="o">=</span><span class="sa">f</span><span class="s2">"/Xdmf/Domain/Grid[@Name='</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">']/Geometry"</span><span class="p">,</span>
            <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="generate-meshes">
<h2>Generate meshes<a class="headerlink" href="#generate-meshes" title="Link to this heading"></a></h2>
<p>Create a Gmsh model and set the verbosity level.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">gmsh</span><span class="o">.</span><span class="n">initialize</span><span class="p">()</span>
<span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">"General.Terminal"</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># Create model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">gmsh</span><span class="o">.</span><span class="n">model</span><span class="p">()</span>
</pre></div>
</div>
<p>First, we create a Gmsh model of a sphere using tetrahedral cells
(linear geometry), then create independent meshes on each MPI rank and
write each mesh to an XDMF file. The MPI rank is appended to the
filename since the meshes are not distributed.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">gmsh_sphere</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s2">"Sphere"</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">setCurrent</span><span class="p">(</span><span class="s2">"Sphere"</span><span class="p">)</span>
<span class="n">create_mesh</span><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://mpi4py.readthedocs.io/en/4.1.1/reference/mpi4py.MPI.COMM_SELF.html#mpi4py.MPI.COMM_SELF" title="mpi4py.MPI.COMM_SELF"><span class="n">MPI</span><span class="o">.</span><span class="n">COMM_SELF</span></a><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="s2">"sphere"</span><span class="p">,</span> <span class="sa">f</span><span class="s2">"out_gmsh/mesh_rank_</span><span class="si">{</span><span class="n">MPI</span><span class="o">.</span><span class="n">COMM_WORLD</span><span class="o">.</span><span class="n">rank</span><span class="si">}</span><span class="s2">.xdmf"</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">)</span>
</pre></div>
</div>
<p>Next, we create a Gmsh model of a sphere with a box removed and using
tetrahedral cells (linear geometry), then create a distributed mesh.
The distributed mesh is written to file. The write option <code class="docutils literal notranslate"><span class="pre">"w"</span></code> is
passed to create a new XDMF file.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">gmsh_sphere_minus_box</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s2">"Sphere minus box"</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">setCurrent</span><span class="p">(</span><span class="s2">"Sphere minus box"</span><span class="p">)</span>
<span class="n">create_mesh</span><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://mpi4py.readthedocs.io/en/4.1.1/reference/mpi4py.MPI.COMM_WORLD.html#mpi4py.MPI.COMM_WORLD" title="mpi4py.MPI.COMM_WORLD"><span class="n">MPI</span><span class="o">.</span><span class="n">COMM_WORLD</span></a><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="s2">"ball_d1"</span><span class="p">,</span> <span class="s2">"out_gmsh/mesh.xdmf"</span><span class="p">,</span> <span class="s2">"w"</span><span class="p">)</span>
</pre></div>
</div>
<p>For the mesh of the sphere with a box remove, we can increase the
degree of the geometry representation to 2 (quadratic geometry
representation). The higher-order distributed mesh is appended to the
XDMF file.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">"General.Terminal"</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">mesh</span><span class="o">.</span><span class="n">setOrder</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">gmsh</span><span class="o">.</span><span class="n">option</span><span class="o">.</span><span class="n">setNumber</span><span class="p">(</span><span class="s2">"General.Terminal"</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">create_mesh</span><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://mpi4py.readthedocs.io/en/4.1.1/reference/mpi4py.MPI.COMM_WORLD.html#mpi4py.MPI.COMM_WORLD" title="mpi4py.MPI.COMM_WORLD"><span class="n">MPI</span><span class="o">.</span><span class="n">COMM_WORLD</span></a><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="s2">"ball_d2"</span><span class="p">,</span> <span class="s2">"out_gmsh/mesh.xdmf"</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, we create a distributed mesh using hexahedral cells of
geometric degree 2, and append the mesh to the XDMF file.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">gmsh_ring</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s2">"Hexahedral mesh"</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">setCurrent</span><span class="p">(</span><span class="s2">"Hexahedral mesh"</span><span class="p">)</span>
<span class="n">create_mesh</span><span class="p">(</span><a class="sphinx-codeautolink-a" href="https://mpi4py.readthedocs.io/en/4.1.1/reference/mpi4py.MPI.COMM_WORLD.html#mpi4py.MPI.COMM_WORLD" title="mpi4py.MPI.COMM_WORLD"><span class="n">MPI</span><span class="o">.</span><span class="n">COMM_WORLD</span></a><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="s2">"hex_d2"</span><span class="p">,</span> <span class="s2">"out_gmsh/mesh.xdmf"</span><span class="p">,</span> <span class="s2">"a"</span><span class="p">)</span>
</pre></div>
</div>
<p>The generated meshes can be visualised using
<a class="reference external" href="https://www.paraview.org/">ParaView</a>.</p>
</section>
</section>
</div>
</div>
<footer><div aria-label="Footer" class="rst-footer-buttons" role="navigation">
<a accesskey="p" class="btn btn-neutral float-left" href="demo_mixed-topology.html" rel="prev" title="Poisson equation"><span aria-hidden="true" class="fa fa-arrow-circle-left"></span> Previous</a>
<a accesskey="n" class="btn btn-neutral float-right" href="demo_pyvista.html" rel="next" title="Visualization with PyVista">Next <span aria-hidden="true" class="fa fa-arrow-circle-right"></span></a>
</div>
<hr/>
<div role="contentinfo">
<p>© Copyright 2025, FEniCS Project.</p>
</div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
</div>
</div>
</section>
</div>
<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
</body>
</html>