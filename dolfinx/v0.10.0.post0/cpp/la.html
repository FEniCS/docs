

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Linear algebra (dolfinx::la) &mdash; DOLFINx 0.3.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=4621528c"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Mesh (dolfinx::mesh)" href="mesh.html" />
    <link rel="prev" title="IO (dolfinx::io)" href="io.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            DOLFINx
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="demo.html">Demos</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="api.html">API documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="common.html">Common (<code class="docutils literal notranslate"><span class="pre">dolfinx::common</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="geometry.html">Geometry (<code class="docutils literal notranslate"><span class="pre">dolfinx::geometry</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="graph.html">Graph (<code class="docutils literal notranslate"><span class="pre">dolfinx::graph</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="fem.html">Finite element (<code class="docutils literal notranslate"><span class="pre">dolfinx::fem</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="io.html">IO (<code class="docutils literal notranslate"><span class="pre">dolfinx::io</span></code>)</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Linear algebra (<code class="docutils literal notranslate"><span class="pre">dolfinx::la</span></code>)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#_CPPv4N7dolfinx2laE"><code class="docutils literal notranslate"><span class="pre">dolfinx::la</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la9BlockModeE"><code class="docutils literal notranslate"><span class="pre">BlockMode</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la4NormE"><code class="docutils literal notranslate"><span class="pre">Norm</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la13inner_productEDaRK1VRK1V"><code class="docutils literal notranslate"><span class="pre">inner_product()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la12squared_normEDaRK1V"><code class="docutils literal notranslate"><span class="pre">squared_norm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la4normEDaRK1V4Norm"><code class="docutils literal notranslate"><span class="pre">norm()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la14orthonormalizeEvNSt6vectorINSt17reference_wrapperI1VEEEE"><code class="docutils literal notranslate"><span class="pre">orthonormalize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la14is_orthonormalEbNSt6vectorINSt17reference_wrapperIK1VEEEEN7dolfinx14scalar_value_tIN1V10value_typeEEE"><code class="docutils literal notranslate"><span class="pre">is_orthonormal()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I0000EN7dolfinx2la9MatrixCSRE"><code class="docutils literal notranslate"><span class="pre">dolfinx::la::MatrixCSR</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la15SparsityPatternE"><code class="docutils literal notranslate"><span class="pre">dolfinx::la::SparsityPattern</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4I000EN7dolfinx2la6VectorE"><code class="docutils literal notranslate"><span class="pre">dolfinx::la::Vector</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#_CPPv4N7dolfinx2la4implE"><code class="docutils literal notranslate"><span class="pre">dolfinx::la::impl</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mesh.html">Mesh (<code class="docutils literal notranslate"><span class="pre">dolfinx::mesh</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="refinement.html">Refinement (<code class="docutils literal notranslate"><span class="pre">dolfinx::refinement</span></code>)</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">DOLFINx</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="api.html">API documentation</a></li>
      <li class="breadcrumb-item active">Linear algebra (<code class="docutils literal notranslate"><span class="pre">dolfinx::la</span></code>)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/la.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="linear-algebra-dolfinx-la">
<h1>Linear algebra (<code class="docutils literal notranslate"><span class="pre">dolfinx::la</span></code>)<a class="headerlink" href="#linear-algebra-dolfinx-la" title="Link to this heading"></a></h1>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2laE">
<span id="_CPPv3N7dolfinx2laE"></span><span id="_CPPv2N7dolfinx2laE"></span><span id="dolfinx::la"></span><span class="target" id="d6/dfa/namespacedolfinx_1_1la"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">la</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx2laE" title="Link to this definition"></a><br /></dt>
<dd><p>Linear algebra interface. </p>
<p>Interface to linear algebra data structures and solvers. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-enums">Enums</p>
<dl class="cpp enum-class">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9BlockModeE">
<span id="_CPPv3N7dolfinx2la9BlockModeE"></span><span id="_CPPv2N7dolfinx2la9BlockModeE"></span><span class="target" id="d6/dfa/namespacedolfinx_1_1la_1a95b1e1b5aab4eb54c39e0977036b7eb3"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BlockMode</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la9BlockModeE" title="Link to this definition"></a><br /></dt>
<dd><p>Modes for representing block structured matrices. </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9BlockMode7compactE">
<span id="_CPPv3N7dolfinx2la9BlockMode7compactE"></span><span id="_CPPv2N7dolfinx2la9BlockMode7compactE"></span><span class="target" id="d6/dfa/namespacedolfinx_1_1la_1a95b1e1b5aab4eb54c39e0977036b7eb3a7cf74ca49c304df8150205fc915cd465"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">compact</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la9BlockMode7compactE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9BlockMode8expandedE">
<span id="_CPPv3N7dolfinx2la9BlockMode8expandedE"></span><span id="_CPPv2N7dolfinx2la9BlockMode8expandedE"></span><span class="target" id="d6/dfa/namespacedolfinx_1_1la_1a95b1e1b5aab4eb54c39e0977036b7eb3a1a6130a21d7d578d81a168ebcf0d9921"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">expanded</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la9BlockMode8expandedE" title="Link to this definition"></a><br /></dt>
<dd><p>Each entry in the sparsity pattern of the matrix refers to a block of data of size (bs[0], bs[1]). </p>
</dd></dl>

</dd></dl>

<dl class="cpp enum-class">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la4NormE">
<span id="_CPPv3N7dolfinx2la4NormE"></span><span id="_CPPv2N7dolfinx2la4NormE"></span><span class="target" id="d6/dfa/namespacedolfinx_1_1la_1af4df48cdbe7039a3ae36d3bb289234bd"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Norm</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int8_t</span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la4NormE" title="Link to this definition"></a><br /></dt>
<dd><p><a class="reference internal" href="#d6/dfa/namespacedolfinx_1_1la_1af4df48cdbe7039a3ae36d3bb289234bd"><span class="std std-ref">Norm</span></a> types. </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la4Norm2l1E">
<span id="_CPPv3N7dolfinx2la4Norm2l1E"></span><span id="_CPPv2N7dolfinx2la4Norm2l1E"></span><span class="target" id="d6/dfa/namespacedolfinx_1_1la_1af4df48cdbe7039a3ae36d3bb289234bda377fd569971eedeba8fbea28434a390a"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">l1</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la4Norm2l1E" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la4Norm2l2E">
<span id="_CPPv3N7dolfinx2la4Norm2l2E"></span><span id="_CPPv2N7dolfinx2la4Norm2l2E"></span><span class="target" id="d6/dfa/namespacedolfinx_1_1la_1af4df48cdbe7039a3ae36d3bb289234bdabec25675775e9e0a0d783a5018b463e3"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">l2</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la4Norm2l2E" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la4Norm4linfE">
<span id="_CPPv3N7dolfinx2la4Norm4linfE"></span><span id="_CPPv2N7dolfinx2la4Norm4linfE"></span><span class="target" id="d6/dfa/namespacedolfinx_1_1la_1af4df48cdbe7039a3ae36d3bb289234bda707f3c5e9c59c9e5f347d2cbec59c66b"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">linf</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la4Norm4linfE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la4Norm9frobeniusE">
<span id="_CPPv3N7dolfinx2la4Norm9frobeniusE"></span><span id="_CPPv2N7dolfinx2la4Norm9frobeniusE"></span><span class="target" id="d6/dfa/namespacedolfinx_1_1la_1af4df48cdbe7039a3ae36d3bb289234bdaa1ae1f31da9633c9e25dcccb0acc3066"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">frobenius</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la4Norm9frobeniusE" title="Link to this definition"></a><br /></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN7dolfinx2la13inner_productEDaRK1VRK1V">
<span id="_CPPv3I0EN7dolfinx2la13inner_productERK1VRK1V"></span><span id="_CPPv2I0EN7dolfinx2la13inner_productERK1VRK1V"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">V</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d6/dfa/namespacedolfinx_1_1la_1aa5d7dcd5bb4b9b5c111350a5c6dd4751"></span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">inner_product</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la13inner_productEDaRK1VRK1V" title="dolfinx::la::inner_product::V"><span class="n"><span class="pre">V</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">a</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la13inner_productEDaRK1VRK1V" title="dolfinx::la::inner_product::V"><span class="n"><span class="pre">V</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">b</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN7dolfinx2la13inner_productEDaRK1VRK1V" title="Link to this definition"></a><br /></dt>
<dd><p>Compute the inner product of two vectors. </p>
<p>Computes <code class="docutils literal notranslate"><span class="pre">a^{H}</span> <span class="pre">b</span></code> (<code class="docutils literal notranslate"><span class="pre">a^{T}</span> <span class="pre">b</span></code> if <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> are real). The two vectors must have the same parallel layout.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Collective MPI operation</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>a</strong> – <a class="reference internal" href="#d2/d0b/classdolfinx_1_1la_1_1Vector"><span class="std std-ref">Vector</span></a> <code class="docutils literal notranslate"><span class="pre">a</span></code>. </p></li>
<li><p><strong>b</strong> – <a class="reference internal" href="#d2/d0b/classdolfinx_1_1la_1_1Vector"><span class="std std-ref">Vector</span></a> <code class="docutils literal notranslate"><span class="pre">b</span></code>. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Inner product between <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code>. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN7dolfinx2la12squared_normEDaRK1V">
<span id="_CPPv3I0EN7dolfinx2la12squared_normERK1V"></span><span id="_CPPv2I0EN7dolfinx2la12squared_normERK1V"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">V</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d6/dfa/namespacedolfinx_1_1la_1a690ebbef0223a5c669b637d5f2f2e6f0"></span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">squared_norm</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la12squared_normEDaRK1V" title="dolfinx::la::squared_norm::V"><span class="n"><span class="pre">V</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">a</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN7dolfinx2la12squared_normEDaRK1V" title="Link to this definition"></a><br /></dt>
<dd><p>Compute the squared L2 norm of vector. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Collective MPI operation. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN7dolfinx2la4normEDaRK1V4Norm">
<span id="_CPPv3I0EN7dolfinx2la4normERK1V4Norm"></span><span id="_CPPv2I0EN7dolfinx2la4normERK1V4Norm"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">V</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d6/dfa/namespacedolfinx_1_1la_1aa32f131f39f8be7ec5e7681950da35e6"></span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">norm</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la4normEDaRK1V4Norm" title="dolfinx::la::norm::V"><span class="n"><span class="pre">V</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x</span></span>, <a class="reference internal" href="#_CPPv4N7dolfinx2la4NormE" title="dolfinx::la::Norm"><span class="n"><span class="pre">Norm</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">type</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la4NormE" title="dolfinx::la::Norm"><span class="n"><span class="pre">Norm</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N7dolfinx2la4Norm2l2E" title="dolfinx::la::Norm::l2"><span class="n"><span class="pre">l2</span></span></a><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN7dolfinx2la4normEDaRK1V4Norm" title="Link to this definition"></a><br /></dt>
<dd><p>Compute the norm of the vector. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Collective MPI operation.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – <a class="reference internal" href="#d2/d0b/classdolfinx_1_1la_1_1Vector"><span class="std std-ref">Vector</span></a> to compute the norm of. </p></li>
<li><p><strong>type</strong> – <a class="reference internal" href="#d6/dfa/namespacedolfinx_1_1la_1af4df48cdbe7039a3ae36d3bb289234bd"><span class="std std-ref">Norm</span></a> type. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN7dolfinx2la14orthonormalizeEvNSt6vectorINSt17reference_wrapperI1VEEEE">
<span id="_CPPv3I0EN7dolfinx2la14orthonormalizeENSt6vectorINSt17reference_wrapperI1VEEEE"></span><span id="_CPPv2I0EN7dolfinx2la14orthonormalizeENSt6vectorINSt17reference_wrapperI1VEEEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">V</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d6/dfa/namespacedolfinx_1_1la_1a099c016d9a283690d5c49dfc49794c45"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">orthonormalize</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">reference_wrapper</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la14orthonormalizeEvNSt6vectorINSt17reference_wrapperI1VEEEE" title="dolfinx::la::orthonormalize::V"><span class="n"><span class="pre">V</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">basis</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN7dolfinx2la14orthonormalizeEvNSt6vectorINSt17reference_wrapperI1VEEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Orthonormalize a set of vectors. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>V</strong> – <a class="reference internal" href="#d2/d0b/classdolfinx_1_1la_1_1Vector"><span class="std std-ref">dolfinx::la::Vector</span></a></p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>basis</strong> – <strong>[inout]</strong> The set of vectors to orthonormalise. The vectors must have identical parallel layouts. The vectors are modified in-place. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN7dolfinx2la14is_orthonormalEbNSt6vectorINSt17reference_wrapperIK1VEEEEN7dolfinx14scalar_value_tIN1V10value_typeEEE">
<span id="_CPPv3I0EN7dolfinx2la14is_orthonormalENSt6vectorINSt17reference_wrapperIK1VEEEEN7dolfinx14scalar_value_tIN1V10value_typeEEE"></span><span id="_CPPv2I0EN7dolfinx2la14is_orthonormalENSt6vectorINSt17reference_wrapperIK1VEEEEN7dolfinx14scalar_value_tIN1V10value_typeEEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">V</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d6/dfa/namespacedolfinx_1_1la_1ab7a26880b50b487413fa2ce42807af6b"></span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">is_orthonormal</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">reference_wrapper</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la14is_orthonormalEbNSt6vectorINSt17reference_wrapperIK1VEEEEN7dolfinx14scalar_value_tIN1V10value_typeEEE" title="dolfinx::la::is_orthonormal::V"><span class="n"><span class="pre">V</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">basis</span></span>, <span class="n"><span class="pre">dolfinx</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">scalar_value_t</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la14is_orthonormalEbNSt6vectorINSt17reference_wrapperIK1VEEEEN7dolfinx14scalar_value_tIN1V10value_typeEEE" title="dolfinx::la::is_orthonormal::V"><span class="n"><span class="pre">V</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">value_type</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">eps</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">numeric_limits</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">dolfinx</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">scalar_value_t</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la14is_orthonormalEbNSt6vectorINSt17reference_wrapperIK1VEEEEN7dolfinx14scalar_value_tIN1V10value_typeEEE" title="dolfinx::la::is_orthonormal::V"><span class="n"><span class="pre">V</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">value_type</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">(</span></span><span class="p"><span class="pre">)</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN7dolfinx2la14is_orthonormalEbNSt6vectorINSt17reference_wrapperIK1VEEEEN7dolfinx14scalar_value_tIN1V10value_typeEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Test if basis is orthonormal. </p>
<p>Returns true if ||x_i - x_j|| - delta_{ij} &lt; eps for all i, j, and otherwise false.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>basis</strong> – <strong>[in]</strong> Set of vectors to check. </p></li>
<li><p><strong>eps</strong> – <strong>[in]</strong> Tolerance. </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>True is basis is orthonormal, otherwise false. </p>
</dd>
</dl>
</dd></dl>

</div>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4I0000EN7dolfinx2la9MatrixCSRE">
<span id="_CPPv3I0000EN7dolfinx2la9MatrixCSRE"></span><span id="_CPPv2I0000EN7dolfinx2la9MatrixCSRE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Scalar</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Container</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000EN7dolfinx2la9MatrixCSRE" title="dolfinx::la::MatrixCSR::Scalar"><span class="n"><span class="pre">Scalar</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ColContainer</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">RowPtrContainer</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">MatrixCSR</span></span></span><a class="headerlink" href="#_CPPv4I0000EN7dolfinx2la9MatrixCSRE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;MatrixCSR.h&gt;</em></div>
<p>Distributed sparse matrix using compressed sparse row storage. </p>
<p>
The matrix storage format is compressed sparse row, and is partitioned by row across MPI ranks. The matrix can be assembled into using the usual DOLFINx assembly routines. Matrix internal data can be accessed for interfacing with other code.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The class is experimental and subject to change.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Scalar</strong> – Scalar type of matrix entries </p></li>
<li><p><strong>Container</strong> – Container type for storing matrix entries </p></li>
<li><p><strong>ColContainer</strong> – Column index container type </p></li>
<li><p><strong>RowPtrContainer</strong> – Row pointer container type </p></li>
</ul>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-types">Public Types</p>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9MatrixCSR10value_typeE">
<span id="_CPPv3N7dolfinx2la9MatrixCSR10value_typeE"></span><span id="_CPPv2N7dolfinx2la9MatrixCSR10value_typeE"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1aae74c256d8fa59319145b92fa944bad9"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_type</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN7dolfinx2la9MatrixCSRE" title="dolfinx::la::MatrixCSR::Scalar"><span class="n"><span class="pre">Scalar</span></span></a><a class="headerlink" href="#_CPPv4N7dolfinx2la9MatrixCSR10value_typeE" title="Link to this definition"></a><br /></dt>
<dd><p>Scalar type. </p>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9MatrixCSR14container_typeE">
<span id="_CPPv3N7dolfinx2la9MatrixCSR14container_typeE"></span><span id="_CPPv2N7dolfinx2la9MatrixCSR14container_typeE"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a9c2014b8eab41918aa55438cb370dd55"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">container_type</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN7dolfinx2la9MatrixCSRE" title="dolfinx::la::MatrixCSR::Container"><span class="n"><span class="pre">Container</span></span></a><a class="headerlink" href="#_CPPv4N7dolfinx2la9MatrixCSR14container_typeE" title="Link to this definition"></a><br /></dt>
<dd><p>Matrix entries container type. </p>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9MatrixCSR21column_container_typeE">
<span id="_CPPv3N7dolfinx2la9MatrixCSR21column_container_typeE"></span><span id="_CPPv2N7dolfinx2la9MatrixCSR21column_container_typeE"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a57a12155c51f09fb23dc396ed08ecf08"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">column_container_type</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN7dolfinx2la9MatrixCSRE" title="dolfinx::la::MatrixCSR::ColContainer"><span class="n"><span class="pre">ColContainer</span></span></a><a class="headerlink" href="#_CPPv4N7dolfinx2la9MatrixCSR21column_container_typeE" title="Link to this definition"></a><br /></dt>
<dd><p>Column index container type. </p>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9MatrixCSR21rowptr_container_typeE">
<span id="_CPPv3N7dolfinx2la9MatrixCSR21rowptr_container_typeE"></span><span id="_CPPv2N7dolfinx2la9MatrixCSR21rowptr_container_typeE"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a199aedf0b3d25f4550fdf6e3cdf9baa0"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">rowptr_container_type</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN7dolfinx2la9MatrixCSRE" title="dolfinx::la::MatrixCSR::RowPtrContainer"><span class="n"><span class="pre">RowPtrContainer</span></span></a><a class="headerlink" href="#_CPPv4N7dolfinx2la9MatrixCSR21rowptr_container_typeE" title="Link to this definition"></a><br /></dt>
<dd><p>Row pointer container type. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_i_iEN7dolfinx2la9MatrixCSR14mat_set_valuesEDav">
<span id="_CPPv3I_i_iEN7dolfinx2la9MatrixCSR14mat_set_valuesEv"></span><span id="_CPPv2I_i_iEN7dolfinx2la9MatrixCSR14mat_set_valuesEv"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BS0</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BS1</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1af82b24e20208984766017747768330d1"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mat_set_values</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_i_iEN7dolfinx2la9MatrixCSR14mat_set_valuesEDav" title="Link to this definition"></a><br /></dt>
<dd><p>Insertion functor for setting values in a matrix. It is typically used in finite element assembly functions. </p>
<p>Create a function to set values in a <a class="reference internal" href="#dc/dfa/classdolfinx_1_1la_1_1MatrixCSR"><span class="std std-ref">MatrixCSR</span></a>. The function signature is <code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">mat_set_fn(std::span&lt;const</span> <span class="pre">std::int32_t</span> <span class="pre">rows,</span> <span class="pre">/</span> <span class="pre">std::span&lt;const</span> <span class="pre">std::int32_t</span> <span class="pre">cols,</span> <span class="pre">std::span&lt;const</span> <a class="reference internal" href="#dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1aae74c256d8fa59319145b92fa944bad9"><span class="std std-ref"><span class="pre">value_type</span></span></a><span class="pre">&gt;</span> <span class="pre">/</span> <span class="pre">data)</span></code>. The rows and columns use process local indexing, and the given rows and columns must pre-exist in the sparsity pattern of the matrix. Insertion into “ghost” rows (in the ghost region of the row <code class="docutils literal notranslate"><span class="pre">IndexMap</span></code>) is permitted, so long as there are correct entries in the sparsity pattern.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using rows or columns which are not in the sparsity will result in undefined behaviour (or an assert failure in Debug mode).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Matrix block size may be (1, 1) or (BS0, BS1) </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Data block size may be (1, 1) or (BS0, BS1)</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>BS0</strong> – Row block size of data for insertion </p></li>
<li><p><strong>BS1</strong> – Column block size of data for insertion</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Function for inserting values into <code class="docutils literal notranslate"><span class="pre">A</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_i_iEN7dolfinx2la9MatrixCSR14mat_add_valuesEDav">
<span id="_CPPv3I_i_iEN7dolfinx2la9MatrixCSR14mat_add_valuesEv"></span><span id="_CPPv2I_i_iEN7dolfinx2la9MatrixCSR14mat_add_valuesEv"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BS0</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BS1</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a29f31ac7eced3e98248e4537b570f1c1"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">auto</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mat_add_values</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_i_iEN7dolfinx2la9MatrixCSR14mat_add_valuesEDav" title="Link to this definition"></a><br /></dt>
<dd><p>Insertion functor for adding values to a matrix. It is typically used in finite element assembly functions. </p>
<p>Create a function to add values to a <a class="reference internal" href="#dc/dfa/classdolfinx_1_1la_1_1MatrixCSR"><span class="std std-ref">MatrixCSR</span></a>. The function signature is <code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">mat_add_fn(std::span&lt;const</span> <span class="pre">std::int32_t</span> <span class="pre">rows,</span> <span class="pre">/</span> <span class="pre">std::span&lt;const</span> <span class="pre">std::int32_t</span> <span class="pre">cols,</span> <span class="pre">std::span&lt;const</span> <a class="reference internal" href="#dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1aae74c256d8fa59319145b92fa944bad9"><span class="std std-ref"><span class="pre">value_type</span></span></a><span class="pre">&gt;</span> <span class="pre">/</span> <span class="pre">data)</span></code>. The rows and columns use process local indexing, and the given rows and columns must pre-exist in the sparsity pattern of the matrix. Insertion into “ghost” rows (in the ghost region of the row <code class="docutils literal notranslate"><span class="pre">IndexMap</span></code>) is permitted, so long as there are correct entries in the sparsity pattern.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using rows or columns which are not in the sparsity will result in undefined behaviour (or an assert failure in Debug mode).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Matrix block size may be (1, 1) or (BS0, BS1) </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Data block size may be (1, 1) or (BS0, BS1)</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>BS0</strong> – Row block size of data for insertion </p></li>
<li><p><strong>BS1</strong> – Column block size of data for insertion</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Function for inserting values into <code class="docutils literal notranslate"><span class="pre">A</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9MatrixCSR9MatrixCSRERK15SparsityPattern9BlockMode">
<span id="_CPPv3N7dolfinx2la9MatrixCSR9MatrixCSRERK15SparsityPattern9BlockMode"></span><span id="_CPPv2N7dolfinx2la9MatrixCSR9MatrixCSRERK15SparsityPattern9BlockMode"></span><span id="dolfinx::la::MatrixCSR::MatrixCSR__SparsityPatternCR.BlockMode"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a4fab1e7a87e50293d7a36cd75e1db2d8"></span><span class="sig-name descname"><span class="n"><span class="pre">MatrixCSR</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la15SparsityPatternE" title="dolfinx::la::SparsityPattern"><span class="n"><span class="pre">SparsityPattern</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">p</span></span>, <a class="reference internal" href="#_CPPv4N7dolfinx2la9BlockModeE" title="dolfinx::la::BlockMode"><span class="n"><span class="pre">BlockMode</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">mode</span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la9BlockModeE" title="dolfinx::la::BlockMode"><span class="n"><span class="pre">BlockMode</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="#_CPPv4N7dolfinx2la9BlockMode7compactE" title="dolfinx::la::BlockMode::compact"><span class="n"><span class="pre">compact</span></span></a><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la9MatrixCSR9MatrixCSRERK15SparsityPattern9BlockMode" title="Link to this definition"></a><br /></dt>
<dd><p>Create a distributed matrix. </p>
<p>The structure of the matrix depends entirely on the input <code class="docutils literal notranslate"><a class="reference internal" href="#d5/df9/classdolfinx_1_1la_1_1SparsityPattern"><span class="std std-ref"><span class="pre">SparsityPattern</span></span></a></code>, which must be finalized. The matrix storage is distributed Compressed Sparse Row: the matrix is distributed by row across processes, and on each process, there is a list of column indices and matrix entries for each row stored. This exactly matches the layout of the <code class="docutils literal notranslate"><a class="reference internal" href="#d5/df9/classdolfinx_1_1la_1_1SparsityPattern"><span class="std std-ref"><span class="pre">SparsityPattern</span></span></a></code>. There is some overlap of matrix rows between processes to allow for independent Finite Element assembly, after which, the ghost rows should be sent to the row owning processes by calling <code class="docutils literal notranslate"><a class="reference internal" href="#dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a76f9d7c359047ead5a1de4746a930910"><span class="std std-ref"><span class="pre">scatter_rev()</span></span></a></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The block size of the matrix is given by the block size of the input <code class="docutils literal notranslate"><a class="reference internal" href="#d5/df9/classdolfinx_1_1la_1_1SparsityPattern"><span class="std std-ref"><span class="pre">SparsityPattern</span></span></a></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> – <strong>[in]</strong> The sparsity pattern which describes the parallel distribution and the non-zero structure. </p></li>
<li><p><strong>mode</strong> – <strong>[in]</strong> Block mode. When the block size is greater than one, the storage can be “compact” where each matrix entry refers to a block of data (stored row major), or “expanded” where each matrix entry is individual. In the “expanded” case, the sparsity is expanded for every entry in the block, and the block size of the matrix is set to <code class="docutils literal notranslate"><span class="pre">(1,</span> <span class="pre">1)</span></code>. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9MatrixCSR9MatrixCSRERR9MatrixCSR">
<span id="_CPPv3N7dolfinx2la9MatrixCSR9MatrixCSRERR9MatrixCSR"></span><span id="_CPPv2N7dolfinx2la9MatrixCSR9MatrixCSRERR9MatrixCSR"></span><span id="dolfinx::la::MatrixCSR::MatrixCSR__MatrixCSRRR"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a614e45af83ed3e32c3f357e85464670c"></span><span class="sig-name descname"><span class="n"><span class="pre">MatrixCSR</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR9MatrixCSRERR9MatrixCSR" title="dolfinx::la::MatrixCSR::MatrixCSR"><span class="n"><span class="pre">MatrixCSR</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">A</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la9MatrixCSR9MatrixCSRERR9MatrixCSR" title="Link to this definition"></a><br /></dt>
<dd><p>Move constructor <dl>
<dt class="sig sig-object cpp">
<em><span class="pre">Todo:</span></em></dt>
<dd><p>Check handling of MPI_Request </p>
</dd></dl>

</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9MatrixCSR9MatrixCSRERK9MatrixCSR">
<span id="_CPPv3N7dolfinx2la9MatrixCSR9MatrixCSRERK9MatrixCSR"></span><span id="_CPPv2N7dolfinx2la9MatrixCSR9MatrixCSRERK9MatrixCSR"></span><span id="dolfinx::la::MatrixCSR::MatrixCSR__MatrixCSRCR"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1ae987664b8a65a7db84b6a8f1830de95b"></span><span class="sig-name descname"><span class="n"><span class="pre">MatrixCSR</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR9MatrixCSRERK9MatrixCSR" title="dolfinx::la::MatrixCSR::MatrixCSR"><span class="n"><span class="pre">MatrixCSR</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">A</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la9MatrixCSR9MatrixCSRERK9MatrixCSR" title="Link to this definition"></a><br /></dt>
<dd><p>Copy constructor <dl>
<dt class="sig sig-object cpp">
<em><span class="pre">Todo:</span></em></dt>
<dd><p>Check handling of MPI_Request </p>
</dd></dl>

</p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0000EN7dolfinx2la9MatrixCSR9MatrixCSRERK9MatrixCSRI7Scalar010Container013ColContainer016RowPtrContainer0E">
<span id="_CPPv3I0000EN7dolfinx2la9MatrixCSR9MatrixCSRERK9MatrixCSRI7Scalar010Container013ColContainer016RowPtrContainer0E"></span><span id="_CPPv2I0000EN7dolfinx2la9MatrixCSR9MatrixCSRERK9MatrixCSRI7Scalar010Container013ColContainer016RowPtrContainer0E"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Scalar0</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Container0</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ColContainer0</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">RowPtrContainer0</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a14abbcfe1d16702cff1168fd4b3f0012"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">explicit</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">MatrixCSR</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN7dolfinx2la9MatrixCSR9MatrixCSRERK9MatrixCSRI7Scalar010Container013ColContainer016RowPtrContainer0E" title="dolfinx::la::MatrixCSR::MatrixCSR"><span class="n"><span class="pre">MatrixCSR</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0000EN7dolfinx2la9MatrixCSR9MatrixCSRERK9MatrixCSRI7Scalar010Container013ColContainer016RowPtrContainer0E" title="dolfinx::la::MatrixCSR::MatrixCSR::Scalar0"><span class="n"><span class="pre">Scalar0</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN7dolfinx2la9MatrixCSR9MatrixCSRERK9MatrixCSRI7Scalar010Container013ColContainer016RowPtrContainer0E" title="dolfinx::la::MatrixCSR::MatrixCSR::Container0"><span class="n"><span class="pre">Container0</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN7dolfinx2la9MatrixCSR9MatrixCSRERK9MatrixCSRI7Scalar010Container013ColContainer016RowPtrContainer0E" title="dolfinx::la::MatrixCSR::MatrixCSR::ColContainer0"><span class="n"><span class="pre">ColContainer0</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0000EN7dolfinx2la9MatrixCSR9MatrixCSRERK9MatrixCSRI7Scalar010Container013ColContainer016RowPtrContainer0E" title="dolfinx::la::MatrixCSR::MatrixCSR::RowPtrContainer0"><span class="n"><span class="pre">RowPtrContainer0</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">A</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0000EN7dolfinx2la9MatrixCSR9MatrixCSRERK9MatrixCSRI7Scalar010Container013ColContainer016RowPtrContainer0E" title="Link to this definition"></a><br /></dt>
<dd><p>Copy-convert matrix, possibly using to different container types. </p>
<p>Examples of use for this constructor include copying a matrix to a different value type, or copying the matrix to a GPU.</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Mat</strong> – </p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>A</strong> – Matrix to copy. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9MatrixCSR3setE10value_type">
<span id="_CPPv3N7dolfinx2la9MatrixCSR3setE10value_type"></span><span id="_CPPv2N7dolfinx2la9MatrixCSR3setE10value_type"></span><span id="dolfinx::la::MatrixCSR::set__value_type"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1abdea5bd806d475ad3ca0636c6919aba2"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR10value_typeE" title="dolfinx::la::MatrixCSR::value_type"><span class="n"><span class="pre">value_type</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la9MatrixCSR3setE10value_type" title="Link to this definition"></a><br /></dt>
<dd><p>Set all non-zero local entries to a value, including entries in ghost rows. </p>
<p><dl>
<dt class="sig sig-object cpp">
<em><span class="pre">Deprecated:</span></em></dt>
<dd><p>Use <code class="docutils literal notranslate"><span class="pre">std::ranges::fill(A.values(),</span> <span class="pre">x)</span></code> instead. </p>
</dd></dl>

</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> – <strong>[in]</strong> The value to set non-zero matrix entries to </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_i_iEN7dolfinx2la9MatrixCSR3setEvNSt4spanIK10value_typeEENSt4spanIKNSt7int32_tEEENSt4spanIKNSt7int32_tEEE">
<span id="_CPPv3I_i_iEN7dolfinx2la9MatrixCSR3setENSt4spanIK10value_typeEENSt4spanIKNSt7int32_tEEENSt4spanIKNSt7int32_tEEE"></span><span id="_CPPv2I_i_iEN7dolfinx2la9MatrixCSR3setENSt4spanIK10value_typeEENSt4spanIKNSt7int32_tEEENSt4spanIKNSt7int32_tEEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BS0</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BS1</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a0e569a33c5838c5fb4bedc14ed195300"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR10value_typeE" title="dolfinx::la::MatrixCSR::value_type"><span class="n"><span class="pre">value_type</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rows</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">cols</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_i_iEN7dolfinx2la9MatrixCSR3setEvNSt4spanIK10value_typeEENSt4spanIKNSt7int32_tEEENSt4spanIKNSt7int32_tEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Set values in the matrix. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only entries included in the sparsity pattern used to initialize the matrix can be set. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All indices are local to the calling MPI rank and entries cannot be set in ghost rows. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This should be called after <code class="docutils literal notranslate"><span class="pre">scatter_rev</span></code>. Using before <code class="docutils literal notranslate"><span class="pre">scatter_rev</span></code> will set the values correctly, but incoming values may get added to them during a subsequent reverse scatter operation. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>BS0</strong> – Data row block size </p></li>
<li><p><strong>BS1</strong> – Data column block size </p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>x</strong> – <strong>[in]</strong> The <code class="docutils literal notranslate"><span class="pre">m</span></code> by <code class="docutils literal notranslate"><span class="pre">n</span></code> dense block of values (row-major) to set in the matrix </p></li>
<li><p><strong>rows</strong> – <strong>[in]</strong> The row indices of <code class="docutils literal notranslate"><span class="pre">x</span></code></p></li>
<li><p><strong>cols</strong> – <strong>[in]</strong> The column indices of <code class="docutils literal notranslate"><span class="pre">x</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_i_iEN7dolfinx2la9MatrixCSR3addEvNSt4spanIK10value_typeEENSt4spanIKNSt7int32_tEEENSt4spanIKNSt7int32_tEEE">
<span id="_CPPv3I_i_iEN7dolfinx2la9MatrixCSR3addENSt4spanIK10value_typeEENSt4spanIKNSt7int32_tEEENSt4spanIKNSt7int32_tEEE"></span><span id="_CPPv2I_i_iEN7dolfinx2la9MatrixCSR3addENSt4spanIK10value_typeEENSt4spanIKNSt7int32_tEEENSt4spanIKNSt7int32_tEEE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BS0</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BS1</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="m"><span class="pre">1</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a3a86261e0064d3ed9ff6b96de35d3d90"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">add</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR10value_typeE" title="dolfinx::la::MatrixCSR::value_type"><span class="n"><span class="pre">value_type</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rows</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">cols</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_i_iEN7dolfinx2la9MatrixCSR3addEvNSt4spanIK10value_typeEENSt4spanIKNSt7int32_tEEENSt4spanIKNSt7int32_tEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Accumulate values in the matrix. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only entries included in the sparsity pattern used to initialize the matrix can be accumulated into. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All indices are local to the calling MPI rank and entries may go into ghost rows. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Use <code class="docutils literal notranslate"><span class="pre">scatter_rev</span></code> after all entries have been added to send ghost rows to owners. Adding more entries after <code class="docutils literal notranslate"><span class="pre">scatter_rev</span></code> is allowed, but another call to <code class="docutils literal notranslate"><span class="pre">scatter_rev</span></code> will then be required.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>BS0</strong> – Row block size of data </p></li>
<li><p><strong>BS1</strong> – Column block size of data </p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>x</strong> – <strong>[in]</strong> The <code class="docutils literal notranslate"><span class="pre">m</span></code> by <code class="docutils literal notranslate"><span class="pre">n</span></code> dense block of values (row-major) to add to the matrix </p></li>
<li><p><strong>rows</strong> – <strong>[in]</strong> The row indices of <code class="docutils literal notranslate"><span class="pre">x</span></code></p></li>
<li><p><strong>cols</strong> – <strong>[in]</strong> The column indices of <code class="docutils literal notranslate"><span class="pre">x</span></code></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la9MatrixCSR14num_owned_rowsEv">
<span id="_CPPv3NK7dolfinx2la9MatrixCSR14num_owned_rowsEv"></span><span id="_CPPv2NK7dolfinx2la9MatrixCSR14num_owned_rowsEv"></span><span id="dolfinx::la::MatrixCSR::num_owned_rowsC"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a44eabebe62656b3b8d9252477e5f61a0"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">num_owned_rows</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la9MatrixCSR14num_owned_rowsEv" title="Link to this definition"></a><br /></dt>
<dd><p>Number of local rows excluding ghost rows. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la9MatrixCSR12num_all_rowsEv">
<span id="_CPPv3NK7dolfinx2la9MatrixCSR12num_all_rowsEv"></span><span id="_CPPv2NK7dolfinx2la9MatrixCSR12num_all_rowsEv"></span><span id="dolfinx::la::MatrixCSR::num_all_rowsC"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1acf00f9c00e0b1fb45f838cccacead71a"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">num_all_rows</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la9MatrixCSR12num_all_rowsEv" title="Link to this definition"></a><br /></dt>
<dd><p>Number of local rows including ghost rows. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la9MatrixCSR8to_denseEv">
<span id="_CPPv3NK7dolfinx2la9MatrixCSR8to_denseEv"></span><span id="_CPPv2NK7dolfinx2la9MatrixCSR8to_denseEv"></span><span id="dolfinx::la::MatrixCSR::to_denseC"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1ad2cdf8148afa7a37915410897fdbd3b5"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR10value_typeE" title="dolfinx::la::MatrixCSR::value_type"><span class="n"><span class="pre">value_type</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">to_dense</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la9MatrixCSR8to_denseEv" title="Link to this definition"></a><br /></dt>
<dd><p>Copy to a dense matrix. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is typically used for debugging and not used in production. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Ghost rows are also returned, and these can be truncated manually by using <a class="reference internal" href="#dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a44eabebe62656b3b8d9252477e5f61a0"><span class="std std-ref">num_owned_rows()</span></a> if required. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the block size is greater than 1, the entries are expanded. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dense copy of the part of the matrix on the calling rank. Storage is row-major. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9MatrixCSR11scatter_revEv">
<span id="_CPPv3N7dolfinx2la9MatrixCSR11scatter_revEv"></span><span id="_CPPv2N7dolfinx2la9MatrixCSR11scatter_revEv"></span><span id="dolfinx::la::MatrixCSR::scatter_rev"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a76f9d7c359047ead5a1de4746a930910"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">scatter_rev</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la9MatrixCSR11scatter_revEv" title="Link to this definition"></a><br /></dt>
<dd><p>Transfer ghost row data to the owning ranks accumulating received values on the owned rows, and zeroing any existing data in ghost rows. </p>
<p>This process is analogous to <code class="docutils literal notranslate"><span class="pre">scatter_rev</span></code> for <code class="docutils literal notranslate"><a class="reference internal" href="#d2/d0b/classdolfinx_1_1la_1_1Vector"><span class="std std-ref"><span class="pre">Vector</span></span></a></code> except that the values are always accumulated on the owning process. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9MatrixCSR17scatter_rev_beginEv">
<span id="_CPPv3N7dolfinx2la9MatrixCSR17scatter_rev_beginEv"></span><span id="_CPPv2N7dolfinx2la9MatrixCSR17scatter_rev_beginEv"></span><span id="dolfinx::la::MatrixCSR::scatter_rev_begin"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1ab032c989bf69e8d9a0f54c2bbdcf28ad"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">scatter_rev_begin</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la9MatrixCSR17scatter_rev_beginEv" title="Link to this definition"></a><br /></dt>
<dd><p>Begin transfer of ghost row data to owning ranks, where it will be accumulated into existing owned rows. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Calls to this function must be followed by <a class="reference internal" href="#dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a1ef6afb8da364f4f5990e31811348d13"><span class="std std-ref">MatrixCSR::scatter_rev_end()</span></a>. Between the two calls matrix values must not be changed.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function does not change the matrix data. Data update only occurs with <code class="docutils literal notranslate"><a class="reference internal" href="#dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a1ef6afb8da364f4f5990e31811348d13"><span class="std std-ref"><span class="pre">scatter_rev_end()</span></span></a></code>. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9MatrixCSR15scatter_rev_endEv">
<span id="_CPPv3N7dolfinx2la9MatrixCSR15scatter_rev_endEv"></span><span id="_CPPv2N7dolfinx2la9MatrixCSR15scatter_rev_endEv"></span><span id="dolfinx::la::MatrixCSR::scatter_rev_end"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a1ef6afb8da364f4f5990e31811348d13"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">scatter_rev_end</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la9MatrixCSR15scatter_rev_endEv" title="Link to this definition"></a><br /></dt>
<dd><p>End transfer of ghost row data to owning ranks. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Must be preceded by <a class="reference internal" href="#dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1ab032c989bf69e8d9a0f54c2bbdcf28ad"><span class="std std-ref">MatrixCSR::scatter_rev_begin()</span></a>. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Matrix data received from other processes will be accumulated into locally owned rows, and ghost rows will be zeroed. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la9MatrixCSR12squared_normEv">
<span id="_CPPv3NK7dolfinx2la9MatrixCSR12squared_normEv"></span><span id="_CPPv2NK7dolfinx2la9MatrixCSR12squared_normEv"></span><span id="dolfinx::la::MatrixCSR::squared_normC"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a76099c1549db9c057693a2f2fe90b620"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">double</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">squared_norm</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la9MatrixCSR12squared_normEv" title="Link to this definition"></a><br /></dt>
<dd><p>Compute the Frobenius norm squared across all processes. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>MPI Collective </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9MatrixCSR4multER6VectorI10value_typeER6VectorI10value_typeE">
<span id="_CPPv3N7dolfinx2la9MatrixCSR4multER6VectorI10value_typeER6VectorI10value_typeE"></span><span id="_CPPv2N7dolfinx2la9MatrixCSR4multER6VectorI10value_typeER6VectorI10value_typeE"></span><span id="dolfinx::la::MatrixCSR::mult__Vector:value_type:R.Vector:value_type:R"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a68605c440399ca7620c8a6d65ae580db"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">mult</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I000EN7dolfinx2la6VectorE" title="dolfinx::la::Vector"><span class="n"><span class="pre">Vector</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR10value_typeE" title="dolfinx::la::MatrixCSR::value_type"><span class="n"><span class="pre">value_type</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x</span></span>, <a class="reference internal" href="#_CPPv4I000EN7dolfinx2la6VectorE" title="dolfinx::la::Vector"><span class="n"><span class="pre">Vector</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR10value_typeE" title="dolfinx::la::MatrixCSR::value_type"><span class="n"><span class="pre">value_type</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">y</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la9MatrixCSR4multER6VectorI10value_typeER6VectorI10value_typeE" title="Link to this definition"></a><br /></dt>
<dd><p>Compute the product <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">+=</span> <span class="pre">Ax</span></code>. </p>
<p>The vectors <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> must have parallel layouts that are compatible with <code class="docutils literal notranslate"><span class="pre">A</span></code>. In detail, <code class="docutils literal notranslate"><span class="pre">x</span></code> must have the same <code class="docutils literal notranslate"><span class="pre">IndexMap</span></code> as the matrix columns, <code class="docutils literal notranslate"><span class="pre">A.index_map(1)</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> must have the same owned indices as the matrix rows in <code class="docutils literal notranslate"><span class="pre">A.index_map(0)</span></code>. Only owned entries of <code class="docutils literal notranslate"><span class="pre">y</span></code> are updated, so any ghost entries of <code class="docutils literal notranslate"><span class="pre">y</span></code> are not affected.</p>
<p>
Computes y += A*x for a parallel CSR matrix A and parallel dense vectors x,y </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – <strong>[in]</strong> <a class="reference internal" href="#d2/d0b/classdolfinx_1_1la_1_1Vector"><span class="std std-ref">Vector</span></a> to apply <code class="docutils literal notranslate"><span class="pre">A</span></code> to. </p></li>
<li><p><strong>y</strong> – <strong>[inout]</strong> <a class="reference internal" href="#d2/d0b/classdolfinx_1_1la_1_1Vector"><span class="std std-ref">Vector</span></a> to accumulate the result into.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la9MatrixCSR4commEv">
<span id="_CPPv3NK7dolfinx2la9MatrixCSR4commEv"></span><span id="_CPPv2NK7dolfinx2la9MatrixCSR4commEv"></span><span id="dolfinx::la::MatrixCSR::commC"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1ad3217ebf3e21d7902bf89ab1248dabb9"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">MPI_Comm</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">comm</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la9MatrixCSR4commEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get MPI communicator that matrix is defined on. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la9MatrixCSR9index_mapEi">
<span id="_CPPv3NK7dolfinx2la9MatrixCSR9index_mapEi"></span><span id="_CPPv2NK7dolfinx2la9MatrixCSR9index_mapEi"></span><span id="dolfinx::la::MatrixCSR::index_map__iC"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a0d7c9f032463aab0dc49ef3a3082ddbb"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6commonE" title="dolfinx::common"><span class="n"><span class="pre">common</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6common8IndexMapE" title="dolfinx::common::IndexMap"><span class="n"><span class="pre">IndexMap</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index_map</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dim</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la9MatrixCSR9index_mapEi" title="Link to this definition"></a><br /></dt>
<dd><p>Index map for the row or column space. </p>
<p>The row index map contains ghost entries for rows which may be inserted into and the column index map contains all local and ghost columns that may exist in the owned rows.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Row (0) or column (1) index map. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la9MatrixCSR6valuesEv">
<span id="_CPPv3N7dolfinx2la9MatrixCSR6valuesEv"></span><span id="_CPPv2N7dolfinx2la9MatrixCSR6valuesEv"></span><span id="dolfinx::la::MatrixCSR::values"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a29b38057b0491969b2e775885cb33c69"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR14container_typeE" title="dolfinx::la::MatrixCSR::container_type"><span class="n"><span class="pre">container_type</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">values</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la9MatrixCSR6valuesEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get local data values. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Includes ghost values. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la9MatrixCSR6valuesEv">
<span id="_CPPv3NK7dolfinx2la9MatrixCSR6valuesEv"></span><span id="_CPPv2NK7dolfinx2la9MatrixCSR6valuesEv"></span><span id="dolfinx::la::MatrixCSR::valuesC"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a03c056df0ddfeee3a2cdc95b0d732329"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR14container_typeE" title="dolfinx::la::MatrixCSR::container_type"><span class="n"><span class="pre">container_type</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">values</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la9MatrixCSR6valuesEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get local values (const version). </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Includes ghost values </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la9MatrixCSR7row_ptrEv">
<span id="_CPPv3NK7dolfinx2la9MatrixCSR7row_ptrEv"></span><span id="_CPPv2NK7dolfinx2la9MatrixCSR7row_ptrEv"></span><span id="dolfinx::la::MatrixCSR::row_ptrC"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1ad0f87c20451b1fe7ec61010d6ae1bddf"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR21rowptr_container_typeE" title="dolfinx::la::MatrixCSR::rowptr_container_type"><span class="n"><span class="pre">rowptr_container_type</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">row_ptr</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la9MatrixCSR7row_ptrEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get local row pointers. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Includes pointers to ghost rows </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la9MatrixCSR4colsEv">
<span id="_CPPv3NK7dolfinx2la9MatrixCSR4colsEv"></span><span id="_CPPv2NK7dolfinx2la9MatrixCSR4colsEv"></span><span id="dolfinx::la::MatrixCSR::colsC"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1abbf3c9be3c7dd289c3e674ac445d9f4e"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR21column_container_typeE" title="dolfinx::la::MatrixCSR::column_container_type"><span class="n"><span class="pre">column_container_type</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">cols</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la9MatrixCSR4colsEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get local column indices </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Includes columns in ghost rows </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la9MatrixCSR15off_diag_offsetEv">
<span id="_CPPv3NK7dolfinx2la9MatrixCSR15off_diag_offsetEv"></span><span id="_CPPv2NK7dolfinx2la9MatrixCSR15off_diag_offsetEv"></span><span id="dolfinx::la::MatrixCSR::off_diag_offsetC"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a0e4fa2488d7568e011bd4e738861d0ab"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la9MatrixCSR21rowptr_container_typeE" title="dolfinx::la::MatrixCSR::rowptr_container_type"><span class="n"><span class="pre">rowptr_container_type</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">off_diag_offset</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la9MatrixCSR15off_diag_offsetEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get the start of off-diagonal (unowned columns) on each row, allowing the matrix to be split (virtually) into two parts. </p>
<p>Operations (such as matrix-vector multiply) between the owned parts of the matrix and vector can then be performed separately from operations on the unowned parts.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Includes ghost rows, which should be ‘truncated’ by the caller if not required. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la9MatrixCSR10block_sizeEv">
<span id="_CPPv3NK7dolfinx2la9MatrixCSR10block_sizeEv"></span><span id="_CPPv2NK7dolfinx2la9MatrixCSR10block_sizeEv"></span><span id="dolfinx::la::MatrixCSR::block_sizeC"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1acd5885105f8558be3508757c934eb606"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">block_size</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la9MatrixCSR10block_sizeEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get block sizes. </p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Block sizes for rows (0) and columns (1). </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la9MatrixCSR10block_modeEv">
<span id="_CPPv3NK7dolfinx2la9MatrixCSR10block_modeEv"></span><span id="_CPPv2NK7dolfinx2la9MatrixCSR10block_modeEv"></span><span id="dolfinx::la::MatrixCSR::block_modeC"></span><span class="target" id="dc/dfa/classdolfinx_1_1la_1_1MatrixCSR_1a36452ae3e6ea247886651c8494b52e5d"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la9BlockModeE" title="dolfinx::la::BlockMode"><span class="n"><span class="pre">BlockMode</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">block_mode</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la9MatrixCSR10block_modeEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get ‘block mode’. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la15SparsityPatternE">
<span id="_CPPv3N7dolfinx2la15SparsityPatternE"></span><span id="_CPPv2N7dolfinx2la15SparsityPatternE"></span><span id="dolfinx::la::SparsityPattern"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SparsityPattern</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la15SparsityPatternE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;SparsityPattern.h&gt;</em></div>
<p>Sparsity pattern data structure that can be used to initialize sparse matrices. After assembly, column indices are always sorted in increasing order. Ghost entries are kept after assembly. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la15SparsityPattern15SparsityPatternE8MPI_CommNSt5arrayINSt10shared_ptrIKN6common8IndexMapEEEXL2EEEENSt5arrayIiXL2EEEE">
<span id="_CPPv3N7dolfinx2la15SparsityPattern15SparsityPatternE8MPI_CommNSt5arrayINSt10shared_ptrIKN6common8IndexMapEEEXL2EEEENSt5arrayIiXL2EEEE"></span><span id="_CPPv2N7dolfinx2la15SparsityPattern15SparsityPatternE8MPI_CommNSt5arrayINSt10shared_ptrIKN6common8IndexMapEEEX2EEENSt5arrayIiX2EEE"></span><span id="dolfinx::la::SparsityPattern::SparsityPattern__MPI_Comm.std::array:std::shared_ptr:common::IndexMapC:.2:.std::array:i.2:"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1ad1c44c60d5668bc0e7ac67ec95c0d679"></span><span class="sig-name descname"><span class="n"><span class="pre">SparsityPattern</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPI_Comm</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">comm</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6commonE" title="dolfinx::common"><span class="n"><span class="pre">common</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6common8IndexMapE" title="dolfinx::common::IndexMap"><span class="n"><span class="pre">IndexMap</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">maps</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">bs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la15SparsityPattern15SparsityPatternE8MPI_CommNSt5arrayINSt10shared_ptrIKN6common8IndexMapEEEXL2EEEENSt5arrayIiXL2EEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Create an empty sparsity pattern with specified dimensions. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>comm</strong> – <strong>[in]</strong> Communicator that the pattern is defined on. </p></li>
<li><p><strong>maps</strong> – <strong>[in]</strong> Index maps describing the [0] row and [1] column index ranges (up to a block size). </p></li>
<li><p><strong>bs</strong> – <strong>[in]</strong> Block sizes for the [0] row and [1] column maps. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la15SparsityPattern15SparsityPatternE8MPI_CommRKNSt6vectorINSt6vectorIPK15SparsityPatternEEEERKNSt5arrayINSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEEXL2EEEERKNSt5arrayINSt6vectorIiEEXL2EEEE">
<span id="_CPPv3N7dolfinx2la15SparsityPattern15SparsityPatternE8MPI_CommRKNSt6vectorINSt6vectorIPK15SparsityPatternEEEERKNSt5arrayINSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEEXL2EEEERKNSt5arrayINSt6vectorIiEEXL2EEEE"></span><span id="_CPPv2N7dolfinx2la15SparsityPattern15SparsityPatternE8MPI_CommRKNSt6vectorINSt6vectorIPK15SparsityPatternEEEERKNSt5arrayINSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEEX2EEERKNSt5arrayINSt6vectorIiEEX2EEE"></span><span id="dolfinx::la::SparsityPattern::SparsityPattern__MPI_Comm.std::vector:std::vector:SparsityPatternCP::CR.std::array:std::vector:std::pair:std::reference_wrapper:common::IndexMapC:.i::.2:CR.std::array:std::vector:i:.2:CR"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a27ee9d8b12fe8591db6a166f10b06379"></span><span class="sig-name descname"><span class="n"><span class="pre">SparsityPattern</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">MPI_Comm</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">comm</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la15SparsityPattern15SparsityPatternE8MPI_CommRKNSt6vectorINSt6vectorIPK15SparsityPatternEEEERKNSt5arrayINSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEEXL2EEEERKNSt5arrayINSt6vectorIiEEXL2EEEE" title="dolfinx::la::SparsityPattern::SparsityPattern"><span class="n"><span class="pre">SparsityPattern</span></span></a><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">patterns</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">reference_wrapper</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6commonE" title="dolfinx::common"><span class="n"><span class="pre">common</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6common8IndexMapE" title="dolfinx::common::IndexMap"><span class="n"><span class="pre">IndexMap</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">maps</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">array</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="m"><span class="pre">2</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">bs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la15SparsityPattern15SparsityPatternE8MPI_CommRKNSt6vectorINSt6vectorIPK15SparsityPatternEEEERKNSt5arrayINSt6vectorINSt4pairINSt17reference_wrapperIKN6common8IndexMapEEEiEEEEXL2EEEERKNSt5arrayINSt6vectorIiEEXL2EEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Create a new sparsity pattern by concatenating sub-patterns, e.g. pattern =[ pattern00 ][ pattern 01] [ pattern10 ][ pattern 11]</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>comm</strong> – <strong>[in]</strong> Communicator that the pattern is defined on. </p></li>
<li><p><strong>patterns</strong> – <strong>[in]</strong> Rectangular array of sparsity pattern. The patterns must not be finalised. Null block are permitted/ </p></li>
<li><p><strong>maps</strong> – <strong>[in]</strong> Pairs of (index map, block size) for each row block (maps[0]) and column blocks (maps[1])/ </p></li>
<li><p><strong>bs</strong> – <strong>[in]</strong> Block sizes for the sparsity pattern entries/ </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la15SparsityPattern15SparsityPatternERR15SparsityPattern">
<span id="_CPPv3N7dolfinx2la15SparsityPattern15SparsityPatternERR15SparsityPattern"></span><span id="_CPPv2N7dolfinx2la15SparsityPattern15SparsityPatternERR15SparsityPattern"></span><span id="dolfinx::la::SparsityPattern::SparsityPattern__SparsityPatternRR"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a02febb2f44c9c8f556a274fe39bb6975"></span><span class="sig-name descname"><span class="n"><span class="pre">SparsityPattern</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx2la15SparsityPattern15SparsityPatternERR15SparsityPattern" title="dolfinx::la::SparsityPattern::SparsityPattern"><span class="n"><span class="pre">SparsityPattern</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">pattern</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la15SparsityPattern15SparsityPatternERR15SparsityPattern" title="Link to this definition"></a><br /></dt>
<dd><p>Move constructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la15SparsityPatternD0Ev">
<span id="_CPPv3N7dolfinx2la15SparsityPatternD0Ev"></span><span id="_CPPv2N7dolfinx2la15SparsityPatternD0Ev"></span><span id="dolfinx::la::SparsityPattern::~SparsityPattern"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1adbd3a02ebc1814404361a1d6221658f1"></span><span class="sig-name descname"><span class="n"><span class="pre">~SparsityPattern</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la15SparsityPatternD0Ev" title="Link to this definition"></a><br /></dt>
<dd><p>Destructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la15SparsityPatternaSERR15SparsityPattern">
<span id="_CPPv3N7dolfinx2la15SparsityPatternaSERR15SparsityPattern"></span><span id="_CPPv2N7dolfinx2la15SparsityPatternaSERR15SparsityPattern"></span><span id="dolfinx::la::SparsityPattern::assign-operator__SparsityPatternRR"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1ad568d43e73eec2449ba9c3c8f54d68c4"></span><a class="reference internal" href="#_CPPv4N7dolfinx2la15SparsityPatternE" title="dolfinx::la::SparsityPattern"><span class="n"><span class="pre">SparsityPattern</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx2la15SparsityPatternE" title="dolfinx::la::SparsityPattern"><span class="n"><span class="pre">SparsityPattern</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">pattern</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la15SparsityPatternaSERR15SparsityPattern" title="Link to this definition"></a><br /></dt>
<dd><p>Move assignment. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la15SparsityPattern6insertENSt7int32_tENSt7int32_tE">
<span id="_CPPv3N7dolfinx2la15SparsityPattern6insertENSt7int32_tENSt7int32_tE"></span><span id="_CPPv2N7dolfinx2la15SparsityPattern6insertENSt7int32_tENSt7int32_tE"></span><span id="dolfinx::la::SparsityPattern::insert__std::int32_t.std::int32_t"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a6491b756e15eec9368cd2b4062ec6511"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">insert</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">row</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">col</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la15SparsityPattern6insertENSt7int32_tENSt7int32_tE" title="Link to this definition"></a><br /></dt>
<dd><p>Insert non-zero locations using local (process-wise) indices. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>row</strong> – <strong>[in]</strong> local row index </p></li>
<li><p><strong>col</strong> – <strong>[in]</strong> local column index </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la15SparsityPattern6insertENSt4spanIKNSt7int32_tEEENSt4spanIKNSt7int32_tEEE">
<span id="_CPPv3N7dolfinx2la15SparsityPattern6insertENSt4spanIKNSt7int32_tEEENSt4spanIKNSt7int32_tEEE"></span><span id="_CPPv2N7dolfinx2la15SparsityPattern6insertENSt4spanIKNSt7int32_tEEENSt4spanIKNSt7int32_tEEE"></span><span id="dolfinx::la::SparsityPattern::insert__std::span:std::int32_tC:.std::span:std::int32_tC:"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a6b8ef4dacf867b55ca9daf900c4568b2"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">insert</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rows</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">cols</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la15SparsityPattern6insertENSt4spanIKNSt7int32_tEEENSt4spanIKNSt7int32_tEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Insert non-zero locations using local (process-wise) indices. </p>
<p>This routine inserts non-zero locations at the outer product of rows and cols into the sparsity pattern, i.e. adds the matrix entries at <code class="docutils literal notranslate"><span class="pre">A[row[i],</span> <span class="pre">col[j]]</span> <span class="pre">for</span> <span class="pre">all</span> <span class="pre">i,</span> <span class="pre">j</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rows</strong> – <strong>[in]</strong> list of the local row indices </p></li>
<li><p><strong>cols</strong> – <strong>[in]</strong> list of the local column indices </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la15SparsityPattern15insert_diagonalENSt4spanIKNSt7int32_tEEE">
<span id="_CPPv3N7dolfinx2la15SparsityPattern15insert_diagonalENSt4spanIKNSt7int32_tEEE"></span><span id="_CPPv2N7dolfinx2la15SparsityPattern15insert_diagonalENSt4spanIKNSt7int32_tEEE"></span><span id="dolfinx::la::SparsityPattern::insert_diagonal__std::span:std::int32_tC:"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a7125025cbd32fbce039d801b65dfffb2"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">insert_diagonal</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">rows</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la15SparsityPattern15insert_diagonalENSt4spanIKNSt7int32_tEEE" title="Link to this definition"></a><br /></dt>
<dd><p>Insert non-zero locations on the diagonal. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>rows</strong> – <strong>[in]</strong> Rows in local (process-wise) indices. The indices must exist in the row IndexMap. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la15SparsityPattern8finalizeEv">
<span id="_CPPv3N7dolfinx2la15SparsityPattern8finalizeEv"></span><span id="_CPPv2N7dolfinx2la15SparsityPattern8finalizeEv"></span><span id="dolfinx::la::SparsityPattern::finalize"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a32d626626eee0bc4ade146973f6abb1c"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">finalize</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la15SparsityPattern8finalizeEv" title="Link to this definition"></a><br /></dt>
<dd><p>Finalize sparsity pattern and communicate off-process entries. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la15SparsityPattern9index_mapEi">
<span id="_CPPv3NK7dolfinx2la15SparsityPattern9index_mapEi"></span><span id="_CPPv2NK7dolfinx2la15SparsityPattern9index_mapEi"></span><span id="dolfinx::la::SparsityPattern::index_map__iC"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a0d7c9f032463aab0dc49ef3a3082ddbb"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6commonE" title="dolfinx::common"><span class="n"><span class="pre">common</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6common8IndexMapE" title="dolfinx::common::IndexMap"><span class="n"><span class="pre">IndexMap</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index_map</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dim</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la15SparsityPattern9index_mapEi" title="Link to this definition"></a><br /></dt>
<dd><p>Index map for given dimension dimension. Returns the index map for rows and columns that will be set by the current MPI rank. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>dim</strong> – <strong>[in]</strong> Requested map, row (0) or column (1). </p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The index map. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la15SparsityPattern14column_indicesEv">
<span id="_CPPv3NK7dolfinx2la15SparsityPattern14column_indicesEv"></span><span id="_CPPv2NK7dolfinx2la15SparsityPattern14column_indicesEv"></span><span id="dolfinx::la::SparsityPattern::column_indicesC"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a8d696ffd12d94e9995a56fddf7030dfb"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">column_indices</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la15SparsityPattern14column_indicesEv" title="Link to this definition"></a><br /></dt>
<dd><p>Global indices of non-zero columns on owned rows. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The ghosts are computed only once <a class="reference internal" href="#d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a32d626626eee0bc4ade146973f6abb1c"><span class="std std-ref">SparsityPattern::finalize</span></a> has been called. </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Global index non-zero columns on this process, including ghosts. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la15SparsityPattern16column_index_mapEv">
<span id="_CPPv3NK7dolfinx2la15SparsityPattern16column_index_mapEv"></span><span id="_CPPv2NK7dolfinx2la15SparsityPattern16column_index_mapEv"></span><span id="dolfinx::la::SparsityPattern::column_index_mapC"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a9671fd5e7395782a5a664fba1806c2a8"></span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6commonE" title="dolfinx::common"><span class="n"><span class="pre">common</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6common8IndexMapE" title="dolfinx::common::IndexMap"><span class="n"><span class="pre">IndexMap</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">column_index_map</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la15SparsityPattern16column_index_mapEv" title="Link to this definition"></a><br /></dt>
<dd><p>Builds the index map for columns after assembly of the sparsity pattern. </p>
<p><dl>
<dt class="sig sig-object cpp">
<em><span class="pre">Todo:</span></em></dt>
<dd><p>Should this be compted and stored when finalising the <a class="reference internal" href="#d5/df9/classdolfinx_1_1la_1_1SparsityPattern"><span class="std std-ref">SparsityPattern</span></a>? </p>
</dd></dl>

</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Map for all non-zero columns on this process, including ghosts </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la15SparsityPattern10block_sizeEi">
<span id="_CPPv3NK7dolfinx2la15SparsityPattern10block_sizeEi"></span><span id="_CPPv2NK7dolfinx2la15SparsityPattern10block_sizeEi"></span><span id="dolfinx::la::SparsityPattern::block_size__iC"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a397d727caaff61d6caafbe154cb5c461"></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">block_size</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">dim</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la15SparsityPattern10block_sizeEi" title="Link to this definition"></a><br /></dt>
<dd><p>Return index map block size for dimension dim. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la15SparsityPattern12num_nonzerosEv">
<span id="_CPPv3NK7dolfinx2la15SparsityPattern12num_nonzerosEv"></span><span id="_CPPv2NK7dolfinx2la15SparsityPattern12num_nonzerosEv"></span><span id="dolfinx::la::SparsityPattern::num_nonzerosC"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a7ad58551156ab501aa9bee7580dc2a93"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">num_nonzeros</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la15SparsityPattern12num_nonzerosEv" title="Link to this definition"></a><br /></dt>
<dd><p>Number of nonzeros on this rank after assembly, including ghost rows. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la15SparsityPattern8nnz_diagENSt7int32_tE">
<span id="_CPPv3NK7dolfinx2la15SparsityPattern8nnz_diagENSt7int32_tE"></span><span id="_CPPv2NK7dolfinx2la15SparsityPattern8nnz_diagENSt7int32_tE"></span><span id="dolfinx::la::SparsityPattern::nnz_diag__std::int32_tC"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a5c76a6f74ef0aec646374dd6716b58e0"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">nnz_diag</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">row</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la15SparsityPattern8nnz_diagENSt7int32_tE" title="Link to this definition"></a><br /></dt>
<dd><p>Number of non-zeros in owned columns (diagonal block) on a given row. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Can also be used on ghost rows </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la15SparsityPattern12nnz_off_diagENSt7int32_tE">
<span id="_CPPv3NK7dolfinx2la15SparsityPattern12nnz_off_diagENSt7int32_tE"></span><span id="_CPPv2NK7dolfinx2la15SparsityPattern12nnz_off_diagENSt7int32_tE"></span><span id="dolfinx::la::SparsityPattern::nnz_off_diag__std::int32_tC"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a26aa980b1174e63fc8eb625f647d312e"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">nnz_off_diag</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">row</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la15SparsityPattern12nnz_off_diagENSt7int32_tE" title="Link to this definition"></a><br /></dt>
<dd><p>Number of non-zeros in unowned columns (off-diagonal block) on a given row. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Can also be used on ghost rows </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la15SparsityPattern5graphEv">
<span id="_CPPv3NK7dolfinx2la15SparsityPattern5graphEv"></span><span id="_CPPv2NK7dolfinx2la15SparsityPattern5graphEv"></span><span id="dolfinx::la::SparsityPattern::graphC"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1af3d9e7570db304b1492da0672877e481"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">pair</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">graph</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la15SparsityPattern5graphEv" title="Link to this definition"></a><br /></dt>
<dd><p>Sparsity pattern graph after assembly. Uses local indices for the columns. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Column global indices can be obtained from <a class="reference internal" href="#d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a9671fd5e7395782a5a664fba1806c2a8"><span class="std std-ref">SparsityPattern::column_index_map()</span></a></p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Includes ghost rows </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Adjacency list edges and offsets </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la15SparsityPattern20off_diagonal_offsetsEv">
<span id="_CPPv3NK7dolfinx2la15SparsityPattern20off_diagonal_offsetsEv"></span><span id="_CPPv2NK7dolfinx2la15SparsityPattern20off_diagonal_offsetsEv"></span><span id="dolfinx::la::SparsityPattern::off_diagonal_offsetsC"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1a88067c688a3d32686a667f9a55bc4f07"></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">off_diagonal_offsets</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la15SparsityPattern20off_diagonal_offsetsEv" title="Link to this definition"></a><br /></dt>
<dd><p>Row-wise start of off-diagonals (unowned columns) for each row. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Includes ghost rows </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la15SparsityPattern4commEv">
<span id="_CPPv3NK7dolfinx2la15SparsityPattern4commEv"></span><span id="_CPPv2NK7dolfinx2la15SparsityPattern4commEv"></span><span id="dolfinx::la::SparsityPattern::commC"></span><span class="target" id="d5/df9/classdolfinx_1_1la_1_1SparsityPattern_1ad3217ebf3e21d7902bf89ab1248dabb9"></span><span class="n"><span class="pre">MPI_Comm</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">comm</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la15SparsityPattern4commEv" title="Link to this definition"></a><br /></dt>
<dd><p>Return MPI communicator. </p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv4I000EN7dolfinx2la6VectorE">
<span id="_CPPv3I000EN7dolfinx2la6VectorE"></span><span id="_CPPv2I000EN7dolfinx2la6VectorE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Container</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000EN7dolfinx2la6VectorE" title="dolfinx::la::Vector::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ScatterContainer</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">vector</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Vector</span></span></span><a class="headerlink" href="#_CPPv4I000EN7dolfinx2la6VectorE" title="Link to this definition"></a><br /></dt>
<dd><div class="docutils container">
<em>#include &lt;Vector.h&gt;</em></div>
<p>A vector that can be distributed across processes. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> – Scalar type of the vector. </p></li>
<li><p><strong>Container</strong> – Data container type. This is typically <code class="docutils literal notranslate"><span class="pre">std::vector&lt;T&gt;</span></code> on CPUs, and <code class="docutils literal notranslate"><span class="pre">thrust::device_vector&lt;T&gt;</span></code> on GPUs. </p></li>
<li><p><strong>ScatterContainer</strong> – Storage container type for the scatterer indices. This is typically <code class="docutils literal notranslate"><span class="pre">std::vector&lt;std::int32_t&gt;</span></code> on CPUs, and <code class="docutils literal notranslate"><span class="pre">thrust::device_vector&lt;std::int32_t&gt;</span></code> on GPUs. </p></li>
</ul>
</dd>
</dl>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-types">Public Types</p>
<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la6Vector14container_typeE">
<span id="_CPPv3N7dolfinx2la6Vector14container_typeE"></span><span id="_CPPv2N7dolfinx2la6Vector14container_typeE"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1a9c2014b8eab41918aa55438cb370dd55"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">container_type</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN7dolfinx2la6VectorE" title="dolfinx::la::Vector::Container"><span class="n"><span class="pre">Container</span></span></a><a class="headerlink" href="#_CPPv4N7dolfinx2la6Vector14container_typeE" title="Link to this definition"></a><br /></dt>
<dd><p>Container type. </p>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la6Vector10value_typeE">
<span id="_CPPv3N7dolfinx2la6Vector10value_typeE"></span><span id="_CPPv2N7dolfinx2la6Vector10value_typeE"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1a1952c1b8061d096ce3aab37a796e7df5"></span><span class="k"><span class="pre">using</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">value_type</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la6Vector14container_typeE" title="dolfinx::la::Vector::container_type"><span class="n"><span class="pre">container_type</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">value_type</span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la6Vector10value_typeE" title="Link to this definition"></a><br /></dt>
<dd><p>Scalar type. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la6Vector6VectorENSt10shared_ptrIKN6common8IndexMapEEEi">
<span id="_CPPv3N7dolfinx2la6Vector6VectorENSt10shared_ptrIKN6common8IndexMapEEEi"></span><span id="_CPPv2N7dolfinx2la6Vector6VectorENSt10shared_ptrIKN6common8IndexMapEEEi"></span><span id="dolfinx::la::Vector::Vector__std::shared_ptr:common::IndexMapC:.i"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1a5e05669c7cdb76c40cf5260bee4682be"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Vector</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6commonE" title="dolfinx::common"><span class="n"><span class="pre">common</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6common8IndexMapE" title="dolfinx::common::IndexMap"><span class="n"><span class="pre">IndexMap</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">map</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">bs</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la6Vector6VectorENSt10shared_ptrIKN6common8IndexMapEEEi" title="Link to this definition"></a><br /></dt>
<dd><p>Create a distributed vector. </p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>map</strong> – Index map that describes the parallel layout of the data. </p></li>
<li><p><strong>bs</strong> – Number of entries per index map ‘index’ (block size). </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la6Vector6VectorERK6Vector">
<span id="_CPPv3N7dolfinx2la6Vector6VectorERK6Vector"></span><span id="_CPPv2N7dolfinx2la6Vector6VectorERK6Vector"></span><span id="dolfinx::la::Vector::Vector__VectorCR"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1ae6dfe382b0653b9282ad56ec3c3ff17e"></span><span class="sig-name descname"><span class="n"><span class="pre">Vector</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la6Vector6VectorERK6Vector" title="dolfinx::la::Vector::Vector"><span class="n"><span class="pre">Vector</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la6Vector6VectorERK6Vector" title="Link to this definition"></a><br /></dt>
<dd><p>Copy constructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la6Vector6VectorERR6Vector">
<span id="_CPPv3N7dolfinx2la6Vector6VectorERR6Vector"></span><span id="_CPPv2N7dolfinx2la6Vector6VectorERR6Vector"></span><span id="dolfinx::la::Vector::Vector__VectorRR"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1abb4bc159ceec64c5dfff2d9c705d135a"></span><span class="sig-name descname"><span class="n"><span class="pre">Vector</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx2la6Vector6VectorERR6Vector" title="dolfinx::la::Vector::Vector"><span class="n"><span class="pre">Vector</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la6Vector6VectorERR6Vector" title="Link to this definition"></a><br /></dt>
<dd><p>Move constructor. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000EN7dolfinx2la6Vector6VectorERK6VectorI2T010Container017ScatterContainer0E">
<span id="_CPPv3I000EN7dolfinx2la6Vector6VectorERK6VectorI2T010Container017ScatterContainer0E"></span><span id="_CPPv2I000EN7dolfinx2la6Vector6VectorERK6VectorI2T010Container017ScatterContainer0E"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T0</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Container0</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ScatterContainer0</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1a43eeee26647538435811ab84696bcc98"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">explicit</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Vector</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN7dolfinx2la6Vector6VectorERK6VectorI2T010Container017ScatterContainer0E" title="dolfinx::la::Vector::Vector"><span class="n"><span class="pre">Vector</span></span></a><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I000EN7dolfinx2la6Vector6VectorERK6VectorI2T010Container017ScatterContainer0E" title="dolfinx::la::Vector::Vector::T0"><span class="n"><span class="pre">T0</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN7dolfinx2la6Vector6VectorERK6VectorI2T010Container017ScatterContainer0E" title="dolfinx::la::Vector::Vector::Container0"><span class="n"><span class="pre">Container0</span></span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000EN7dolfinx2la6Vector6VectorERK6VectorI2T010Container017ScatterContainer0E" title="dolfinx::la::Vector::Vector::ScatterContainer0"><span class="n"><span class="pre">ScatterContainer0</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000EN7dolfinx2la6Vector6VectorERK6VectorI2T010Container017ScatterContainer0E" title="Link to this definition"></a><br /></dt>
<dd><p>Copy-convert vector, possibly using to different container types. </p>
<p>Examples of use include copying a <a class="reference internal" href="#d2/d0b/classdolfinx_1_1la_1_1Vector"><span class="std std-ref">Vector</span></a> to a different value type, e.g. double to float, or copying a <a class="reference internal" href="#d2/d0b/classdolfinx_1_1la_1_1Vector"><span class="std std-ref">Vector</span></a> from a CPU to a GPU.</p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>Vec</strong> – Type of the <a class="reference internal" href="#d2/d0b/classdolfinx_1_1la_1_1Vector"><span class="std std-ref">Vector</span></a> being copied. </p>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>x</strong> – <a class="reference internal" href="#d2/d0b/classdolfinx_1_1la_1_1Vector"><span class="std std-ref">Vector</span></a> to copy. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la6VectoraSERR6Vector">
<span id="_CPPv3N7dolfinx2la6VectoraSERR6Vector"></span><span id="_CPPv2N7dolfinx2la6VectoraSERR6Vector"></span><span id="dolfinx::la::Vector::assign-operator__VectorRR"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1a776a08fdde16fc24c1de53bbb115f71f"></span><a class="reference internal" href="#_CPPv4I000EN7dolfinx2la6VectorE" title="dolfinx::la::Vector"><span class="n"><span class="pre">Vector</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="k"><span class="pre">operator</span></span><span class="o"><span class="pre">=</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I000EN7dolfinx2la6VectorE" title="dolfinx::la::Vector"><span class="n"><span class="pre">Vector</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="k"><span class="pre">default</span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la6VectoraSERR6Vector" title="Link to this definition"></a><br /></dt>
<dd><p>Move assignment operator. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la6Vector3setE10value_type">
<span id="_CPPv3N7dolfinx2la6Vector3setE10value_type"></span><span id="_CPPv2N7dolfinx2la6Vector3setE10value_type"></span><span id="dolfinx::la::Vector::set__value_type"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1ab4a809e8bd73a28e6bbe63aec58cda6a"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">set</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4N7dolfinx2la6Vector10value_typeE" title="dolfinx::la::Vector::value_type"><span class="n"><span class="pre">value_type</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">v</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la6Vector3setE10value_type" title="Link to this definition"></a><br /></dt>
<dd><p>Set all entries (including ghosts). </p>
<p><dl>
<dt class="sig sig-object cpp">
<em><span class="pre">Deprecated:</span></em></dt>
<dd><p>Use <code class="docutils literal notranslate"><span class="pre">std::ranges::fill(u.array(),</span> <span class="pre">v)</span></code> instead. </p>
</dd></dl>

</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>v</strong> – <strong>[in]</strong> Value to set all entries to (on calling rank). </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN7dolfinx2la6Vector17scatter_fwd_beginEv1U6GetPtr">
<span id="_CPPv3I00EN7dolfinx2la6Vector17scatter_fwd_beginE1U6GetPtr"></span><span id="_CPPv2I00EN7dolfinx2la6Vector17scatter_fwd_beginE1U6GetPtr"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">U</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GetPtr</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1ab07d9857e0d635d27f7ea915262c11a6"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">scatter_fwd_begin</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00EN7dolfinx2la6Vector17scatter_fwd_beginEv1U6GetPtr" title="dolfinx::la::Vector::scatter_fwd_begin::U"><span class="n"><span class="pre">U</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">pack</span></span>, <a class="reference internal" href="#_CPPv4I00EN7dolfinx2la6Vector17scatter_fwd_beginEv1U6GetPtr" title="dolfinx::la::Vector::scatter_fwd_begin::GetPtr"><span class="n"><span class="pre">GetPtr</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">get_ptr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00EN7dolfinx2la6Vector17scatter_fwd_beginEv1U6GetPtr" title="Link to this definition"></a><br /></dt>
<dd><p>Begin scatter (send) of local data that is ghosted on other processes. </p>
<p>The user provides the function to pack to the send buffer. Typically usage would be a specialised function to pack data that resides on a GPU.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Collective MPI operation</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>U</strong> – Pack function type. </p></li>
<li><p><strong>GetPtr</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>pack</strong> – Function that packs owned data into a send buffer. </p></li>
<li><p><strong>get_ptr</strong> – Function that for a <code class="docutils literal notranslate"><span class="pre">Container</span></code> type returns the pointer to the underlying data. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la6Vector17scatter_fwd_beginEv">
<span id="_CPPv3N7dolfinx2la6Vector17scatter_fwd_beginEv"></span><span id="_CPPv2N7dolfinx2la6Vector17scatter_fwd_beginEv"></span><span id="dolfinx::la::Vector::scatter_fwd_begin"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1ada646adaa18ddbaed19b60e3e2dad6ce"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">scatter_fwd_begin</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la6Vector17scatter_fwd_beginEv" title="Link to this definition"></a><br /></dt>
<dd><p>Begin scatter (send) of local data that is ghosted on other processes (simplified CPU version). </p>
<p>Suitable for scatter operations on a CPU with <code class="docutils literal notranslate"><span class="pre">std::vector</span></code> storage. The send buffer is packed internally by a function that is suitable for use on a CPU.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Collective MPI operation. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN7dolfinx2la6Vector15scatter_fwd_endEv1U">
<span id="_CPPv3I0EN7dolfinx2la6Vector15scatter_fwd_endE1U"></span><span id="_CPPv2I0EN7dolfinx2la6Vector15scatter_fwd_endE1U"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">U</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1a69e66e0d1a3ab2ef39506e38001c339a"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">scatter_fwd_end</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la6Vector15scatter_fwd_endEv1U" title="dolfinx::la::Vector::scatter_fwd_end::U"><span class="n"><span class="pre">U</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">unpack</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN7dolfinx2la6Vector15scatter_fwd_endEv1U" title="Link to this definition"></a><br /></dt>
<dd><p>End scatter (send) of local data values that are ghosted on other processes. </p>
<p>The user provides the function to unpack the receive buffer. Typically usage would be a specialised function to unpack data that resides on a GPU.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Collective MPI operation.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>unpack</strong> – Function to unpack the receive buffer into the ghost entries. </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la6Vector15scatter_fwd_endEv">
<span id="_CPPv3N7dolfinx2la6Vector15scatter_fwd_endEv"></span><span id="_CPPv2N7dolfinx2la6Vector15scatter_fwd_endEv"></span><span id="dolfinx::la::Vector::scatter_fwd_end"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1a87d2509d857a40b8c696c896ef3adbdd"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">scatter_fwd_end</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la6Vector15scatter_fwd_endEv" title="Link to this definition"></a><br /></dt>
<dd><p>End scatter (send) of local data values that are ghosted on other processes (simplified CPU version). </p>
<p>Suitable for scatter operations on a CPU with <code class="docutils literal notranslate"><span class="pre">std::vector</span></code> storage. The receive buffer is unpacked internally by a function that is suitable for use on a CPU.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Collective MPI operation. </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la6Vector11scatter_fwdEv">
<span id="_CPPv3N7dolfinx2la6Vector11scatter_fwdEv"></span><span id="_CPPv2N7dolfinx2la6Vector11scatter_fwdEv"></span><span id="dolfinx::la::Vector::scatter_fwd"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1a913455928bb202d138e185228b8fe488"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">scatter_fwd</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la6Vector11scatter_fwdEv" title="Link to this definition"></a><br /></dt>
<dd><p>Scatter (send) of local data values that are ghosted on other processes and update ghost entry values (simplified CPU version). </p>
<p>Suitable for scatter operations on a CPU with <code class="docutils literal notranslate"><span class="pre">std::vector</span></code> storage. The send buffer is packed and the receive buffer unpacked by a function that is suitable for use on a CPU.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Collective MPI operation </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I00EN7dolfinx2la6Vector17scatter_rev_beginEv1U6GetPtr">
<span id="_CPPv3I00EN7dolfinx2la6Vector17scatter_rev_beginE1U6GetPtr"></span><span id="_CPPv2I00EN7dolfinx2la6Vector17scatter_rev_beginE1U6GetPtr"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">U</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">GetPtr</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1a2849d0f2db352096a2fe68935a218a68"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">scatter_rev_begin</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I00EN7dolfinx2la6Vector17scatter_rev_beginEv1U6GetPtr" title="dolfinx::la::Vector::scatter_rev_begin::U"><span class="n"><span class="pre">U</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">pack</span></span>, <a class="reference internal" href="#_CPPv4I00EN7dolfinx2la6Vector17scatter_rev_beginEv1U6GetPtr" title="dolfinx::la::Vector::scatter_rev_begin::GetPtr"><span class="n"><span class="pre">GetPtr</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">get_ptr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I00EN7dolfinx2la6Vector17scatter_rev_beginEv1U6GetPtr" title="Link to this definition"></a><br /></dt>
<dd><p>Start scatter (send) of ghost entry data to the owning process of an index. </p>
<p>The user provides the function to pack to the send buffer. Typically usage would be a specialised function to pack data that resides on a GPU.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Collective MPI operation </p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>U</strong> – Pack function type. </p></li>
<li><p><strong>GetPtr</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>pack</strong> – Function that packs ghost data into a send buffer. </p></li>
<li><p><strong>get_ptr</strong> – Function that for a <code class="docutils literal notranslate"><span class="pre">Container</span></code> type returns the pointer to the underlying data. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la6Vector17scatter_rev_beginEv">
<span id="_CPPv3N7dolfinx2la6Vector17scatter_rev_beginEv"></span><span id="_CPPv2N7dolfinx2la6Vector17scatter_rev_beginEv"></span><span id="dolfinx::la::Vector::scatter_rev_begin"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1ae7726d782f9b67d20d5cf5b22414305b"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">scatter_rev_begin</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la6Vector17scatter_rev_beginEv" title="Link to this definition"></a><br /></dt>
<dd><p>Start scatter (send) of ghost entry data to the owning process of an index (simplified CPU version). </p>
<p>Suitable for scatter operations on a CPU with <code class="docutils literal notranslate"><span class="pre">std::vector</span></code> storage. The send buffer is packed internally by a function that is suitable for use on a CPU.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Collective MPI operation </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN7dolfinx2la6Vector15scatter_rev_endEv1U">
<span id="_CPPv3I0EN7dolfinx2la6Vector15scatter_rev_endE1U"></span><span id="_CPPv2I0EN7dolfinx2la6Vector15scatter_rev_endE1U"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">U</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1a70df360bc6aacc28b6124d1a99bf39f7"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">scatter_rev_end</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la6Vector15scatter_rev_endEv1U" title="dolfinx::la::Vector::scatter_rev_end::U"><span class="n"><span class="pre">U</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">unpack</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN7dolfinx2la6Vector15scatter_rev_endEv1U" title="Link to this definition"></a><br /></dt>
<dd><p>End scatter of ghost data to owner and update owned entries. </p>
<p>For an owned entry, data from more than one process may be received. The received data can be summed or inserted into the owning entry by the <code class="docutils literal notranslate"><span class="pre">unpack</span></code> function.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Collective MPI operation </p>
</div>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0EN7dolfinx2la6Vector11scatter_revEv15BinaryOperation">
<span id="_CPPv3I0EN7dolfinx2la6Vector11scatter_revE15BinaryOperation"></span><span id="_CPPv2I0EN7dolfinx2la6Vector11scatter_revE15BinaryOperation"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BinaryOperation</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1a61f543b1aa833487e2a9f94a59a8acfe"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">scatter_rev</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I0EN7dolfinx2la6Vector11scatter_revEv15BinaryOperation" title="dolfinx::la::Vector::scatter_rev::BinaryOperation"><span class="n"><span class="pre">BinaryOperation</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">op</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0EN7dolfinx2la6Vector11scatter_revEv15BinaryOperation" title="Link to this definition"></a><br /></dt>
<dd><p>Scatter (send) of ghost data values to the owning process and assign/accumulate into the owned data entries (simplified CPU version). </p>
<p>For an owned entry, data from more than one process may be received. The received data can be summed or inserted into the owning entry. The this is controlled by the <code class="docutils literal notranslate"><span class="pre">op</span></code> function.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Collective MPI operation</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>op</strong> – IndexMap operation (add or insert). </p>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la6Vector9index_mapEv">
<span id="_CPPv3NK7dolfinx2la6Vector9index_mapEv"></span><span id="_CPPv2NK7dolfinx2la6Vector9index_mapEv"></span><span id="dolfinx::la::Vector::index_mapC"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1a8293d9aee560cf478b9c9e3def1d0255"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">shared_ptr</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6commonE" title="dolfinx::common"><span class="n"><span class="pre">common</span></span></a><span class="p"><span class="pre">::</span></span><a class="reference internal" href="common.html#_CPPv4N7dolfinx6common8IndexMapE" title="dolfinx::common::IndexMap"><span class="n"><span class="pre">IndexMap</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">index_map</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la6Vector9index_mapEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get IndexMap. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la6Vector2bsEv">
<span id="_CPPv3NK7dolfinx2la6Vector2bsEv"></span><span id="_CPPv2NK7dolfinx2la6Vector2bsEv"></span><span id="dolfinx::la::Vector::bsC"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1a48ddad8b3b7b898f02a7e99332a2ac4e"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">bs</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la6Vector2bsEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get block size. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la6Vector5arrayEv">
<span id="_CPPv3N7dolfinx2la6Vector5arrayEv"></span><span id="_CPPv2N7dolfinx2la6Vector5arrayEv"></span><span id="dolfinx::la::Vector::array"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1a138cacaeb58bb73d0c223d48bb946d00"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la6Vector14container_typeE" title="dolfinx::la::Vector::container_type"><span class="n"><span class="pre">container_type</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">array</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la6Vector5arrayEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get the process-local part of the vector. </p>
<p>Owned entries appear first, followed by ghosted entries. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK7dolfinx2la6Vector5arrayEv">
<span id="_CPPv3NK7dolfinx2la6Vector5arrayEv"></span><span id="_CPPv2NK7dolfinx2la6Vector5arrayEv"></span><span id="dolfinx::la::Vector::arrayC"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1a1a487a589e6a018d1d4aa65d645edd5f"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la6Vector14container_typeE" title="dolfinx::la::Vector::container_type"><span class="n"><span class="pre">container_type</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">array</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><a class="headerlink" href="#_CPPv4NK7dolfinx2la6Vector5arrayEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get the process-local part of the vector (const version). </p>
<p>Owned entries appear first, followed by ghosted entries. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la6Vector13mutable_arrayEv">
<span id="_CPPv3N7dolfinx2la6Vector13mutable_arrayEv"></span><span id="_CPPv2N7dolfinx2la6Vector13mutable_arrayEv"></span><span id="dolfinx::la::Vector::mutable_array"></span><span class="target" id="d2/d0b/classdolfinx_1_1la_1_1Vector_1a0ade3a27614cf09ae1133dbecf75a882"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4N7dolfinx2la6Vector14container_typeE" title="dolfinx::la::Vector::container_type"><span class="n"><span class="pre">container_type</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">mutable_array</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4N7dolfinx2la6Vector13mutable_arrayEv" title="Link to this definition"></a><br /></dt>
<dd><p>Get local part of the vector. </p>
<p><dl>
<dt class="sig sig-object cpp">
<em><span class="pre">Deprecated:</span></em></dt>
<dd><p>Use <a class="reference internal" href="#d2/d0b/classdolfinx_1_1la_1_1Vector_1a138cacaeb58bb73d0c223d48bb946d00"><span class="std std-ref">array</span></a> instead. </p>
</dd></dl>

</p>
</dd></dl>

</div>
</dd></dl>

<dl class="cpp type">
<dt class="sig sig-object cpp" id="_CPPv4N7dolfinx2la4implE">
<span id="_CPPv3N7dolfinx2la4implE"></span><span id="_CPPv2N7dolfinx2la4implE"></span><span id="dolfinx::la::impl"></span><span class="target" id="d8/d02/namespacedolfinx_1_1la_1_1impl"></span><span class="k"><span class="pre">namespace</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">impl</span></span></span><a class="headerlink" href="#_CPPv4N7dolfinx2la4implE" title="Link to this definition"></a><br /></dt>
<dd><div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-functions">Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_i_i000000EN7dolfinx2la4impl10insert_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE">
<span id="_CPPv3I_i_i000000EN7dolfinx2la4impl10insert_csrERR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE"></span><span id="_CPPv2I_i_i000000EN7dolfinx2la4impl10insert_csrERR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BS0</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BS1</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OP</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">U</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">V</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">W</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">X</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Y</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d8/dc8/matrix__csr__impl_8h_1a31692db705b456c0480131d9045a2131"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">insert_csr</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl10insert_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_csr::U"><span class="n"><span class="pre">U</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl10insert_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_csr::V"><span class="n"><span class="pre">V</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">cols</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl10insert_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_csr::W"><span class="n"><span class="pre">W</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">row_ptr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl10insert_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_csr::X"><span class="n"><span class="pre">X</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl10insert_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_csr::Y"><span class="n"><span class="pre">Y</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">xrows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl10insert_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_csr::Y"><span class="n"><span class="pre">Y</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">xcols</span></span>, <a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl10insert_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_csr::OP"><span class="n"><span class="pre">OP</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">op</span></span>, <span class="k"><span class="pre">typename</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl10insert_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_csr::Y"><span class="n"><span class="pre">Y</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">value_type</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_rows</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl10insert_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="Link to this definition"></a><br /></dt>
<dd><p>Incorporate data into a CSR matrix. </p>
<p>
0 1 | 2 3 <em>4 5 | 6 7 </em></p>
<p>8 9 | 10 11 12 13 | 14 15 </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the case of block data, where BS0 or BS1 are greater than one, the layout of the input data is still the same. For example, the following can be inserted into the top-left corner with <code class="docutils literal notranslate"><span class="pre">xrows={0,1}</span></code> and <code class="docutils literal notranslate"><span class="pre">xcols={0,1}</span></code>, <code class="docutils literal notranslate"><span class="pre">BS0=2</span></code>, <code class="docutils literal notranslate"><span class="pre">BS1=2</span></code> and <code class="docutils literal notranslate"><span class="pre">x={0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15}</span></code>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>BS0</strong> – Row block size (of both matrix and data). </p></li>
<li><p><strong>BS1</strong> – Column block size (of both matrix and data). </p></li>
<li><p><strong>OP</strong> – The operation (usually “set” or “add”). </p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>data</strong> – <strong>[out]</strong> CSR matrix data. </p></li>
<li><p><strong>cols</strong> – <strong>[in]</strong> CSR column indices. </p></li>
<li><p><strong>row_ptr</strong> – <strong>[in]</strong> Pointer to the ith row in the CSR data. </p></li>
<li><p><strong>x</strong> – <strong>[in]</strong> The <code class="docutils literal notranslate"><span class="pre">m</span></code> by <code class="docutils literal notranslate"><span class="pre">n</span></code> dense block of values (row-major) to add to the matrix. </p></li>
<li><p><strong>xrows</strong> – <strong>[in]</strong> Row indices of <code class="docutils literal notranslate"><span class="pre">x</span></code>. </p></li>
<li><p><strong>xcols</strong> – <strong>[in]</strong> Column indices of <code class="docutils literal notranslate"><span class="pre">x</span></code>. </p></li>
<li><p><strong>op</strong> – <strong>[in]</strong> The operation (set or add), </p></li>
<li><p><strong>num_rows</strong> – <strong>[in]</strong> Maximum row index that can be set. Used when debugging to check that rows beyond a permitted range are not being set.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I_i_i000000EN7dolfinx2la4impl18insert_blocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE">
<span id="_CPPv3I_i_i000000EN7dolfinx2la4impl18insert_blocked_csrERR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE"></span><span id="_CPPv2I_i_i000000EN7dolfinx2la4impl18insert_blocked_csrERR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BS0</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BS1</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OP</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">U</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">V</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">W</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">X</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Y</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d8/dc8/matrix__csr__impl_8h_1aa25ace929659f48c2174ceade56a4953"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">insert_blocked_csr</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl18insert_blocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_blocked_csr::U"><span class="n"><span class="pre">U</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl18insert_blocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_blocked_csr::V"><span class="n"><span class="pre">V</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">cols</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl18insert_blocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_blocked_csr::W"><span class="n"><span class="pre">W</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">row_ptr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl18insert_blocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_blocked_csr::X"><span class="n"><span class="pre">X</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl18insert_blocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_blocked_csr::Y"><span class="n"><span class="pre">Y</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">xrows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl18insert_blocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_blocked_csr::Y"><span class="n"><span class="pre">Y</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">xcols</span></span>, <a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl18insert_blocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_blocked_csr::OP"><span class="n"><span class="pre">OP</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">op</span></span>, <span class="k"><span class="pre">typename</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl18insert_blocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="dolfinx::la::impl::insert_blocked_csr::Y"><span class="n"><span class="pre">Y</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">value_type</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_rows</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I_i_i000000EN7dolfinx2la4impl18insert_blocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeE" title="Link to this definition"></a><br /></dt>
<dd><p>Incorporate blocked data with given block sizes into a non-blocked <a class="reference internal" href="#dc/dfa/classdolfinx_1_1la_1_1MatrixCSR"><span class="std std-ref">MatrixCSR</span></a>. </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Matrix block size (bs=1). Matrix sparsity must be correct to accept the data. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See ::insert_csr for data layout.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>BS0</strong> – Row block size of data. </p></li>
<li><p><strong>BS1</strong> – Column block size of data. </p></li>
<li><p><strong>OP</strong> – The operation (usually “set” or “add”). </p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>data</strong> – <strong>[out]</strong> CSR matrix data. </p></li>
<li><p><strong>cols</strong> – <strong>[in]</strong> CSR column indices. </p></li>
<li><p><strong>row_ptr</strong> – <strong>[in]</strong> Pointer to the ith row in the CSR data. </p></li>
<li><p><strong>x</strong> – <strong>[in]</strong> The <code class="docutils literal notranslate"><span class="pre">m</span></code> by <code class="docutils literal notranslate"><span class="pre">n</span></code> dense block of values (row-major) to add to the matrix. </p></li>
<li><p><strong>xrows</strong> – <strong>[in]</strong> Row indices of <code class="docutils literal notranslate"><span class="pre">x</span></code>. </p></li>
<li><p><strong>xcols</strong> – <strong>[in]</strong> Column indices of <code class="docutils literal notranslate"><span class="pre">x</span></code>. </p></li>
<li><p><strong>op</strong> – <strong>[in]</strong> The operation (set or add). </p></li>
<li><p><strong>num_rows</strong> – <strong>[in]</strong> Maximum row index that can be set. Used when debugging to check that rows beyond a permitted range are not being set. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I000000EN7dolfinx2la4impl21insert_nonblocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeEii">
<span id="_CPPv3I000000EN7dolfinx2la4impl21insert_nonblocked_csrERR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeEii"></span><span id="_CPPv2I000000EN7dolfinx2la4impl21insert_nonblocked_csrERR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeEii"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">OP</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">U</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">V</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">W</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">X</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Y</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d8/dc8/matrix__csr__impl_8h_1acc4c75ca996b044001c8f7677aa9b931"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">insert_nonblocked_csr</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv4I000000EN7dolfinx2la4impl21insert_nonblocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeEii" title="dolfinx::la::impl::insert_nonblocked_csr::U"><span class="n"><span class="pre">U</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">data</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000000EN7dolfinx2la4impl21insert_nonblocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeEii" title="dolfinx::la::impl::insert_nonblocked_csr::V"><span class="n"><span class="pre">V</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">cols</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000000EN7dolfinx2la4impl21insert_nonblocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeEii" title="dolfinx::la::impl::insert_nonblocked_csr::W"><span class="n"><span class="pre">W</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">row_ptr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000000EN7dolfinx2la4impl21insert_nonblocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeEii" title="dolfinx::la::impl::insert_nonblocked_csr::X"><span class="n"><span class="pre">X</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">x</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000000EN7dolfinx2la4impl21insert_nonblocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeEii" title="dolfinx::la::impl::insert_nonblocked_csr::Y"><span class="n"><span class="pre">Y</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">xrows</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000000EN7dolfinx2la4impl21insert_nonblocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeEii" title="dolfinx::la::impl::insert_nonblocked_csr::Y"><span class="n"><span class="pre">Y</span></span></a><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">xcols</span></span>, <a class="reference internal" href="#_CPPv4I000000EN7dolfinx2la4impl21insert_nonblocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeEii" title="dolfinx::la::impl::insert_nonblocked_csr::OP"><span class="n"><span class="pre">OP</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">op</span></span>, <span class="k"><span class="pre">typename</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I000000EN7dolfinx2la4impl21insert_nonblocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeEii" title="dolfinx::la::impl::insert_nonblocked_csr::Y"><span class="n"><span class="pre">Y</span></span></a><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">value_type</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">num_rows</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">bs0</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">bs1</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I000000EN7dolfinx2la4impl21insert_nonblocked_csrEvRR1URK1VRK1WRK1XRK1YRK1Y2OPN1Y10value_typeEii" title="Link to this definition"></a><br /></dt>
<dd><p>Incorporate non-blocked data into a blocked matrix (data block size=1) </p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Matrix sparsity must be correct to accept the data. </p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See ::insert_csr for data layout.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – <strong>[out]</strong> CSR matrix data. </p></li>
<li><p><strong>cols</strong> – <strong>[in]</strong> CSR column indices. </p></li>
<li><p><strong>row_ptr</strong> – <strong>[in]</strong> Pointer to the ith row in the CSR data. </p></li>
<li><p><strong>x</strong> – <strong>[in]</strong> The <code class="docutils literal notranslate"><span class="pre">m</span></code> by <code class="docutils literal notranslate"><span class="pre">n</span></code> dense block of values (row-major) to add to the matrix. </p></li>
<li><p><strong>xrows</strong> – <strong>[in]</strong> Rrow indices of <code class="docutils literal notranslate"><span class="pre">x</span></code>. </p></li>
<li><p><strong>xcols</strong> – <strong>[in]</strong> Column indices of <code class="docutils literal notranslate"><span class="pre">x</span></code>. </p></li>
<li><p><strong>op</strong> – <strong>[in]</strong> The operation (set or add). </p></li>
<li><p><strong>num_rows</strong> – <strong>[in]</strong> Maximum row index that can be set. Used when debugging to check that rows beyond a permitted range are not being set. </p></li>
<li><p><strong>bs0</strong> – <strong>[in]</strong> Row block size of matrix. </p></li>
<li><p><strong>bs1</strong> – <strong>[in]</strong> Column block size of matrix. </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4I0_iEN7dolfinx2la4impl4spmvEvNSt4spanIK1TEENSt4spanIKNSt7int64_tEEENSt4spanIKNSt7int64_tEEENSt4spanIKNSt7int32_tEEENSt4spanIK1TEENSt4spanI1TEEii">
<span id="_CPPv3I0_iEN7dolfinx2la4impl4spmvENSt4spanIK1TEENSt4spanIKNSt7int64_tEEENSt4spanIKNSt7int64_tEEENSt4spanIKNSt7int32_tEEENSt4spanIK1TEENSt4spanI1TEEii"></span><span id="_CPPv2I0_iEN7dolfinx2la4impl4spmvENSt4spanIK1TEENSt4spanIKNSt7int64_tEEENSt4spanIKNSt7int64_tEEENSt4spanIKNSt7int32_tEEENSt4spanIK1TEENSt4spanI1TEEii"></span><span class="k"><span class="pre">template</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">typename</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">T</span></span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">BS1</span></span></span><span class="p"><span class="pre">&gt;</span></span><br /><span class="target" id="d8/dc8/matrix__csr__impl_8h_1ad00ab7ccdc4d44c9a2765aa8fcbfdc18"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">spmv</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0_iEN7dolfinx2la4impl4spmvEvNSt4spanIK1TEENSt4spanIKNSt7int64_tEEENSt4spanIKNSt7int64_tEEENSt4spanIKNSt7int32_tEEENSt4spanIK1TEENSt4spanI1TEEii" title="dolfinx::la::impl::spmv::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">values</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">row_begin</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int64_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">row_end</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">int32_t</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">indices</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv4I0_iEN7dolfinx2la4impl4spmvEvNSt4spanIK1TEENSt4spanIKNSt7int64_tEEENSt4spanIKNSt7int64_tEEENSt4spanIKNSt7int32_tEEENSt4spanIK1TEENSt4spanI1TEEii" title="dolfinx::la::impl::spmv::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">x</span></span>, <span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">span</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="#_CPPv4I0_iEN7dolfinx2la4impl4spmvEvNSt4spanIK1TEENSt4spanIKNSt7int64_tEEENSt4spanIKNSt7int64_tEEENSt4spanIKNSt7int32_tEEENSt4spanIK1TEENSt4spanI1TEEii" title="dolfinx::la::impl::spmv::T"><span class="n"><span class="pre">T</span></span></a><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">y</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">bs0</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">bs1</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv4I0_iEN7dolfinx2la4impl4spmvEvNSt4spanIK1TEENSt4spanIKNSt7int64_tEEENSt4spanIKNSt7int64_tEEENSt4spanIKNSt7int32_tEEENSt4spanIK1TEENSt4spanI1TEEii" title="Link to this definition"></a><br /></dt>
<dd><p>Sparse matrix-vector product implementation. </p>
<dl class="field-list simple">
<dt class="field-odd">Template Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> – </p></li>
<li><p><strong>BS1</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Parameters<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>values</strong> – </p></li>
<li><p><strong>row_begin</strong> – </p></li>
<li><p><strong>row_end</strong> – </p></li>
<li><p><strong>indices</strong> – </p></li>
<li><p><strong>x</strong> – </p></li>
<li><p><strong>y</strong> – </p></li>
<li><p><strong>bs0</strong> – </p></li>
<li><p><strong>bs1</strong> – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="io.html" class="btn btn-neutral float-left" title="IO (dolfinx::io)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="mesh.html" class="btn btn-neutral float-right" title="Mesh (dolfinx::mesh)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, FEniCS Project.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>